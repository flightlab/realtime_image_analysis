/* Generated by Pyrex 0.9.5.1a on Thu Jan 10 00:13:45 2008 */

#include "Python.h"
#include "structmember.h"
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifdef __cplusplus
#define __PYX_EXTERN_C extern "C"
#else
#define __PYX_EXTERN_C extern
#endif
__PYX_EXTERN_C double pow(double, double);
#include "unistd.h"
#include "c_fit_params.h"
#include "eigen.h"
#include "motmot_ipp_macros.h"
#include "c_time_time.h"
#include "stdlib.h"
#include "math.h"
#include "ads_wrap_system.h"
#include "stdio.h"
#include "fi_ipp.h"


typedef struct {PyObject **p; char *s;} __Pyx_InternTabEntry; /*proto*/
typedef struct {PyObject **p; char *s; long n;} __Pyx_StringTabEntry; /*proto*/

static PyObject *__pyx_m;
static PyObject *__pyx_b;
static int __pyx_lineno;
static char *__pyx_filename;
static char **__pyx_f;

static int __Pyx_GetStarArgs(PyObject **args, PyObject **kwds, char *kwd_list[], int nargs, PyObject **args2, PyObject **kwds2); /*proto*/

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed, char *name); /*proto*/

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list); /*proto*/

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb); /*proto*/

static int __Pyx_PrintItem(PyObject *); /*proto*/
static int __Pyx_PrintNewline(void); /*proto*/

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type); /*proto*/

static PyObject *__Pyx_UnpackItem(PyObject *); /*proto*/
static int __Pyx_EndUnpack(PyObject *); /*proto*/

static int __Pyx_InternStrings(__Pyx_InternTabEntry *t); /*proto*/

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t); /*proto*/

static PyTypeObject *__Pyx_ImportType(char *module_name, char *class_name, long size);  /*proto*/

static int __Pyx_GetVtable(PyObject *dict, void *vtabptr); /*proto*/

static void __Pyx_AddTraceback(char *funcname); /*proto*/

/* Declarations from c_lib */


/* Declarations from c_python */


/* Declarations from ipp */


/* Declarations from motmot.FastImage.FastImage */


struct __pyx_obj_6motmot_9FastImage_9FastImage_Size {
  PyObject_HEAD
  IppiSize sz;
};


struct __pyx_obj_6motmot_9FastImage_9FastImage_Point {
  PyObject_HEAD
  IppiPoint pt;
};


struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase {
  PyObject_HEAD
  struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase *__pyx_vtab;
  void (*im);
  Py_intptr_t (shape[2]);
  Py_intptr_t (strides[2]);
  int step;
  int view;
  PyObject *basetype;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *imsiz;
  PyObject *source_data;
};

struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *((*c_roi)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *,int ,int ,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
};
static struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase *__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImageBase;


struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
};

struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage32f {
  struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
  void ((*fast_toself_add_weighted_8u)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *,float ));
  void ((*fast_toself_add_weighted_32f)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *,float ));
  void ((*fast_get_8u_copy_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
  void ((*fast_toself_square)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
  void ((*fast_get_square_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
  void ((*fast_get_subtracted_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
  void ((*fast_toself_multiply)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,float ,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
};
static struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage32f;


struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
};

struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage8u {
  struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
  void ((*fast_get_absdiff_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
  void ((*fast_get_sub_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
  void ((*fast_set_val_masked)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,Ipp8u ,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
  void ((*fast_get_32f_copy_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
  void ((*fast_get_compare_int_put_greater)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,int ,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
};
static struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage8u;


struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp {
  PyObject_HEAD
};


struct __pyx_obj_6motmot_9FastImage_9FastImage_square {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *base;
};


struct __pyx_obj_6motmot_9FastImage_9FastImage_sqrt {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *base;
};


struct __pyx_obj_6motmot_9FastImage_9FastImage_blend_with {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *other8u;
  float alpha;
};


struct __pyx_obj_6motmot_9FastImage_9FastImage_convert_to_8u {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *orig32f;
};


struct __pyx_obj_6motmot_9FastImage_9FastImage_convert_to_32f {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *orig8u;
};

static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_Size = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_Point = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_FastImageBase = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_LazyOp = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_square = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_sqrt = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_blend_with = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_8u = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_32f = 0;

/* Declarations from realtime_image_analysis */


struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer {
  PyObject_HEAD
  int maxwidth;
  int maxheight;
  int _left;
  int _bottom;
  int _right;
  int _top;
  int _roi2_radius;
  double _scale_factor;
  Ipp8u _diff_threshold;
  float _clear_threshold;
  PyObject *_pmat;
  PyObject *_pmat_inv;
  PyObject *camera_center;
  PyObject *_pmat_meters;
  PyObject *_pmat_meters_inv;
  PyObject *camera_center_meters;
  PyObject *_set_pmat;
  PyObject *_helper;
  Ipp8u _despeckle_threshold;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *_roi_sz;
  int n_rot_samples;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *absdiff_im;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmpdiff_im;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *absdiff_im_roi_view;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmpdiff_im_roi_view;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *absdiff_im_roi2_view;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmpdiff_im_roi2_view;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *mask_im;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *mean_im;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmp_im;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *mean_im_roi_view;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmp_im_roi_view;
  IppiMomentState_64f (*pState);
  PyObject *imname2im;
  int max_num_points;
};

static PyTypeObject *__pyx_ptype_23realtime_image_analysis_RealtimeAnalyzer = 0;
static double __pyx_v_23realtime_image_analysis_nan;
static int __pyx_k6;
static int __pyx_k7;
static double __pyx_k8;
static PyObject *__pyx_k10;
static int __pyx_k11;
static void (__pyx_f_23realtime_image_analysis_CHK_HAVEGIL(IppStatus )); /*proto*/
static PyObject *(__pyx_f_23realtime_image_analysis_print_8u_arr(Ipp8u (*),int ,int ,int )); /*proto*/


/* Implementation of realtime_image_analysis */

static char (__pyx_k4[]) = "numpy.dual";
static char (__pyx_k5[]) = "motmot.FastImage.FastImage";

static PyObject *__pyx_n_time;
static PyObject *__pyx_n_nx;
static PyObject *__pyx_n_warnings;
static PyObject *__pyx_n_numpy;
static PyObject *__pyx_n_FastImage;
static PyObject *__pyx_n_near_inf;
static PyObject *__pyx_n_c_lib;
static PyObject *__pyx_n_c_python;
static PyObject *__pyx_n_ipp;
static PyObject *__pyx_n_L_i;
static PyObject *__pyx_n_L_j;
static PyObject *__pyx_n_Lmatrix2Lcoords;
static PyObject *__pyx_n_pluecker_from_verts;
static PyObject *__pyx_n_bg_help_slow;
static PyObject *__pyx_n_bg_help;
static PyObject *__pyx_n_do_bg_maint;
static PyObject *__pyx_n_nan;
static PyObject *__pyx_n_array;
static PyObject *__pyx_n_mean;

static PyObject *__pyx_k4p;
static PyObject *__pyx_k5p;

static PyObject *__pyx_n_IppError;

static void __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(IppStatus __pyx_v_errval) {
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":63 */
  __pyx_1 = (__pyx_v_errval != ippStsNoErr);
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":64 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_FastImage); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; goto __pyx_L1;}
    __pyx_3 = PyObject_GetAttr(__pyx_2, __pyx_n_IppError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_2 = PyInt_FromLong(__pyx_v_errval); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; goto __pyx_L1;}
    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
    __pyx_2 = 0;
    __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 64; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("realtime_image_analysis.CHK_HAVEGIL");
  __pyx_L0:;
}

static PyObject *__pyx_k12p;

static char (__pyx_k12[]) = "%d";

static PyObject *__pyx_f_23realtime_image_analysis_print_8u_arr(Ipp8u (*__pyx_v_src),int __pyx_v_width,int __pyx_v_height,int __pyx_v_src_step) {
  int __pyx_v_row;
  int __pyx_v_col;
  Ipp8u (*__pyx_v_src_rowstart);
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":76 */
  for (__pyx_v_row = 0; __pyx_v_row < __pyx_v_height; ++__pyx_v_row) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":77 */
    __pyx_v_src_rowstart = (__pyx_v_src + (__pyx_v_row * __pyx_v_src_step));

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":78 */
    for (__pyx_v_col = 0; __pyx_v_col < __pyx_v_width; ++__pyx_v_col) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":79 */
      __pyx_1 = PyInt_FromLong((__pyx_v_src_rowstart[__pyx_v_col])); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; goto __pyx_L1;}
      __pyx_2 = PyNumber_Remainder(__pyx_k12p, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      if (__Pyx_PrintItem(__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 79; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
    }

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":80 */
    if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; goto __pyx_L1;}
  }

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":81 */
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 81; goto __pyx_L1;}

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("realtime_image_analysis.print_8u_arr");
  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_Lmatrix2Lcoords(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_Lmatrix2Lcoords(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_Lmatrix = 0;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static char *__pyx_argnames[] = {"Lmatrix",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_Lmatrix)) return 0;
  Py_INCREF(__pyx_v_Lmatrix);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":87 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_L_i); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_L_j); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_3, 1, __pyx_2);
  __pyx_1 = 0;
  __pyx_2 = 0;
  __pyx_1 = PyObject_GetItem(__pyx_v_Lmatrix, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("realtime_image_analysis.Lmatrix2Lcoords");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_Lmatrix);
  return __pyx_r;
}

static PyObject *__pyx_n_len;
static PyObject *__pyx_n_reshape;
static PyObject *__pyx_n_dot;
static PyObject *__pyx_n_transpose;

static PyObject *__pyx_f_23realtime_image_analysis_pluecker_from_verts(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_23realtime_image_analysis_pluecker_from_verts[] = "\n    See Hartley & Zisserman (2003) p. 70\n    ";
static PyObject *__pyx_f_23realtime_image_analysis_pluecker_from_verts(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_A = 0;
  PyObject *__pyx_v_B = 0;
  PyObject *__pyx_v_L;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  int __pyx_4;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  static char *__pyx_argnames[] = {"A","B",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OO", __pyx_argnames, &__pyx_v_A, &__pyx_v_B)) return 0;
  Py_INCREF(__pyx_v_A);
  Py_INCREF(__pyx_v_B);
  __pyx_v_L = Py_None; Py_INCREF(Py_None);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":93 */
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; goto __pyx_L1;}
  Py_INCREF(__pyx_v_A);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_A);
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyInt_FromLong(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_3, __pyx_1, &__pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 93; goto __pyx_L1;}
  __pyx_4 = __pyx_4 == 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_4) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":94 */
    __pyx_2 = PyInt_FromLong(0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; goto __pyx_L1;}
    __pyx_3 = PyObject_GetItem(__pyx_v_A, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_1 = PyInt_FromLong(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; goto __pyx_L1;}
    __pyx_2 = PyObject_GetItem(__pyx_v_A, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_1 = PyInt_FromLong(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; goto __pyx_L1;}
    __pyx_5 = PyObject_GetItem(__pyx_v_A, __pyx_1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_1 = PyFloat_FromDouble(1.0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; goto __pyx_L1;}
    __pyx_6 = PyTuple_New(4); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_6, 0, __pyx_3);
    PyTuple_SET_ITEM(__pyx_6, 1, __pyx_2);
    PyTuple_SET_ITEM(__pyx_6, 2, __pyx_5);
    PyTuple_SET_ITEM(__pyx_6, 3, __pyx_1);
    __pyx_3 = 0;
    __pyx_2 = 0;
    __pyx_5 = 0;
    __pyx_1 = 0;
    Py_DECREF(__pyx_v_A);
    __pyx_v_A = __pyx_6;
    __pyx_6 = 0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":95 */
  __pyx_3 = __Pyx_GetName(__pyx_b, __pyx_n_len); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 95; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 95; goto __pyx_L1;}
  Py_INCREF(__pyx_v_B);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_B);
  __pyx_5 = PyObject_CallObject(__pyx_3, __pyx_2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 95; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_1 = PyInt_FromLong(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 95; goto __pyx_L1;}
  if (PyObject_Cmp(__pyx_5, __pyx_1, &__pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 95; goto __pyx_L1;}
  __pyx_4 = __pyx_4 == 0;
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_4) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":96 */
    __pyx_6 = PyInt_FromLong(0); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; goto __pyx_L1;}
    __pyx_3 = PyObject_GetItem(__pyx_v_B, __pyx_6); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; goto __pyx_L1;}
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    __pyx_2 = PyInt_FromLong(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; goto __pyx_L1;}
    __pyx_5 = PyObject_GetItem(__pyx_v_B, __pyx_2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_1 = PyInt_FromLong(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; goto __pyx_L1;}
    __pyx_6 = PyObject_GetItem(__pyx_v_B, __pyx_1); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_2 = PyFloat_FromDouble(1.0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; goto __pyx_L1;}
    __pyx_1 = PyTuple_New(4); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 96; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
    PyTuple_SET_ITEM(__pyx_1, 1, __pyx_5);
    PyTuple_SET_ITEM(__pyx_1, 2, __pyx_6);
    PyTuple_SET_ITEM(__pyx_1, 3, __pyx_2);
    __pyx_3 = 0;
    __pyx_5 = 0;
    __pyx_6 = 0;
    __pyx_2 = 0;
    Py_DECREF(__pyx_v_B);
    __pyx_v_B = __pyx_1;
    __pyx_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":97 */
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; goto __pyx_L1;}
  __pyx_5 = PyObject_GetAttr(__pyx_3, __pyx_n_reshape); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_6 = PyInt_FromLong(4); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_6);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_2);
  __pyx_6 = 0;
  __pyx_2 = 0;
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; goto __pyx_L1;}
  Py_INCREF(__pyx_v_A);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_A);
  PyTuple_SET_ITEM(__pyx_3, 1, __pyx_1);
  __pyx_1 = 0;
  __pyx_6 = PyObject_CallObject(__pyx_5, __pyx_3); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 97; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_v_A);
  __pyx_v_A = __pyx_6;
  __pyx_6 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":98 */
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; goto __pyx_L1;}
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_reshape); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_5 = PyInt_FromLong(4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; goto __pyx_L1;}
  __pyx_3 = PyInt_FromLong(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; goto __pyx_L1;}
  __pyx_6 = PyTuple_New(2); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_6, 0, __pyx_5);
  PyTuple_SET_ITEM(__pyx_6, 1, __pyx_3);
  __pyx_5 = 0;
  __pyx_3 = 0;
  __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; goto __pyx_L1;}
  Py_INCREF(__pyx_v_B);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_B);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_6);
  __pyx_6 = 0;
  __pyx_5 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 98; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_v_B);
  __pyx_v_B = __pyx_5;
  __pyx_5 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":99 */
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  __pyx_6 = PyObject_GetAttr(__pyx_3, __pyx_n_dot); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_transpose); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_5 = PyTuple_New(1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  Py_INCREF(__pyx_v_B);
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_v_B);
  __pyx_3 = PyObject_CallObject(__pyx_2, __pyx_5); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  __pyx_1 = PyTuple_New(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  Py_INCREF(__pyx_v_A);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_A);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_3);
  __pyx_3 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_6, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_5 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  __pyx_3 = PyObject_GetAttr(__pyx_5, __pyx_n_dot); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  __pyx_6 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  __pyx_1 = PyObject_GetAttr(__pyx_6, __pyx_n_transpose); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  __pyx_5 = PyTuple_New(1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  Py_INCREF(__pyx_v_A);
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_v_A);
  __pyx_6 = PyObject_CallObject(__pyx_1, __pyx_5); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  __pyx_1 = PyTuple_New(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  Py_INCREF(__pyx_v_B);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_B);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_6);
  __pyx_6 = 0;
  __pyx_5 = PyObject_CallObject(__pyx_3, __pyx_1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_6 = PyNumber_Subtract(__pyx_2, __pyx_5); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 99; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_v_L);
  __pyx_v_L = __pyx_6;
  __pyx_6 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":100 */
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_Lmatrix2Lcoords); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; goto __pyx_L1;}
  Py_INCREF(__pyx_v_L);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_L);
  __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 100; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_r = __pyx_2;
  __pyx_2 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  __Pyx_AddTraceback("realtime_image_analysis.pluecker_from_verts");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_L);
  Py_DECREF(__pyx_v_A);
  Py_DECREF(__pyx_v_B);
  return __pyx_r;
}

static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kw = 0;
  int __pyx_r;
  static char *__pyx_argnames[] = {0};
  if (__Pyx_GetStarArgs(&__pyx_args, &__pyx_kwds, __pyx_argnames, 0, &__pyx_v_args, &__pyx_v_kw) < 0) return -1;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) {
    Py_XDECREF(__pyx_args);
    Py_XDECREF(__pyx_kwds);
    Py_XDECREF(__pyx_v_args);
    Py_XDECREF(__pyx_v_kw);
    return -1;
  }
  Py_INCREF(__pyx_v_self);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":161 */
  __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(ippiMomentInitAlloc_64f((&((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->pState),ippAlgHintFast)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 161; goto __pyx_L1;}

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.__new__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_XDECREF(__pyx_v_args);
  Py_XDECREF(__pyx_v_kw);
  Py_DECREF(__pyx_v_self);
  Py_XDECREF(__pyx_args);
  Py_XDECREF(__pyx_kwds);
  return __pyx_r;
}

static void __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___dealloc__(PyObject *__pyx_v_self) {
  Py_INCREF(__pyx_v_self);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":164 */
  __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(ippiMomentFree_64f(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->pState)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 164; goto __pyx_L1;}

  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.__dealloc__");
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
}

static PyObject *__pyx_n_False;
static PyObject *__pyx_n_set_val;
static PyObject *__pyx_n_absdiff;
static PyObject *__pyx_n_mask;
static PyObject *__pyx_n_cmp;
static PyObject *__pyx_n_cmpdiff;
static PyObject *__pyx_n_roi;


static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_lbrt = 0;
  int __pyx_v_maxwidth;
  int __pyx_v_maxheight;
  int __pyx_v_max_num_points;
  int __pyx_v_roi2_radius;
  PyObject *__pyx_v_sz;
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static char *__pyx_argnames[] = {"lbrt","maxwidth","maxheight","max_num_points","roi2_radius",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "Oiiii", __pyx_argnames, &__pyx_v_lbrt, &__pyx_v_maxwidth, &__pyx_v_maxheight, &__pyx_v_max_num_points, &__pyx_v_roi2_radius)) return -1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_lbrt);
  __pyx_v_sz = Py_None; Py_INCREF(Py_None);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":168 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxwidth = __pyx_v_maxwidth;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":169 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxheight = __pyx_v_maxheight;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":171 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->max_num_points = __pyx_v_max_num_points;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":174 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius = __pyx_v_roi2_radius;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":175 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold = 11;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":176 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold = 0.2;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":178 */
  Py_INCREF(Py_None);
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat = Py_None;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":179 */
  Py_INCREF(Py_None);
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_inv);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_inv = Py_None;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":180 */
  __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_False); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 180; goto __pyx_L1;}
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_set_pmat);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_set_pmat = __pyx_1;
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":182 */
  Py_INCREF(Py_None);
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->camera_center);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->camera_center = Py_None;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":183 */
  Py_INCREF(Py_None);
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->camera_center_meters);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->camera_center_meters = Py_None;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":185 */
  Py_INCREF(Py_None);
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_meters_inv);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_meters_inv = Py_None;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":187 */
  Py_INCREF(Py_None);
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_helper);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_helper = Py_None;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":189 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_scale_factor = __pyx_v_23realtime_image_analysis_nan;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":191 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_despeckle_threshold = 5;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":192 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->n_rot_samples = (100 * 60);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":194 */
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxwidth); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxheight); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_3, 1, __pyx_2);
  __pyx_1 = 0;
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_Size), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 194; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_v_sz);
  __pyx_v_sz = __pyx_1;
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":196 */
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; goto __pyx_L1;}
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_sz);
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 196; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":199 */
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 199; goto __pyx_L1;}
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_sz);
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 199; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 199; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":200 */
  __pyx_3 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im), __pyx_n_set_val); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_v_sz);
  __pyx_1 = 0;
  __pyx_1 = PyObject_CallObject(__pyx_3, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 200; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":202 */
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; goto __pyx_L1;}
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_sz);
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u), __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 202; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":203 */
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; goto __pyx_L1;}
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_sz);
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u), __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":204 */
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; goto __pyx_L1;}
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_sz);
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u), __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 204; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":207 */
  __pyx_3 = PyDict_New(); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; goto __pyx_L1;}
  if (PyDict_SetItem(__pyx_3, __pyx_n_absdiff, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; goto __pyx_L1;}
  if (PyDict_SetItem(__pyx_3, __pyx_n_mean, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; goto __pyx_L1;}
  if (PyDict_SetItem(__pyx_3, __pyx_n_mask, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; goto __pyx_L1;}
  if (PyDict_SetItem(__pyx_3, __pyx_n_cmp, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; goto __pyx_L1;}
  if (PyDict_SetItem(__pyx_3, __pyx_n_cmpdiff, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; goto __pyx_L1;}
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->imname2im);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->imname2im = __pyx_3;
  __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":214 */
  if (PyObject_SetAttr(__pyx_v_self, __pyx_n_roi, __pyx_v_lbrt) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 214; goto __pyx_L1;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":217 */
  __pyx_2 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view), __pyx_n_set_val); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_1);
  Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  __pyx_1 = 0;
  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 217; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_sz);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_lbrt);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_set_reconstruct_helper(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_set_reconstruct_helper(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_helper = 0;
  PyObject *__pyx_r;
  static char *__pyx_argnames[] = {"helper",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_helper)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_helper);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":220 */
  Py_INCREF(__pyx_v_helper);
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_helper);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_helper = __pyx_v_helper;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_helper);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_get_pmat(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_get_pmat(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_r;
  static char *__pyx_argnames[] = {0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":223 */
  Py_INCREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat);
  __pyx_r = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_asarray;
static PyObject *__pyx_n_dual;
static PyObject *__pyx_n_det;
static PyObject *__pyx_n_r_;
static PyObject *__pyx_n_newaxis;
static PyObject *__pyx_n_pinv;
static PyObject *__pyx_n_True;
static PyObject *__pyx_n_ones;

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_set_pmat(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_set_pmat(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_value = 0;
  PyObject *__pyx_v_P;
  PyObject *__pyx_v_determinant;
  PyObject *__pyx_v_r_;
  PyObject *__pyx_v_col0_asrow;
  PyObject *__pyx_v_col1_asrow;
  PyObject *__pyx_v_col2_asrow;
  PyObject *__pyx_v_col3_asrow;
  PyObject *__pyx_v_X;
  PyObject *__pyx_v_Y;
  PyObject *__pyx_v_Z;
  PyObject *__pyx_v_T;
  PyObject *__pyx_v_scale_array;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  static char *__pyx_argnames[] = {"value",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "O", __pyx_argnames, &__pyx_v_value)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_value);
  __pyx_v_P = Py_None; Py_INCREF(Py_None);
  __pyx_v_determinant = Py_None; Py_INCREF(Py_None);
  __pyx_v_r_ = Py_None; Py_INCREF(Py_None);
  __pyx_v_col0_asrow = Py_None; Py_INCREF(Py_None);
  __pyx_v_col1_asrow = Py_None; Py_INCREF(Py_None);
  __pyx_v_col2_asrow = Py_None; Py_INCREF(Py_None);
  __pyx_v_col3_asrow = Py_None; Py_INCREF(Py_None);
  __pyx_v_X = Py_None; Py_INCREF(Py_None);
  __pyx_v_Y = Py_None; Py_INCREF(Py_None);
  __pyx_v_Z = Py_None; Py_INCREF(Py_None);
  __pyx_v_T = Py_None; Py_INCREF(Py_None);
  __pyx_v_scale_array = Py_None; Py_INCREF(Py_None);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":226 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_asarray); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; goto __pyx_L1;}
  Py_INCREF(__pyx_v_value);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_value);
  __pyx_3 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat = __pyx_3;
  __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":228 */
  Py_INCREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat);
  Py_DECREF(__pyx_v_P);
  __pyx_v_P = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":229 */
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_dual); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_3 = PyObject_GetAttr(__pyx_1, __pyx_n_det); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_v_determinant);
  __pyx_v_determinant = __pyx_3;
  __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":230 */
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; goto __pyx_L1;}
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_r_); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_v_r_);
  __pyx_v_r_ = __pyx_1;
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":233 */
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_3, __pyx_n_newaxis); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_1 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; goto __pyx_L1;}
  __pyx_3 = PyInt_FromLong(0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_1);
  PyTuple_SET_ITEM(__pyx_4, 2, __pyx_3);
  __pyx_2 = 0;
  __pyx_1 = 0;
  __pyx_3 = 0;
  __pyx_2 = PyObject_GetItem(__pyx_v_P, __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  Py_DECREF(__pyx_v_col0_asrow);
  __pyx_v_col0_asrow = __pyx_2;
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":234 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  __pyx_3 = PyObject_GetAttr(__pyx_1, __pyx_n_newaxis); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_4 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_4);
  PyTuple_SET_ITEM(__pyx_1, 2, __pyx_2);
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_2 = 0;
  __pyx_3 = PyObject_GetItem(__pyx_v_P, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_v_col1_asrow);
  __pyx_v_col1_asrow = __pyx_3;
  __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":235 */
  __pyx_4 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_4, __pyx_n_newaxis); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  __pyx_1 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; goto __pyx_L1;}
  __pyx_3 = PyInt_FromLong(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_1);
  PyTuple_SET_ITEM(__pyx_4, 2, __pyx_3);
  __pyx_2 = 0;
  __pyx_1 = 0;
  __pyx_3 = 0;
  __pyx_2 = PyObject_GetItem(__pyx_v_P, __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  Py_DECREF(__pyx_v_col2_asrow);
  __pyx_v_col2_asrow = __pyx_2;
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":236 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
  __pyx_3 = PyObject_GetAttr(__pyx_1, __pyx_n_newaxis); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_4 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_4);
  PyTuple_SET_ITEM(__pyx_1, 2, __pyx_2);
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_2 = 0;
  __pyx_3 = PyObject_GetItem(__pyx_v_P, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_v_col3_asrow);
  __pyx_v_col3_asrow = __pyx_3;
  __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":237 */
  __pyx_4 = PyTuple_New(3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; goto __pyx_L1;}
  Py_INCREF(__pyx_v_col1_asrow);
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_v_col1_asrow);
  Py_INCREF(__pyx_v_col2_asrow);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_v_col2_asrow);
  Py_INCREF(__pyx_v_col3_asrow);
  PyTuple_SET_ITEM(__pyx_4, 2, __pyx_v_col3_asrow);
  __pyx_2 = PyObject_GetItem(__pyx_v_r_, __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_3 = PyObject_CallObject(__pyx_v_determinant, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_v_X);
  __pyx_v_X = __pyx_3;
  __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":238 */
  __pyx_4 = PyTuple_New(3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; goto __pyx_L1;}
  Py_INCREF(__pyx_v_col0_asrow);
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_v_col0_asrow);
  Py_INCREF(__pyx_v_col2_asrow);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_v_col2_asrow);
  Py_INCREF(__pyx_v_col3_asrow);
  PyTuple_SET_ITEM(__pyx_4, 2, __pyx_v_col3_asrow);
  __pyx_2 = PyObject_GetItem(__pyx_v_r_, __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_3 = PyObject_CallObject(__pyx_v_determinant, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_4 = PyNumber_Negative(__pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_v_Y);
  __pyx_v_Y = __pyx_4;
  __pyx_4 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":239 */
  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; goto __pyx_L1;}
  Py_INCREF(__pyx_v_col0_asrow);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_col0_asrow);
  Py_INCREF(__pyx_v_col1_asrow);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_v_col1_asrow);
  Py_INCREF(__pyx_v_col3_asrow);
  PyTuple_SET_ITEM(__pyx_2, 2, __pyx_v_col3_asrow);
  __pyx_1 = PyObject_GetItem(__pyx_v_r_, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_4 = PyObject_CallObject(__pyx_v_determinant, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_v_Z);
  __pyx_v_Z = __pyx_4;
  __pyx_4 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":240 */
  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; goto __pyx_L1;}
  Py_INCREF(__pyx_v_col0_asrow);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_col0_asrow);
  Py_INCREF(__pyx_v_col1_asrow);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_v_col1_asrow);
  Py_INCREF(__pyx_v_col2_asrow);
  PyTuple_SET_ITEM(__pyx_2, 2, __pyx_v_col2_asrow);
  __pyx_1 = PyObject_GetItem(__pyx_v_r_, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_4 = PyObject_CallObject(__pyx_v_determinant, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_2 = PyNumber_Negative(__pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  Py_DECREF(__pyx_v_T);
  __pyx_v_T = __pyx_2;
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":242 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; goto __pyx_L1;}
  __pyx_3 = PyObject_GetAttr(__pyx_1, __pyx_n_array); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_4 = PyNumber_Divide(__pyx_v_X, __pyx_v_T); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; goto __pyx_L1;}
  __pyx_2 = PyNumber_Divide(__pyx_v_Y, __pyx_v_T); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; goto __pyx_L1;}
  __pyx_1 = PyNumber_Divide(__pyx_v_Z, __pyx_v_T); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; goto __pyx_L1;}
  __pyx_5 = PyFloat_FromDouble(1.0); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; goto __pyx_L1;}
  __pyx_6 = PyList_New(4); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; goto __pyx_L1;}
  PyList_SET_ITEM(__pyx_6, 0, __pyx_4);
  PyList_SET_ITEM(__pyx_6, 1, __pyx_2);
  PyList_SET_ITEM(__pyx_6, 2, __pyx_1);
  PyList_SET_ITEM(__pyx_6, 3, __pyx_5);
  __pyx_4 = 0;
  __pyx_2 = 0;
  __pyx_1 = 0;
  __pyx_5 = 0;
  __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_6);
  __pyx_6 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->camera_center);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->camera_center = __pyx_2;
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":243 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; goto __pyx_L1;}
  __pyx_5 = PyObject_GetAttr(__pyx_1, __pyx_n_dual); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_6 = PyObject_GetAttr(__pyx_5, __pyx_n_pinv); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; goto __pyx_L1;}
  Py_INCREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat);
  PyTuple_SET_ITEM(__pyx_3, 0, ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat);
  __pyx_4 = PyObject_CallObject(__pyx_6, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_inv);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_inv = __pyx_4;
  __pyx_4 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":244 */
  __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_True); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; goto __pyx_L1;}
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_set_pmat);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_set_pmat = __pyx_2;
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":246 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; goto __pyx_L1;}
  __pyx_5 = PyObject_GetAttr(__pyx_1, __pyx_n_ones); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_6 = PyInt_FromLong(3); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; goto __pyx_L1;}
  __pyx_3 = PyInt_FromLong(4); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_6);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_3);
  __pyx_6 = 0;
  __pyx_3 = 0;
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_4);
  __pyx_4 = 0;
  __pyx_1 = PyObject_CallObject(__pyx_5, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_v_scale_array);
  __pyx_v_scale_array = __pyx_1;
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":247 */
  __pyx_6 = PyFloat_FromDouble(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_scale_factor); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; goto __pyx_L1;}
  __pyx_3 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; goto __pyx_L1;}
  __pyx_4 = PyInt_FromLong(3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; goto __pyx_L1;}
  __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_3);
  PyTuple_SET_ITEM(__pyx_5, 1, __pyx_4);
  __pyx_3 = 0;
  __pyx_4 = 0;
  if (PyObject_SetItem(__pyx_v_scale_array, __pyx_5, __pyx_6) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_6); __pyx_6 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":248 */
  __pyx_2 = PyNumber_Multiply(__pyx_v_scale_array, ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 248; goto __pyx_L1;}
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_meters);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_meters = __pyx_2;
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":249 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; goto __pyx_L1;}
  __pyx_3 = PyObject_GetAttr(__pyx_1, __pyx_n_dual); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_4 = PyObject_GetAttr(__pyx_3, __pyx_n_pinv); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_6 = PyTuple_New(1); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; goto __pyx_L1;}
  Py_INCREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_meters);
  PyTuple_SET_ITEM(__pyx_6, 0, ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_meters);
  __pyx_5 = PyObject_CallObject(__pyx_4, __pyx_6); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_meters_inv);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_meters_inv = __pyx_5;
  __pyx_5 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":250 */
  Py_INCREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_meters);
  Py_DECREF(__pyx_v_P);
  __pyx_v_P = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_meters;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":252 */
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; goto __pyx_L1;}
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_newaxis); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_3 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; goto __pyx_L1;}
  __pyx_4 = PyInt_FromLong(0); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; goto __pyx_L1;}
  __pyx_6 = PyTuple_New(3); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_6, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_6, 1, __pyx_3);
  PyTuple_SET_ITEM(__pyx_6, 2, __pyx_4);
  __pyx_1 = 0;
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_5 = PyObject_GetItem(__pyx_v_P, __pyx_6); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 252; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  Py_DECREF(__pyx_v_col0_asrow);
  __pyx_v_col0_asrow = __pyx_5;
  __pyx_5 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":253 */
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; goto __pyx_L1;}
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_newaxis); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_3 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; goto __pyx_L1;}
  __pyx_4 = PyInt_FromLong(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; goto __pyx_L1;}
  __pyx_6 = PyTuple_New(3); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_6, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_6, 1, __pyx_3);
  PyTuple_SET_ITEM(__pyx_6, 2, __pyx_4);
  __pyx_1 = 0;
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_5 = PyObject_GetItem(__pyx_v_P, __pyx_6); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 253; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  Py_DECREF(__pyx_v_col1_asrow);
  __pyx_v_col1_asrow = __pyx_5;
  __pyx_5 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":254 */
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; goto __pyx_L1;}
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_newaxis); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_3 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; goto __pyx_L1;}
  __pyx_4 = PyInt_FromLong(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; goto __pyx_L1;}
  __pyx_6 = PyTuple_New(3); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_6, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_6, 1, __pyx_3);
  PyTuple_SET_ITEM(__pyx_6, 2, __pyx_4);
  __pyx_1 = 0;
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_5 = PyObject_GetItem(__pyx_v_P, __pyx_6); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 254; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  Py_DECREF(__pyx_v_col2_asrow);
  __pyx_v_col2_asrow = __pyx_5;
  __pyx_5 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":255 */
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; goto __pyx_L1;}
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_newaxis); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_3 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; goto __pyx_L1;}
  __pyx_4 = PyInt_FromLong(3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; goto __pyx_L1;}
  __pyx_6 = PyTuple_New(3); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_6, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_6, 1, __pyx_3);
  PyTuple_SET_ITEM(__pyx_6, 2, __pyx_4);
  __pyx_1 = 0;
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_5 = PyObject_GetItem(__pyx_v_P, __pyx_6); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 255; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  Py_DECREF(__pyx_v_col3_asrow);
  __pyx_v_col3_asrow = __pyx_5;
  __pyx_5 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":256 */
  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; goto __pyx_L1;}
  Py_INCREF(__pyx_v_col1_asrow);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_col1_asrow);
  Py_INCREF(__pyx_v_col2_asrow);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_v_col2_asrow);
  Py_INCREF(__pyx_v_col3_asrow);
  PyTuple_SET_ITEM(__pyx_2, 2, __pyx_v_col3_asrow);
  __pyx_1 = PyObject_GetItem(__pyx_v_r_, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_1);
  __pyx_1 = 0;
  __pyx_4 = PyObject_CallObject(__pyx_v_determinant, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_v_X);
  __pyx_v_X = __pyx_4;
  __pyx_4 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":257 */
  __pyx_6 = PyTuple_New(3); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; goto __pyx_L1;}
  Py_INCREF(__pyx_v_col0_asrow);
  PyTuple_SET_ITEM(__pyx_6, 0, __pyx_v_col0_asrow);
  Py_INCREF(__pyx_v_col2_asrow);
  PyTuple_SET_ITEM(__pyx_6, 1, __pyx_v_col2_asrow);
  Py_INCREF(__pyx_v_col3_asrow);
  PyTuple_SET_ITEM(__pyx_6, 2, __pyx_v_col3_asrow);
  __pyx_5 = PyObject_GetItem(__pyx_v_r_, __pyx_6); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_5);
  __pyx_5 = 0;
  __pyx_1 = PyObject_CallObject(__pyx_v_determinant, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_3 = PyNumber_Negative(__pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 257; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_v_Y);
  __pyx_v_Y = __pyx_3;
  __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":258 */
  __pyx_4 = PyTuple_New(3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; goto __pyx_L1;}
  Py_INCREF(__pyx_v_col0_asrow);
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_v_col0_asrow);
  Py_INCREF(__pyx_v_col1_asrow);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_v_col1_asrow);
  Py_INCREF(__pyx_v_col3_asrow);
  PyTuple_SET_ITEM(__pyx_4, 2, __pyx_v_col3_asrow);
  __pyx_6 = PyObject_GetItem(__pyx_v_r_, __pyx_4); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  __pyx_5 = PyTuple_New(1); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_6);
  __pyx_6 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_v_determinant, __pyx_5); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_v_Z);
  __pyx_v_Z = __pyx_2;
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":259 */
  __pyx_1 = PyTuple_New(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; goto __pyx_L1;}
  Py_INCREF(__pyx_v_col0_asrow);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_col0_asrow);
  Py_INCREF(__pyx_v_col1_asrow);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_v_col1_asrow);
  Py_INCREF(__pyx_v_col2_asrow);
  PyTuple_SET_ITEM(__pyx_1, 2, __pyx_v_col2_asrow);
  __pyx_3 = PyObject_GetItem(__pyx_v_r_, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_3);
  __pyx_3 = 0;
  __pyx_6 = PyObject_CallObject(__pyx_v_determinant, __pyx_4); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  __pyx_5 = PyNumber_Negative(__pyx_6); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  Py_DECREF(__pyx_v_T);
  __pyx_v_T = __pyx_5;
  __pyx_5 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":260 */
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; goto __pyx_L1;}
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_array); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_3 = PyNumber_Divide(__pyx_v_X, __pyx_v_T); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; goto __pyx_L1;}
  __pyx_4 = PyNumber_Divide(__pyx_v_Y, __pyx_v_T); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; goto __pyx_L1;}
  __pyx_6 = PyNumber_Divide(__pyx_v_Z, __pyx_v_T); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; goto __pyx_L1;}
  __pyx_5 = PyFloat_FromDouble(1.0); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; goto __pyx_L1;}
  __pyx_2 = PyList_New(4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; goto __pyx_L1;}
  PyList_SET_ITEM(__pyx_2, 0, __pyx_3);
  PyList_SET_ITEM(__pyx_2, 1, __pyx_4);
  PyList_SET_ITEM(__pyx_2, 2, __pyx_6);
  PyList_SET_ITEM(__pyx_2, 3, __pyx_5);
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_6 = 0;
  __pyx_5 = 0;
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  __pyx_2 = 0;
  __pyx_4 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 260; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->camera_center_meters);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->camera_center_meters = __pyx_4;
  __pyx_4 = 0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.set_pmat");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_P);
  Py_DECREF(__pyx_v_determinant);
  Py_DECREF(__pyx_v_r_);
  Py_DECREF(__pyx_v_col0_asrow);
  Py_DECREF(__pyx_v_col1_asrow);
  Py_DECREF(__pyx_v_col2_asrow);
  Py_DECREF(__pyx_v_col3_asrow);
  Py_DECREF(__pyx_v_X);
  Py_DECREF(__pyx_v_Y);
  Py_DECREF(__pyx_v_Z);
  Py_DECREF(__pyx_v_T);
  Py_DECREF(__pyx_v_scale_array);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_value);
  return __pyx_r;
}

static PyObject *__pyx_n_distort;

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_distort(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_distort(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  float __pyx_v_x0;
  float __pyx_v_y0;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  static char *__pyx_argnames[] = {"x0","y0",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "ff", __pyx_argnames, &__pyx_v_x0, &__pyx_v_y0)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":263 */
  __pyx_1 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_helper == Py_None;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":264 */
    __pyx_2 = PyFloat_FromDouble(__pyx_v_x0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 264; goto __pyx_L1;}
    __pyx_3 = PyFloat_FromDouble(__pyx_v_y0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 264; goto __pyx_L1;}
    __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 264; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
    PyTuple_SET_ITEM(__pyx_4, 1, __pyx_3);
    __pyx_2 = 0;
    __pyx_3 = 0;
    __pyx_r = __pyx_4;
    __pyx_4 = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":265 */
  __pyx_2 = PyObject_GetAttr(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_helper, __pyx_n_distort); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; goto __pyx_L1;}
  __pyx_3 = PyFloat_FromDouble(__pyx_v_x0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; goto __pyx_L1;}
  __pyx_4 = PyFloat_FromDouble(__pyx_v_y0); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; goto __pyx_L1;}
  __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_3);
  PyTuple_SET_ITEM(__pyx_5, 1, __pyx_4);
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_3 = PyObject_CallObject(__pyx_2, __pyx_5); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 265; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  __pyx_r = __pyx_3;
  __pyx_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.distort");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_svd;
static PyObject *__pyx_n_ValueError;
static PyObject *__pyx_n_str;
static PyObject *__pyx_n_warn;
static PyObject *__pyx_n_stacklevel;
static PyObject *__pyx_n_undistort;
static PyObject *__pyx_n_full_matrices;
static PyObject *__pyx_n_append;

static PyObject *__pyx_k18p;
static PyObject *__pyx_k19p;
static PyObject *__pyx_k22p;

static char (__pyx_k18[]) = "input image size (%s) does not correspond to ROI (%s)(set RealtimeAnalyzer.roi before calling)";
static char (__pyx_k19[]) = "stopped looking for points (this frame only) because it was taking longer than max_duration_sec";
static char (__pyx_k22[]) = "ERROR: SVD returned nan";

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_do_work(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_23realtime_image_analysis_16RealtimeAnalyzer_do_work[] = "find fly and orientation (fast enough for realtime use)\n\n        inputs\n        ------\n\n        timestamp\n        framenumber\n        use_roi2\n\n        optional inputs (default to 0)\n        ------------------------------\n        use_cmp -- perform more detailed analysis against cmp image (used with ongoing variance estimation)\n        return_first_xy -- for debugging\n\n        outputs\n        -------\n\n        [ (x0_abs, y0_abs, area, slope, eccentricity, p1, p2, p3, p4) ]\n\n        ";
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_do_work(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_raw_im_small = 0;
  double __pyx_v_timestamp;
  int __pyx_v_framenumber;
  int __pyx_v_use_roi2;
  int __pyx_v_use_cmp;
  int __pyx_v_return_first_xy;
  double __pyx_v_max_duration_sec;
  double __pyx_v_x0;
  double __pyx_v_y0;
  double __pyx_v_x0_abs;
  double __pyx_v_y0_abs;
  double __pyx_v_area;
  double __pyx_v_x0u;
  double __pyx_v_y0u;
  double __pyx_v_x1u;
  double __pyx_v_y1u;
  double __pyx_v_orientation;
  double __pyx_v_slope;
  double __pyx_v_eccentricity;
  double __pyx_v_p1;
  double __pyx_v_p2;
  double __pyx_v_p3;
  double __pyx_v_p4;
  double __pyx_v_rise;
  double __pyx_v_run;
  double __pyx_v_evalA;
  double __pyx_v_evalB;
  double __pyx_v_evecA1;
  double __pyx_v_evecB1;
  double __pyx_v_Mu00;
  double __pyx_v_Uu11;
  double __pyx_v_Uu02;
  double __pyx_v_Uu20;
  int __pyx_v_result;
  int __pyx_v_eigen_err;
  int __pyx_v_index_x;
  int __pyx_v_index_y;
  Ipp8u __pyx_v_max_val;
  Ipp8u (*__pyx_v_max_val_ptr);
  Ipp8u __pyx_v_max_std_diff;
  Ipp8u __pyx_v_clear_despeckle_thresh;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *__pyx_v_roi2_sz;
  int __pyx_v_left2;
  int __pyx_v_right2;
  int __pyx_v_bottom2;
  int __pyx_v_top2;
  int __pyx_v_found_point;
  int __pyx_v_n_found_points;
  double __pyx_v_entry_time;
  double __pyx_v_now;
  PyObject *__pyx_v_matrixmultiply;
  PyObject *__pyx_v_svd;
  PyObject *__pyx_v_all_points_found;
  PyObject *__pyx_v_rval;
  PyObject *__pyx_v_undistort;
  PyObject *__pyx_v_found_point_image_plane;
  PyObject *__pyx_v_X0;
  PyObject *__pyx_v_X1;
  PyObject *__pyx_v_A;
  PyObject *__pyx_v_u;
  PyObject *__pyx_v_d;
  PyObject *__pyx_v_vt;
  PyObject *__pyx_v_Pt;
  PyObject *__pyx_v_line_found;
  PyObject *__pyx_v_X0meters;
  PyObject *__pyx_v_pluecker_meters;
  PyObject *__pyx_v_ray_valid;
  PyObject *__pyx_v_ray0;
  PyObject *__pyx_v_ray1;
  PyObject *__pyx_v_ray2;
  PyObject *__pyx_v_ray3;
  PyObject *__pyx_v_ray4;
  PyObject *__pyx_v_ray5;
  PyObject *__pyx_v_slope_found;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  double __pyx_3;
  PyObject *__pyx_4 = 0;
  int __pyx_5;
  int __pyx_6;
  PyObject *__pyx_7 = 0;
  PyObject *__pyx_8 = 0;
  PyObject *__pyx_9 = 0;
  PyObject *__pyx_10 = 0;
  PyObject *__pyx_11 = 0;
  PyObject *__pyx_12 = 0;
  PyObject *__pyx_13 = 0;
  PyObject *__pyx_14 = 0;
  PyObject *__pyx_15 = 0;
  PyObject *__pyx_16 = 0;
  static char *__pyx_argnames[] = {"raw_im_small","timestamp","framenumber","use_roi2","use_cmp","return_first_xy","max_duration_sec",0};
  __pyx_v_use_cmp = __pyx_k6;
  __pyx_v_return_first_xy = __pyx_k7;
  __pyx_v_max_duration_sec = __pyx_k8;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "Odii|iid", __pyx_argnames, &__pyx_v_raw_im_small, &__pyx_v_timestamp, &__pyx_v_framenumber, &__pyx_v_use_roi2, &__pyx_v_use_cmp, &__pyx_v_return_first_xy, &__pyx_v_max_duration_sec)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF((PyObject *)__pyx_v_raw_im_small);
  __pyx_v_roi2_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)Py_None); Py_INCREF(Py_None);
  __pyx_v_matrixmultiply = Py_None; Py_INCREF(Py_None);
  __pyx_v_svd = Py_None; Py_INCREF(Py_None);
  __pyx_v_all_points_found = Py_None; Py_INCREF(Py_None);
  __pyx_v_rval = Py_None; Py_INCREF(Py_None);
  __pyx_v_undistort = Py_None; Py_INCREF(Py_None);
  __pyx_v_found_point_image_plane = Py_None; Py_INCREF(Py_None);
  __pyx_v_X0 = Py_None; Py_INCREF(Py_None);
  __pyx_v_X1 = Py_None; Py_INCREF(Py_None);
  __pyx_v_A = Py_None; Py_INCREF(Py_None);
  __pyx_v_u = Py_None; Py_INCREF(Py_None);
  __pyx_v_d = Py_None; Py_INCREF(Py_None);
  __pyx_v_vt = Py_None; Py_INCREF(Py_None);
  __pyx_v_Pt = Py_None; Py_INCREF(Py_None);
  __pyx_v_line_found = Py_None; Py_INCREF(Py_None);
  __pyx_v_X0meters = Py_None; Py_INCREF(Py_None);
  __pyx_v_pluecker_meters = Py_None; Py_INCREF(Py_None);
  __pyx_v_ray_valid = Py_None; Py_INCREF(Py_None);
  __pyx_v_ray0 = Py_None; Py_INCREF(Py_None);
  __pyx_v_ray1 = Py_None; Py_INCREF(Py_None);
  __pyx_v_ray2 = Py_None; Py_INCREF(Py_None);
  __pyx_v_ray3 = Py_None; Py_INCREF(Py_None);
  __pyx_v_ray4 = Py_None; Py_INCREF(Py_None);
  __pyx_v_ray5 = Py_None; Py_INCREF(Py_None);
  __pyx_v_slope_found = Py_None; Py_INCREF(Py_None);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_raw_im_small), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "raw_im_small")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; goto __pyx_L1;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":327 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_time); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 327; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_time); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 327; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyObject_CallObject(__pyx_2, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 327; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_3 = PyFloat_AsDouble(__pyx_1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 327; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_v_entry_time = __pyx_3;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":329 */
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; goto __pyx_L1;}
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_dot); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_v_matrixmultiply);
  __pyx_v_matrixmultiply = __pyx_1;
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":330 */
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; goto __pyx_L1;}
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_dual); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_svd); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_v_svd);
  __pyx_v_svd = __pyx_2;
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":332 */
  __pyx_1 = PyInt_FromLong(21); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(21); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_2);
  __pyx_1 = 0;
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_Size), __pyx_4); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_6motmot_9FastImage_9FastImage_Size)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_roi2_sz));
  __pyx_v_roi2_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":334 */
  __pyx_2 = PyList_New(0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 334; goto __pyx_L1;}
  Py_DECREF(__pyx_v_all_points_found);
  __pyx_v_all_points_found = __pyx_2;
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":335 */
  __pyx_v_n_found_points = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":338 */
  __pyx_5 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.width == __pyx_v_raw_im_small->__pyx_base.imsiz->sz.width);
  if (__pyx_5) {
    __pyx_5 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.height == __pyx_v_raw_im_small->__pyx_base.imsiz->sz.height);
  }
  __pyx_6 = (!__pyx_5);
  if (__pyx_6) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":340 */
    __pyx_4 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; goto __pyx_L1;}
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_str); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
    __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
    Py_INCREF(((PyObject *)__pyx_v_raw_im_small->__pyx_base.imsiz));
    PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_raw_im_small->__pyx_base.imsiz));
    __pyx_7 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_str); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
    __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
    Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
    PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
    __pyx_8 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_1 = PyTuple_New(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_7);
    PyTuple_SET_ITEM(__pyx_1, 1, __pyx_8);
    __pyx_7 = 0;
    __pyx_8 = 0;
    __pyx_2 = PyNumber_Remainder(__pyx_k18p, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_7 = PyTuple_New(1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_7, 0, __pyx_2);
    __pyx_2 = 0;
    __pyx_8 = PyObject_CallObject(__pyx_4, __pyx_7); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; goto __pyx_L1;}
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    Py_DECREF(__pyx_7); __pyx_7 = 0;
    __Pyx_Raise(__pyx_8, 0, 0);
    Py_DECREF(__pyx_8); __pyx_8 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":345 */
  Py_BEGIN_ALLOW_THREADS;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":350 */
  CHK_NOGIL(ippiAbsDiff_8u_C1R(((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view->__pyx_base.step,((Ipp8u (*))__pyx_v_raw_im_small->__pyx_base.im),__pyx_v_raw_im_small->__pyx_base.step,((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":360 */
  CHK_NOGIL(ippiSet_8u_C1MR(0,((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im->__pyx_base.imsiz->sz,((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im->__pyx_base.step));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":363 */
  __pyx_5 = __pyx_v_use_cmp;
  if (__pyx_5) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":365 */
    CHK_NOGIL(ippiThreshold_Val_8u_C1IR(((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold,ippCmpLess));
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":369 */
  Py_END_ALLOW_THREADS;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":371 */
  while (1) {
    __pyx_6 = (__pyx_v_n_found_points < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->max_num_points);
    if (!__pyx_6) break;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":372 */
    __pyx_5 = (__pyx_v_max_duration_sec != 0.0);
    if (__pyx_5) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":373 */
      __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_time); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; goto __pyx_L1;}
      __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_time); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_4 = PyObject_CallObject(__pyx_2, 0); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __pyx_3 = PyFloat_AsDouble(__pyx_4); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 373; goto __pyx_L1;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      __pyx_v_now = __pyx_3;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":374 */
      __pyx_6 = ((__pyx_v_now - __pyx_v_entry_time) > __pyx_v_max_duration_sec);
      if (__pyx_6) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":375 */
        __pyx_7 = __Pyx_GetName(__pyx_m, __pyx_n_warnings); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; goto __pyx_L1;}
        __pyx_8 = PyObject_GetAttr(__pyx_7, __pyx_n_warn); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; goto __pyx_L1;}
        Py_DECREF(__pyx_7); __pyx_7 = 0;
        __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; goto __pyx_L1;}
        Py_INCREF(__pyx_k19p);
        PyTuple_SET_ITEM(__pyx_1, 0, __pyx_k19p);
        __pyx_2 = PyDict_New(); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; goto __pyx_L1;}
        __pyx_4 = PyInt_FromLong(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 376; goto __pyx_L1;}
        if (PyDict_SetItem(__pyx_2, __pyx_n_stacklevel, __pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; goto __pyx_L1;}
        Py_DECREF(__pyx_4); __pyx_4 = 0;
        __pyx_7 = PyEval_CallObjectWithKeywords(__pyx_8, __pyx_1, __pyx_2); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 375; goto __pyx_L1;}
        Py_DECREF(__pyx_8); __pyx_8 = 0;
        Py_DECREF(__pyx_1); __pyx_1 = 0;
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        Py_DECREF(__pyx_7); __pyx_7 = 0;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":377 */
        goto __pyx_L5;
        goto __pyx_L7;
      }
      __pyx_L7:;
      goto __pyx_L6;
    }
    __pyx_L6:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":379 */
    Py_BEGIN_ALLOW_THREADS;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":395 */
    __pyx_5 = __pyx_v_use_cmp;
    if (__pyx_5) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":400 */
      CHK_NOGIL(ippiSub_8u_C1RSfs(((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.step,((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step,((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,0));

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":404 */
      CHK_NOGIL(ippiMaxIndx_8u_C1R(((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,(&__pyx_v_max_std_diff),(&__pyx_v_index_x),(&__pyx_v_index_y)));

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":407 */
      __pyx_v_max_val_ptr = ((((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im) + (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step * __pyx_v_index_y)) + __pyx_v_index_x);

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":408 */
      __pyx_v_max_val = (__pyx_v_max_val_ptr[0]);
      goto __pyx_L8;
    }
    /*else*/ {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":410 */
      CHK_NOGIL(ippiMaxIndx_8u_C1R(((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,(&__pyx_v_max_val),(&__pyx_v_index_x),(&__pyx_v_index_y)));
    }
    __pyx_L8:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":414 */
    __pyx_6 = __pyx_v_use_roi2;
    if (__pyx_6) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":416 */
      __pyx_v_left2 = ((__pyx_v_index_x - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":417 */
      __pyx_v_right2 = ((__pyx_v_index_x + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":418 */
      __pyx_v_bottom2 = ((__pyx_v_index_y - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":419 */
      __pyx_v_top2 = ((__pyx_v_index_y + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":421 */
      __pyx_5 = (__pyx_v_left2 < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);
      if (__pyx_5) {
        __pyx_v_left2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left;
        goto __pyx_L10;
      }
      __pyx_L10:;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":422 */
      __pyx_6 = (__pyx_v_right2 > ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right);
      if (__pyx_6) {
        __pyx_v_right2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right;
        goto __pyx_L11;
      }
      __pyx_L11:;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":423 */
      __pyx_5 = (__pyx_v_bottom2 < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);
      if (__pyx_5) {
        __pyx_v_bottom2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom;
        goto __pyx_L12;
      }
      __pyx_L12:;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":424 */
      __pyx_6 = (__pyx_v_top2 > ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top);
      if (__pyx_6) {
        __pyx_v_top2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top;
        goto __pyx_L13;
      }
      __pyx_L13:;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":425 */
      __pyx_v_roi2_sz->sz.width = ((__pyx_v_right2 - __pyx_v_left2) + 1);

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":426 */
      __pyx_v_roi2_sz->sz.height = ((__pyx_v_top2 - __pyx_v_bottom2) + 1);
      goto __pyx_L9;
    }
    /*else*/ {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":428 */
      __pyx_v_left2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":429 */
      __pyx_v_right2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":430 */
      __pyx_v_bottom2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":431 */
      __pyx_v_top2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":432 */
      __pyx_v_roi2_sz->sz.width = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.width;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":433 */
      __pyx_v_roi2_sz->sz.height = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.height;
    }
    __pyx_L9:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":435 */
    Py_END_ALLOW_THREADS;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":437 */
    __pyx_4 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im), __pyx_n_roi); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; goto __pyx_L1;}
    __pyx_8 = PyInt_FromLong(__pyx_v_left2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; goto __pyx_L1;}
    __pyx_1 = PyInt_FromLong(__pyx_v_bottom2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; goto __pyx_L1;}
    __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_8);
    PyTuple_SET_ITEM(__pyx_2, 1, __pyx_1);
    Py_INCREF(((PyObject *)__pyx_v_roi2_sz));
    PyTuple_SET_ITEM(__pyx_2, 2, ((PyObject *)__pyx_v_roi2_sz));
    __pyx_8 = 0;
    __pyx_1 = 0;
    __pyx_7 = PyObject_CallObject(__pyx_4, __pyx_2); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; goto __pyx_L1;}
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    if (!__Pyx_TypeTest(__pyx_7, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; goto __pyx_L1;}
    Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view));
    ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_7);
    __pyx_7 = 0;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":438 */
    __pyx_5 = __pyx_v_use_cmp;
    if (__pyx_5) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":439 */
      __pyx_8 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im), __pyx_n_roi); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; goto __pyx_L1;}
      __pyx_1 = PyInt_FromLong(__pyx_v_left2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; goto __pyx_L1;}
      __pyx_4 = PyInt_FromLong(__pyx_v_bottom2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; goto __pyx_L1;}
      __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
      PyTuple_SET_ITEM(__pyx_2, 1, __pyx_4);
      Py_INCREF(((PyObject *)__pyx_v_roi2_sz));
      PyTuple_SET_ITEM(__pyx_2, 2, ((PyObject *)__pyx_v_roi2_sz));
      __pyx_1 = 0;
      __pyx_4 = 0;
      __pyx_7 = PyObject_CallObject(__pyx_8, __pyx_2); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; goto __pyx_L1;}
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      if (!__Pyx_TypeTest(__pyx_7, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; goto __pyx_L1;}
      Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi2_view));
      ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_7);
      __pyx_7 = 0;
      goto __pyx_L14;
    }
    __pyx_L14:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":440 */
    Py_BEGIN_ALLOW_THREADS;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":444 */
    __pyx_v_clear_despeckle_thresh = ((unsigned char )(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold * __pyx_v_max_val));

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":445 */
    __pyx_6 = (__pyx_v_clear_despeckle_thresh < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_despeckle_threshold);
    if (__pyx_6) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":446 */
      __pyx_v_clear_despeckle_thresh = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_despeckle_threshold;
      goto __pyx_L15;
    }
    __pyx_L15:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":448 */
    CHK_NOGIL(ippiThreshold_Val_8u_C1IR(((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.step,__pyx_v_roi2_sz->sz,__pyx_v_clear_despeckle_thresh,0,ippCmpLess));

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":452 */
    __pyx_v_found_point = 1;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":454 */
    __pyx_5 = (!__pyx_v_use_cmp);
    if (__pyx_5) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":455 */
      __pyx_6 = (__pyx_v_max_val < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold);
      if (__pyx_6) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":456 */
        __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":457 */
        __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":458 */
        __pyx_v_x0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":459 */
        __pyx_v_y0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":460 */
        __pyx_v_found_point = 0;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":461 */
        __pyx_v_max_val = 0;
        goto __pyx_L17;
      }
      __pyx_L17:;
      goto __pyx_L16;
    }
    /*else*/ {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":463 */
      __pyx_5 = (__pyx_v_max_std_diff == 0);
      if (__pyx_5) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":464 */
        __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":465 */
        __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":466 */
        __pyx_v_x0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":467 */
        __pyx_v_y0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":468 */
        __pyx_v_found_point = 0;
        goto __pyx_L18;
      }
      __pyx_L18:;
    }
    __pyx_L16:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":469 */
    __pyx_6 = __pyx_v_found_point;
    if (__pyx_6) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":470 */
      __pyx_v_result = fit_params(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->pState,(&__pyx_v_x0),(&__pyx_v_y0),(&__pyx_v_Mu00),(&__pyx_v_Uu11),(&__pyx_v_Uu20),(&__pyx_v_Uu02),__pyx_v_roi2_sz->sz.width,__pyx_v_roi2_sz->sz.height,((unsigned char (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.step);

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":477 */
      __pyx_5 = (__pyx_v_result == CFitParamsNoError);
      if (__pyx_5) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":478 */
        __pyx_v_area = __pyx_v_Mu00;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":479 */
        __pyx_v_eigen_err = eigen_2x2_real(__pyx_v_Uu20,__pyx_v_Uu11,__pyx_v_Uu11,__pyx_v_Uu02,(&__pyx_v_evalA),(&__pyx_v_evecA1),(&__pyx_v_evalB),(&__pyx_v_evecB1));

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":483 */
        __pyx_6 = __pyx_v_eigen_err;
        if (__pyx_6) {

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":484 */
          __pyx_v_slope = __pyx_v_23realtime_image_analysis_nan;

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":485 */
          __pyx_v_orientation = __pyx_v_23realtime_image_analysis_nan;

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":486 */
          __pyx_v_eccentricity = 0.0;
          goto __pyx_L21;
        }
        /*else*/ {

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":488 */
          __pyx_v_rise = 1.0;

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":489 */
          __pyx_5 = (__pyx_v_evalA > __pyx_v_evalB);
          if (__pyx_5) {

            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":490 */
            __pyx_v_run = __pyx_v_evecA1;

            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":491 */
            __pyx_v_eccentricity = (__pyx_v_evalA / __pyx_v_evalB);
            goto __pyx_L22;
          }
          /*else*/ {

            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":493 */
            __pyx_v_run = __pyx_v_evecB1;

            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":494 */
            __pyx_v_eccentricity = (__pyx_v_evalB / __pyx_v_evalA);
          }
          __pyx_L22:;

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":495 */
          __pyx_v_slope = (__pyx_v_rise / __pyx_v_run);

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":498 */
          __pyx_v_orientation = atan2(__pyx_v_rise,__pyx_v_run);

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":499 */
          __pyx_v_orientation = (__pyx_v_orientation + 1.57079632679489661923);
        }
        __pyx_L21:;
        goto __pyx_L20;
      }
      __pyx_6 = (__pyx_v_result == CFitParamsZeroMomentError);
      if (__pyx_6) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":501 */
        __pyx_v_orientation = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":502 */
        __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":503 */
        __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":504 */
        __pyx_v_x0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":505 */
        __pyx_v_y0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":506 */
        __pyx_v_found_point = 0;
        goto __pyx_L20;
      }
      __pyx_5 = (__pyx_v_result == CFitParamsCentralMomentError);
      if (__pyx_5) {
        __pyx_v_orientation = __pyx_v_23realtime_image_analysis_nan;
        goto __pyx_L20;
      }
      /*else*/ {
        SET_ERR(1);
      }
      __pyx_L20:;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":511 */
      __pyx_6 = __pyx_v_found_point;
      if (__pyx_6) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":512 */
        __pyx_v_x0_abs = (__pyx_v_x0 + __pyx_v_left2);

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":513 */
        __pyx_v_y0_abs = (__pyx_v_y0 + __pyx_v_bottom2);
        goto __pyx_L23;
      }
      __pyx_L23:;
      goto __pyx_L19;
    }
    __pyx_L19:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":518 */
    Py_END_ALLOW_THREADS;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":520 */
    __pyx_5 = __pyx_v_found_point;
    if (__pyx_5) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":521 */
      __pyx_6 = (!((__pyx_v_n_found_points + 1) == ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->max_num_points));
      if (__pyx_6) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":522 */
        __pyx_1 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view), __pyx_n_set_val); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; goto __pyx_L1;}
        __pyx_4 = PyInt_FromLong(0); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; goto __pyx_L1;}
        __pyx_8 = PyTuple_New(2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; goto __pyx_L1;}
        PyTuple_SET_ITEM(__pyx_8, 0, __pyx_4);
        Py_INCREF(((PyObject *)__pyx_v_roi2_sz));
        PyTuple_SET_ITEM(__pyx_8, 1, ((PyObject *)__pyx_v_roi2_sz));
        __pyx_4 = 0;
        __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_8); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; goto __pyx_L1;}
        Py_DECREF(__pyx_1); __pyx_1 = 0;
        Py_DECREF(__pyx_8); __pyx_8 = 0;
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        goto __pyx_L25;
      }
      __pyx_L25:;
      goto __pyx_L24;
    }
    __pyx_L24:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":524 */
    __pyx_5 = __pyx_v_return_first_xy;
    if (__pyx_5) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":526 */
      __pyx_7 = PyInt_FromLong(__pyx_v_index_x); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
      __pyx_4 = PyInt_FromLong(__pyx_v_index_y); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
      __pyx_1 = PyInt_FromLong(__pyx_v_max_std_diff); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
      __pyx_8 = PyInt_FromLong(__pyx_v_max_val); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
      __pyx_2 = PyFloat_FromDouble(__pyx_v_eccentricity); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
      __pyx_9 = PyFloat_FromDouble(__pyx_v_p1); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
      __pyx_10 = PyFloat_FromDouble(__pyx_v_p2); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
      __pyx_11 = PyFloat_FromDouble(__pyx_v_p3); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
      __pyx_12 = PyFloat_FromDouble(__pyx_v_p4); if (!__pyx_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
      __pyx_13 = PyInt_FromLong(0); if (!__pyx_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
      __pyx_14 = PyInt_FromLong(__pyx_v_found_point); if (!__pyx_14) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
      __pyx_15 = PyTuple_New(11); if (!__pyx_15) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_15, 0, __pyx_7);
      PyTuple_SET_ITEM(__pyx_15, 1, __pyx_4);
      PyTuple_SET_ITEM(__pyx_15, 2, __pyx_1);
      PyTuple_SET_ITEM(__pyx_15, 3, __pyx_8);
      PyTuple_SET_ITEM(__pyx_15, 4, __pyx_2);
      PyTuple_SET_ITEM(__pyx_15, 5, __pyx_9);
      PyTuple_SET_ITEM(__pyx_15, 6, __pyx_10);
      PyTuple_SET_ITEM(__pyx_15, 7, __pyx_11);
      PyTuple_SET_ITEM(__pyx_15, 8, __pyx_12);
      PyTuple_SET_ITEM(__pyx_15, 9, __pyx_13);
      PyTuple_SET_ITEM(__pyx_15, 10, __pyx_14);
      __pyx_7 = 0;
      __pyx_4 = 0;
      __pyx_1 = 0;
      __pyx_8 = 0;
      __pyx_2 = 0;
      __pyx_9 = 0;
      __pyx_10 = 0;
      __pyx_11 = 0;
      __pyx_12 = 0;
      __pyx_13 = 0;
      __pyx_14 = 0;
      __pyx_7 = PyList_New(1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
      PyList_SET_ITEM(__pyx_7, 0, __pyx_15);
      __pyx_15 = 0;
      Py_DECREF(__pyx_v_rval);
      __pyx_v_rval = __pyx_7;
      __pyx_7 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":527 */
      Py_INCREF(__pyx_v_rval);
      __pyx_r = __pyx_v_rval;
      goto __pyx_L0;
      goto __pyx_L26;
    }
    __pyx_L26:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":529 */
    __pyx_6 = (!__pyx_v_found_point);
    if (__pyx_6) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":530 */
      goto __pyx_L5;
      goto __pyx_L27;
    }
    __pyx_L27:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":532 */
    __pyx_5 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_helper != Py_None;
    if (__pyx_5) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":537 */
      __pyx_4 = PyObject_GetAttr(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_helper, __pyx_n_undistort); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; goto __pyx_L1;}
      Py_DECREF(__pyx_v_undistort);
      __pyx_v_undistort = __pyx_4;
      __pyx_4 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":544 */
      __pyx_1 = PyFloat_FromDouble(__pyx_v_x0_abs); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; goto __pyx_L1;}
      __pyx_8 = PyFloat_FromDouble(__pyx_v_y0_abs); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; goto __pyx_L1;}
      __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
      PyTuple_SET_ITEM(__pyx_2, 1, __pyx_8);
      __pyx_1 = 0;
      __pyx_8 = 0;
      __pyx_9 = PyObject_CallObject(__pyx_v_undistort, __pyx_2); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __pyx_10 = PyObject_GetIter(__pyx_9); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; goto __pyx_L1;}
      Py_DECREF(__pyx_9); __pyx_9 = 0;
      __pyx_11 = __Pyx_UnpackItem(__pyx_10); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; goto __pyx_L1;}
      __pyx_3 = PyFloat_AsDouble(__pyx_11); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; goto __pyx_L1;}
      Py_DECREF(__pyx_11); __pyx_11 = 0;
      __pyx_v_x0u = __pyx_3;
      __pyx_12 = __Pyx_UnpackItem(__pyx_10); if (!__pyx_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; goto __pyx_L1;}
      __pyx_3 = PyFloat_AsDouble(__pyx_12); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; goto __pyx_L1;}
      Py_DECREF(__pyx_12); __pyx_12 = 0;
      __pyx_v_y0u = __pyx_3;
      if (__Pyx_EndUnpack(__pyx_10) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; goto __pyx_L1;}
      Py_DECREF(__pyx_10); __pyx_10 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":545 */
      __pyx_13 = PyFloat_FromDouble(__pyx_v_x0u); if (!__pyx_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; goto __pyx_L1;}
      __pyx_14 = PyFloat_FromDouble(__pyx_v_y0u); if (!__pyx_14) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; goto __pyx_L1;}
      __pyx_15 = PyFloat_FromDouble(1.0); if (!__pyx_15) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; goto __pyx_L1;}
      __pyx_7 = PyList_New(3); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 545; goto __pyx_L1;}
      PyList_SET_ITEM(__pyx_7, 0, __pyx_13);
      PyList_SET_ITEM(__pyx_7, 1, __pyx_14);
      PyList_SET_ITEM(__pyx_7, 2, __pyx_15);
      __pyx_13 = 0;
      __pyx_14 = 0;
      __pyx_15 = 0;
      Py_DECREF(__pyx_v_found_point_image_plane);
      __pyx_v_found_point_image_plane = __pyx_7;
      __pyx_7 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":546 */
      __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; goto __pyx_L1;}
      Py_INCREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_inv);
      PyTuple_SET_ITEM(__pyx_4, 0, ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_inv);
      Py_INCREF(__pyx_v_found_point_image_plane);
      PyTuple_SET_ITEM(__pyx_4, 1, __pyx_v_found_point_image_plane);
      __pyx_1 = PyObject_CallObject(__pyx_v_matrixmultiply, __pyx_4); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; goto __pyx_L1;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      Py_DECREF(__pyx_v_X0);
      __pyx_v_X0 = __pyx_1;
      __pyx_1 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":548 */
      __pyx_8 = PyFloat_FromDouble((__pyx_v_x0_abs + __pyx_v_run)); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; goto __pyx_L1;}
      __pyx_2 = PyFloat_FromDouble((__pyx_v_y0_abs + __pyx_v_rise)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; goto __pyx_L1;}
      __pyx_9 = PyTuple_New(2); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_9, 0, __pyx_8);
      PyTuple_SET_ITEM(__pyx_9, 1, __pyx_2);
      __pyx_8 = 0;
      __pyx_2 = 0;
      __pyx_11 = PyObject_CallObject(__pyx_v_undistort, __pyx_9); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; goto __pyx_L1;}
      Py_DECREF(__pyx_9); __pyx_9 = 0;
      __pyx_12 = PyObject_GetIter(__pyx_11); if (!__pyx_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; goto __pyx_L1;}
      Py_DECREF(__pyx_11); __pyx_11 = 0;
      __pyx_10 = __Pyx_UnpackItem(__pyx_12); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; goto __pyx_L1;}
      __pyx_3 = PyFloat_AsDouble(__pyx_10); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; goto __pyx_L1;}
      Py_DECREF(__pyx_10); __pyx_10 = 0;
      __pyx_v_x1u = __pyx_3;
      __pyx_13 = __Pyx_UnpackItem(__pyx_12); if (!__pyx_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; goto __pyx_L1;}
      __pyx_3 = PyFloat_AsDouble(__pyx_13); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; goto __pyx_L1;}
      Py_DECREF(__pyx_13); __pyx_13 = 0;
      __pyx_v_y1u = __pyx_3;
      if (__Pyx_EndUnpack(__pyx_12) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; goto __pyx_L1;}
      Py_DECREF(__pyx_12); __pyx_12 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":549 */
      __pyx_14 = PyFloat_FromDouble(__pyx_v_x1u); if (!__pyx_14) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; goto __pyx_L1;}
      __pyx_15 = PyFloat_FromDouble(__pyx_v_y1u); if (!__pyx_15) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; goto __pyx_L1;}
      __pyx_7 = PyFloat_FromDouble(1.0); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; goto __pyx_L1;}
      __pyx_4 = PyList_New(3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; goto __pyx_L1;}
      PyList_SET_ITEM(__pyx_4, 0, __pyx_14);
      PyList_SET_ITEM(__pyx_4, 1, __pyx_15);
      PyList_SET_ITEM(__pyx_4, 2, __pyx_7);
      __pyx_14 = 0;
      __pyx_15 = 0;
      __pyx_7 = 0;
      __pyx_1 = PyTuple_New(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; goto __pyx_L1;}
      Py_INCREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_inv);
      PyTuple_SET_ITEM(__pyx_1, 0, ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_inv);
      PyTuple_SET_ITEM(__pyx_1, 1, __pyx_4);
      __pyx_4 = 0;
      __pyx_8 = PyObject_CallObject(__pyx_v_matrixmultiply, __pyx_1); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      Py_DECREF(__pyx_v_X1);
      __pyx_v_X1 = __pyx_8;
      __pyx_8 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":553 */
      __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; goto __pyx_L1;}
      __pyx_9 = PyObject_GetAttr(__pyx_2, __pyx_n_array); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __pyx_11 = PyList_New(3); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; goto __pyx_L1;}
      Py_INCREF(__pyx_v_X0);
      PyList_SET_ITEM(__pyx_11, 0, __pyx_v_X0);
      Py_INCREF(__pyx_v_X1);
      PyList_SET_ITEM(__pyx_11, 1, __pyx_v_X1);
      Py_INCREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->camera_center);
      PyList_SET_ITEM(__pyx_11, 2, ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->camera_center);
      __pyx_10 = PyTuple_New(1); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_10, 0, __pyx_11);
      __pyx_11 = 0;
      __pyx_13 = PyObject_CallObject(__pyx_9, __pyx_10); if (!__pyx_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; goto __pyx_L1;}
      Py_DECREF(__pyx_9); __pyx_9 = 0;
      Py_DECREF(__pyx_10); __pyx_10 = 0;
      Py_DECREF(__pyx_v_A);
      __pyx_v_A = __pyx_13;
      __pyx_13 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":554 */
      __pyx_12 = PyTuple_New(1); if (!__pyx_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; goto __pyx_L1;}
      Py_INCREF(__pyx_v_A);
      PyTuple_SET_ITEM(__pyx_12, 0, __pyx_v_A);
      __pyx_14 = PyDict_New(); if (!__pyx_14) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; goto __pyx_L1;}
      __pyx_15 = __Pyx_GetName(__pyx_b, __pyx_n_True); if (!__pyx_15) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; goto __pyx_L1;}
      if (PyDict_SetItem(__pyx_14, __pyx_n_full_matrices, __pyx_15) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; goto __pyx_L1;}
      Py_DECREF(__pyx_15); __pyx_15 = 0;
      __pyx_7 = PyEval_CallObjectWithKeywords(__pyx_v_svd, __pyx_12, __pyx_14); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; goto __pyx_L1;}
      Py_DECREF(__pyx_12); __pyx_12 = 0;
      Py_DECREF(__pyx_14); __pyx_14 = 0;
      __pyx_4 = PyObject_GetIter(__pyx_7); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; goto __pyx_L1;}
      Py_DECREF(__pyx_7); __pyx_7 = 0;
      __pyx_1 = __Pyx_UnpackItem(__pyx_4); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; goto __pyx_L1;}
      Py_DECREF(__pyx_v_u);
      __pyx_v_u = __pyx_1;
      __pyx_1 = 0;
      __pyx_8 = __Pyx_UnpackItem(__pyx_4); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; goto __pyx_L1;}
      Py_DECREF(__pyx_v_d);
      __pyx_v_d = __pyx_8;
      __pyx_8 = 0;
      __pyx_2 = __Pyx_UnpackItem(__pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; goto __pyx_L1;}
      Py_DECREF(__pyx_v_vt);
      __pyx_v_vt = __pyx_2;
      __pyx_2 = 0;
      if (__Pyx_EndUnpack(__pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 554; goto __pyx_L1;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":555 */
      __pyx_11 = PyInt_FromLong(3); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; goto __pyx_L1;}
      __pyx_9 = PySlice_New(Py_None, Py_None, Py_None); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; goto __pyx_L1;}
      __pyx_10 = PyTuple_New(2); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_10, 0, __pyx_11);
      PyTuple_SET_ITEM(__pyx_10, 1, __pyx_9);
      __pyx_11 = 0;
      __pyx_9 = 0;
      __pyx_13 = PyObject_GetItem(__pyx_v_vt, __pyx_10); if (!__pyx_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; goto __pyx_L1;}
      Py_DECREF(__pyx_10); __pyx_10 = 0;
      Py_DECREF(__pyx_v_Pt);
      __pyx_v_Pt = __pyx_13;
      __pyx_13 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":557 */
      __pyx_15 = PySequence_GetSlice(__pyx_v_Pt, 0, 4); if (!__pyx_15) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; goto __pyx_L1;}
      __pyx_12 = PyObject_GetIter(__pyx_15); if (!__pyx_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; goto __pyx_L1;}
      Py_DECREF(__pyx_15); __pyx_15 = 0;
      __pyx_14 = __Pyx_UnpackItem(__pyx_12); if (!__pyx_14) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; goto __pyx_L1;}
      __pyx_3 = PyFloat_AsDouble(__pyx_14); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; goto __pyx_L1;}
      Py_DECREF(__pyx_14); __pyx_14 = 0;
      __pyx_v_p1 = __pyx_3;
      __pyx_7 = __Pyx_UnpackItem(__pyx_12); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; goto __pyx_L1;}
      __pyx_3 = PyFloat_AsDouble(__pyx_7); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; goto __pyx_L1;}
      Py_DECREF(__pyx_7); __pyx_7 = 0;
      __pyx_v_p2 = __pyx_3;
      __pyx_1 = __Pyx_UnpackItem(__pyx_12); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; goto __pyx_L1;}
      __pyx_3 = PyFloat_AsDouble(__pyx_1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_v_p3 = __pyx_3;
      __pyx_8 = __Pyx_UnpackItem(__pyx_12); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; goto __pyx_L1;}
      __pyx_3 = PyFloat_AsDouble(__pyx_8); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; goto __pyx_L1;}
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      __pyx_v_p4 = __pyx_3;
      if (__Pyx_EndUnpack(__pyx_12) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; goto __pyx_L1;}
      Py_DECREF(__pyx_12); __pyx_12 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":558 */
      __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_True); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 558; goto __pyx_L1;}
      Py_DECREF(__pyx_v_line_found);
      __pyx_v_line_found = __pyx_2;
      __pyx_2 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":559 */
      __pyx_6 = isnan(__pyx_v_p1);
      if (__pyx_6) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":560 */
        if (__Pyx_PrintItem(__pyx_k22p) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; goto __pyx_L1;}
        if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; goto __pyx_L1;}
        goto __pyx_L29;
      }
      __pyx_L29:;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":564 */
      __pyx_4 = __Pyx_GetName(__pyx_m, __pyx_n_numpy); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; goto __pyx_L1;}
      __pyx_11 = PyObject_GetAttr(__pyx_4, __pyx_n_dot); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; goto __pyx_L1;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      __pyx_9 = PyTuple_New(2); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; goto __pyx_L1;}
      Py_INCREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_meters_inv);
      PyTuple_SET_ITEM(__pyx_9, 0, ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_pmat_meters_inv);
      Py_INCREF(__pyx_v_found_point_image_plane);
      PyTuple_SET_ITEM(__pyx_9, 1, __pyx_v_found_point_image_plane);
      __pyx_10 = PyObject_CallObject(__pyx_11, __pyx_9); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; goto __pyx_L1;}
      Py_DECREF(__pyx_11); __pyx_11 = 0;
      Py_DECREF(__pyx_9); __pyx_9 = 0;
      Py_DECREF(__pyx_v_X0meters);
      __pyx_v_X0meters = __pyx_10;
      __pyx_10 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":565 */
      __pyx_13 = PySequence_GetSlice(__pyx_v_X0meters, 0, 3); if (!__pyx_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 565; goto __pyx_L1;}
      __pyx_15 = PyInt_FromLong(3); if (!__pyx_15) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 565; goto __pyx_L1;}
      __pyx_14 = PyObject_GetItem(__pyx_v_X0meters, __pyx_15); if (!__pyx_14) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 565; goto __pyx_L1;}
      Py_DECREF(__pyx_15); __pyx_15 = 0;
      __pyx_7 = PyNumber_Divide(__pyx_13, __pyx_14); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 565; goto __pyx_L1;}
      Py_DECREF(__pyx_13); __pyx_13 = 0;
      Py_DECREF(__pyx_14); __pyx_14 = 0;
      Py_DECREF(__pyx_v_X0meters);
      __pyx_v_X0meters = __pyx_7;
      __pyx_7 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":567 */
      __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_pluecker_from_verts); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 567; goto __pyx_L1;}
      __pyx_8 = PyTuple_New(2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 567; goto __pyx_L1;}
      Py_INCREF(__pyx_v_X0meters);
      PyTuple_SET_ITEM(__pyx_8, 0, __pyx_v_X0meters);
      Py_INCREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->camera_center_meters);
      PyTuple_SET_ITEM(__pyx_8, 1, ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->camera_center_meters);
      __pyx_12 = PyObject_CallObject(__pyx_1, __pyx_8); if (!__pyx_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 567; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      Py_DECREF(__pyx_v_pluecker_meters);
      __pyx_v_pluecker_meters = __pyx_12;
      __pyx_12 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":568 */
      __pyx_2 = PyInt_FromLong(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 568; goto __pyx_L1;}
      Py_DECREF(__pyx_v_ray_valid);
      __pyx_v_ray_valid = __pyx_2;
      __pyx_2 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":569 */
      __pyx_4 = PyObject_GetIter(__pyx_v_pluecker_meters); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; goto __pyx_L1;}
      __pyx_11 = __Pyx_UnpackItem(__pyx_4); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; goto __pyx_L1;}
      Py_DECREF(__pyx_v_ray0);
      __pyx_v_ray0 = __pyx_11;
      __pyx_11 = 0;
      __pyx_9 = __Pyx_UnpackItem(__pyx_4); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; goto __pyx_L1;}
      Py_DECREF(__pyx_v_ray1);
      __pyx_v_ray1 = __pyx_9;
      __pyx_9 = 0;
      __pyx_10 = __Pyx_UnpackItem(__pyx_4); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; goto __pyx_L1;}
      Py_DECREF(__pyx_v_ray2);
      __pyx_v_ray2 = __pyx_10;
      __pyx_10 = 0;
      __pyx_15 = __Pyx_UnpackItem(__pyx_4); if (!__pyx_15) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; goto __pyx_L1;}
      Py_DECREF(__pyx_v_ray3);
      __pyx_v_ray3 = __pyx_15;
      __pyx_15 = 0;
      __pyx_13 = __Pyx_UnpackItem(__pyx_4); if (!__pyx_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; goto __pyx_L1;}
      Py_DECREF(__pyx_v_ray4);
      __pyx_v_ray4 = __pyx_13;
      __pyx_13 = 0;
      __pyx_14 = __Pyx_UnpackItem(__pyx_4); if (!__pyx_14) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; goto __pyx_L1;}
      Py_DECREF(__pyx_v_ray5);
      __pyx_v_ray5 = __pyx_14;
      __pyx_14 = 0;
      if (__Pyx_EndUnpack(__pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 569; goto __pyx_L1;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      goto __pyx_L28;
    }
    /*else*/ {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":571 */
      __pyx_v_x0u = __pyx_v_x0_abs;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":572 */
      __pyx_v_y0u = __pyx_v_y0_abs;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":574 */
      __pyx_7 = __Pyx_GetName(__pyx_b, __pyx_n_False); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 574; goto __pyx_L1;}
      Py_DECREF(__pyx_v_line_found);
      __pyx_v_line_found = __pyx_7;
      __pyx_7 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":575 */
      __pyx_1 = PyInt_FromLong(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 575; goto __pyx_L1;}
      Py_DECREF(__pyx_v_ray_valid);
      __pyx_v_ray_valid = __pyx_1;
      __pyx_1 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":576 */
      __pyx_8 = PyInt_FromLong(0); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 576; goto __pyx_L1;}
      __pyx_12 = PyInt_FromLong(0); if (!__pyx_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 576; goto __pyx_L1;}
      __pyx_2 = PyInt_FromLong(0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 576; goto __pyx_L1;}
      __pyx_11 = PyInt_FromLong(0); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 576; goto __pyx_L1;}
      __pyx_9 = PyInt_FromLong(0); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 576; goto __pyx_L1;}
      __pyx_10 = PyInt_FromLong(0); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 576; goto __pyx_L1;}
      Py_DECREF(__pyx_v_ray0);
      __pyx_v_ray0 = __pyx_8;
      __pyx_8 = 0;
      Py_DECREF(__pyx_v_ray1);
      __pyx_v_ray1 = __pyx_12;
      __pyx_12 = 0;
      Py_DECREF(__pyx_v_ray2);
      __pyx_v_ray2 = __pyx_2;
      __pyx_2 = 0;
      Py_DECREF(__pyx_v_ray3);
      __pyx_v_ray3 = __pyx_11;
      __pyx_11 = 0;
      Py_DECREF(__pyx_v_ray4);
      __pyx_v_ray4 = __pyx_9;
      __pyx_9 = 0;
      Py_DECREF(__pyx_v_ray5);
      __pyx_v_ray5 = __pyx_10;
      __pyx_10 = 0;
    }
    __pyx_L28:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":579 */
    __pyx_5 = isnan(__pyx_v_slope);
    if (__pyx_5) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":580 */
      __pyx_v_slope = 0.0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":581 */
      __pyx_15 = __Pyx_GetName(__pyx_b, __pyx_n_False); if (!__pyx_15) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 581; goto __pyx_L1;}
      Py_DECREF(__pyx_v_slope_found);
      __pyx_v_slope_found = __pyx_15;
      __pyx_15 = 0;
      goto __pyx_L30;
    }
    /*else*/ {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":583 */
      __pyx_13 = __Pyx_GetName(__pyx_b, __pyx_n_True); if (!__pyx_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 583; goto __pyx_L1;}
      Py_DECREF(__pyx_v_slope_found);
      __pyx_v_slope_found = __pyx_13;
      __pyx_13 = 0;
    }
    __pyx_L30:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":585 */
    __pyx_6 = isinf(__pyx_v_eccentricity);
    if (__pyx_6) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":586 */
      __pyx_14 = __Pyx_GetName(__pyx_m, __pyx_n_near_inf); if (!__pyx_14) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 586; goto __pyx_L1;}
      __pyx_3 = PyFloat_AsDouble(__pyx_14); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 586; goto __pyx_L1;}
      Py_DECREF(__pyx_14); __pyx_14 = 0;
      __pyx_v_eccentricity = __pyx_3;
      goto __pyx_L31;
    }
    __pyx_L31:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":588 */
    __pyx_5 = isinf(__pyx_v_slope);
    if (__pyx_5) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":589 */
      __pyx_4 = __Pyx_GetName(__pyx_m, __pyx_n_near_inf); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; goto __pyx_L1;}
      __pyx_3 = PyFloat_AsDouble(__pyx_4); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 589; goto __pyx_L1;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      __pyx_v_slope = __pyx_3;
      goto __pyx_L32;
    }
    __pyx_L32:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":591 */
    __pyx_7 = PyObject_GetAttr(__pyx_v_all_points_found, __pyx_n_append); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; goto __pyx_L1;}
    __pyx_1 = PyFloat_FromDouble(__pyx_v_x0_abs); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; goto __pyx_L1;}
    __pyx_8 = PyFloat_FromDouble(__pyx_v_y0_abs); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; goto __pyx_L1;}
    __pyx_12 = PyFloat_FromDouble(__pyx_v_area); if (!__pyx_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; goto __pyx_L1;}
    __pyx_2 = PyFloat_FromDouble(__pyx_v_slope); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; goto __pyx_L1;}
    __pyx_11 = PyFloat_FromDouble(__pyx_v_eccentricity); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; goto __pyx_L1;}
    __pyx_9 = PyFloat_FromDouble(__pyx_v_p1); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 593; goto __pyx_L1;}
    __pyx_10 = PyFloat_FromDouble(__pyx_v_p2); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 593; goto __pyx_L1;}
    __pyx_15 = PyFloat_FromDouble(__pyx_v_p3); if (!__pyx_15) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 593; goto __pyx_L1;}
    __pyx_13 = PyFloat_FromDouble(__pyx_v_p4); if (!__pyx_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 593; goto __pyx_L1;}
    __pyx_14 = PyFloat_FromDouble(__pyx_v_x0u); if (!__pyx_14) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 594; goto __pyx_L1;}
    __pyx_4 = PyFloat_FromDouble(__pyx_v_y0u); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 594; goto __pyx_L1;}
    __pyx_16 = PyTuple_New(20); if (!__pyx_16) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 592; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_16, 0, __pyx_1);
    PyTuple_SET_ITEM(__pyx_16, 1, __pyx_8);
    PyTuple_SET_ITEM(__pyx_16, 2, __pyx_12);
    PyTuple_SET_ITEM(__pyx_16, 3, __pyx_2);
    PyTuple_SET_ITEM(__pyx_16, 4, __pyx_11);
    PyTuple_SET_ITEM(__pyx_16, 5, __pyx_9);
    PyTuple_SET_ITEM(__pyx_16, 6, __pyx_10);
    PyTuple_SET_ITEM(__pyx_16, 7, __pyx_15);
    PyTuple_SET_ITEM(__pyx_16, 8, __pyx_13);
    Py_INCREF(__pyx_v_line_found);
    PyTuple_SET_ITEM(__pyx_16, 9, __pyx_v_line_found);
    Py_INCREF(__pyx_v_slope_found);
    PyTuple_SET_ITEM(__pyx_16, 10, __pyx_v_slope_found);
    PyTuple_SET_ITEM(__pyx_16, 11, __pyx_14);
    PyTuple_SET_ITEM(__pyx_16, 12, __pyx_4);
    Py_INCREF(__pyx_v_ray_valid);
    PyTuple_SET_ITEM(__pyx_16, 13, __pyx_v_ray_valid);
    Py_INCREF(__pyx_v_ray0);
    PyTuple_SET_ITEM(__pyx_16, 14, __pyx_v_ray0);
    Py_INCREF(__pyx_v_ray1);
    PyTuple_SET_ITEM(__pyx_16, 15, __pyx_v_ray1);
    Py_INCREF(__pyx_v_ray2);
    PyTuple_SET_ITEM(__pyx_16, 16, __pyx_v_ray2);
    Py_INCREF(__pyx_v_ray3);
    PyTuple_SET_ITEM(__pyx_16, 17, __pyx_v_ray3);
    Py_INCREF(__pyx_v_ray4);
    PyTuple_SET_ITEM(__pyx_16, 18, __pyx_v_ray4);
    Py_INCREF(__pyx_v_ray5);
    PyTuple_SET_ITEM(__pyx_16, 19, __pyx_v_ray5);
    __pyx_1 = 0;
    __pyx_8 = 0;
    __pyx_12 = 0;
    __pyx_2 = 0;
    __pyx_11 = 0;
    __pyx_9 = 0;
    __pyx_10 = 0;
    __pyx_15 = 0;
    __pyx_13 = 0;
    __pyx_14 = 0;
    __pyx_4 = 0;
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_16);
    __pyx_16 = 0;
    __pyx_8 = PyObject_CallObject(__pyx_7, __pyx_1); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 591; goto __pyx_L1;}
    Py_DECREF(__pyx_7); __pyx_7 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_8); __pyx_8 = 0;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":598 */
    __pyx_v_n_found_points = (__pyx_v_n_found_points + 1);
  }
  __pyx_L5:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":600 */
  Py_INCREF(__pyx_v_all_points_found);
  __pyx_r = __pyx_v_all_points_found;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_7);
  Py_XDECREF(__pyx_8);
  Py_XDECREF(__pyx_9);
  Py_XDECREF(__pyx_10);
  Py_XDECREF(__pyx_11);
  Py_XDECREF(__pyx_12);
  Py_XDECREF(__pyx_13);
  Py_XDECREF(__pyx_14);
  Py_XDECREF(__pyx_15);
  Py_XDECREF(__pyx_16);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.do_work");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_roi2_sz);
  Py_DECREF(__pyx_v_matrixmultiply);
  Py_DECREF(__pyx_v_svd);
  Py_DECREF(__pyx_v_all_points_found);
  Py_DECREF(__pyx_v_rval);
  Py_DECREF(__pyx_v_undistort);
  Py_DECREF(__pyx_v_found_point_image_plane);
  Py_DECREF(__pyx_v_X0);
  Py_DECREF(__pyx_v_X1);
  Py_DECREF(__pyx_v_A);
  Py_DECREF(__pyx_v_u);
  Py_DECREF(__pyx_v_d);
  Py_DECREF(__pyx_v_vt);
  Py_DECREF(__pyx_v_Pt);
  Py_DECREF(__pyx_v_line_found);
  Py_DECREF(__pyx_v_X0meters);
  Py_DECREF(__pyx_v_pluecker_meters);
  Py_DECREF(__pyx_v_ray_valid);
  Py_DECREF(__pyx_v_ray0);
  Py_DECREF(__pyx_v_ray1);
  Py_DECREF(__pyx_v_ray2);
  Py_DECREF(__pyx_v_ray3);
  Py_DECREF(__pyx_v_ray4);
  Py_DECREF(__pyx_v_ray5);
  Py_DECREF(__pyx_v_slope_found);
  Py_DECREF(__pyx_v_self);
  Py_DECREF((PyObject *)__pyx_v_raw_im_small);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_get_image_view(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_get_image_view(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_which = 0;
  PyObject *__pyx_v_im;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static char *__pyx_argnames[] = {"which",0};
  __pyx_v_which = __pyx_k10;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "|O", __pyx_argnames, &__pyx_v_which)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_which);
  __pyx_v_im = Py_None; Py_INCREF(Py_None);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":603 */
  __pyx_1 = PyObject_GetItem(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->imname2im, __pyx_v_which); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; goto __pyx_L1;}
  Py_DECREF(__pyx_v_im);
  __pyx_v_im = __pyx_1;
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":604 */
  Py_INCREF(__pyx_v_im);
  __pyx_r = __pyx_v_im;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.get_image_view");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_im);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_which);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":608 */
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.roi2_radius.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  int __pyx_1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_value);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":610 */
  __pyx_1 = PyInt_AsLong(__pyx_v_value); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; goto __pyx_L1;}
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius = __pyx_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.roi2_radius.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_value);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":614 */
  __pyx_1 = PyFloat_FromDouble(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 614; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.clear_threshold.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  float __pyx_1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_value);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":616 */
  __pyx_1 = PyFloat_AsDouble(__pyx_v_value); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 616; goto __pyx_L1;}
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold = __pyx_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.clear_threshold.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_value);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":620 */
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 620; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.diff_threshold.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  Ipp8u __pyx_1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_value);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":622 */
  __pyx_1 = PyInt_AsLong(__pyx_v_value); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; goto __pyx_L1;}
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold = __pyx_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.diff_threshold.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_value);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":626 */
  __pyx_1 = PyFloat_FromDouble(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_scale_factor); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.scale_factor.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k23p;

static char (__pyx_k23[]) = "setting scale_factor to";

static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  double __pyx_1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_value);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":628 */
  if (__Pyx_PrintItem(__pyx_k23p) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; goto __pyx_L1;}
  if (__Pyx_PrintItem(__pyx_v_value) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; goto __pyx_L1;}
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; goto __pyx_L1;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":629 */
  __pyx_1 = PyFloat_AsDouble(__pyx_v_value); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 629; goto __pyx_L1;}
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_scale_factor = __pyx_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.scale_factor.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_value);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_3roi___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_3roi___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":633 */
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 633; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 633; goto __pyx_L1;}
  __pyx_3 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 633; goto __pyx_L1;}
  __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 633; goto __pyx_L1;}
  __pyx_5 = PyTuple_New(4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 633; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_5, 1, __pyx_2);
  PyTuple_SET_ITEM(__pyx_5, 2, __pyx_3);
  PyTuple_SET_ITEM(__pyx_5, 3, __pyx_4);
  __pyx_1 = 0;
  __pyx_2 = 0;
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_r = __pyx_5;
  __pyx_5 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.roi.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k24p;
static PyObject *__pyx_k25p;
static PyObject *__pyx_k26p;
static PyObject *__pyx_k27p;

static char (__pyx_k24[]) = "attempting to set ROI left %d";
static char (__pyx_k25[]) = "attempting to set ROI bottom %d";
static char (__pyx_k26[]) = "attempting to set ROI right to %d (width %d)";
static char (__pyx_k27[]) = "attempting to set ROI top to %d (height %d)";

static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_3roi___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_lbrt); /*proto*/
static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_3roi___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_lbrt) {
  int __pyx_v_l;
  int __pyx_v_b;
  int __pyx_v_r;
  int __pyx_v_t;
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_lbrt);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":637 */
  __pyx_1 = PyObject_GetIter(__pyx_v_lbrt); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 637; goto __pyx_L1;}
  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 637; goto __pyx_L1;}
  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 637; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_v_l = __pyx_3;
  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 637; goto __pyx_L1;}
  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 637; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_v_b = __pyx_3;
  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 637; goto __pyx_L1;}
  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 637; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_v_r = __pyx_3;
  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 637; goto __pyx_L1;}
  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 637; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_v_t = __pyx_3;
  if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 637; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":638 */
  __pyx_3 = (__pyx_v_l == ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);
  if (__pyx_3) {
    __pyx_3 = (__pyx_v_b == ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);
    if (__pyx_3) {
      __pyx_3 = (__pyx_v_r == ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right);
      if (__pyx_3) {
        __pyx_3 = (__pyx_v_t == ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top);
      }
    }
  }
  if (__pyx_3) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":641 */
    __pyx_r = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":643 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left = __pyx_v_l;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":644 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom = __pyx_v_b;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":645 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right = __pyx_v_r;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":646 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top = __pyx_v_t;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":648 */
  __pyx_3 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left < 0);
  if (__pyx_3) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":649 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; goto __pyx_L1;}
    __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; goto __pyx_L1;}
    __pyx_4 = PyNumber_Remainder(__pyx_k24p, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_4);
    __pyx_4 = 0;
    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_Raise(__pyx_4, 0, 0);
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 649; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":650 */
  __pyx_3 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom < 0);
  if (__pyx_3) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":651 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; goto __pyx_L1;}
    __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; goto __pyx_L1;}
    __pyx_4 = PyNumber_Remainder(__pyx_k25p, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_4);
    __pyx_4 = 0;
    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_Raise(__pyx_4, 0, 0);
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; goto __pyx_L1;}
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":652 */
  __pyx_3 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right >= ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxwidth);
  if (__pyx_3) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":653 */
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 653; goto __pyx_L1;}
    __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 653; goto __pyx_L1;}
    __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxwidth); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 653; goto __pyx_L1;}
    __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 653; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_1);
    PyTuple_SET_ITEM(__pyx_5, 1, __pyx_4);
    __pyx_1 = 0;
    __pyx_4 = 0;
    __pyx_1 = PyNumber_Remainder(__pyx_k26p, __pyx_5); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 653; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 653; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_1);
    __pyx_1 = 0;
    __pyx_5 = PyObject_CallObject(__pyx_2, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 653; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    __Pyx_Raise(__pyx_5, 0, 0);
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 653; goto __pyx_L1;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":654 */
  __pyx_3 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top >= ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxheight);
  if (__pyx_3) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":655 */
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; goto __pyx_L1;}
    __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; goto __pyx_L1;}
    __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxheight); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; goto __pyx_L1;}
    __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_2);
    PyTuple_SET_ITEM(__pyx_5, 1, __pyx_4);
    __pyx_2 = 0;
    __pyx_4 = 0;
    __pyx_2 = PyNumber_Remainder(__pyx_k27p, __pyx_5); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
    __pyx_2 = 0;
    __pyx_5 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    __Pyx_Raise(__pyx_5, 0, 0);
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; goto __pyx_L1;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":657 */
  __pyx_2 = PyInt_FromLong(((((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left) + 1)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 657; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(((((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom) + 1)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 657; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 657; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_1);
  __pyx_2 = 0;
  __pyx_1 = 0;
  __pyx_5 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_Size), __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 657; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  if (!__Pyx_TypeTest(__pyx_5, __pyx_ptype_6motmot_9FastImage_9FastImage_Size)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 657; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)__pyx_5);
  __pyx_5 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":659 */
  __pyx_2 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im), __pyx_n_roi); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; goto __pyx_L1;}
  __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; goto __pyx_L1;}
  __pyx_5 = PyTuple_New(3); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_5, 1, __pyx_4);
  Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  PyTuple_SET_ITEM(__pyx_5, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  __pyx_1 = 0;
  __pyx_4 = 0;
  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_5); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":660 */
  __pyx_4 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im), __pyx_n_roi); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; goto __pyx_L1;}
  __pyx_5 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_2);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_5);
  Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  PyTuple_SET_ITEM(__pyx_1, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  __pyx_2 = 0;
  __pyx_5 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_4, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":661 */
  __pyx_5 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im), __pyx_n_roi); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; goto __pyx_L1;}
  __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_4);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_1);
  Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  PyTuple_SET_ITEM(__pyx_2, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  __pyx_4 = 0;
  __pyx_1 = 0;
  __pyx_4 = PyObject_CallObject(__pyx_5, __pyx_2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_4, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_4);
  __pyx_4 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":662 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im), __pyx_n_roi); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 662; goto __pyx_L1;}
  __pyx_5 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 662; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 662; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 662; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_5);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_2);
  Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  PyTuple_SET_ITEM(__pyx_4, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  __pyx_5 = 0;
  __pyx_2 = 0;
  __pyx_5 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 662; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  if (!__Pyx_TypeTest(__pyx_5, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 662; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_5);
  __pyx_5 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.roi.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_lbrt);
  return __pyx_r;
}

static PyObject *__pyx_n_toself_add_weighted;
static PyObject *__pyx_n_get_8u_copy_put;
static PyObject *__pyx_n_get_32f_copy_put;
static PyObject *__pyx_n_toself_square;
static PyObject *__pyx_n_get_square_put;
static PyObject *__pyx_n_get_subtracted_put;
static PyObject *__pyx_n_toself_multiply;
static PyObject *__pyx_n_get_compare_put;
static PyObject *__pyx_n_CmpGreater;
static PyObject *__pyx_n_set_val_masked;

static PyObject *__pyx_f_23realtime_image_analysis_bg_help_slow(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_bg_help_slow(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_mean_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_fastframef32_tmp = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_sumsqf = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_mean2 = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_stdframe = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_running_mean8u_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_hw_roi_frame = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_noisy_pixels_mask = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_compareframe8u = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *__pyx_v_max_frame_size = 0;
  double __pyx_v_ALPHA;
  double __pyx_v_C;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {"running_mean_im","fastframef32_tmp","running_sumsqf","mean2","running_stdframe","running_mean8u_im","hw_roi_frame","noisy_pixels_mask","compareframe8u","max_frame_size","ALPHA","C",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OOOOOOOOOOdd", __pyx_argnames, &__pyx_v_running_mean_im, &__pyx_v_fastframef32_tmp, &__pyx_v_running_sumsqf, &__pyx_v_mean2, &__pyx_v_running_stdframe, &__pyx_v_running_mean8u_im, &__pyx_v_hw_roi_frame, &__pyx_v_noisy_pixels_mask, &__pyx_v_compareframe8u, &__pyx_v_max_frame_size, &__pyx_v_ALPHA, &__pyx_v_C)) return 0;
  Py_INCREF((PyObject *)__pyx_v_running_mean_im);
  Py_INCREF((PyObject *)__pyx_v_fastframef32_tmp);
  Py_INCREF((PyObject *)__pyx_v_running_sumsqf);
  Py_INCREF((PyObject *)__pyx_v_mean2);
  Py_INCREF((PyObject *)__pyx_v_running_stdframe);
  Py_INCREF((PyObject *)__pyx_v_running_mean8u_im);
  Py_INCREF((PyObject *)__pyx_v_hw_roi_frame);
  Py_INCREF((PyObject *)__pyx_v_noisy_pixels_mask);
  Py_INCREF((PyObject *)__pyx_v_compareframe8u);
  Py_INCREF(__pyx_v_max_frame_size);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_mean_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 664; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "fastframef32_tmp")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 665; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_sumsqf), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_sumsqf")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 666; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_mean2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "mean2")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 667; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_stdframe), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_stdframe")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 668; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean8u_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "running_mean8u_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 669; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_hw_roi_frame), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "hw_roi_frame")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 670; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_noisy_pixels_mask), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "noisy_pixels_mask")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 671; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_compareframe8u), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "compareframe8u")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 672; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_max_frame_size), __pyx_ptype_6motmot_9FastImage_9FastImage_Size, 1, "max_frame_size")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 673; goto __pyx_L1;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":677 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean_im), __pyx_n_toself_add_weighted); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 677; goto __pyx_L1;}
  __pyx_2 = PyFloat_FromDouble(__pyx_v_ALPHA); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 677; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(3); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 677; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_hw_roi_frame));
  PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_hw_roi_frame));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 2, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 677; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":679 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean_im), __pyx_n_get_8u_copy_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 679; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 679; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_running_mean8u_im));
  PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_running_mean8u_im));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 679; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":682 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_hw_roi_frame), __pyx_n_get_32f_copy_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 682; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 682; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_fastframef32_tmp));
  PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_fastframef32_tmp));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 682; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":683 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_n_toself_square); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 683; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 683; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 683; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":684 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_sumsqf), __pyx_n_toself_add_weighted); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; goto __pyx_L1;}
  __pyx_3 = PyFloat_FromDouble(__pyx_v_ALPHA); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_fastframef32_tmp));
  PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_fastframef32_tmp));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 2, __pyx_3);
  __pyx_3 = 0;
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 684; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":685 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean_im), __pyx_n_get_square_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_mean2));
  PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_mean2));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 685; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":686 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_sumsqf), __pyx_n_get_subtracted_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 686; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 686; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_mean2));
  PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_mean2));
  Py_INCREF(((PyObject *)__pyx_v_running_stdframe));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_running_stdframe));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 2, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 686; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":689 */
  __pyx_v_C = 6.0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":690 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_stdframe), __pyx_n_toself_multiply); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 690; goto __pyx_L1;}
  __pyx_2 = PyFloat_FromDouble(__pyx_v_C); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 690; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 690; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 690; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":691 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_stdframe), __pyx_n_get_8u_copy_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 691; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 691; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_compareframe8u));
  PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_compareframe8u));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 691; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":694 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean8u_im), __pyx_n_get_compare_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 694; goto __pyx_L1;}
  __pyx_3 = PyInt_FromLong(200); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 694; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_FastImage); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 694; goto __pyx_L1;}
  __pyx_4 = PyObject_GetAttr(__pyx_2, __pyx_n_CmpGreater); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 694; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyTuple_New(4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 694; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_3);
  Py_INCREF(((PyObject *)__pyx_v_noisy_pixels_mask));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_noisy_pixels_mask));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 2, ((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 3, __pyx_4);
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 694; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":695 */
  __pyx_4 = PyObject_GetAttr(((PyObject *)__pyx_v_compareframe8u), __pyx_n_set_val_masked); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 695; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(25); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 695; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 695; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  Py_INCREF(((PyObject *)__pyx_v_noisy_pixels_mask));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_noisy_pixels_mask));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 2, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(__pyx_4, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 695; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("realtime_image_analysis.bg_help_slow");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF((PyObject *)__pyx_v_running_mean_im);
  Py_DECREF((PyObject *)__pyx_v_fastframef32_tmp);
  Py_DECREF((PyObject *)__pyx_v_running_sumsqf);
  Py_DECREF((PyObject *)__pyx_v_mean2);
  Py_DECREF((PyObject *)__pyx_v_running_stdframe);
  Py_DECREF((PyObject *)__pyx_v_running_mean8u_im);
  Py_DECREF((PyObject *)__pyx_v_hw_roi_frame);
  Py_DECREF((PyObject *)__pyx_v_noisy_pixels_mask);
  Py_DECREF((PyObject *)__pyx_v_compareframe8u);
  Py_DECREF(__pyx_v_max_frame_size);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_bg_help(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_bg_help(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_mean_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_fastframef32_tmp = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_sumsqf = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_mean2 = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_stdframe = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_running_mean8u_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_hw_roi_frame = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_noisy_pixels_mask = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_compareframe8u = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *__pyx_v_max_frame_size = 0;
  float __pyx_v_ALPHA;
  double __pyx_v_C;
  PyObject *__pyx_r;
  static char *__pyx_argnames[] = {"running_mean_im","fastframef32_tmp","running_sumsqf","mean2","running_stdframe","running_mean8u_im","hw_roi_frame","noisy_pixels_mask","compareframe8u","max_frame_size","ALPHA","C",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OOOOOOOOOOfd", __pyx_argnames, &__pyx_v_running_mean_im, &__pyx_v_fastframef32_tmp, &__pyx_v_running_sumsqf, &__pyx_v_mean2, &__pyx_v_running_stdframe, &__pyx_v_running_mean8u_im, &__pyx_v_hw_roi_frame, &__pyx_v_noisy_pixels_mask, &__pyx_v_compareframe8u, &__pyx_v_max_frame_size, &__pyx_v_ALPHA, &__pyx_v_C)) return 0;
  Py_INCREF((PyObject *)__pyx_v_running_mean_im);
  Py_INCREF((PyObject *)__pyx_v_fastframef32_tmp);
  Py_INCREF((PyObject *)__pyx_v_running_sumsqf);
  Py_INCREF((PyObject *)__pyx_v_mean2);
  Py_INCREF((PyObject *)__pyx_v_running_stdframe);
  Py_INCREF((PyObject *)__pyx_v_running_mean8u_im);
  Py_INCREF((PyObject *)__pyx_v_hw_roi_frame);
  Py_INCREF((PyObject *)__pyx_v_noisy_pixels_mask);
  Py_INCREF((PyObject *)__pyx_v_compareframe8u);
  Py_INCREF(__pyx_v_max_frame_size);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_mean_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 698; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "fastframef32_tmp")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 699; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_sumsqf), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_sumsqf")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 700; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_mean2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "mean2")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_stdframe), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_stdframe")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 702; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean8u_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "running_mean8u_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 703; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_hw_roi_frame), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "hw_roi_frame")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 704; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_noisy_pixels_mask), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "noisy_pixels_mask")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_compareframe8u), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "compareframe8u")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 706; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_max_frame_size), __pyx_ptype_6motmot_9FastImage_9FastImage_Size, 1, "max_frame_size")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 707; goto __pyx_L1;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":711 */
  Py_BEGIN_ALLOW_THREADS;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":714 */
  CHK_NOGIL(ippiAddWeighted_8u32f_C1IR(((Ipp8u (*))__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f (*))__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":720 */
  CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f (*))__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp8u (*))__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":727 */
  CHK_NOGIL(ippiConvert_8u32f_C1R(((Ipp8u (*))__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f (*))__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":732 */
  CHK_NOGIL(ippiSqr_32f_C1IR(((Ipp32f (*))__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":736 */
  CHK_NOGIL(ippiAddWeighted_32f_C1IR(((Ipp32f (*))__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,((Ipp32f (*))__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":740 */
  CHK_NOGIL(ippiSqr_32f_C1R(((Ipp32f (*))__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp32f (*))__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":744 */
  CHK_NOGIL(ippiSub_32f_C1R(((Ipp32f (*))__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,((Ipp32f (*))__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,((Ipp32f (*))__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":751 */
  CHK_NOGIL(ippiMulC_32f_C1IR(__pyx_v_C,((Ipp32f (*))__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":754 */
  CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f (*))__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,((Ipp8u (*))__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":761 */
  CHK_NOGIL(ippiCompareC_8u_C1R(((Ipp8u (*))__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,200,((Ipp8u (*))__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step,__pyx_v_max_frame_size->sz,ippCmpGreater));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":768 */
  CHK_NOGIL(ippiSet_8u_C1MR(25,((Ipp8u (*))__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,((Ipp8u (*))__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":770 */
  Py_END_ALLOW_THREADS;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("realtime_image_analysis.bg_help");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF((PyObject *)__pyx_v_running_mean_im);
  Py_DECREF((PyObject *)__pyx_v_fastframef32_tmp);
  Py_DECREF((PyObject *)__pyx_v_running_sumsqf);
  Py_DECREF((PyObject *)__pyx_v_mean2);
  Py_DECREF((PyObject *)__pyx_v_running_stdframe);
  Py_DECREF((PyObject *)__pyx_v_running_mean8u_im);
  Py_DECREF((PyObject *)__pyx_v_hw_roi_frame);
  Py_DECREF((PyObject *)__pyx_v_noisy_pixels_mask);
  Py_DECREF((PyObject *)__pyx_v_compareframe8u);
  Py_DECREF(__pyx_v_max_frame_size);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_do_bg_maint(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_do_bg_maint(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_mean_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_hw_roi_frame = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *__pyx_v_max_frame_size = 0;
  float __pyx_v_ALPHA;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_running_mean8u_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_fastframef32_tmp = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_sumsqf = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_mean2 = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_stdframe = 0;
  float __pyx_v_n_sigma;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_compareframe8u = 0;
  int __pyx_v_bright_non_gaussian_cutoff;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_noisy_pixels_mask = 0;
  int __pyx_v_bright_non_gaussian_replacement;
  int __pyx_v_bench;
  int __pyx_v_BENCHMARK;
  double __pyx_v_t41;
  double __pyx_v_t42;
  double __pyx_v_t43;
  double __pyx_v_t44;
  double __pyx_v_t45;
  double __pyx_v_t46;
  double __pyx_v_t47;
  double __pyx_v_t48;
  double __pyx_v_t49;
  double __pyx_v_t491;
  double __pyx_v_t492;
  PyObject *__pyx_v_res;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  PyObject *__pyx_7 = 0;
  PyObject *__pyx_8 = 0;
  PyObject *__pyx_9 = 0;
  PyObject *__pyx_10 = 0;
  PyObject *__pyx_11 = 0;
  PyObject *__pyx_12 = 0;
  PyObject *__pyx_13 = 0;
  static char *__pyx_argnames[] = {"running_mean_im","hw_roi_frame","max_frame_size","ALPHA","running_mean8u_im","fastframef32_tmp","running_sumsqf","mean2","running_stdframe","n_sigma","compareframe8u","bright_non_gaussian_cutoff","noisy_pixels_mask","bright_non_gaussian_replacement","bench",0};
  __pyx_v_bench = __pyx_k11;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OOOfOOOOOfOiOi|i", __pyx_argnames, &__pyx_v_running_mean_im, &__pyx_v_hw_roi_frame, &__pyx_v_max_frame_size, &__pyx_v_ALPHA, &__pyx_v_running_mean8u_im, &__pyx_v_fastframef32_tmp, &__pyx_v_running_sumsqf, &__pyx_v_mean2, &__pyx_v_running_stdframe, &__pyx_v_n_sigma, &__pyx_v_compareframe8u, &__pyx_v_bright_non_gaussian_cutoff, &__pyx_v_noisy_pixels_mask, &__pyx_v_bright_non_gaussian_replacement, &__pyx_v_bench)) return 0;
  Py_INCREF((PyObject *)__pyx_v_running_mean_im);
  Py_INCREF((PyObject *)__pyx_v_hw_roi_frame);
  Py_INCREF(__pyx_v_max_frame_size);
  Py_INCREF((PyObject *)__pyx_v_running_mean8u_im);
  Py_INCREF((PyObject *)__pyx_v_fastframef32_tmp);
  Py_INCREF((PyObject *)__pyx_v_running_sumsqf);
  Py_INCREF((PyObject *)__pyx_v_mean2);
  Py_INCREF((PyObject *)__pyx_v_running_stdframe);
  Py_INCREF((PyObject *)__pyx_v_compareframe8u);
  Py_INCREF((PyObject *)__pyx_v_noisy_pixels_mask);
  __pyx_v_res = Py_None; Py_INCREF(Py_None);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_mean_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 772; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_hw_roi_frame), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "hw_roi_frame")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 773; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_max_frame_size), __pyx_ptype_6motmot_9FastImage_9FastImage_Size, 1, "max_frame_size")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 774; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean8u_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "running_mean8u_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 776; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "fastframef32_tmp")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 777; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_sumsqf), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_sumsqf")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 778; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_mean2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "mean2")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 779; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_stdframe), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_stdframe")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 780; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_compareframe8u), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "compareframe8u")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_noisy_pixels_mask), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "noisy_pixels_mask")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 784; goto __pyx_L1;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":789 */
  __pyx_v_BENCHMARK = __pyx_v_bench;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":792 */
  Py_BEGIN_ALLOW_THREADS;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":795 */
  CHK_NOGIL(ippiAddWeighted_8u32f_C1IR(((Ipp8u (*))__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f (*))__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":798 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":799 */
    __pyx_v_t41 = time_time();
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":801 */
  CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f (*))__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp8u (*))__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":806 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":807 */
    __pyx_v_t42 = time_time();
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":810 */
  CHK_NOGIL(ippiConvert_8u32f_C1R(((Ipp8u (*))__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f (*))__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":813 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":814 */
    __pyx_v_t43 = time_time();
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":816 */
  CHK_NOGIL(ippiSqr_32f_C1IR(((Ipp32f (*))__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":818 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":819 */
    __pyx_v_t44 = time_time();
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":821 */
  CHK_NOGIL(ippiAddWeighted_32f_C1IR(((Ipp32f (*))__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,((Ipp32f (*))__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":824 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":825 */
    __pyx_v_t45 = time_time();
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":828 */
  CHK_NOGIL(ippiSqr_32f_C1R(((Ipp32f (*))__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp32f (*))__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":831 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":832 */
    __pyx_v_t46 = time_time();
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":834 */
  CHK_NOGIL(ippiSub_32f_C1R(((Ipp32f (*))__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,((Ipp32f (*))__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,((Ipp32f (*))__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":838 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":839 */
    __pyx_v_t47 = time_time();
    goto __pyx_L8;
  }
  __pyx_L8:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":842 */
  CHK_NOGIL(ippiMulC_32f_C1IR(__pyx_v_n_sigma,((Ipp32f (*))__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":844 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":845 */
    __pyx_v_t48 = time_time();
    goto __pyx_L9;
  }
  __pyx_L9:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":847 */
  CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f (*))__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,((Ipp8u (*))__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":852 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":853 */
    __pyx_v_t49 = time_time();
    goto __pyx_L10;
  }
  __pyx_L10:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":856 */
  CHK_NOGIL(ippiCompareC_8u_C1R(((Ipp8u (*))__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,__pyx_v_bright_non_gaussian_cutoff,((Ipp8u (*))__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step,__pyx_v_max_frame_size->sz,ippCmpGreater));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":861 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":862 */
    __pyx_v_t491 = time_time();
    goto __pyx_L11;
  }
  __pyx_L11:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":864 */
  CHK_NOGIL(ippiSet_8u_C1MR(__pyx_v_bright_non_gaussian_replacement,((Ipp8u (*))__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,((Ipp8u (*))__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":867 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":868 */
    __pyx_v_t492 = time_time();
    goto __pyx_L12;
  }
  __pyx_L12:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":870 */
  Py_END_ALLOW_THREADS;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":872 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":873 */
    __pyx_2 = PyFloat_FromDouble(__pyx_v_t41); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; goto __pyx_L1;}
    __pyx_3 = PyFloat_FromDouble(__pyx_v_t42); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; goto __pyx_L1;}
    __pyx_4 = PyFloat_FromDouble(__pyx_v_t43); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; goto __pyx_L1;}
    __pyx_5 = PyFloat_FromDouble(__pyx_v_t44); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; goto __pyx_L1;}
    __pyx_6 = PyFloat_FromDouble(__pyx_v_t45); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; goto __pyx_L1;}
    __pyx_7 = PyFloat_FromDouble(__pyx_v_t46); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; goto __pyx_L1;}
    __pyx_8 = PyFloat_FromDouble(__pyx_v_t47); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; goto __pyx_L1;}
    __pyx_9 = PyFloat_FromDouble(__pyx_v_t48); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; goto __pyx_L1;}
    __pyx_10 = PyFloat_FromDouble(__pyx_v_t49); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; goto __pyx_L1;}
    __pyx_11 = PyFloat_FromDouble(__pyx_v_t491); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; goto __pyx_L1;}
    __pyx_12 = PyFloat_FromDouble(__pyx_v_t492); if (!__pyx_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; goto __pyx_L1;}
    __pyx_13 = PyTuple_New(11); if (!__pyx_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 873; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_13, 0, __pyx_2);
    PyTuple_SET_ITEM(__pyx_13, 1, __pyx_3);
    PyTuple_SET_ITEM(__pyx_13, 2, __pyx_4);
    PyTuple_SET_ITEM(__pyx_13, 3, __pyx_5);
    PyTuple_SET_ITEM(__pyx_13, 4, __pyx_6);
    PyTuple_SET_ITEM(__pyx_13, 5, __pyx_7);
    PyTuple_SET_ITEM(__pyx_13, 6, __pyx_8);
    PyTuple_SET_ITEM(__pyx_13, 7, __pyx_9);
    PyTuple_SET_ITEM(__pyx_13, 8, __pyx_10);
    PyTuple_SET_ITEM(__pyx_13, 9, __pyx_11);
    PyTuple_SET_ITEM(__pyx_13, 10, __pyx_12);
    __pyx_2 = 0;
    __pyx_3 = 0;
    __pyx_4 = 0;
    __pyx_5 = 0;
    __pyx_6 = 0;
    __pyx_7 = 0;
    __pyx_8 = 0;
    __pyx_9 = 0;
    __pyx_10 = 0;
    __pyx_11 = 0;
    __pyx_12 = 0;
    Py_DECREF(__pyx_v_res);
    __pyx_v_res = __pyx_13;
    __pyx_13 = 0;
    goto __pyx_L13;
  }
  /*else*/ {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":875 */
    Py_INCREF(Py_None);
    Py_DECREF(__pyx_v_res);
    __pyx_v_res = Py_None;
  }
  __pyx_L13:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":876 */
  Py_INCREF(__pyx_v_res);
  __pyx_r = __pyx_v_res;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  Py_XDECREF(__pyx_7);
  Py_XDECREF(__pyx_8);
  Py_XDECREF(__pyx_9);
  Py_XDECREF(__pyx_10);
  Py_XDECREF(__pyx_11);
  Py_XDECREF(__pyx_12);
  Py_XDECREF(__pyx_13);
  __Pyx_AddTraceback("realtime_image_analysis.do_bg_maint");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_res);
  Py_DECREF((PyObject *)__pyx_v_running_mean_im);
  Py_DECREF((PyObject *)__pyx_v_hw_roi_frame);
  Py_DECREF(__pyx_v_max_frame_size);
  Py_DECREF((PyObject *)__pyx_v_running_mean8u_im);
  Py_DECREF((PyObject *)__pyx_v_fastframef32_tmp);
  Py_DECREF((PyObject *)__pyx_v_running_sumsqf);
  Py_DECREF((PyObject *)__pyx_v_mean2);
  Py_DECREF((PyObject *)__pyx_v_running_stdframe);
  Py_DECREF((PyObject *)__pyx_v_compareframe8u);
  Py_DECREF((PyObject *)__pyx_v_noisy_pixels_mask);
  return __pyx_r;
}

static __Pyx_InternTabEntry __pyx_intern_tab[] = {
  {&__pyx_n_CmpGreater, "CmpGreater"},
  {&__pyx_n_False, "False"},
  {&__pyx_n_FastImage, "FastImage"},
  {&__pyx_n_IppError, "IppError"},
  {&__pyx_n_L_i, "L_i"},
  {&__pyx_n_L_j, "L_j"},
  {&__pyx_n_Lmatrix2Lcoords, "Lmatrix2Lcoords"},
  {&__pyx_n_True, "True"},
  {&__pyx_n_ValueError, "ValueError"},
  {&__pyx_n_absdiff, "absdiff"},
  {&__pyx_n_append, "append"},
  {&__pyx_n_array, "array"},
  {&__pyx_n_asarray, "asarray"},
  {&__pyx_n_bg_help, "bg_help"},
  {&__pyx_n_bg_help_slow, "bg_help_slow"},
  {&__pyx_n_c_lib, "c_lib"},
  {&__pyx_n_c_python, "c_python"},
  {&__pyx_n_cmp, "cmp"},
  {&__pyx_n_cmpdiff, "cmpdiff"},
  {&__pyx_n_det, "det"},
  {&__pyx_n_distort, "distort"},
  {&__pyx_n_do_bg_maint, "do_bg_maint"},
  {&__pyx_n_dot, "dot"},
  {&__pyx_n_dual, "dual"},
  {&__pyx_n_full_matrices, "full_matrices"},
  {&__pyx_n_get_32f_copy_put, "get_32f_copy_put"},
  {&__pyx_n_get_8u_copy_put, "get_8u_copy_put"},
  {&__pyx_n_get_compare_put, "get_compare_put"},
  {&__pyx_n_get_square_put, "get_square_put"},
  {&__pyx_n_get_subtracted_put, "get_subtracted_put"},
  {&__pyx_n_ipp, "ipp"},
  {&__pyx_n_len, "len"},
  {&__pyx_n_mask, "mask"},
  {&__pyx_n_mean, "mean"},
  {&__pyx_n_nan, "nan"},
  {&__pyx_n_near_inf, "near_inf"},
  {&__pyx_n_newaxis, "newaxis"},
  {&__pyx_n_numpy, "numpy"},
  {&__pyx_n_nx, "nx"},
  {&__pyx_n_ones, "ones"},
  {&__pyx_n_pinv, "pinv"},
  {&__pyx_n_pluecker_from_verts, "pluecker_from_verts"},
  {&__pyx_n_r_, "r_"},
  {&__pyx_n_reshape, "reshape"},
  {&__pyx_n_roi, "roi"},
  {&__pyx_n_set_val, "set_val"},
  {&__pyx_n_set_val_masked, "set_val_masked"},
  {&__pyx_n_stacklevel, "stacklevel"},
  {&__pyx_n_str, "str"},
  {&__pyx_n_svd, "svd"},
  {&__pyx_n_time, "time"},
  {&__pyx_n_toself_add_weighted, "toself_add_weighted"},
  {&__pyx_n_toself_multiply, "toself_multiply"},
  {&__pyx_n_toself_square, "toself_square"},
  {&__pyx_n_transpose, "transpose"},
  {&__pyx_n_undistort, "undistort"},
  {&__pyx_n_warn, "warn"},
  {&__pyx_n_warnings, "warnings"},
  {0, 0}
};

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_k4p, __pyx_k4, sizeof(__pyx_k4)},
  {&__pyx_k5p, __pyx_k5, sizeof(__pyx_k5)},
  {&__pyx_k12p, __pyx_k12, sizeof(__pyx_k12)},
  {&__pyx_k18p, __pyx_k18, sizeof(__pyx_k18)},
  {&__pyx_k19p, __pyx_k19, sizeof(__pyx_k19)},
  {&__pyx_k22p, __pyx_k22, sizeof(__pyx_k22)},
  {&__pyx_k23p, __pyx_k23, sizeof(__pyx_k23)},
  {&__pyx_k24p, __pyx_k24, sizeof(__pyx_k24)},
  {&__pyx_k25p, __pyx_k25, sizeof(__pyx_k25)},
  {&__pyx_k26p, __pyx_k26, sizeof(__pyx_k26)},
  {&__pyx_k27p, __pyx_k27, sizeof(__pyx_k27)},
  {0, 0, 0}
};

static PyObject *__pyx_tp_new_23realtime_image_analysis_RealtimeAnalyzer(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *p = (struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)o;
  p->_pmat = Py_None; Py_INCREF(Py_None);
  p->_pmat_inv = Py_None; Py_INCREF(Py_None);
  p->camera_center = Py_None; Py_INCREF(Py_None);
  p->_pmat_meters = Py_None; Py_INCREF(Py_None);
  p->_pmat_meters_inv = Py_None; Py_INCREF(Py_None);
  p->camera_center_meters = Py_None; Py_INCREF(Py_None);
  p->_set_pmat = Py_None; Py_INCREF(Py_None);
  p->_helper = Py_None; Py_INCREF(Py_None);
  p->_roi_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)Py_None); Py_INCREF(Py_None);
  p->absdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->cmpdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->absdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->cmpdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->absdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->cmpdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->mask_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->mean_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->cmp_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->mean_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->cmp_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->imname2im = Py_None; Py_INCREF(Py_None);
  if (__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___new__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_23realtime_image_analysis_RealtimeAnalyzer(PyObject *o) {
  struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *p = (struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)o;
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++o->ob_refcnt;
    __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --o->ob_refcnt;
    PyErr_Restore(etype, eval, etb);
  }
  Py_XDECREF(p->_pmat);
  Py_XDECREF(p->_pmat_inv);
  Py_XDECREF(p->camera_center);
  Py_XDECREF(p->_pmat_meters);
  Py_XDECREF(p->_pmat_meters_inv);
  Py_XDECREF(p->camera_center_meters);
  Py_XDECREF(p->_set_pmat);
  Py_XDECREF(p->_helper);
  Py_XDECREF(((PyObject *)p->_roi_sz));
  Py_XDECREF(((PyObject *)p->absdiff_im));
  Py_XDECREF(((PyObject *)p->cmpdiff_im));
  Py_XDECREF(((PyObject *)p->absdiff_im_roi_view));
  Py_XDECREF(((PyObject *)p->cmpdiff_im_roi_view));
  Py_XDECREF(((PyObject *)p->absdiff_im_roi2_view));
  Py_XDECREF(((PyObject *)p->cmpdiff_im_roi2_view));
  Py_XDECREF(((PyObject *)p->mask_im));
  Py_XDECREF(((PyObject *)p->mean_im));
  Py_XDECREF(((PyObject *)p->cmp_im));
  Py_XDECREF(((PyObject *)p->mean_im_roi_view));
  Py_XDECREF(((PyObject *)p->cmp_im_roi_view));
  Py_XDECREF(p->imname2im);
  (*o->ob_type->tp_free)(o);
}

static int __pyx_tp_traverse_23realtime_image_analysis_RealtimeAnalyzer(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *p = (struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)o;
  if (p->_pmat) {
    e = (*v)(p->_pmat, a); if (e) return e;
  }
  if (p->_pmat_inv) {
    e = (*v)(p->_pmat_inv, a); if (e) return e;
  }
  if (p->camera_center) {
    e = (*v)(p->camera_center, a); if (e) return e;
  }
  if (p->_pmat_meters) {
    e = (*v)(p->_pmat_meters, a); if (e) return e;
  }
  if (p->_pmat_meters_inv) {
    e = (*v)(p->_pmat_meters_inv, a); if (e) return e;
  }
  if (p->camera_center_meters) {
    e = (*v)(p->camera_center_meters, a); if (e) return e;
  }
  if (p->_set_pmat) {
    e = (*v)(p->_set_pmat, a); if (e) return e;
  }
  if (p->_helper) {
    e = (*v)(p->_helper, a); if (e) return e;
  }
  if (p->_roi_sz) {
    e = (*v)(((PyObject*)p->_roi_sz), a); if (e) return e;
  }
  if (p->absdiff_im) {
    e = (*v)(((PyObject*)p->absdiff_im), a); if (e) return e;
  }
  if (p->cmpdiff_im) {
    e = (*v)(((PyObject*)p->cmpdiff_im), a); if (e) return e;
  }
  if (p->absdiff_im_roi_view) {
    e = (*v)(((PyObject*)p->absdiff_im_roi_view), a); if (e) return e;
  }
  if (p->cmpdiff_im_roi_view) {
    e = (*v)(((PyObject*)p->cmpdiff_im_roi_view), a); if (e) return e;
  }
  if (p->absdiff_im_roi2_view) {
    e = (*v)(((PyObject*)p->absdiff_im_roi2_view), a); if (e) return e;
  }
  if (p->cmpdiff_im_roi2_view) {
    e = (*v)(((PyObject*)p->cmpdiff_im_roi2_view), a); if (e) return e;
  }
  if (p->mask_im) {
    e = (*v)(((PyObject*)p->mask_im), a); if (e) return e;
  }
  if (p->mean_im) {
    e = (*v)(((PyObject*)p->mean_im), a); if (e) return e;
  }
  if (p->cmp_im) {
    e = (*v)(((PyObject*)p->cmp_im), a); if (e) return e;
  }
  if (p->mean_im_roi_view) {
    e = (*v)(((PyObject*)p->mean_im_roi_view), a); if (e) return e;
  }
  if (p->cmp_im_roi_view) {
    e = (*v)(((PyObject*)p->cmp_im_roi_view), a); if (e) return e;
  }
  if (p->imname2im) {
    e = (*v)(p->imname2im, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_23realtime_image_analysis_RealtimeAnalyzer(PyObject *o) {
  struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *p = (struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)o;
  Py_XDECREF(p->_pmat);
  p->_pmat = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->_pmat_inv);
  p->_pmat_inv = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->camera_center);
  p->camera_center = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->_pmat_meters);
  p->_pmat_meters = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->_pmat_meters_inv);
  p->_pmat_meters_inv = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->camera_center_meters);
  p->camera_center_meters = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->_set_pmat);
  p->_set_pmat = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(p->_helper);
  p->_helper = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->_roi_sz));
  p->_roi_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->absdiff_im));
  p->absdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->cmpdiff_im));
  p->cmpdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->absdiff_im_roi_view));
  p->absdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->cmpdiff_im_roi_view));
  p->cmpdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->absdiff_im_roi2_view));
  p->absdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->cmpdiff_im_roi2_view));
  p->cmpdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->mask_im));
  p->mask_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->mean_im));
  p->mean_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->cmp_im));
  p->cmp_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->mean_im_roi_view));
  p->mean_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->cmp_im_roi_view));
  p->cmp_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(p->imname2im);
  p->imname2im = Py_None; Py_INCREF(Py_None);
  return 0;
}

static PyObject *__pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_roi2_radius(PyObject *o, void *x) {
  return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___get__(o);
}

static int __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_roi2_radius(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_clear_threshold(PyObject *o, void *x) {
  return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___get__(o);
}

static int __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_clear_threshold(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_diff_threshold(PyObject *o, void *x) {
  return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___get__(o);
}

static int __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_diff_threshold(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_scale_factor(PyObject *o, void *x) {
  return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___get__(o);
}

static int __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_scale_factor(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_roi(PyObject *o, void *x) {
  return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_3roi___get__(o);
}

static int __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_roi(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_3roi___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static struct PyMethodDef __pyx_methods_23realtime_image_analysis_RealtimeAnalyzer[] = {
  {"set_reconstruct_helper", (PyCFunction)__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_set_reconstruct_helper, METH_VARARGS|METH_KEYWORDS, 0},
  {"get_pmat", (PyCFunction)__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_get_pmat, METH_VARARGS|METH_KEYWORDS, 0},
  {"set_pmat", (PyCFunction)__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_set_pmat, METH_VARARGS|METH_KEYWORDS, 0},
  {"distort", (PyCFunction)__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_distort, METH_VARARGS|METH_KEYWORDS, 0},
  {"do_work", (PyCFunction)__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_do_work, METH_VARARGS|METH_KEYWORDS, __pyx_doc_23realtime_image_analysis_16RealtimeAnalyzer_do_work},
  {"get_image_view", (PyCFunction)__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_get_image_view, METH_VARARGS|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_23realtime_image_analysis_RealtimeAnalyzer[] = {
  {"roi2_radius", __pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_roi2_radius, __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_roi2_radius, 0, 0},
  {"clear_threshold", __pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_clear_threshold, __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_clear_threshold, 0, 0},
  {"diff_threshold", __pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_diff_threshold, __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_diff_threshold, 0, 0},
  {"scale_factor", __pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_scale_factor, __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_scale_factor, 0, 0},
  {"roi", __pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_roi, __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_roi, 0, 0},
  {0, 0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_RealtimeAnalyzer = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
};

static PySequenceMethods __pyx_tp_as_sequence_RealtimeAnalyzer = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_RealtimeAnalyzer = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_RealtimeAnalyzer = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_23realtime_image_analysis_RealtimeAnalyzer = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "realtime_image_analysis.RealtimeAnalyzer", /*tp_name*/
  sizeof(struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_23realtime_image_analysis_RealtimeAnalyzer, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_RealtimeAnalyzer, /*tp_as_number*/
  &__pyx_tp_as_sequence_RealtimeAnalyzer, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_RealtimeAnalyzer, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_RealtimeAnalyzer, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_23realtime_image_analysis_RealtimeAnalyzer, /*tp_traverse*/
  __pyx_tp_clear_23realtime_image_analysis_RealtimeAnalyzer, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_23realtime_image_analysis_RealtimeAnalyzer, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_23realtime_image_analysis_RealtimeAnalyzer, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_23realtime_image_analysis_RealtimeAnalyzer, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static struct PyMethodDef __pyx_methods[] = {
  {"Lmatrix2Lcoords", (PyCFunction)__pyx_f_23realtime_image_analysis_Lmatrix2Lcoords, METH_VARARGS|METH_KEYWORDS, 0},
  {"pluecker_from_verts", (PyCFunction)__pyx_f_23realtime_image_analysis_pluecker_from_verts, METH_VARARGS|METH_KEYWORDS, __pyx_doc_23realtime_image_analysis_pluecker_from_verts},
  {"bg_help_slow", (PyCFunction)__pyx_f_23realtime_image_analysis_bg_help_slow, METH_VARARGS|METH_KEYWORDS, 0},
  {"bg_help", (PyCFunction)__pyx_f_23realtime_image_analysis_bg_help, METH_VARARGS|METH_KEYWORDS, 0},
  {"do_bg_maint", (PyCFunction)__pyx_f_23realtime_image_analysis_do_bg_maint, METH_VARARGS|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static void __pyx_init_filenames(void); /*proto*/

PyMODINIT_FUNC initrealtime_image_analysis(void); /*proto*/
PyMODINIT_FUNC initrealtime_image_analysis(void) {
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  double __pyx_3;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  PyObject *__pyx_7 = 0;
  PyObject *__pyx_8 = 0;
  PyObject *__pyx_9 = 0;
  __pyx_init_filenames();
  __pyx_m = Py_InitModule4("realtime_image_analysis", __pyx_methods, 0, 0, PYTHON_API_VERSION);
  if (!__pyx_m) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; goto __pyx_L1;};
  __pyx_b = PyImport_AddModule("__builtin__");
  if (!__pyx_b) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; goto __pyx_L1;};
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; goto __pyx_L1;};
  if (__Pyx_InternStrings(__pyx_intern_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; goto __pyx_L1;};
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; goto __pyx_L1;};
  __pyx_type_23realtime_image_analysis_RealtimeAnalyzer.tp_free = _PyObject_GC_Del;
  if (PyType_Ready(&__pyx_type_23realtime_image_analysis_RealtimeAnalyzer) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "RealtimeAnalyzer", (PyObject *)&__pyx_type_23realtime_image_analysis_RealtimeAnalyzer) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 102; goto __pyx_L1;}
  __pyx_ptype_23realtime_image_analysis_RealtimeAnalyzer = &__pyx_type_23realtime_image_analysis_RealtimeAnalyzer;
  __pyx_ptype_6motmot_9FastImage_9FastImage_Size = __Pyx_ImportType("motmot.FastImage.FastImage", "Size", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_Size)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_Size) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 6; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_Point = __Pyx_ImportType("motmot.FastImage.FastImage", "Point", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_Point)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_Point) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 9; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_FastImageBase = __Pyx_ImportType("motmot.FastImage.FastImage", "FastImageBase", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_FastImageBase) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 12; goto __pyx_L1;}
  if (__Pyx_GetVtable(__pyx_ptype_6motmot_9FastImage_9FastImage_FastImageBase->tp_dict, &__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImageBase) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 12; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f = __Pyx_ImportType("motmot.FastImage.FastImage", "FastImage32f", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 24; goto __pyx_L1;}
  if (__Pyx_GetVtable(__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f->tp_dict, &__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage32f) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 24; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u = __Pyx_ImportType("motmot.FastImage.FastImage", "FastImage8u", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 26; goto __pyx_L1;}
  if (__Pyx_GetVtable(__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u->tp_dict, &__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage8u) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 26; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_LazyOp = __Pyx_ImportType("motmot.FastImage.FastImage", "LazyOp", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_LazyOp) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_square = __Pyx_ImportType("motmot.FastImage.FastImage", "square", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_square)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_square) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 47; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_sqrt = __Pyx_ImportType("motmot.FastImage.FastImage", "sqrt", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_sqrt)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_sqrt) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 50; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_blend_with = __Pyx_ImportType("motmot.FastImage.FastImage", "blend_with", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_blend_with)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_blend_with) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 55; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_8u = __Pyx_ImportType("motmot.FastImage.FastImage", "convert_to_8u", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_convert_to_8u)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_8u) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 59; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_32f = __Pyx_ImportType("motmot.FastImage.FastImage", "convert_to_32f", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_convert_to_32f)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_32f) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 62; goto __pyx_L1;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":15 */
  __pyx_1 = __Pyx_Import(__pyx_n_time, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_time, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":16 */
  __pyx_1 = __Pyx_Import(__pyx_n_numpy, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_nx, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 16; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":17 */
  __pyx_1 = __Pyx_Import(__pyx_n_warnings, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_warnings, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 17; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":18 */
  __pyx_1 = __Pyx_Import(__pyx_k4p, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_numpy, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":22 */
  __pyx_1 = __Pyx_Import(__pyx_k5p, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 22; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_FastImage, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 22; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":25 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_nan); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_3 = PyFloat_AsDouble(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_v_23realtime_image_analysis_nan = __pyx_3;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":27 */
  __pyx_1 = PyFloat_FromDouble(9.999999e20); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_near_inf, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 27; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":83 */
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_array); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyInt_FromLong(0); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  __pyx_4 = PyInt_FromLong(0); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  __pyx_5 = PyInt_FromLong(0); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  __pyx_6 = PyInt_FromLong(1); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  __pyx_7 = PyInt_FromLong(3); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  __pyx_8 = PyInt_FromLong(2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  __pyx_9 = PyList_New(6); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  PyList_SET_ITEM(__pyx_9, 0, __pyx_2);
  PyList_SET_ITEM(__pyx_9, 1, __pyx_4);
  PyList_SET_ITEM(__pyx_9, 2, __pyx_5);
  PyList_SET_ITEM(__pyx_9, 3, __pyx_6);
  PyList_SET_ITEM(__pyx_9, 4, __pyx_7);
  PyList_SET_ITEM(__pyx_9, 5, __pyx_8);
  __pyx_2 = 0;
  __pyx_4 = 0;
  __pyx_5 = 0;
  __pyx_6 = 0;
  __pyx_7 = 0;
  __pyx_8 = 0;
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_9);
  __pyx_9 = 0;
  __pyx_4 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_L_i, __pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":84 */
  __pyx_5 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; goto __pyx_L1;}
  __pyx_6 = PyObject_GetAttr(__pyx_5, __pyx_n_array); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  __pyx_7 = PyInt_FromLong(1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; goto __pyx_L1;}
  __pyx_8 = PyInt_FromLong(2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; goto __pyx_L1;}
  __pyx_9 = PyInt_FromLong(3); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; goto __pyx_L1;}
  __pyx_4 = PyInt_FromLong(3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; goto __pyx_L1;}
  __pyx_5 = PyList_New(6); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; goto __pyx_L1;}
  PyList_SET_ITEM(__pyx_5, 0, __pyx_7);
  PyList_SET_ITEM(__pyx_5, 1, __pyx_8);
  PyList_SET_ITEM(__pyx_5, 2, __pyx_9);
  PyList_SET_ITEM(__pyx_5, 3, __pyx_1);
  PyList_SET_ITEM(__pyx_5, 4, __pyx_2);
  PyList_SET_ITEM(__pyx_5, 5, __pyx_4);
  __pyx_7 = 0;
  __pyx_8 = 0;
  __pyx_9 = 0;
  __pyx_1 = 0;
  __pyx_2 = 0;
  __pyx_4 = 0;
  __pyx_7 = PyTuple_New(1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_7, 0, __pyx_5);
  __pyx_5 = 0;
  __pyx_8 = PyObject_CallObject(__pyx_6, __pyx_7); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; goto __pyx_L1;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  Py_DECREF(__pyx_7); __pyx_7 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_L_j, __pyx_8) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 84; goto __pyx_L1;}
  Py_DECREF(__pyx_8); __pyx_8 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":267 */
  __pyx_k6 = 0;
  __pyx_k7 = 0;
  __pyx_k8 = 0.0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":602 */
  Py_INCREF(__pyx_n_mean);
  __pyx_k10 = __pyx_n_mean;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":772 */
  __pyx_k11 = 0;
  return;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  Py_XDECREF(__pyx_7);
  Py_XDECREF(__pyx_8);
  Py_XDECREF(__pyx_9);
  __Pyx_AddTraceback("realtime_image_analysis");
}

static char *__pyx_filenames[] = {
  "realtime_image_analysis.pyx",
  "motmot.FastImage.FastImage.pxd",
};

/* Runtime support code */

static void __pyx_init_filenames(void) {
  __pyx_f = __pyx_filenames;
}

static int __Pyx_GetStarArgs(
    PyObject **args, 
    PyObject **kwds,
    char *kwd_list[], 
    int nargs,
    PyObject **args2, 
    PyObject **kwds2)
{
    PyObject *x = 0, *args1 = 0, *kwds1 = 0;
    
    if (args2)
        *args2 = 0;
    if (kwds2)
        *kwds2 = 0;
    
    if (args2) {
        args1 = PyTuple_GetSlice(*args, 0, nargs);
        if (!args1)
            goto bad;
        *args2 = PyTuple_GetSlice(*args, nargs, PyTuple_Size(*args));
        if (!*args2)
            goto bad;
    }
    else {
        args1 = *args;
        Py_INCREF(args1);
    }
    
    if (kwds2) {
        if (*kwds) {
            char **p;
            kwds1 = PyDict_New();
            if (!kwds)
                goto bad;
            *kwds2 = PyDict_Copy(*kwds);
            if (!*kwds2)
                goto bad;
            for (p = kwd_list; *p; p++) {
                x = PyDict_GetItemString(*kwds, *p);
                if (x) {
                    if (PyDict_SetItemString(kwds1, *p, x) < 0)
                        goto bad;
                    if (PyDict_DelItemString(*kwds2, *p) < 0)
                        goto bad;
                }
            }
        }
        else {
            *kwds2 = PyDict_New();
            if (!*kwds2)
                goto bad;
        }
    }
    else {
        kwds1 = *kwds;
        Py_XINCREF(kwds1);
    }
    
    *args = args1;
    *kwds = kwds1;
    return 0;
bad:
    Py_XDECREF(args1);
    Py_XDECREF(kwds1);
    if (*args2) {
        Py_XDECREF(*args2);
    }
    if (*kwds2) {
        Py_XDECREF(*kwds2);
    }
    return -1;
}

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed, char *name) {
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if ((none_allowed && obj == Py_None) || PyObject_TypeCheck(obj, type))
        return 1;
    PyErr_Format(PyExc_TypeError,
        "Argument '%s' has incorrect type (expected %s, got %s)",
        name, type->tp_name, obj->ob_type->tp_name);
    return 0;
}

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list) {
    PyObject *__import__ = 0;
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    __import__ = PyObject_GetAttrString(__pyx_b, "__import__");
    if (!__import__)
        goto bad;
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    module = PyObject_CallFunction(__import__, "OOOO",
        name, global_dict, empty_dict, list);
bad:
    Py_XDECREF(empty_list);
    Py_XDECREF(__import__);
    Py_XDECREF(empty_dict);
    return module;
}

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name) {
    PyObject *result;
    result = PyObject_GetAttr(dict, name);
    if (!result)
        PyErr_SetObject(PyExc_NameError, name);
    return result;
}

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb) {
    Py_XINCREF(type);
    Py_XINCREF(value);
    Py_XINCREF(tb);
    /* First, check the traceback argument, replacing None with NULL. */
    if (tb == Py_None) {
        Py_DECREF(tb);
        tb = 0;
    }
    else if (tb != NULL && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto raise_error;
    }
    /* Next, replace a missing value with None */
    if (value == NULL) {
        value = Py_None;
        Py_INCREF(value);
    }
    /* Next, repeatedly, replace a tuple exception with its first item */
    while (PyTuple_Check(type) && PyTuple_Size(type) > 0) {
        PyObject *tmp = type;
        type = PyTuple_GET_ITEM(type, 0);
        Py_INCREF(type);
        Py_DECREF(tmp);
    }
    if (PyString_Check(type)) {
        if (PyErr_Warn(PyExc_DeprecationWarning,
                "raising a string exception is deprecated"))
            goto raise_error;
    }
    else if (PyType_Check(type) || PyClass_Check(type))
        ; /*PyErr_NormalizeException(&type, &value, &tb);*/
    else {
        /* Raising an instance.  The value should be a dummy. */
        if (value != Py_None) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        /* Normalize to raise <class>, <instance> */
        Py_DECREF(value);
        value = type;
        if (PyInstance_Check(type))
            type = (PyObject*) ((PyInstanceObject*)type)->in_class;
        else
            type = (PyObject*) type->ob_type;
        Py_INCREF(type);
    }
    PyErr_Restore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}

static PyObject *__Pyx_GetStdout(void) {
    PyObject *f = PySys_GetObject("stdout");
    if (!f) {
        PyErr_SetString(PyExc_RuntimeError, "lost sys.stdout");
    }
    return f;
}

static int __Pyx_PrintItem(PyObject *v) {
    PyObject *f;
    
    if (!(f = __Pyx_GetStdout()))
        return -1;
    if (PyFile_SoftSpace(f, 1)) {
        if (PyFile_WriteString(" ", f) < 0)
            return -1;
    }
    if (PyFile_WriteObject(v, f, Py_PRINT_RAW) < 0)
        return -1;
    if (PyString_Check(v)) {
        char *s = PyString_AsString(v);
        int len = PyString_Size(v);
        if (len > 0 &&
            isspace(Py_CHARMASK(s[len-1])) &&
            s[len-1] != ' ')
                PyFile_SoftSpace(f, 0);
    }
    return 0;
}

static int __Pyx_PrintNewline(void) {
    PyObject *f;
    
    if (!(f = __Pyx_GetStdout()))
        return -1;
    if (PyFile_WriteString("\n", f) < 0)
        return -1;
    PyFile_SoftSpace(f, 0);
    return 0;
}

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (obj == Py_None || PyObject_TypeCheck(obj, type))
        return 1;
    PyErr_Format(PyExc_TypeError, "Cannot convert %s to %s",
        obj->ob_type->tp_name, type->tp_name);
    return 0;
}

static void __Pyx_UnpackError(void) {
    PyErr_SetString(PyExc_ValueError, "unpack sequence of wrong size");
}

static PyObject *__Pyx_UnpackItem(PyObject *iter) {
    PyObject *item;
    if (!(item = PyIter_Next(iter))) {
        if (!PyErr_Occurred())
            __Pyx_UnpackError();
    }
    return item;
}

static int __Pyx_EndUnpack(PyObject *iter) {
    PyObject *item;
    if ((item = PyIter_Next(iter))) {
        Py_DECREF(item);
        __Pyx_UnpackError();
        return -1;
    }
    else if (!PyErr_Occurred())
        return 0;
    else
        return -1;
}

static int __Pyx_InternStrings(__Pyx_InternTabEntry *t) {
    while (t->p) {
        *t->p = PyString_InternFromString(t->s);
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static PyTypeObject *__Pyx_ImportType(char *module_name, char *class_name, 
    long size) 
{
    PyObject *py_module_name = 0;
    PyObject *py_class_name = 0;
    PyObject *py_name_list = 0;
    PyObject *py_module = 0;
    PyObject *result = 0;
    
    py_module_name = PyString_FromString(module_name);
    if (!py_module_name)
        goto bad;
    py_class_name = PyString_FromString(class_name);
    if (!py_class_name)
        goto bad;
    py_name_list = PyList_New(1);
    if (!py_name_list)
        goto bad;
    Py_INCREF(py_class_name);
    if (PyList_SetItem(py_name_list, 0, py_class_name) < 0)
        goto bad;
    py_module = __Pyx_Import(py_module_name, py_name_list);
    if (!py_module)
        goto bad;
    result = PyObject_GetAttr(py_module, py_class_name);
    if (!result)
        goto bad;
    if (!PyType_Check(result)) {
        PyErr_Format(PyExc_TypeError, 
            "%s.%s is not a type object",
            module_name, class_name);
        goto bad;
    }
    if (((PyTypeObject *)result)->tp_basicsize != size) {
        PyErr_Format(PyExc_ValueError, 
            "%s.%s does not appear to be the correct type object",
            module_name, class_name);
        goto bad;
    }
    goto done;
bad:
    Py_XDECREF(result);
    result = 0;
done:
    Py_XDECREF(py_module_name);
    Py_XDECREF(py_class_name);
    Py_XDECREF(py_name_list);
    return (PyTypeObject *)result;
}

static int __Pyx_GetVtable(PyObject *dict, void *vtabptr) {
    int result;
    PyObject *pycobj;
    
    pycobj = PyMapping_GetItemString(dict, "__pyx_vtable__");
    if (!pycobj)
        goto bad;
    *(void **)vtabptr = PyCObject_AsVoidPtr(pycobj);
    if (!*(void **)vtabptr)
        goto bad;
    result = 0;
    goto done;

bad:
    result = -1;
done:
    Py_XDECREF(pycobj);
    return result;
}

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"

static void __Pyx_AddTraceback(char *funcname) {
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    PyObject *py_globals = 0;
    PyObject *empty_tuple = 0;
    PyObject *empty_string = 0;
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;
    
    py_srcfile = PyString_FromString(__pyx_filename);
    if (!py_srcfile) goto bad;
    py_funcname = PyString_FromString(funcname);
    if (!py_funcname) goto bad;
    py_globals = PyModule_GetDict(__pyx_m);
    if (!py_globals) goto bad;
    empty_tuple = PyTuple_New(0);
    if (!empty_tuple) goto bad;
    empty_string = PyString_FromString("");
    if (!empty_string) goto bad;
    py_code = PyCode_New(
        0,            /*int argcount,*/
        0,            /*int nlocals,*/
        0,            /*int stacksize,*/
        0,            /*int flags,*/
        empty_string, /*PyObject *code,*/
        empty_tuple,  /*PyObject *consts,*/
        empty_tuple,  /*PyObject *names,*/
        empty_tuple,  /*PyObject *varnames,*/
        empty_tuple,  /*PyObject *freevars,*/
        empty_tuple,  /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        __pyx_lineno,   /*int firstlineno,*/
        empty_string  /*PyObject *lnotab*/
    );
    if (!py_code) goto bad;
    py_frame = PyFrame_New(
        PyThreadState_Get(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        py_globals,          /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = __pyx_lineno;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    Py_XDECREF(empty_tuple);
    Py_XDECREF(empty_string);
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}
