/* Generated by Cython 0.10.3 on Wed Feb 25 00:08:02 2009 */

#define PY_SSIZE_T_CLEAN
#include "Python.h"
#include "structmember.h"
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifndef DL_EXPORT
  #define DL_EXPORT(t) t
#endif
#if PY_VERSION_HEX < 0x02040000
  #define METH_COEXIST 0
#endif
#if PY_VERSION_HEX < 0x02050000
  typedef int Py_ssize_t;
  #define PY_SSIZE_T_MAX INT_MAX
  #define PY_SSIZE_T_MIN INT_MIN
  #define PyInt_FromSsize_t(z) PyInt_FromLong(z)
  #define PyInt_AsSsize_t(o)   PyInt_AsLong(o)
  #define PyNumber_Index(o)    PyNumber_Int(o)
  #define PyIndex_Check(o)     PyNumber_Check(o)
#endif
#if PY_VERSION_HEX < 0x02060000
  #define Py_REFCNT(ob) (((PyObject*)(ob))->ob_refcnt)
  #define Py_TYPE(ob)   (((PyObject*)(ob))->ob_type)
  #define Py_SIZE(ob)   (((PyVarObject*)(ob))->ob_size)
  #define PyVarObject_HEAD_INIT(type, size) \
          PyObject_HEAD_INIT(type) size,
  #define PyType_Modified(t)

  typedef struct {
       void *buf;
       PyObject *obj;
       Py_ssize_t len;
       Py_ssize_t itemsize;
       int readonly;
       int ndim;
       char *format;
       Py_ssize_t *shape;
       Py_ssize_t *strides;
       Py_ssize_t *suboffsets;
       void *internal;
  } Py_buffer;

  #define PyBUF_SIMPLE 0
  #define PyBUF_WRITABLE 0x0001
  #define PyBUF_LOCK 0x0002
  #define PyBUF_FORMAT 0x0004
  #define PyBUF_ND 0x0008
  #define PyBUF_STRIDES (0x0010 | PyBUF_ND)
  #define PyBUF_C_CONTIGUOUS (0x0020 | PyBUF_STRIDES)
  #define PyBUF_F_CONTIGUOUS (0x0040 | PyBUF_STRIDES)
  #define PyBUF_ANY_CONTIGUOUS (0x0080 | PyBUF_STRIDES)
  #define PyBUF_INDIRECT (0x0100 | PyBUF_STRIDES)

#endif
#if PY_MAJOR_VERSION < 3
  #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
#else
  #define __Pyx_BUILTIN_MODULE_NAME "builtins"
#endif
#if PY_MAJOR_VERSION >= 3
  #define Py_TPFLAGS_CHECKTYPES 0
  #define Py_TPFLAGS_HAVE_INDEX 0
#endif
#if (PY_VERSION_HEX < 0x02060000) || (PY_MAJOR_VERSION >= 3)
  #define Py_TPFLAGS_HAVE_NEWBUFFER 0
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBaseString_Type            PyUnicode_Type
  #define PyString_Type                PyBytes_Type
  #define PyInt_Type                   PyLong_Type
  #define PyInt_Check(op)              PyLong_Check(op)
  #define PyInt_CheckExact(op)         PyLong_CheckExact(op)
  #define PyInt_FromString             PyLong_FromString
  #define PyInt_FromUnicode            PyLong_FromUnicode
  #define PyInt_FromLong               PyLong_FromLong
  #define PyInt_FromSize_t             PyLong_FromSize_t
  #define PyInt_FromSsize_t            PyLong_FromSsize_t
  #define PyInt_AsLong                 PyLong_AsLong
  #define PyInt_AS_LONG                PyLong_AS_LONG
  #define PyInt_AsSsize_t              PyLong_AsSsize_t
  #define PyInt_AsUnsignedLongMask     PyLong_AsUnsignedLongMask
  #define PyInt_AsUnsignedLongLongMask PyLong_AsUnsignedLongLongMask
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
#else
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_Divide(x,y)
  #define PyBytes_Type                 PyString_Type
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyMethod_New(func, self, klass) PyInstanceMethod_New(func)
#endif
#if !defined(WIN32) && !defined(MS_WINDOWS)
  #ifndef __stdcall
    #define __stdcall
  #endif
  #ifndef __cdecl
    #define __cdecl
  #endif
#else
  #define _USE_MATH_DEFINES
#endif
#ifdef __cplusplus
#define __PYX_EXTERN_C extern "C"
#else
#define __PYX_EXTERN_C extern
#endif
#include <math.h>
#define __PYX_HAVE_API__realtime_image_analysis
#include "unistd.h"
#include "eigen.h"
#include "motmot_ria_macros.h"
#include "c_time_time.h"
#include "stdlib.h"
#include "math.h"
#include "ads_wrap_system.h"
#include "stdio.h"
#include "fi_fw.h"
#include "fic.h"
#include "c_fit_params.h"


#ifdef __GNUC__
#define INLINE __inline__
#elif _WIN32
#define INLINE __inline
#else
#define INLINE 
#endif

typedef struct {PyObject **p; char *s; long n; char is_unicode; char intern; char is_identifier;} __Pyx_StringTabEntry; /*proto*/



static int __pyx_skip_dispatch = 0;


/* Type Conversion Predeclarations */

#if PY_MAJOR_VERSION < 3
#define __Pyx_PyBytes_FromString PyString_FromString
#define __Pyx_PyBytes_AsString   PyString_AsString
#else
#define __Pyx_PyBytes_FromString PyBytes_FromString
#define __Pyx_PyBytes_AsString   PyBytes_AsString
#endif

#define __Pyx_PyBool_FromLong(b) ((b) ? (Py_INCREF(Py_True), Py_True) : (Py_INCREF(Py_False), Py_False))
static INLINE int __Pyx_PyObject_IsTrue(PyObject* x);
static INLINE PY_LONG_LONG __pyx_PyInt_AsLongLong(PyObject* x);
static INLINE unsigned PY_LONG_LONG __pyx_PyInt_AsUnsignedLongLong(PyObject* x);
static INLINE Py_ssize_t __pyx_PyIndex_AsSsize_t(PyObject* b);

#define __pyx_PyInt_AsLong(x) (PyInt_CheckExact(x) ? PyInt_AS_LONG(x) : PyInt_AsLong(x))
#define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))

static INLINE unsigned char __pyx_PyInt_unsigned_char(PyObject* x);
static INLINE unsigned short __pyx_PyInt_unsigned_short(PyObject* x);
static INLINE char __pyx_PyInt_char(PyObject* x);
static INLINE short __pyx_PyInt_short(PyObject* x);
static INLINE int __pyx_PyInt_int(PyObject* x);
static INLINE long __pyx_PyInt_long(PyObject* x);
static INLINE signed char __pyx_PyInt_signed_char(PyObject* x);
static INLINE signed short __pyx_PyInt_signed_short(PyObject* x);
static INLINE signed int __pyx_PyInt_signed_int(PyObject* x);
static INLINE signed long __pyx_PyInt_signed_long(PyObject* x);
static INLINE long double __pyx_PyInt_long_double(PyObject* x);
#ifdef __GNUC__
/* Test for GCC > 2.95 */
#if __GNUC__ > 2 ||               (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)) 
#define likely(x)   __builtin_expect(!!(x), 1)
#define unlikely(x) __builtin_expect(!!(x), 0)
#else /* __GNUC__ > 2 ... */
#define likely(x)   (x)
#define unlikely(x) (x)
#endif /* __GNUC__ > 2 ... */
#else /* __GNUC__ */
#define likely(x)   (x)
#define unlikely(x) (x)
#endif /* __GNUC__ */
    
static PyObject *__pyx_m;
static PyObject *__pyx_b;
static PyObject *__pyx_empty_tuple;
static int __pyx_lineno;
static int __pyx_clineno = 0;
static const char * __pyx_cfilenm= __FILE__;
static const char *__pyx_filename;
static const char **__pyx_f;

static INLINE int __Pyx_CheckKeywordStrings(PyObject *kwdict,
    const char* function_name, int kw_allowed); /*proto*/

static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name, PyObject* kw_name); /*proto*/

static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found); /*proto*/

static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],     PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,     const char* function_name); /*proto*/

static INLINE void __Pyx_ErrRestore(PyObject *type, PyObject *value, PyObject *tb); /*proto*/
static INLINE void __Pyx_ErrFetch(PyObject **type, PyObject **value, PyObject **tb); /*proto*/

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
    const char *name, int exact); /*proto*/

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list); /*proto*/

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/

static PyObject *__Pyx_CreateClass(PyObject *bases, PyObject *dict, PyObject *name, char *modname); /*proto*/

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb); /*proto*/

static int __Pyx_Print(PyObject *, int); /*proto*/
#if PY_MAJOR_VERSION >= 3
static PyObject* __pyx_print = 0;
static PyObject* __pyx_print_kwargs = 0;
#endif

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type); /*proto*/

static INLINE PyObject* __Pyx_PyObject_Append(PyObject* L, PyObject* x) {
    if (likely(PyList_CheckExact(L))) {
        if (PyList_Append(L, x) < 0) return NULL;
        Py_INCREF(Py_None);
        return Py_None; // this is just to have an accurate signature
    }
    else {
        return PyObject_CallMethod(L, "append", "(O)", x);
    }
}

static PyObject *__Pyx_UnpackItem(PyObject *, Py_ssize_t index); /*proto*/
static int __Pyx_EndUnpack(PyObject *); /*proto*/

static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name, long size);  /*proto*/

static PyObject *__Pyx_ImportModule(const char *name); /*proto*/

static int __Pyx_GetVtable(PyObject *dict, void *vtabptr); /*proto*/

static void __Pyx_AddTraceback(const char *funcname); /*proto*/

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t); /*proto*/

/* Type declarations */

typedef void *__pyx_t_6motmot_9FastImage_9FastImage_fiptr;

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":76
 *     pass
 * 
 * cdef class FitParamsClass:             # <<<<<<<<<<<<<<
 *     cdef fit_params.cFitParamsMomentState_64f *pState
 *     def __cinit__(self,*args,**kw):
 */

struct __pyx_obj_23realtime_image_analysis_FitParamsClass {
  PyObject_HEAD
  cFitParamsMomentState_64f *pState;
};

/* "/home/astraw/src/motmot/realtime_image_analysis/src/motmot.FastImage.FastImage.pxd":47
 * # normal symbols (e.g. +=).
 * 
 * cdef class LazyOp:             # <<<<<<<<<<<<<<
 *     pass
 * 
 */

struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp {
  PyObject_HEAD
};

/* "/home/astraw/src/motmot/realtime_image_analysis/src/motmot.FastImage.FastImage.pxd":53
 *     cdef FastImageBase base
 * 
 * cdef class sqrt(LazyOp):             # <<<<<<<<<<<<<<
 *     cdef FastImageBase base
 * 
 */

struct __pyx_obj_6motmot_9FastImage_9FastImage_sqrt {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *base;
};

/* "/home/astraw/src/motmot/realtime_image_analysis/src/motmot.FastImage.FastImage.pxd":12
 *     cdef fw.FwiSize sz
 * 
 * cdef class Point:             # <<<<<<<<<<<<<<
 *     cdef fw.FwiPoint pt
 * 
 */

struct __pyx_obj_6motmot_9FastImage_9FastImage_Point {
  PyObject_HEAD
  FwiPoint pt;
};

/* "/home/astraw/src/motmot/realtime_image_analysis/src/motmot.FastImage.FastImage.pxd":50
 *     pass
 * 
 * cdef class square(LazyOp):             # <<<<<<<<<<<<<<
 *     cdef FastImageBase base
 * 
 */

struct __pyx_obj_6motmot_9FastImage_9FastImage_square {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *base;
};

/* "/home/astraw/src/motmot/realtime_image_analysis/src/motmot.FastImage.FastImage.pxd":15
 *     cdef fw.FwiPoint pt
 * 
 * cdef class FastImageBase:             # <<<<<<<<<<<<<<
 *     cdef fiptr im
 *     cdef c_python.Py_intptr_t shape[2] # don't use, purely for making __array_struct__ without extra malloc
 */

struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase {
  PyObject_HEAD
  struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase *__pyx_vtab;
  __pyx_t_6motmot_9FastImage_9FastImage_fiptr im;
  Py_intptr_t shape[2];
  Py_intptr_t strides[2];
  int step;
  int view;
  PyObject *basetype;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *imsiz;
  PyObject *source_data;
};

/* "/home/astraw/src/motmot/realtime_image_analysis/src/motmot.FastImage.FastImage.pxd":29
 * cdef class FastImage32f(FastImageBase) # forward definition
 * 
 * cdef class FastImage8u(FastImageBase):             # <<<<<<<<<<<<<<
 *     cdef void fast_get_absdiff_put(self, FastImage8u other, FastImage8u result, Size size)
 *     cdef void fast_get_sub_put(self, FastImage8u other, FastImage8u result, Size size)
 */

struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
};

/* "/home/astraw/src/motmot/realtime_image_analysis/src/motmot.FastImage.FastImage.pxd":9
 * ctypedef void* fiptr # pointer to FastImage base type
 * 
 * cdef class Size:             # <<<<<<<<<<<<<<
 *     cdef fw.FwiSize sz
 * 
 */

struct __pyx_obj_6motmot_9FastImage_9FastImage_Size {
  PyObject_HEAD
  FwiSize sz;
};

/* "/home/astraw/src/motmot/realtime_image_analysis/src/motmot.FastImage.FastImage.pxd":62
 *     cdef float alpha
 * 
 * cdef class convert_to_8u(LazyOp):             # <<<<<<<<<<<<<<
 *     cdef FastImage32f orig32f
 * 
 */

struct __pyx_obj_6motmot_9FastImage_9FastImage_convert_to_8u {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *orig32f;
};

/* "/home/astraw/src/motmot/realtime_image_analysis/src/motmot.FastImage.FastImage.pxd":27
 *     cdef FastImageBase c_roi( self, int left, int bottom, Size size)
 * 
 * cdef class FastImage32f(FastImageBase) # forward definition             # <<<<<<<<<<<<<<
 * 
 * cdef class FastImage8u(FastImageBase):
 */

struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
};

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":130
 *     return fpc.fit(im)
 * 
 * cdef class RealtimeAnalyzer:             # <<<<<<<<<<<<<<
 * 
 *     # full image size
 */

struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer {
  PyObject_HEAD
  int maxwidth;
  int maxheight;
  int _left;
  int _bottom;
  int _right;
  int _top;
  int _roi2_radius;
  Fw8u _diff_threshold;
  float _clear_threshold;
  Fw8u _despeckle_threshold;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *_roi_sz;
  int n_rot_samples;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *absdiff_im;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmpdiff_im;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *absdiff_im_roi_view;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmpdiff_im_roi_view;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *absdiff_im_roi2_view;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmpdiff_im_roi2_view;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *mask_im;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *mean_im;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmp_im;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *mean_im_roi_view;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmp_im_roi_view;
  cFitParamsMomentState_64f *pState;
  PyObject *imname2im;
  int max_num_points;
};

/* "/home/astraw/src/motmot/realtime_image_analysis/src/motmot.FastImage.FastImage.pxd":65
 *     cdef FastImage32f orig32f
 * 
 * cdef class convert_to_32f(LazyOp):             # <<<<<<<<<<<<<<
 *     cdef FastImage8u orig8u
 * 
 */

struct __pyx_obj_6motmot_9FastImage_9FastImage_convert_to_32f {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *orig8u;
};

/* "/home/astraw/src/motmot/realtime_image_analysis/src/motmot.FastImage.FastImage.pxd":58
 * # for use with %= ############
 * 
 * cdef class blend_with(LazyOp):             # <<<<<<<<<<<<<<
 *     cdef FastImage8u other8u
 *     cdef float alpha
 */

struct __pyx_obj_6motmot_9FastImage_9FastImage_blend_with {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *other8u;
  float alpha;
};


/* "/home/astraw/src/motmot/realtime_image_analysis/src/motmot.FastImage.FastImage.pxd":15
 *     cdef fw.FwiPoint pt
 * 
 * cdef class FastImageBase:             # <<<<<<<<<<<<<<
 *     cdef fiptr im
 *     cdef c_python.Py_intptr_t shape[2] # don't use, purely for making __array_struct__ without extra malloc
 */

struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *(*c_roi)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *, int, int, struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
};
static struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase *__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImageBase;


/* "/home/astraw/src/motmot/realtime_image_analysis/src/motmot.FastImage.FastImage.pxd":29
 * cdef class FastImage32f(FastImageBase) # forward definition
 * 
 * cdef class FastImage8u(FastImageBase):             # <<<<<<<<<<<<<<
 *     cdef void fast_get_absdiff_put(self, FastImage8u other, FastImage8u result, Size size)
 *     cdef void fast_get_sub_put(self, FastImage8u other, FastImage8u result, Size size)
 */

struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage8u {
  struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
  void (*fast_get_absdiff_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *, struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *, struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *, struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_get_sub_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *, struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *, struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *, struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_set_val_masked)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *, Fw8u, struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *, struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_get_32f_copy_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *, struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *, struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_get_compare_int_put_greater)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *, int, struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *, struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
};
static struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage8u;


/* "/home/astraw/src/motmot/realtime_image_analysis/src/motmot.FastImage.FastImage.pxd":27
 *     cdef FastImageBase c_roi( self, int left, int bottom, Size size)
 * 
 * cdef class FastImage32f(FastImageBase) # forward definition             # <<<<<<<<<<<<<<
 * 
 * cdef class FastImage8u(FastImageBase):
 */

struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage32f {
  struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
  void (*fast_toself_add_weighted_8u)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *, struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *, struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *, float);
  void (*fast_toself_add_weighted_32f)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *, struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *, struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *, float);
  void (*fast_get_8u_copy_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *, struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *, struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_toself_square)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *, struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_get_square_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *, struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *, struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_get_subtracted_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *, struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *, struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *, struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_toself_multiply)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *, float, struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
};
static struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage32f;
/* Module declarations from c_lib */

/* Module declarations from c_python */

/* Module declarations from fw */

/* Module declarations from fic */

/* Module declarations from motmot.FastImage.FastImage */

static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_Size = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_Point = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_FastImageBase = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_LazyOp = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_square = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_sqrt = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_blend_with = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_8u = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_32f = 0;
/* Module declarations from fit_params */

/* Module declarations from realtime_image_analysis */

static PyTypeObject *__pyx_ptype_23realtime_image_analysis_FitParamsClass = 0;
static PyTypeObject *__pyx_ptype_23realtime_image_analysis_RealtimeAnalyzer = 0;
static double __pyx_v_23realtime_image_analysis_nan;
static void __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(FwStatus); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_print_8u_arr(Fw8u *, int, int, int); /*proto*/


/* Implementation of realtime_image_analysis */
static char __pyx_k_11[] = "*";
static PyObject *__pyx_int_0;
static PyObject *__pyx_int_21;
static PyObject *__pyx_int_1;
static PyObject *__pyx_int_200;
static PyObject *__pyx_int_25;
static char __pyx_k___cinit__[] = "__cinit__";
static PyObject *__pyx_kp___cinit__;
static char __pyx_k___dealloc__[] = "__dealloc__";
static PyObject *__pyx_kp___dealloc__;
static char __pyx_k_fit[] = "fit";
static PyObject *__pyx_kp_fit;
static char __pyx_k___init__[] = "__init__";
static PyObject *__pyx_kp___init__;
static char __pyx_k_distort[] = "distort";
static PyObject *__pyx_kp_distort;
static char __pyx_k_do_work[] = "do_work";
static PyObject *__pyx_kp_do_work;
static char __pyx_k_get_image_view[] = "get_image_view";
static PyObject *__pyx_kp_get_image_view;
static char __pyx_k_im[] = "im";
static PyObject *__pyx_kp_im;
static char __pyx_k_lbrt[] = "lbrt";
static PyObject *__pyx_kp_lbrt;
static char __pyx_k_maxwidth[] = "maxwidth";
static PyObject *__pyx_kp_maxwidth;
static char __pyx_k_maxheight[] = "maxheight";
static PyObject *__pyx_kp_maxheight;
static char __pyx_k_max_num_points[] = "max_num_points";
static PyObject *__pyx_kp_max_num_points;
static char __pyx_k_1[] = "roi2_radius";
static PyObject *__pyx_kp_1;
static char __pyx_k_x0[] = "x0";
static PyObject *__pyx_kp_x0;
static char __pyx_k_y0[] = "y0";
static PyObject *__pyx_kp_y0;
static char __pyx_k_raw_im_small[] = "raw_im_small";
static PyObject *__pyx_kp_raw_im_small;
static char __pyx_k_timestamp[] = "timestamp";
static PyObject *__pyx_kp_timestamp;
static char __pyx_k_framenumber[] = "framenumber";
static PyObject *__pyx_kp_framenumber;
static char __pyx_k_2[] = "use_roi2";
static PyObject *__pyx_kp_2;
static char __pyx_k_use_cmp[] = "use_cmp";
static PyObject *__pyx_kp_use_cmp;
static char __pyx_k_max_duration_sec[] = "max_duration_sec";
static PyObject *__pyx_kp_max_duration_sec;
static char __pyx_k_return_debug_values[] = "return_debug_values";
static PyObject *__pyx_kp_return_debug_values;
static char __pyx_k_which[] = "which";
static PyObject *__pyx_kp_which;
static char __pyx_k_value[] = "value";
static PyObject *__pyx_kp_value;
static char __pyx_k_running_mean_im[] = "running_mean_im";
static PyObject *__pyx_kp_running_mean_im;
static char __pyx_k_3[] = "fastframef32_tmp";
static PyObject *__pyx_kp_3;
static char __pyx_k_running_sumsqf[] = "running_sumsqf";
static PyObject *__pyx_kp_running_sumsqf;
static char __pyx_k_4[] = "mean2";
static PyObject *__pyx_kp_4;
static char __pyx_k_running_stdframe[] = "running_stdframe";
static PyObject *__pyx_kp_running_stdframe;
static char __pyx_k_5[] = "running_mean8u_im";
static PyObject *__pyx_kp_5;
static char __pyx_k_hw_roi_frame[] = "hw_roi_frame";
static PyObject *__pyx_kp_hw_roi_frame;
static char __pyx_k_noisy_pixels_mask[] = "noisy_pixels_mask";
static PyObject *__pyx_kp_noisy_pixels_mask;
static char __pyx_k_6[] = "compareframe8u";
static PyObject *__pyx_kp_6;
static char __pyx_k_max_frame_size[] = "max_frame_size";
static PyObject *__pyx_kp_max_frame_size;
static char __pyx_k_ALPHA[] = "ALPHA";
static PyObject *__pyx_kp_ALPHA;
static char __pyx_k_C[] = "C";
static PyObject *__pyx_kp_C;
static char __pyx_k_7[] = "std2";
static PyObject *__pyx_kp_7;
static char __pyx_k_n_sigma[] = "n_sigma";
static PyObject *__pyx_kp_n_sigma;
static char __pyx_k_8[] = "bright_non_gaussian_cutoff";
static PyObject *__pyx_kp_8;
static char __pyx_k_9[] = "bright_non_gaussian_replacement";
static PyObject *__pyx_kp_9;
static char __pyx_k_bench[] = "bench";
static PyObject *__pyx_kp_bench;
static char __pyx_k_time[] = "time";
static PyObject *__pyx_kp_time;
static char __pyx_k_numpy[] = "numpy";
static PyObject *__pyx_kp_numpy;
static char __pyx_k_nx[] = "nx";
static PyObject *__pyx_kp_nx;
static char __pyx_k_warnings[] = "warnings";
static PyObject *__pyx_kp_warnings;
static char __pyx_k_10[] = "motmot.FastImage.FastImage";
static PyObject *__pyx_kp_10;
static char __pyx_k_FastImage[] = "FastImage";
static PyObject *__pyx_kp_FastImage;
static char __pyx_k_nan[] = "nan";
static PyObject *__pyx_kp_nan;
static char __pyx_k_FitParamsError[] = "FitParamsError";
static PyObject *__pyx_kp_FitParamsError;
static char __pyx_k_Exception[] = "Exception";
static PyObject *__pyx_kp_Exception;
static char __pyx_k_12[] = "mean";
static PyObject *__pyx_kp_12;
static char __pyx_k_FwError[] = "FwError";
static PyObject *__pyx_kp_FwError;
static char __pyx_k_set_val[] = "set_val";
static PyObject *__pyx_kp_set_val;
static char __pyx_k_15[] = "absdiff";
static PyObject *__pyx_kp_15;
static char __pyx_k_16[] = "mean";
static PyObject *__pyx_kp_16;
static char __pyx_k_17[] = "mask";
static PyObject *__pyx_kp_17;
static char __pyx_k_18[] = "cmp";
static PyObject *__pyx_kp_18;
static char __pyx_k_19[] = "cmpdiff";
static PyObject *__pyx_kp_19;
static char __pyx_k_roi[] = "roi";
static PyObject *__pyx_kp_roi;
static char __pyx_k__helper[] = "_helper";
static PyObject *__pyx_kp__helper;
static char __pyx_k_ValueError[] = "ValueError";
static PyObject *__pyx_kp_ValueError;
static char __pyx_k_warn[] = "warn";
static PyObject *__pyx_kp_warn;
static char __pyx_k_stacklevel[] = "stacklevel";
static PyObject *__pyx_kp_stacklevel;
static char __pyx_k_append[] = "append";
static PyObject *__pyx_kp_append;
static char __pyx_k__scale_factor[] = "_scale_factor";
static PyObject *__pyx_kp__scale_factor;
static char __pyx_k_toself_add_weighted[] = "toself_add_weighted";
static PyObject *__pyx_kp_toself_add_weighted;
static char __pyx_k_28[] = "get_8u_copy_put";
static PyObject *__pyx_kp_28;
static char __pyx_k_29[] = "get_32f_copy_put";
static PyObject *__pyx_kp_29;
static char __pyx_k_toself_square[] = "toself_square";
static PyObject *__pyx_kp_toself_square;
static char __pyx_k_get_square_put[] = "get_square_put";
static PyObject *__pyx_kp_get_square_put;
static char __pyx_k_get_subtracted_put[] = "get_subtracted_put";
static PyObject *__pyx_kp_get_subtracted_put;
static char __pyx_k_toself_multiply[] = "toself_multiply";
static PyObject *__pyx_kp_toself_multiply;
static char __pyx_k_get_compare_put[] = "get_compare_put";
static PyObject *__pyx_kp_get_compare_put;
static char __pyx_k_CmpGreater[] = "CmpGreater";
static PyObject *__pyx_kp_CmpGreater;
static char __pyx_k_set_val_masked[] = "set_val_masked";
static PyObject *__pyx_kp_set_val_masked;
static PyObject *__pyx_kp_11;
static PyObject *__pyx_builtin_Exception;
static PyObject *__pyx_builtin_ValueError;
static PyObject *__pyx_kp_13;
static char __pyx_k_13[] = "%d";
static PyObject *__pyx_kp_14;
static char __pyx_k_14[] = "fit_params error %d";
static PyObject *__pyx_kp_20;
static PyObject *__pyx_kp_21;
static char __pyx_k_20[] = "input image size (%s) does not correspond to ROI (%s)(set RealtimeAnalyzer.roi before calling)";
static char __pyx_k_21[] = "stopped looking for points (this frame only) because it was taking longer than max_duration_sec";
static PyObject *__pyx_kp_22;
static char __pyx_k_22[] = "setting scale_factor to";
static PyObject *__pyx_kp_23;
static PyObject *__pyx_kp_24;
static PyObject *__pyx_kp_25;
static PyObject *__pyx_kp_26;
static char __pyx_k_23[] = "attempting to set ROI left %d";
static char __pyx_k_24[] = "attempting to set ROI bottom %d";
static char __pyx_k_25[] = "attempting to set ROI right to %d (width %d)";
static char __pyx_k_26[] = "attempting to set ROI top to %d (height %d)";
static PyObject *__pyx_kp_27;
static char __pyx_k_27[] = "unknown result (%d)";

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":52
 *     double time_time()
 * 
 * cdef void CHK_HAVEGIL( fw.FwStatus errval ) except *:             # <<<<<<<<<<<<<<
 *     if (errval != fw.fwStsNoErr):
 *         raise FastImage.FwError(errval)
 */

static  void __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(FwStatus __pyx_v_errval) {
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":53
 * 
 * cdef void CHK_HAVEGIL( fw.FwStatus errval ) except *:
 *     if (errval != fw.fwStsNoErr):             # <<<<<<<<<<<<<<
 *         raise FastImage.FwError(errval)
 * 
 */
  __pyx_1 = (__pyx_v_errval != fwStsNoErr);
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":54
 * cdef void CHK_HAVEGIL( fw.FwStatus errval ) except *:
 *     if (errval != fw.fwStsNoErr):
 *         raise FastImage.FwError(errval)             # <<<<<<<<<<<<<<
 * 
 * ##cdef void SET_ERR( int errval ):
 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_kp_FastImage); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_3 = PyObject_GetAttr(__pyx_2, __pyx_kp_FwError); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_2 = PyInt_FromLong(__pyx_v_errval); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_4 = PyTuple_New(1); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
    __pyx_2 = 0;
    __pyx_2 = PyObject_Call(__pyx_3, ((PyObject *)__pyx_4), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(((PyObject *)__pyx_4)); __pyx_4 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 54; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("realtime_image_analysis.CHK_HAVEGIL");
  __pyx_L0:;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":63
 * ##    c_lib.exit(2)
 * 
 * cdef print_8u_arr(fw.Fw8u* src,int width,int height,int src_step):             # <<<<<<<<<<<<<<
 *   cdef int row, col
 *   cdef fw.Fw8u* src_rowstart
 */

static  PyObject *__pyx_f_23realtime_image_analysis_print_8u_arr(Fw8u *__pyx_v_src, int __pyx_v_width, int __pyx_v_height, int __pyx_v_src_step) {
  int __pyx_v_row;
  int __pyx_v_col;
  Fw8u *__pyx_v_src_rowstart;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_t_1 = NULL;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":66
 *   cdef int row, col
 *   cdef fw.Fw8u* src_rowstart
 *   for row from 0 <= row < height:             # <<<<<<<<<<<<<<
 *     src_rowstart = src+(row*src_step);
 *     for col from 0 <= col < width:
 */
  for (__pyx_v_row = 0; __pyx_v_row < __pyx_v_height; __pyx_v_row++) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":67
 *   cdef fw.Fw8u* src_rowstart
 *   for row from 0 <= row < height:
 *     src_rowstart = src+(row*src_step);             # <<<<<<<<<<<<<<
 *     for col from 0 <= col < width:
 *       print "%d"%src_rowstart[col],
 */
    __pyx_v_src_rowstart = (__pyx_v_src + (__pyx_v_row * __pyx_v_src_step));

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":68
 *   for row from 0 <= row < height:
 *     src_rowstart = src+(row*src_step);
 *     for col from 0 <= col < width:             # <<<<<<<<<<<<<<
 *       print "%d"%src_rowstart[col],
 *     print
 */
    for (__pyx_v_col = 0; __pyx_v_col < __pyx_v_width; __pyx_v_col++) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":69
 *     src_rowstart = src+(row*src_step);
 *     for col from 0 <= col < width:
 *       print "%d"%src_rowstart[col],             # <<<<<<<<<<<<<<
 *     print
 *   print
 */
      __pyx_1 = PyInt_FromLong((__pyx_v_src_rowstart[__pyx_v_col])); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_t_1 = PyNumber_Remainder(__pyx_kp_13, __pyx_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_1 = PyTuple_New(1); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      PyTuple_SET_ITEM(__pyx_1, 0, __pyx_t_1);
      __pyx_t_1 = 0;
      if (__Pyx_Print(((PyObject *)__pyx_1), 0) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 69; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      Py_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
    }

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":70
 *     for col from 0 <= col < width:
 *       print "%d"%src_rowstart[col],
 *     print             # <<<<<<<<<<<<<<
 *   print
 * 
 */
    if (__Pyx_Print(((PyObject *)__pyx_empty_tuple), 1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  }

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":71
 *       print "%d"%src_rowstart[col],
 *     print
 *   print             # <<<<<<<<<<<<<<
 * 
 * class FitParamsError(Exception):
 */
  if (__Pyx_Print(((PyObject *)__pyx_empty_tuple), 1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.print_8u_arr");
  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":78
 * cdef class FitParamsClass:
 *     cdef fit_params.cFitParamsMomentState_64f *pState
 *     def __cinit__(self,*args,**kw):             # <<<<<<<<<<<<<<
 *         # image moment calculation initialization
 *         CHK_HAVEGIL( fit_params.cFitParamsMomentInitAlloc_64f( &self.pState))
 */

static int __pyx_pf_23realtime_image_analysis_14FitParamsClass___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_23realtime_image_analysis_14FitParamsClass___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kw = 0;
  int __pyx_r;
  if (unlikely(__pyx_kwds) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__cinit__", 1))) return -1;
  __pyx_v_kw = (__pyx_kwds) ? PyDict_Copy(__pyx_kwds) : PyDict_New();
  if (unlikely(!__pyx_v_kw)) return -1;
  Py_INCREF(__pyx_args);
  __pyx_v_args = __pyx_args;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":80
 *     def __cinit__(self,*args,**kw):
 *         # image moment calculation initialization
 *         CHK_HAVEGIL( fit_params.cFitParamsMomentInitAlloc_64f( &self.pState))             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(cFitParamsMomentInitAlloc_64f((&((struct __pyx_obj_23realtime_image_analysis_FitParamsClass *)__pyx_v_self)->pState))); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 80; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("realtime_image_analysis.FitParamsClass.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_args);
  Py_DECREF(__pyx_v_kw);
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":82
 *         CHK_HAVEGIL( fit_params.cFitParamsMomentInitAlloc_64f( &self.pState))
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         CHK_HAVEGIL( fit_params.cFitParamsMomentFree_64f( self.pState ))
 * 
 */

static void __pyx_pf_23realtime_image_analysis_14FitParamsClass___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pf_23realtime_image_analysis_14FitParamsClass___dealloc__(PyObject *__pyx_v_self) {

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":83
 * 
 *     def __dealloc__(self):
 *         CHK_HAVEGIL( fit_params.cFitParamsMomentFree_64f( self.pState ))             # <<<<<<<<<<<<<<
 * 
 *     def fit(self,FastImage.FastImage8u im):
 */
  __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(cFitParamsMomentFree_64f(((struct __pyx_obj_23realtime_image_analysis_FitParamsClass *)__pyx_v_self)->pState)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 83; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("realtime_image_analysis.FitParamsClass.__dealloc__");
  __pyx_L0:;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":85
 *         CHK_HAVEGIL( fit_params.cFitParamsMomentFree_64f( self.pState ))
 * 
 *     def fit(self,FastImage.FastImage8u im):             # <<<<<<<<<<<<<<
 *         cdef double x0, y0
 *         cdef double Mu00, Uu11, Uu02, Uu20
 */

static PyObject *__pyx_pf_23realtime_image_analysis_14FitParamsClass_fit(PyObject *__pyx_v_self, PyObject *__pyx_v_im); /*proto*/
static PyObject *__pyx_pf_23realtime_image_analysis_14FitParamsClass_fit(PyObject *__pyx_v_self, PyObject *__pyx_v_im) {
  double __pyx_v_x0;
  double __pyx_v_y0;
  double __pyx_v_Mu00;
  double __pyx_v_Uu11;
  double __pyx_v_Uu02;
  double __pyx_v_Uu20;
  int __pyx_v_result;
  int __pyx_v_eigen_err;
  double __pyx_v_area;
  double __pyx_v_rise;
  double __pyx_v_run;
  double __pyx_v_slope;
  double __pyx_v_eccentricity;
  double __pyx_v_evalA;
  double __pyx_v_evalB;
  double __pyx_v_evecA1;
  double __pyx_v_evecB1;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  int __pyx_5;
  PyObject *__pyx_6 = 0;
  PyObject *__pyx_7 = 0;
  PyObject *__pyx_8 = 0;
  PyObject *__pyx_t_1 = NULL;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "im", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 85; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":99
 *                                         im.imsiz.sz.width, im.imsiz.sz.height,
 *                                         <unsigned char*>im.im,
 *                                         im.step)             # <<<<<<<<<<<<<<
 *         if result != fit_params.CFitParamsNoError:
 *             raise FitParamsError('fit_params error %d'%result)
 */
  __pyx_v_result = fit_params(((struct __pyx_obj_23realtime_image_analysis_FitParamsClass *)__pyx_v_self)->pState, (&__pyx_v_x0), (&__pyx_v_y0), (&__pyx_v_Mu00), (&__pyx_v_Uu11), (&__pyx_v_Uu20), (&__pyx_v_Uu02), ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_v_im)->__pyx_base.imsiz->sz.width, ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_v_im)->__pyx_base.imsiz->sz.height, ((unsigned char *)((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_v_im)->__pyx_base.im), ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_v_im)->__pyx_base.step);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":100
 *                                         <unsigned char*>im.im,
 *                                         im.step)
 *         if result != fit_params.CFitParamsNoError:             # <<<<<<<<<<<<<<
 *             raise FitParamsError('fit_params error %d'%result)
 * 
 */
  __pyx_1 = (__pyx_v_result != CFitParamsNoError);
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":101
 *                                         im.step)
 *         if result != fit_params.CFitParamsNoError:
 *             raise FitParamsError('fit_params error %d'%result)             # <<<<<<<<<<<<<<
 * 
 *         # See note at top of file about determining orientation from
 */
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_kp_FitParamsError); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_3 = PyInt_FromLong(__pyx_v_result); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = PyNumber_Remainder(__pyx_kp_14, __pyx_3); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    __pyx_3 = PyTuple_New(1); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    PyTuple_SET_ITEM(__pyx_3, 0, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_4 = PyObject_Call(__pyx_2, ((PyObject *)__pyx_3), NULL); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(((PyObject *)__pyx_3)); __pyx_3 = 0;
    __Pyx_Raise(__pyx_4, 0, 0);
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":106
 *         # pixel covariance.
 * 
 *         area = Mu00             # <<<<<<<<<<<<<<
 *         eigen_err = eigen_2x2_real( Uu20, Uu11,
 *                                     Uu11, Uu02,
 */
  __pyx_v_area = __pyx_v_Mu00;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":110
 *                                     Uu11, Uu02,
 *                                     &evalA, &evecA1,
 *                                     &evalB, &evecB1)             # <<<<<<<<<<<<<<
 *         if eigen_err:
 *             slope = nan
 */
  __pyx_v_eigen_err = eigen_2x2_real(__pyx_v_Uu20, __pyx_v_Uu11, __pyx_v_Uu11, __pyx_v_Uu02, (&__pyx_v_evalA), (&__pyx_v_evecA1), (&__pyx_v_evalB), (&__pyx_v_evecB1));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":111
 *                                     &evalA, &evecA1,
 *                                     &evalB, &evecB1)
 *         if eigen_err:             # <<<<<<<<<<<<<<
 *             slope = nan
 *             eccentricity = 0.0
 */
  __pyx_5 = __pyx_v_eigen_err;
  if (__pyx_5) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":112
 *                                     &evalB, &evecB1)
 *         if eigen_err:
 *             slope = nan             # <<<<<<<<<<<<<<
 *             eccentricity = 0.0
 *         else:
 */
    __pyx_v_slope = __pyx_v_23realtime_image_analysis_nan;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":113
 *         if eigen_err:
 *             slope = nan
 *             eccentricity = 0.0             # <<<<<<<<<<<<<<
 *         else:
 *             rise = 1.0 # 2nd component of eigenvectors will always be 1.0
 */
    __pyx_v_eccentricity = 0.0;
    goto __pyx_L6;
  }
  /*else*/ {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":115
 *             eccentricity = 0.0
 *         else:
 *             rise = 1.0 # 2nd component of eigenvectors will always be 1.0             # <<<<<<<<<<<<<<
 *             if evalA > evalB:
 *                 run = evecA1
 */
    __pyx_v_rise = 1.0;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":116
 *         else:
 *             rise = 1.0 # 2nd component of eigenvectors will always be 1.0
 *             if evalA > evalB:             # <<<<<<<<<<<<<<
 *                 run = evecA1
 *                 eccentricity = evalA/evalB
 */
    __pyx_1 = (__pyx_v_evalA > __pyx_v_evalB);
    if (__pyx_1) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":117
 *             rise = 1.0 # 2nd component of eigenvectors will always be 1.0
 *             if evalA > evalB:
 *                 run = evecA1             # <<<<<<<<<<<<<<
 *                 eccentricity = evalA/evalB
 *             else:
 */
      __pyx_v_run = __pyx_v_evecA1;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":118
 *             if evalA > evalB:
 *                 run = evecA1
 *                 eccentricity = evalA/evalB             # <<<<<<<<<<<<<<
 *             else:
 *                 run = evecB1
 */
      __pyx_v_eccentricity = (__pyx_v_evalA / __pyx_v_evalB);
      goto __pyx_L7;
    }
    /*else*/ {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":120
 *                 eccentricity = evalA/evalB
 *             else:
 *                 run = evecB1             # <<<<<<<<<<<<<<
 *                 eccentricity = evalB/evalA
 *             slope = rise/run
 */
      __pyx_v_run = __pyx_v_evecB1;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":121
 *             else:
 *                 run = evecB1
 *                 eccentricity = evalB/evalA             # <<<<<<<<<<<<<<
 *             slope = rise/run
 * 
 */
      __pyx_v_eccentricity = (__pyx_v_evalB / __pyx_v_evalA);
    }
    __pyx_L7:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":122
 *                 run = evecB1
 *                 eccentricity = evalB/evalA
 *             slope = rise/run             # <<<<<<<<<<<<<<
 * 
 *         return (x0, y0, area, slope, eccentricity)
 */
    __pyx_v_slope = (__pyx_v_rise / __pyx_v_run);
  }
  __pyx_L6:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":124
 *             slope = rise/run
 * 
 *         return (x0, y0, area, slope, eccentricity)             # <<<<<<<<<<<<<<
 * 
 * def py_fit_params(FastImage.FastImage8u im):
 */
  __pyx_2 = PyFloat_FromDouble(__pyx_v_x0); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_3 = PyFloat_FromDouble(__pyx_v_y0); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_4 = PyFloat_FromDouble(__pyx_v_area); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_6 = PyFloat_FromDouble(__pyx_v_slope); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_7 = PyFloat_FromDouble(__pyx_v_eccentricity); if (unlikely(!__pyx_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_8 = PyTuple_New(5); if (unlikely(!__pyx_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  PyTuple_SET_ITEM(__pyx_8, 0, __pyx_2);
  PyTuple_SET_ITEM(__pyx_8, 1, __pyx_3);
  PyTuple_SET_ITEM(__pyx_8, 2, __pyx_4);
  PyTuple_SET_ITEM(__pyx_8, 3, __pyx_6);
  PyTuple_SET_ITEM(__pyx_8, 4, __pyx_7);
  __pyx_2 = 0;
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_6 = 0;
  __pyx_7 = 0;
  __pyx_r = ((PyObject *)__pyx_8);
  __pyx_8 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_6);
  Py_XDECREF(__pyx_7);
  Py_XDECREF(__pyx_8);
  __Pyx_AddTraceback("realtime_image_analysis.FitParamsClass.fit");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":126
 *         return (x0, y0, area, slope, eccentricity)
 * 
 * def py_fit_params(FastImage.FastImage8u im):             # <<<<<<<<<<<<<<
 *     cdef FitParamsClass fpc = FitParamsClass()
 *     return fpc.fit(im)
 */

static PyObject *__pyx_pf_23realtime_image_analysis_py_fit_params(PyObject *__pyx_self, PyObject *__pyx_v_im); /*proto*/
static PyObject *__pyx_pf_23realtime_image_analysis_py_fit_params(PyObject *__pyx_self, PyObject *__pyx_v_im) {
  struct __pyx_obj_23realtime_image_analysis_FitParamsClass *__pyx_v_fpc = 0;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  __pyx_self = __pyx_self;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "im", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 126; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":127
 * 
 * def py_fit_params(FastImage.FastImage8u im):
 *     cdef FitParamsClass fpc = FitParamsClass()             # <<<<<<<<<<<<<<
 *     return fpc.fit(im)
 * 
 */
  __pyx_1 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_23realtime_image_analysis_FitParamsClass)), ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (!(__Pyx_TypeTest(__pyx_1, __pyx_ptype_23realtime_image_analysis_FitParamsClass))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_v_fpc = ((struct __pyx_obj_23realtime_image_analysis_FitParamsClass *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":128
 * def py_fit_params(FastImage.FastImage8u im):
 *     cdef FitParamsClass fpc = FitParamsClass()
 *     return fpc.fit(im)             # <<<<<<<<<<<<<<
 * 
 * cdef class RealtimeAnalyzer:
 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_fpc), __pyx_kp_fit); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyTuple_New(1); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_v_im);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_im);
  __pyx_3 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_2), NULL); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
  __pyx_r = __pyx_3;
  __pyx_3 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("realtime_image_analysis.py_fit_params");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_XDECREF(__pyx_v_fpc);
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":179
 *     cdef int max_num_points
 * 
 *     def __cinit__(self,*args,**kw):             # <<<<<<<<<<<<<<
 *         # image moment calculation initialization
 *         CHK_HAVEGIL( fit_params.cFitParamsMomentInitAlloc_64f( &self.pState ))
 */

static int __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer___cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kw = 0;
  int __pyx_r;
  if (unlikely(__pyx_kwds) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "__cinit__", 1))) return -1;
  __pyx_v_kw = (__pyx_kwds) ? PyDict_Copy(__pyx_kwds) : PyDict_New();
  if (unlikely(!__pyx_v_kw)) return -1;
  Py_INCREF(__pyx_args);
  __pyx_v_args = __pyx_args;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":181
 *     def __cinit__(self,*args,**kw):
 *         # image moment calculation initialization
 *         CHK_HAVEGIL( fit_params.cFitParamsMomentInitAlloc_64f( &self.pState ))             # <<<<<<<<<<<<<<
 * 
 *     def __dealloc__(self):
 */
  __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(cFitParamsMomentInitAlloc_64f((&((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->pState))); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_args);
  Py_DECREF(__pyx_v_kw);
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":183
 *         CHK_HAVEGIL( fit_params.cFitParamsMomentInitAlloc_64f( &self.pState ))
 * 
 *     def __dealloc__(self):             # <<<<<<<<<<<<<<
 *         CHK_HAVEGIL( fit_params.cFitParamsMomentFree_64f( self.pState ))
 * 
 */

static void __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer___dealloc__(PyObject *__pyx_v_self) {

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":184
 * 
 *     def __dealloc__(self):
 *         CHK_HAVEGIL( fit_params.cFitParamsMomentFree_64f( self.pState ))             # <<<<<<<<<<<<<<
 * 
 *     def __init__(self,object lbrt,int maxwidth, int maxheight, int max_num_points, int roi2_radius):
 */
  __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(cFitParamsMomentFree_64f(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->pState)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 184; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.__dealloc__");
  __pyx_L0:;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":186
 *         CHK_HAVEGIL( fit_params.cFitParamsMomentFree_64f( self.pState ))
 * 
 *     def __init__(self,object lbrt,int maxwidth, int maxheight, int max_num_points, int roi2_radius):             # <<<<<<<<<<<<<<
 *         # software analysis ROI
 *         self.maxwidth = maxwidth
 */

static int __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_lbrt = 0;
  int __pyx_v_maxwidth;
  int __pyx_v_maxheight;
  int __pyx_v_max_num_points;
  int __pyx_v_roi2_radius;
  PyObject *__pyx_v_sz;
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_lbrt,&__pyx_kp_maxwidth,&__pyx_kp_maxheight,&__pyx_kp_max_num_points,&__pyx_kp_1,0};
  if (unlikely(__pyx_kwds)) {
    PyObject* values[5] = {0,0,0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_lbrt);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_maxwidth);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__init__", 1, 5, 5, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_maxheight);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__init__", 1, 5, 5, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_max_num_points);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__init__", 1, 5, 5, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  4:
      values[4] = PyDict_GetItem(__pyx_kwds, __pyx_kp_1);
      if (likely(values[4])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("__init__", 1, 5, 5, 4); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "__init__") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_lbrt = values[0];
    __pyx_v_maxwidth = __pyx_PyInt_int(values[1]); if (unlikely((__pyx_v_maxwidth == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_maxheight = __pyx_PyInt_int(values[2]); if (unlikely((__pyx_v_maxheight == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_max_num_points = __pyx_PyInt_int(values[3]); if (unlikely((__pyx_v_max_num_points == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_roi2_radius = __pyx_PyInt_int(values[4]); if (unlikely((__pyx_v_roi2_radius == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_lbrt = PyTuple_GET_ITEM(__pyx_args, 0);
    __pyx_v_maxwidth = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely((__pyx_v_maxwidth == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_maxheight = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_maxheight == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_max_num_points = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_max_num_points == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_roi2_radius = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_roi2_radius == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("__init__", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 186; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.__init__");
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_sz = Py_None; Py_INCREF(Py_None);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":188
 *     def __init__(self,object lbrt,int maxwidth, int maxheight, int max_num_points, int roi2_radius):
 *         # software analysis ROI
 *         self.maxwidth = maxwidth             # <<<<<<<<<<<<<<
 *         self.maxheight = maxheight
 * 
 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxwidth = __pyx_v_maxwidth;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":189
 *         # software analysis ROI
 *         self.maxwidth = maxwidth
 *         self.maxheight = maxheight             # <<<<<<<<<<<<<<
 * 
 *         self.max_num_points = max_num_points
 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxheight = __pyx_v_maxheight;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":191
 *         self.maxheight = maxheight
 * 
 *         self.max_num_points = max_num_points             # <<<<<<<<<<<<<<
 *         #print 'realtime analysis with %d points maximum starting'%self.max_num_points
 * 
 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->max_num_points = __pyx_v_max_num_points;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":194
 *         #print 'realtime analysis with %d points maximum starting'%self.max_num_points
 * 
 *         self._roi2_radius = roi2_radius             # <<<<<<<<<<<<<<
 *         self._diff_threshold = 11
 *         self._clear_threshold = 0.2
 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius = __pyx_v_roi2_radius;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":195
 * 
 *         self._roi2_radius = roi2_radius
 *         self._diff_threshold = 11             # <<<<<<<<<<<<<<
 *         self._clear_threshold = 0.2
 * 
 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold = 11;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":196
 *         self._roi2_radius = roi2_radius
 *         self._diff_threshold = 11
 *         self._clear_threshold = 0.2             # <<<<<<<<<<<<<<
 * 
 *         self._despeckle_threshold = 5
 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold = 0.2;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":198
 *         self._clear_threshold = 0.2
 * 
 *         self._despeckle_threshold = 5             # <<<<<<<<<<<<<<
 *         self.n_rot_samples = 100*60 # 1 minute
 * 
 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_despeckle_threshold = 5;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":199
 * 
 *         self._despeckle_threshold = 5
 *         self.n_rot_samples = 100*60 # 1 minute             # <<<<<<<<<<<<<<
 * 
 *         sz = FastImage.Size(self.maxwidth,self.maxheight)
 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->n_rot_samples = (100 * 60);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":201
 *         self.n_rot_samples = 100*60 # 1 minute
 * 
 *         sz = FastImage.Size(self.maxwidth,self.maxheight)             # <<<<<<<<<<<<<<
 *         # 8u images
 *         self.absdiff_im=FastImage.FastImage8u(sz)
 */
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxwidth); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxheight); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_3 = PyTuple_New(2); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_3, 1, __pyx_2);
  __pyx_1 = 0;
  __pyx_2 = 0;
  __pyx_1 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_Size)), ((PyObject *)__pyx_3), NULL); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 201; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)__pyx_3)); __pyx_3 = 0;
  Py_DECREF(__pyx_v_sz);
  __pyx_v_sz = __pyx_1;
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":203
 *         sz = FastImage.Size(self.maxwidth,self.maxheight)
 *         # 8u images
 *         self.absdiff_im=FastImage.FastImage8u(sz)             # <<<<<<<<<<<<<<
 * 
 *         # 8u background
 */
  __pyx_2 = PyTuple_New(1); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_sz);
  __pyx_3 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)), ((PyObject *)__pyx_2), NULL); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
  if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 203; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":206
 * 
 *         # 8u background
 *         self.mask_im=FastImage.FastImage8u(sz)             # <<<<<<<<<<<<<<
 *         self.mask_im.set_val(0,sz)
 * 
 */
  __pyx_1 = PyTuple_New(1); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_sz);
  __pyx_2 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)), ((PyObject *)__pyx_1), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
  if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 206; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":207
 *         # 8u background
 *         self.mask_im=FastImage.FastImage8u(sz)
 *         self.mask_im.set_val(0,sz)             # <<<<<<<<<<<<<<
 * 
 *         self.mean_im=FastImage.FastImage8u(sz)
 */
  __pyx_3 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im), __pyx_kp_set_val); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_1 = PyTuple_New(2); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_int_0);
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_v_sz);
  __pyx_2 = PyObject_Call(__pyx_3, ((PyObject *)__pyx_1), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 207; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":209
 *         self.mask_im.set_val(0,sz)
 * 
 *         self.mean_im=FastImage.FastImage8u(sz)             # <<<<<<<<<<<<<<
 *         self.cmp_im=FastImage.FastImage8u(sz)
 *         self.cmp_im.set_val(0,sz)
 */
  __pyx_3 = PyTuple_New(1); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_sz);
  __pyx_1 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)), ((PyObject *)__pyx_3), NULL); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)__pyx_3)); __pyx_3 = 0;
  if (!(__Pyx_TypeTest(__pyx_1, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 209; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":210
 * 
 *         self.mean_im=FastImage.FastImage8u(sz)
 *         self.cmp_im=FastImage.FastImage8u(sz)             # <<<<<<<<<<<<<<
 *         self.cmp_im.set_val(0,sz)
 * 
 */
  __pyx_2 = PyTuple_New(1); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_sz);
  __pyx_3 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)), ((PyObject *)__pyx_2), NULL); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
  if (!(__Pyx_TypeTest(__pyx_3, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 210; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":211
 *         self.mean_im=FastImage.FastImage8u(sz)
 *         self.cmp_im=FastImage.FastImage8u(sz)
 *         self.cmp_im.set_val(0,sz)             # <<<<<<<<<<<<<<
 * 
 *         self.cmpdiff_im=FastImage.FastImage8u(sz)
 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im), __pyx_kp_set_val); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyTuple_New(2); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_int_0);
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_v_sz);
  __pyx_3 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_2), NULL); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 211; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":213
 *         self.cmp_im.set_val(0,sz)
 * 
 *         self.cmpdiff_im=FastImage.FastImage8u(sz)             # <<<<<<<<<<<<<<
 * 
 *         # create and update self.imname2im dict
 */
  __pyx_1 = PyTuple_New(1); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_sz);
  __pyx_2 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)), ((PyObject *)__pyx_1), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
  if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 213; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":216
 * 
 *         # create and update self.imname2im dict
 *         self.imname2im = {'absdiff' :self.absdiff_im,             # <<<<<<<<<<<<<<
 *                           'mean'    :self.mean_im,
 *                           'mask'    :self.mask_im,
 */
  __pyx_3 = PyDict_New(); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyDict_SetItem(__pyx_3, __pyx_kp_15, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":217
 *         # create and update self.imname2im dict
 *         self.imname2im = {'absdiff' :self.absdiff_im,
 *                           'mean'    :self.mean_im,             # <<<<<<<<<<<<<<
 *                           'mask'    :self.mask_im,
 *                           'cmp'     :self.cmp_im,
 */
  if (PyDict_SetItem(__pyx_3, __pyx_kp_16, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":218
 *         self.imname2im = {'absdiff' :self.absdiff_im,
 *                           'mean'    :self.mean_im,
 *                           'mask'    :self.mask_im,             # <<<<<<<<<<<<<<
 *                           'cmp'     :self.cmp_im,
 *                           'cmpdiff' :self.cmpdiff_im,
 */
  if (PyDict_SetItem(__pyx_3, __pyx_kp_17, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":219
 *                           'mean'    :self.mean_im,
 *                           'mask'    :self.mask_im,
 *                           'cmp'     :self.cmp_im,             # <<<<<<<<<<<<<<
 *                           'cmpdiff' :self.cmpdiff_im,
 *                           }
 */
  if (PyDict_SetItem(__pyx_3, __pyx_kp_18, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":220
 *                           'mask'    :self.mask_im,
 *                           'cmp'     :self.cmp_im,
 *                           'cmpdiff' :self.cmpdiff_im,             # <<<<<<<<<<<<<<
 *                           }
 * 
 */
  if (PyDict_SetItem(__pyx_3, __pyx_kp_19, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 216; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":216
 * 
 *         # create and update self.imname2im dict
 *         self.imname2im = {'absdiff' :self.absdiff_im,             # <<<<<<<<<<<<<<
 *                           'mean'    :self.mean_im,
 *                           'mask'    :self.mask_im,
 */
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->imname2im);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->imname2im = ((PyObject *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":223
 *                           }
 * 
 *         self.roi = lbrt             # <<<<<<<<<<<<<<
 * 
 *         # initialize background images
 */
  if (PyObject_SetAttr(__pyx_v_self, __pyx_kp_roi, __pyx_v_lbrt) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 223; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":226
 * 
 *         # initialize background images
 *         self.mean_im_roi_view.set_val( 0, self._roi_sz )             # <<<<<<<<<<<<<<
 * 
 *     def distort( self, float x0, float y0 ):
 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view), __pyx_kp_set_val); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyTuple_New(2); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_int_0);
  Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  __pyx_3 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_2), NULL); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 226; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_sz);
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":228
 *         self.mean_im_roi_view.set_val( 0, self._roi_sz )
 * 
 *     def distort( self, float x0, float y0 ):             # <<<<<<<<<<<<<<
 *         if self._helper is None:
 *             return x0, y0
 */

static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_distort(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_distort(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  float __pyx_v_x0;
  float __pyx_v_y0;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  int __pyx_2;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_x0,&__pyx_kp_y0,0};
  if (unlikely(__pyx_kwds)) {
    PyObject* values[2] = {0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_x0);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_y0);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("distort", 1, 2, 2, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "distort") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_x0 = __pyx_PyFloat_AsDouble(values[0]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_y0 = __pyx_PyFloat_AsDouble(values[1]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_x0 = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 0)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_y0 = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("distort", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.distort");
  return NULL;
  __pyx_L4_argument_unpacking_done:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":229
 * 
 *     def distort( self, float x0, float y0 ):
 *         if self._helper is None:             # <<<<<<<<<<<<<<
 *             return x0, y0
 *         return self._helper.distort( x0, y0 )
 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp__helper); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 229; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = (__pyx_1 == Py_None);
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_2) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":230
 *     def distort( self, float x0, float y0 ):
 *         if self._helper is None:
 *             return x0, y0             # <<<<<<<<<<<<<<
 *         return self._helper.distort( x0, y0 )
 * 
 */
    __pyx_1 = PyFloat_FromDouble(__pyx_v_x0); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_3 = PyFloat_FromDouble(__pyx_v_y0); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_4 = PyTuple_New(2); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 230; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_1);
    PyTuple_SET_ITEM(__pyx_4, 1, __pyx_3);
    __pyx_1 = 0;
    __pyx_3 = 0;
    __pyx_r = ((PyObject *)__pyx_4);
    __pyx_4 = 0;
    goto __pyx_L0;
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":231
 *         if self._helper is None:
 *             return x0, y0
 *         return self._helper.distort( x0, y0 )             # <<<<<<<<<<<<<<
 * 
 *     def do_work(self,
 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp__helper); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_3 = PyObject_GetAttr(__pyx_1, __pyx_kp_distort); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_4 = PyFloat_FromDouble(__pyx_v_x0); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_1 = PyFloat_FromDouble(__pyx_v_y0); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_5 = PyTuple_New(2); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_4);
  PyTuple_SET_ITEM(__pyx_5, 1, __pyx_1);
  __pyx_4 = 0;
  __pyx_1 = 0;
  __pyx_4 = PyObject_Call(__pyx_3, ((PyObject *)__pyx_5), NULL); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 231; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(((PyObject *)__pyx_5)); __pyx_5 = 0;
  __pyx_r = __pyx_4;
  __pyx_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.distort");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":233
 *         return self._helper.distort( x0, y0 )
 * 
 *     def do_work(self,             # <<<<<<<<<<<<<<
 *                 FastImage.FastImage8u raw_im_small,
 *                 double timestamp,
 */

static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_do_work(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_23realtime_image_analysis_16RealtimeAnalyzer_do_work[] = "find location and orientation of local points (fast enough for realtime use)\n\n        inputs\n        ------\n\n        timestamp\n        framenumber\n        use_roi2\n\n        optional inputs (default to 0)\n        ------------------------------\n        use_cmp -- perform more detailed analysis against cmp image (used with ongoing variance estimation)\n\n        outputs\n        -------\n\n        [ (x0_abs, y0_abs, area, slope, eccentricity) ] -- with a tuple for each point found\n\n        ";
static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_do_work(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_raw_im_small = 0;
  double __pyx_v_timestamp;
  int __pyx_v_framenumber;
  int __pyx_v_use_roi2;
  int __pyx_v_use_cmp;
  double __pyx_v_max_duration_sec;
  int __pyx_v_return_debug_values;
  double __pyx_v_x0;
  double __pyx_v_y0;
  double __pyx_v_x0_abs;
  double __pyx_v_y0_abs;
  double __pyx_v_area;
  double __pyx_v_rise;
  double __pyx_v_run;
  double __pyx_v_slope;
  double __pyx_v_eccentricity;
  double __pyx_v_evalA;
  double __pyx_v_evalB;
  double __pyx_v_evecA1;
  double __pyx_v_evecB1;
  double __pyx_v_Mu00;
  double __pyx_v_Uu11;
  double __pyx_v_Uu02;
  double __pyx_v_Uu20;
  int __pyx_v_result;
  int __pyx_v_eigen_err;
  int __pyx_v_index_x;
  int __pyx_v_index_y;
  Fw8u __pyx_v_max_abs_diff;
  Fw8u *__pyx_v_im_loc_ptr;
  Fw8u __pyx_v_max_std_diff;
  Fw8u __pyx_v_clear_despeckle_thresh;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *__pyx_v_roi2_sz;
  int __pyx_v_left2;
  int __pyx_v_right2;
  int __pyx_v_bottom2;
  int __pyx_v_top2;
  int __pyx_v_found_point;
  int __pyx_v_n_found_points;
  double __pyx_v_entry_time;
  double __pyx_v_now;
  FiciSize __pyx_v_fic_sz;
  PyObject *__pyx_v_all_points_found;
  PyObject *__pyx_v_pt_tuple;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  double __pyx_3;
  int __pyx_4;
  int __pyx_5;
  PyObject *__pyx_6 = 0;
  int __pyx_7;
  PyObject *__pyx_8 = 0;
  PyObject *__pyx_9 = 0;
  PyObject *__pyx_10 = 0;
  PyObject *__pyx_11 = 0;
  PyObject *__pyx_12 = 0;
  PyObject *__pyx_t_1 = NULL;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_raw_im_small,&__pyx_kp_timestamp,&__pyx_kp_framenumber,&__pyx_kp_2,&__pyx_kp_use_cmp,&__pyx_kp_max_duration_sec,&__pyx_kp_return_debug_values,0};
  __pyx_v_use_cmp = 0;
  __pyx_v_max_duration_sec = 0.0;
  __pyx_v_return_debug_values = 0;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[7] = {0,0,0,0,0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
      case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_raw_im_small);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_timestamp);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_work", 0, 4, 7, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_framenumber);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_work", 0, 4, 7, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_2);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_work", 0, 4, 7, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "do_work") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_raw_im_small = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)values[0]);
    __pyx_v_timestamp = __pyx_PyFloat_AsDouble(values[1]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_framenumber = __pyx_PyInt_int(values[2]); if (unlikely((__pyx_v_framenumber == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_use_roi2 = __pyx_PyInt_int(values[3]); if (unlikely((__pyx_v_use_roi2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    if (values[4]) {
      __pyx_v_use_cmp = __pyx_PyInt_int(values[4]); if (unlikely((__pyx_v_use_cmp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    if (values[5]) {
      __pyx_v_max_duration_sec = __pyx_PyFloat_AsDouble(values[5]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    if (values[6]) {
      __pyx_v_return_debug_values = __pyx_PyInt_int(values[6]); if (unlikely((__pyx_v_return_debug_values == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
  } else {
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  7:
      __pyx_v_return_debug_values = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 6)); if (unlikely((__pyx_v_return_debug_values == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  6:
      __pyx_v_max_duration_sec = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 5)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  5:
      __pyx_v_use_cmp = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 4)); if (unlikely((__pyx_v_use_cmp == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 238; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case  4:
      __pyx_v_use_roi2 = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely((__pyx_v_use_roi2 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 237; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_framenumber = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 2)); if (unlikely((__pyx_v_framenumber == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_timestamp = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 1)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 235; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_raw_im_small = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)PyTuple_GET_ITEM(__pyx_args, 0));
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("do_work", 0, 4, 7, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 233; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.do_work");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_roi2_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)Py_None); Py_INCREF(Py_None);
  __pyx_v_all_points_found = Py_None; Py_INCREF(Py_None);
  __pyx_v_pt_tuple = Py_None; Py_INCREF(Py_None);
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_raw_im_small), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "raw_im_small", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":290
 *         cdef fic.FiciSize fic_sz
 * 
 *         entry_time = time.time()             # <<<<<<<<<<<<<<
 * 
 *         roi2_sz = FastImage.Size(21,21)
 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_kp_time); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_kp_time); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyObject_Call(__pyx_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_3 = __pyx_PyFloat_AsDouble(__pyx_1); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 290; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_v_entry_time = __pyx_3;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":292
 *         entry_time = time.time()
 * 
 *         roi2_sz = FastImage.Size(21,21)             # <<<<<<<<<<<<<<
 * 
 *         all_points_found = [] # len(all_points_found) == n_found_points
 */
  __pyx_2 = PyTuple_New(2); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_int_21);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_int_21);
  Py_INCREF(__pyx_int_21);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_int_21);
  __pyx_1 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_Size)), ((PyObject *)__pyx_2), NULL); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
  if (!(__Pyx_TypeTest(__pyx_1, __pyx_ptype_6motmot_9FastImage_9FastImage_Size))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 292; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)__pyx_v_roi2_sz));
  __pyx_v_roi2_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":294
 *         roi2_sz = FastImage.Size(21,21)
 * 
 *         all_points_found = [] # len(all_points_found) == n_found_points             # <<<<<<<<<<<<<<
 *         n_found_points = 0
 * 
 */
  __pyx_2 = PyList_New(0); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 294; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_all_points_found);
  __pyx_v_all_points_found = ((PyObject *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":295
 * 
 *         all_points_found = [] # len(all_points_found) == n_found_points
 *         n_found_points = 0             # <<<<<<<<<<<<<<
 * 
 *         # This is our near-hack to ensure users update .roi before calling .do_work()
 */
  __pyx_v_n_found_points = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":298
 * 
 *         # This is our near-hack to ensure users update .roi before calling .do_work()
 *         if not ((self._roi_sz.sz.width == raw_im_small.imsiz.sz.width) and             # <<<<<<<<<<<<<<
 *                 (self._roi_sz.sz.height == raw_im_small.imsiz.sz.height)):
 *             raise ValueError("input image size (%s) does not correspond to ROI (%s)"
 */
  __pyx_4 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.width == __pyx_v_raw_im_small->__pyx_base.imsiz->sz.width);
  if (__pyx_4) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":299
 *         # This is our near-hack to ensure users update .roi before calling .do_work()
 *         if not ((self._roi_sz.sz.width == raw_im_small.imsiz.sz.width) and
 *                 (self._roi_sz.sz.height == raw_im_small.imsiz.sz.height)):             # <<<<<<<<<<<<<<
 *             raise ValueError("input image size (%s) does not correspond to ROI (%s)"
 *                              "(set RealtimeAnalyzer.roi before calling)"%(
 */
    __pyx_4 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.height == __pyx_v_raw_im_small->__pyx_base.imsiz->sz.height);
  }
  __pyx_5 = (!__pyx_4);
  if (__pyx_5) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":302
 *             raise ValueError("input image size (%s) does not correspond to ROI (%s)"
 *                              "(set RealtimeAnalyzer.roi before calling)"%(
 *                 str(raw_im_small.imsiz),str(self._roi_sz)))             # <<<<<<<<<<<<<<
 * 
 *         # find difference from mean
 */
    __pyx_1 = PyTuple_New(1); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_INCREF(((PyObject *)__pyx_v_raw_im_small->__pyx_base.imsiz));
    PyTuple_SET_ITEM(__pyx_1, 0, ((PyObject *)__pyx_v_raw_im_small->__pyx_base.imsiz));
    __pyx_2 = PyObject_Call(((PyObject *)((PyObject*)&PyString_Type)), ((PyObject *)__pyx_1), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
    __pyx_1 = PyTuple_New(1); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
    PyTuple_SET_ITEM(__pyx_1, 0, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
    __pyx_6 = PyObject_Call(((PyObject *)((PyObject*)&PyString_Type)), ((PyObject *)__pyx_1), NULL); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
    __pyx_1 = PyTuple_New(2); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 302; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_2);
    PyTuple_SET_ITEM(__pyx_1, 1, __pyx_6);
    __pyx_2 = 0;
    __pyx_6 = 0;
    __pyx_t_1 = PyNumber_Remainder(__pyx_kp_20, ((PyObject *)__pyx_1)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
    __pyx_2 = PyTuple_New(1); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_6 = PyObject_Call(__pyx_builtin_ValueError, ((PyObject *)__pyx_2), NULL); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
    __Pyx_Raise(__pyx_6, 0, 0);
    Py_DECREF(__pyx_6); __pyx_6 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":305
 * 
 *         # find difference from mean
 *         c_python.Py_BEGIN_ALLOW_THREADS             # <<<<<<<<<<<<<<
 *         # absdiff_im = | raw_im - mean_im |
 *         #raw_im_small.fast_get_absdiff_put( self.mean_im_roi_view,
 */
  Py_BEGIN_ALLOW_THREADS;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":313
 *                                           <fw.Fw8u*>raw_im_small.im,raw_im_small.step,
 *                                           <fw.Fw8u*>self.absdiff_im_roi_view.im,self.absdiff_im_roi_view.step,
 *                                           self._roi_sz.sz))             # <<<<<<<<<<<<<<
 * 
 *         # mask unused part of absdiff_im to 0
 */
  CHK_NOGIL(fwiAbsDiff_8u_C1R(((Fw8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view->__pyx_base.im), ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view->__pyx_base.step, ((Fw8u *)__pyx_v_raw_im_small->__pyx_base.im), __pyx_v_raw_im_small->__pyx_base.step, ((Fw8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im), ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step, ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":321
 * 
 *         CHK_NOGIL( fw.fwiSet_8u_C1MR( 0, <fw.Fw8u*>self.absdiff_im.im, self.absdiff_im.step, self.absdiff_im.imsiz.sz,
 *                                         <fw.Fw8u*>self.mask_im.im, self.mask_im.step))             # <<<<<<<<<<<<<<
 * 
 *         if use_cmp:
 */
  CHK_NOGIL(fwiSet_8u_C1MR(0, ((Fw8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im->__pyx_base.im), ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im->__pyx_base.step, ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im->__pyx_base.imsiz->sz, ((Fw8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im->__pyx_base.im), ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im->__pyx_base.step));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":323
 *                                         <fw.Fw8u*>self.mask_im.im, self.mask_im.step))
 * 
 *         if use_cmp:             # <<<<<<<<<<<<<<
 *             # clip the minimum comparison value to diff_threshold
 *             CHK_NOGIL( fw.fwiThreshold_Val_8u_C1IR(<fw.Fw8u*>self.cmp_im_roi_view.im,
 */
  __pyx_7 = __pyx_v_use_cmp;
  if (__pyx_7) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":328
 *                                                self.cmp_im_roi_view.step,
 *                                                self._roi_sz.sz,
 *                                                self._diff_threshold, self._diff_threshold, fw.fwCmpLess))             # <<<<<<<<<<<<<<
 *         c_python.Py_END_ALLOW_THREADS
 * 
 */
    CHK_NOGIL(fwiThreshold_Val_8u_C1IR(((Fw8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.im), ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.step, ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz, ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold, ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold, fwCmpLess));
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":329
 *                                                self._roi_sz.sz,
 *                                                self._diff_threshold, self._diff_threshold, fw.fwCmpLess))
 *         c_python.Py_END_ALLOW_THREADS             # <<<<<<<<<<<<<<
 * 
 *         while n_found_points < self.max_num_points:
 */
  Py_END_ALLOW_THREADS;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":331
 *         c_python.Py_END_ALLOW_THREADS
 * 
 *         while n_found_points < self.max_num_points:             # <<<<<<<<<<<<<<
 *             if max_duration_sec != 0.0:
 *                 now = time.time()
 */
  while (1) {
    __pyx_4 = (__pyx_v_n_found_points < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->max_num_points);
    if (!__pyx_4) break;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":332
 * 
 *         while n_found_points < self.max_num_points:
 *             if max_duration_sec != 0.0:             # <<<<<<<<<<<<<<
 *                 now = time.time()
 *                 if (now-entry_time) > max_duration_sec:
 */
    __pyx_5 = (__pyx_v_max_duration_sec != 0.0);
    if (__pyx_5) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":333
 *         while n_found_points < self.max_num_points:
 *             if max_duration_sec != 0.0:
 *                 now = time.time()             # <<<<<<<<<<<<<<
 *                 if (now-entry_time) > max_duration_sec:
 *                     warnings.warn('stopped looking for points (this frame only) because it was taking longer than max_duration_sec',
 */
      __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_kp_time); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_kp_time); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_6 = PyObject_Call(__pyx_2, ((PyObject *)__pyx_empty_tuple), NULL); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __pyx_3 = __pyx_PyFloat_AsDouble(__pyx_6); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      Py_DECREF(__pyx_6); __pyx_6 = 0;
      __pyx_v_now = __pyx_3;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":334
 *             if max_duration_sec != 0.0:
 *                 now = time.time()
 *                 if (now-entry_time) > max_duration_sec:             # <<<<<<<<<<<<<<
 *                     warnings.warn('stopped looking for points (this frame only) because it was taking longer than max_duration_sec',
 *                                   stacklevel=1)
 */
      __pyx_4 = ((__pyx_v_now - __pyx_v_entry_time) > __pyx_v_max_duration_sec);
      if (__pyx_4) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":335
 *                 now = time.time()
 *                 if (now-entry_time) > max_duration_sec:
 *                     warnings.warn('stopped looking for points (this frame only) because it was taking longer than max_duration_sec',             # <<<<<<<<<<<<<<
 *                                   stacklevel=1)
 *                     break
 */
        __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_kp_warnings); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_kp_warn); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        Py_DECREF(__pyx_1); __pyx_1 = 0;
        __pyx_6 = PyTuple_New(1); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        Py_INCREF(__pyx_kp_21);
        PyTuple_SET_ITEM(__pyx_6, 0, __pyx_kp_21);
        __pyx_1 = PyDict_New(); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":336
 *                 if (now-entry_time) > max_duration_sec:
 *                     warnings.warn('stopped looking for points (this frame only) because it was taking longer than max_duration_sec',
 *                                   stacklevel=1)             # <<<<<<<<<<<<<<
 *                     break
 *             # release GIL
 */
        if (PyDict_SetItem(__pyx_1, __pyx_kp_stacklevel, __pyx_int_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_8 = PyEval_CallObjectWithKeywords(__pyx_2, ((PyObject *)__pyx_6), ((PyObject *)__pyx_1)); if (unlikely(!__pyx_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        Py_DECREF(((PyObject *)__pyx_6)); __pyx_6 = 0;
        Py_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
        Py_DECREF(__pyx_8); __pyx_8 = 0;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":337
 *                     warnings.warn('stopped looking for points (this frame only) because it was taking longer than max_duration_sec',
 *                                   stacklevel=1)
 *                     break             # <<<<<<<<<<<<<<
 *             # release GIL
 *             c_python.Py_BEGIN_ALLOW_THREADS
 */
        goto __pyx_L9;
        goto __pyx_L11;
      }
      __pyx_L11:;
      goto __pyx_L10;
    }
    __pyx_L10:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":339
 *                     break
 *             # release GIL
 *             c_python.Py_BEGIN_ALLOW_THREADS             # <<<<<<<<<<<<<<
 * 
 *             # WARNING WARNING WARNING WARNING WARNING WARNING WARNING
 */
    Py_BEGIN_ALLOW_THREADS;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":355
 * 
 *             # find max pixel in ROI
 *             if use_cmp:             # <<<<<<<<<<<<<<
 *                 # cmpdiff_im = absdiff_im - cmp_im (saturates 8u)
 *                 #self.absdiff_im_roi_view.fast_get_sub_put( self.cmp_im_roi_view,
 */
    __pyx_7 = __pyx_v_use_cmp;
    if (__pyx_7) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":363
 *                                                  <fw.Fw8u*>self.absdiff_im_roi_view.im, self.absdiff_im_roi_view.step,
 *                                                  <fw.Fw8u*>self.cmpdiff_im_roi_view.im, self.cmpdiff_im_roi_view.step,
 *                                                  self._roi_sz.sz,0))             # <<<<<<<<<<<<<<
 *                 fic_sz.width = self._roi_sz.sz.width;
 *                 fic_sz.height = self._roi_sz.sz.height;
 */
      CHK_NOGIL(fwiSub_8u_C1RSfs(((Fw8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.im), ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.step, ((Fw8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im), ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step, ((Fw8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.im), ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.step, ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz, 0));

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":364
 *                                                  <fw.Fw8u*>self.cmpdiff_im_roi_view.im, self.cmpdiff_im_roi_view.step,
 *                                                  self._roi_sz.sz,0))
 *                 fic_sz.width = self._roi_sz.sz.width;             # <<<<<<<<<<<<<<
 *                 fic_sz.height = self._roi_sz.sz.height;
 *                 CHK_FIC_NOGIL( fic.ficiMaxIndx_8u_C1R(
 */
      __pyx_v_fic_sz.width = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.width;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":365
 *                                                  self._roi_sz.sz,0))
 *                 fic_sz.width = self._roi_sz.sz.width;
 *                 fic_sz.height = self._roi_sz.sz.height;             # <<<<<<<<<<<<<<
 *                 CHK_FIC_NOGIL( fic.ficiMaxIndx_8u_C1R(
 *                     <fic.Fic8u*>self.cmpdiff_im_roi_view.im,self.cmpdiff_im_roi_view.step,
 */
      __pyx_v_fic_sz.height = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.height;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":368
 *                 CHK_FIC_NOGIL( fic.ficiMaxIndx_8u_C1R(
 *                     <fic.Fic8u*>self.cmpdiff_im_roi_view.im,self.cmpdiff_im_roi_view.step,
 *                     fic_sz, &max_std_diff, &index_x, &index_y))             # <<<<<<<<<<<<<<
 * 
 *                 im_loc_ptr = (<fw.Fw8u*>self.absdiff_im_roi_view.im)+self.absdiff_im_roi_view.step*index_y+index_x
 */
      CHK_FIC_NOGIL(ficiMaxIndx_8u_C1R(((Fic8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.im), ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.step, __pyx_v_fic_sz, (&__pyx_v_max_std_diff), (&__pyx_v_index_x), (&__pyx_v_index_y)));

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":370
 *                     fic_sz, &max_std_diff, &index_x, &index_y))
 * 
 *                 im_loc_ptr = (<fw.Fw8u*>self.absdiff_im_roi_view.im)+self.absdiff_im_roi_view.step*index_y+index_x             # <<<<<<<<<<<<<<
 *                 max_abs_diff = im_loc_ptr[0] # value at maximum difference from std
 *             else:
 */
      __pyx_v_im_loc_ptr = ((((Fw8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im) + (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step * __pyx_v_index_y)) + __pyx_v_index_x);

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":371
 * 
 *                 im_loc_ptr = (<fw.Fw8u*>self.absdiff_im_roi_view.im)+self.absdiff_im_roi_view.step*index_y+index_x
 *                 max_abs_diff = im_loc_ptr[0] # value at maximum difference from std             # <<<<<<<<<<<<<<
 *             else:
 *                 max_std_diff=0
 */
      __pyx_v_max_abs_diff = (__pyx_v_im_loc_ptr[0]);
      goto __pyx_L12;
    }
    /*else*/ {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":373
 *                 max_abs_diff = im_loc_ptr[0] # value at maximum difference from std
 *             else:
 *                 max_std_diff=0             # <<<<<<<<<<<<<<
 *                 fic_sz.width = self._roi_sz.sz.width;
 *                 fic_sz.height = self._roi_sz.sz.height;
 */
      __pyx_v_max_std_diff = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":374
 *             else:
 *                 max_std_diff=0
 *                 fic_sz.width = self._roi_sz.sz.width;             # <<<<<<<<<<<<<<
 *                 fic_sz.height = self._roi_sz.sz.height;
 *                 CHK_FIC_NOGIL( fic.ficiMaxIndx_8u_C1R(
 */
      __pyx_v_fic_sz.width = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.width;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":375
 *                 max_std_diff=0
 *                 fic_sz.width = self._roi_sz.sz.width;
 *                 fic_sz.height = self._roi_sz.sz.height;             # <<<<<<<<<<<<<<
 *                 CHK_FIC_NOGIL( fic.ficiMaxIndx_8u_C1R(
 *                     <fic.Fic8u*>self.absdiff_im_roi_view.im,self.absdiff_im_roi_view.step,
 */
      __pyx_v_fic_sz.height = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.height;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":378
 *                 CHK_FIC_NOGIL( fic.ficiMaxIndx_8u_C1R(
 *                     <fic.Fic8u*>self.absdiff_im_roi_view.im,self.absdiff_im_roi_view.step,
 *                     fic_sz, &max_abs_diff, &index_x, &index_y))             # <<<<<<<<<<<<<<
 * 
 *             if use_roi2:
 */
      CHK_FIC_NOGIL(ficiMaxIndx_8u_C1R(((Fic8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im), ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step, __pyx_v_fic_sz, (&__pyx_v_max_abs_diff), (&__pyx_v_index_x), (&__pyx_v_index_y)));
    }
    __pyx_L12:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":380
 *                     fic_sz, &max_abs_diff, &index_x, &index_y))
 * 
 *             if use_roi2:             # <<<<<<<<<<<<<<
 *                 # find mini-ROI for further analysis (defined in non-ROI space)
 *                 left2 = index_x - self._roi2_radius + self._left
 */
    __pyx_7 = __pyx_v_use_roi2;
    if (__pyx_7) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":382
 *             if use_roi2:
 *                 # find mini-ROI for further analysis (defined in non-ROI space)
 *                 left2 = index_x - self._roi2_radius + self._left             # <<<<<<<<<<<<<<
 *                 right2 = index_x + self._roi2_radius + self._left
 *                 bottom2 = index_y - self._roi2_radius + self._bottom
 */
      __pyx_v_left2 = ((__pyx_v_index_x - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":383
 *                 # find mini-ROI for further analysis (defined in non-ROI space)
 *                 left2 = index_x - self._roi2_radius + self._left
 *                 right2 = index_x + self._roi2_radius + self._left             # <<<<<<<<<<<<<<
 *                 bottom2 = index_y - self._roi2_radius + self._bottom
 *                 top2 = index_y + self._roi2_radius + self._bottom
 */
      __pyx_v_right2 = ((__pyx_v_index_x + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":384
 *                 left2 = index_x - self._roi2_radius + self._left
 *                 right2 = index_x + self._roi2_radius + self._left
 *                 bottom2 = index_y - self._roi2_radius + self._bottom             # <<<<<<<<<<<<<<
 *                 top2 = index_y + self._roi2_radius + self._bottom
 * 
 */
      __pyx_v_bottom2 = ((__pyx_v_index_y - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":385
 *                 right2 = index_x + self._roi2_radius + self._left
 *                 bottom2 = index_y - self._roi2_radius + self._bottom
 *                 top2 = index_y + self._roi2_radius + self._bottom             # <<<<<<<<<<<<<<
 * 
 *                 if left2 < self._left: left2 = self._left
 */
      __pyx_v_top2 = ((__pyx_v_index_y + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":387
 *                 top2 = index_y + self._roi2_radius + self._bottom
 * 
 *                 if left2 < self._left: left2 = self._left             # <<<<<<<<<<<<<<
 *                 if right2 > self._right: right2 = self._right
 *                 if bottom2 < self._bottom: bottom2 = self._bottom
 */
      __pyx_5 = (__pyx_v_left2 < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);
      if (__pyx_5) {
        __pyx_v_left2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left;
        goto __pyx_L14;
      }
      __pyx_L14:;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":388
 * 
 *                 if left2 < self._left: left2 = self._left
 *                 if right2 > self._right: right2 = self._right             # <<<<<<<<<<<<<<
 *                 if bottom2 < self._bottom: bottom2 = self._bottom
 *                 if top2 > self._top: top2 = self._top
 */
      __pyx_4 = (__pyx_v_right2 > ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right);
      if (__pyx_4) {
        __pyx_v_right2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right;
        goto __pyx_L15;
      }
      __pyx_L15:;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":389
 *                 if left2 < self._left: left2 = self._left
 *                 if right2 > self._right: right2 = self._right
 *                 if bottom2 < self._bottom: bottom2 = self._bottom             # <<<<<<<<<<<<<<
 *                 if top2 > self._top: top2 = self._top
 *                 roi2_sz.sz.width = right2 - left2 + 1
 */
      __pyx_5 = (__pyx_v_bottom2 < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);
      if (__pyx_5) {
        __pyx_v_bottom2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom;
        goto __pyx_L16;
      }
      __pyx_L16:;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":390
 *                 if right2 > self._right: right2 = self._right
 *                 if bottom2 < self._bottom: bottom2 = self._bottom
 *                 if top2 > self._top: top2 = self._top             # <<<<<<<<<<<<<<
 *                 roi2_sz.sz.width = right2 - left2 + 1
 *                 roi2_sz.sz.height = top2 - bottom2 + 1
 */
      __pyx_4 = (__pyx_v_top2 > ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top);
      if (__pyx_4) {
        __pyx_v_top2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top;
        goto __pyx_L17;
      }
      __pyx_L17:;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":391
 *                 if bottom2 < self._bottom: bottom2 = self._bottom
 *                 if top2 > self._top: top2 = self._top
 *                 roi2_sz.sz.width = right2 - left2 + 1             # <<<<<<<<<<<<<<
 *                 roi2_sz.sz.height = top2 - bottom2 + 1
 *             else:
 */
      __pyx_v_roi2_sz->sz.width = ((__pyx_v_right2 - __pyx_v_left2) + 1);

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":392
 *                 if top2 > self._top: top2 = self._top
 *                 roi2_sz.sz.width = right2 - left2 + 1
 *                 roi2_sz.sz.height = top2 - bottom2 + 1             # <<<<<<<<<<<<<<
 *             else:
 *                 left2 = self._left
 */
      __pyx_v_roi2_sz->sz.height = ((__pyx_v_top2 - __pyx_v_bottom2) + 1);
      goto __pyx_L13;
    }
    /*else*/ {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":394
 *                 roi2_sz.sz.height = top2 - bottom2 + 1
 *             else:
 *                 left2 = self._left             # <<<<<<<<<<<<<<
 *                 right2 = self._right
 *                 bottom2 = self._bottom
 */
      __pyx_v_left2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":395
 *             else:
 *                 left2 = self._left
 *                 right2 = self._right             # <<<<<<<<<<<<<<
 *                 bottom2 = self._bottom
 *                 top2 = self._top
 */
      __pyx_v_right2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":396
 *                 left2 = self._left
 *                 right2 = self._right
 *                 bottom2 = self._bottom             # <<<<<<<<<<<<<<
 *                 top2 = self._top
 *                 roi2_sz.sz.width = self._roi_sz.sz.width
 */
      __pyx_v_bottom2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":397
 *                 right2 = self._right
 *                 bottom2 = self._bottom
 *                 top2 = self._top             # <<<<<<<<<<<<<<
 *                 roi2_sz.sz.width = self._roi_sz.sz.width
 *                 roi2_sz.sz.height = self._roi_sz.sz.height
 */
      __pyx_v_top2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":398
 *                 bottom2 = self._bottom
 *                 top2 = self._top
 *                 roi2_sz.sz.width = self._roi_sz.sz.width             # <<<<<<<<<<<<<<
 *                 roi2_sz.sz.height = self._roi_sz.sz.height
 * 
 */
      __pyx_v_roi2_sz->sz.width = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.width;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":399
 *                 top2 = self._top
 *                 roi2_sz.sz.width = self._roi_sz.sz.width
 *                 roi2_sz.sz.height = self._roi_sz.sz.height             # <<<<<<<<<<<<<<
 * 
 *             c_python.Py_END_ALLOW_THREADS
 */
      __pyx_v_roi2_sz->sz.height = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.height;
    }
    __pyx_L13:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":401
 *                 roi2_sz.sz.height = self._roi_sz.sz.height
 * 
 *             c_python.Py_END_ALLOW_THREADS             # <<<<<<<<<<<<<<
 *             # XXX should figure out how not to release GIL here...
 *             self.absdiff_im_roi2_view = self.absdiff_im.roi(left2,bottom2,roi2_sz)
 */
    Py_END_ALLOW_THREADS;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":403
 *             c_python.Py_END_ALLOW_THREADS
 *             # XXX should figure out how not to release GIL here...
 *             self.absdiff_im_roi2_view = self.absdiff_im.roi(left2,bottom2,roi2_sz)             # <<<<<<<<<<<<<<
 *             if use_cmp:
 *                 self.cmpdiff_im_roi2_view = self.cmpdiff_im.roi(left2,bottom2,roi2_sz)
 */
    __pyx_2 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im), __pyx_kp_roi); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_6 = PyInt_FromLong(__pyx_v_left2); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_1 = PyInt_FromLong(__pyx_v_bottom2); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_8 = PyTuple_New(3); if (unlikely(!__pyx_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    PyTuple_SET_ITEM(__pyx_8, 0, __pyx_6);
    PyTuple_SET_ITEM(__pyx_8, 1, __pyx_1);
    Py_INCREF(((PyObject *)__pyx_v_roi2_sz));
    PyTuple_SET_ITEM(__pyx_8, 2, ((PyObject *)__pyx_v_roi2_sz));
    __pyx_6 = 0;
    __pyx_1 = 0;
    __pyx_6 = PyObject_Call(__pyx_2, ((PyObject *)__pyx_8), NULL); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(((PyObject *)__pyx_8)); __pyx_8 = 0;
    if (!(__Pyx_TypeTest(__pyx_6, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 403; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view));
    ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_6);
    __pyx_6 = 0;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":404
 *             # XXX should figure out how not to release GIL here...
 *             self.absdiff_im_roi2_view = self.absdiff_im.roi(left2,bottom2,roi2_sz)
 *             if use_cmp:             # <<<<<<<<<<<<<<
 *                 self.cmpdiff_im_roi2_view = self.cmpdiff_im.roi(left2,bottom2,roi2_sz)
 *             c_python.Py_BEGIN_ALLOW_THREADS
 */
    __pyx_7 = __pyx_v_use_cmp;
    if (__pyx_7) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":405
 *             self.absdiff_im_roi2_view = self.absdiff_im.roi(left2,bottom2,roi2_sz)
 *             if use_cmp:
 *                 self.cmpdiff_im_roi2_view = self.cmpdiff_im.roi(left2,bottom2,roi2_sz)             # <<<<<<<<<<<<<<
 *             c_python.Py_BEGIN_ALLOW_THREADS
 * 
 */
      __pyx_1 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im), __pyx_kp_roi); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_2 = PyInt_FromLong(__pyx_v_left2); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_8 = PyInt_FromLong(__pyx_v_bottom2); if (unlikely(!__pyx_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_6 = PyTuple_New(3); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      PyTuple_SET_ITEM(__pyx_6, 0, __pyx_2);
      PyTuple_SET_ITEM(__pyx_6, 1, __pyx_8);
      Py_INCREF(((PyObject *)__pyx_v_roi2_sz));
      PyTuple_SET_ITEM(__pyx_6, 2, ((PyObject *)__pyx_v_roi2_sz));
      __pyx_2 = 0;
      __pyx_8 = 0;
      __pyx_2 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_6), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      Py_DECREF(((PyObject *)__pyx_6)); __pyx_6 = 0;
      if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 405; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi2_view));
      ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_2);
      __pyx_2 = 0;
      goto __pyx_L18;
    }
    __pyx_L18:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":406
 *             if use_cmp:
 *                 self.cmpdiff_im_roi2_view = self.cmpdiff_im.roi(left2,bottom2,roi2_sz)
 *             c_python.Py_BEGIN_ALLOW_THREADS             # <<<<<<<<<<<<<<
 * 
 *             # (to reduce moment arm:) if pixel < self._clear_threshold*max(pixel): pixel=0
 */
    Py_BEGIN_ALLOW_THREADS;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":410
 *             # (to reduce moment arm:) if pixel < self._clear_threshold*max(pixel): pixel=0
 * 
 *             clear_despeckle_thresh = <fw.Fw8u>(self._clear_threshold*max_abs_diff)             # <<<<<<<<<<<<<<
 *             if clear_despeckle_thresh < self._despeckle_threshold:
 *                 clear_despeckle_thresh = self._despeckle_threshold
 */
    __pyx_v_clear_despeckle_thresh = ((Fw8u)(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold * __pyx_v_max_abs_diff));

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":411
 * 
 *             clear_despeckle_thresh = <fw.Fw8u>(self._clear_threshold*max_abs_diff)
 *             if clear_despeckle_thresh < self._despeckle_threshold:             # <<<<<<<<<<<<<<
 *                 clear_despeckle_thresh = self._despeckle_threshold
 * 
 */
    __pyx_5 = (__pyx_v_clear_despeckle_thresh < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_despeckle_threshold);
    if (__pyx_5) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":412
 *             clear_despeckle_thresh = <fw.Fw8u>(self._clear_threshold*max_abs_diff)
 *             if clear_despeckle_thresh < self._despeckle_threshold:
 *                 clear_despeckle_thresh = self._despeckle_threshold             # <<<<<<<<<<<<<<
 * 
 *             CHK_NOGIL( fw.fwiThreshold_Val_8u_C1IR(
 */
      __pyx_v_clear_despeckle_thresh = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_despeckle_threshold;
      goto __pyx_L19;
    }
    __pyx_L19:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":416
 *             CHK_NOGIL( fw.fwiThreshold_Val_8u_C1IR(
 *                 <fw.Fw8u*>self.absdiff_im_roi2_view.im,self.absdiff_im_roi2_view.step,
 *                 roi2_sz.sz, clear_despeckle_thresh, 0, fw.fwCmpLess))             # <<<<<<<<<<<<<<
 * 
 *             found_point = 1
 */
    CHK_NOGIL(fwiThreshold_Val_8u_C1IR(((Fw8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.im), ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.step, __pyx_v_roi2_sz->sz, __pyx_v_clear_despeckle_thresh, 0, fwCmpLess));

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":418
 *                 roi2_sz.sz, clear_despeckle_thresh, 0, fw.fwCmpLess))
 * 
 *             found_point = 1             # <<<<<<<<<<<<<<
 * 
 *             if not use_cmp:
 */
    __pyx_v_found_point = 1;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":420
 *             found_point = 1
 * 
 *             if not use_cmp:             # <<<<<<<<<<<<<<
 *                 if max_abs_diff < self._diff_threshold:
 *                     x0=nan
 */
    __pyx_4 = (!__pyx_v_use_cmp);
    if (__pyx_4) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":421
 * 
 *             if not use_cmp:
 *                 if max_abs_diff < self._diff_threshold:             # <<<<<<<<<<<<<<
 *                     x0=nan
 *                     y0=nan
 */
      __pyx_5 = (__pyx_v_max_abs_diff < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold);
      if (__pyx_5) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":422
 *             if not use_cmp:
 *                 if max_abs_diff < self._diff_threshold:
 *                     x0=nan             # <<<<<<<<<<<<<<
 *                     y0=nan
 *                     x0_abs = nan
 */
        __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":423
 *                 if max_abs_diff < self._diff_threshold:
 *                     x0=nan
 *                     y0=nan             # <<<<<<<<<<<<<<
 *                     x0_abs = nan
 *                     y0_abs = nan
 */
        __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":424
 *                     x0=nan
 *                     y0=nan
 *                     x0_abs = nan             # <<<<<<<<<<<<<<
 *                     y0_abs = nan
 *                     found_point = 0 # c int (bool)
 */
        __pyx_v_x0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":425
 *                     y0=nan
 *                     x0_abs = nan
 *                     y0_abs = nan             # <<<<<<<<<<<<<<
 *                     found_point = 0 # c int (bool)
 *                     max_abs_diff = 0
 */
        __pyx_v_y0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":426
 *                     x0_abs = nan
 *                     y0_abs = nan
 *                     found_point = 0 # c int (bool)             # <<<<<<<<<<<<<<
 *                     max_abs_diff = 0
 *             else:
 */
        __pyx_v_found_point = 0;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":427
 *                     y0_abs = nan
 *                     found_point = 0 # c int (bool)
 *                     max_abs_diff = 0             # <<<<<<<<<<<<<<
 *             else:
 *                 if max_std_diff == 0:
 */
        __pyx_v_max_abs_diff = 0;
        goto __pyx_L21;
      }
      __pyx_L21:;
      goto __pyx_L20;
    }
    /*else*/ {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":429
 *                     max_abs_diff = 0
 *             else:
 *                 if max_std_diff == 0:             # <<<<<<<<<<<<<<
 *                     x0=nan
 *                     y0=nan
 */
      __pyx_4 = (__pyx_v_max_std_diff == 0);
      if (__pyx_4) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":430
 *             else:
 *                 if max_std_diff == 0:
 *                     x0=nan             # <<<<<<<<<<<<<<
 *                     y0=nan
 *                     x0_abs = nan
 */
        __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":431
 *                 if max_std_diff == 0:
 *                     x0=nan
 *                     y0=nan             # <<<<<<<<<<<<<<
 *                     x0_abs = nan
 *                     y0_abs = nan
 */
        __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":432
 *                     x0=nan
 *                     y0=nan
 *                     x0_abs = nan             # <<<<<<<<<<<<<<
 *                     y0_abs = nan
 *                     found_point = 0 # c int (bool)
 */
        __pyx_v_x0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":433
 *                     y0=nan
 *                     x0_abs = nan
 *                     y0_abs = nan             # <<<<<<<<<<<<<<
 *                     found_point = 0 # c int (bool)
 *             if found_point:
 */
        __pyx_v_y0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":434
 *                     x0_abs = nan
 *                     y0_abs = nan
 *                     found_point = 0 # c int (bool)             # <<<<<<<<<<<<<<
 *             if found_point:
 *                 result = fit_params.fit_params(
 */
        __pyx_v_found_point = 0;
        goto __pyx_L22;
      }
      __pyx_L22:;
    }
    __pyx_L20:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":435
 *                     y0_abs = nan
 *                     found_point = 0 # c int (bool)
 *             if found_point:             # <<<<<<<<<<<<<<
 *                 result = fit_params.fit_params(
 *                     self.pState, &x0, &y0,
 */
    __pyx_7 = __pyx_v_found_point;
    if (__pyx_7) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":442
 *                     roi2_sz.sz.width, roi2_sz.sz.height,
 *                     <unsigned char*>self.absdiff_im_roi2_view.im,
 *                     self.absdiff_im_roi2_view.step)             # <<<<<<<<<<<<<<
 *                 # note that x0 and y0 are now relative to the ROI origin
 * 
 */
      __pyx_v_result = fit_params(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->pState, (&__pyx_v_x0), (&__pyx_v_y0), (&__pyx_v_Mu00), (&__pyx_v_Uu11), (&__pyx_v_Uu20), (&__pyx_v_Uu02), __pyx_v_roi2_sz->sz.width, __pyx_v_roi2_sz->sz.height, ((unsigned char *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.im), ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.step);

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":448
 *                 # orientation from pixel covariance.
 * 
 *                 if result == fit_params.CFitParamsNoError:             # <<<<<<<<<<<<<<
 *                     area = Mu00
 *                     eigen_err = eigen_2x2_real( Uu20, Uu11,
 */
      __pyx_5 = (__pyx_v_result == CFitParamsNoError);
      if (__pyx_5) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":449
 * 
 *                 if result == fit_params.CFitParamsNoError:
 *                     area = Mu00             # <<<<<<<<<<<<<<
 *                     eigen_err = eigen_2x2_real( Uu20, Uu11,
 *                                                 Uu11, Uu02,
 */
        __pyx_v_area = __pyx_v_Mu00;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":453
 *                                                 Uu11, Uu02,
 *                                                 &evalA, &evecA1,
 *                                                 &evalB, &evecB1)             # <<<<<<<<<<<<<<
 *                     if eigen_err:
 *                         slope = nan
 */
        __pyx_v_eigen_err = eigen_2x2_real(__pyx_v_Uu20, __pyx_v_Uu11, __pyx_v_Uu11, __pyx_v_Uu02, (&__pyx_v_evalA), (&__pyx_v_evecA1), (&__pyx_v_evalB), (&__pyx_v_evecB1));

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":454
 *                                                 &evalA, &evecA1,
 *                                                 &evalB, &evecB1)
 *                     if eigen_err:             # <<<<<<<<<<<<<<
 *                         slope = nan
 *                         eccentricity = 0.0
 */
        __pyx_7 = __pyx_v_eigen_err;
        if (__pyx_7) {

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":455
 *                                                 &evalB, &evecB1)
 *                     if eigen_err:
 *                         slope = nan             # <<<<<<<<<<<<<<
 *                         eccentricity = 0.0
 *                     else:
 */
          __pyx_v_slope = __pyx_v_23realtime_image_analysis_nan;

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":456
 *                     if eigen_err:
 *                         slope = nan
 *                         eccentricity = 0.0             # <<<<<<<<<<<<<<
 *                     else:
 *                         rise = 1.0 # 2nd component of eigenvectors will always be 1.0
 */
          __pyx_v_eccentricity = 0.0;
          goto __pyx_L25;
        }
        /*else*/ {

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":458
 *                         eccentricity = 0.0
 *                     else:
 *                         rise = 1.0 # 2nd component of eigenvectors will always be 1.0             # <<<<<<<<<<<<<<
 *                         if evalA > evalB:
 *                             run = evecA1
 */
          __pyx_v_rise = 1.0;

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":459
 *                     else:
 *                         rise = 1.0 # 2nd component of eigenvectors will always be 1.0
 *                         if evalA > evalB:             # <<<<<<<<<<<<<<
 *                             run = evecA1
 *                             eccentricity = evalA/evalB
 */
          __pyx_4 = (__pyx_v_evalA > __pyx_v_evalB);
          if (__pyx_4) {

            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":460
 *                         rise = 1.0 # 2nd component of eigenvectors will always be 1.0
 *                         if evalA > evalB:
 *                             run = evecA1             # <<<<<<<<<<<<<<
 *                             eccentricity = evalA/evalB
 *                         else:
 */
            __pyx_v_run = __pyx_v_evecA1;

            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":461
 *                         if evalA > evalB:
 *                             run = evecA1
 *                             eccentricity = evalA/evalB             # <<<<<<<<<<<<<<
 *                         else:
 *                             run = evecB1
 */
            __pyx_v_eccentricity = (__pyx_v_evalA / __pyx_v_evalB);
            goto __pyx_L26;
          }
          /*else*/ {

            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":463
 *                             eccentricity = evalA/evalB
 *                         else:
 *                             run = evecB1             # <<<<<<<<<<<<<<
 *                             eccentricity = evalB/evalA
 *                         slope = rise/run
 */
            __pyx_v_run = __pyx_v_evecB1;

            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":464
 *                         else:
 *                             run = evecB1
 *                             eccentricity = evalB/evalA             # <<<<<<<<<<<<<<
 *                         slope = rise/run
 * 
 */
            __pyx_v_eccentricity = (__pyx_v_evalB / __pyx_v_evalA);
          }
          __pyx_L26:;

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":465
 *                             run = evecB1
 *                             eccentricity = evalB/evalA
 *                         slope = rise/run             # <<<<<<<<<<<<<<
 * 
 *                 elif result == fit_params.CFitParamsZeroMomentError:
 */
          __pyx_v_slope = (__pyx_v_rise / __pyx_v_run);
        }
        __pyx_L25:;
        goto __pyx_L24;
      }

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":467
 *                         slope = rise/run
 * 
 *                 elif result == fit_params.CFitParamsZeroMomentError:             # <<<<<<<<<<<<<<
 *                     x0 = nan
 *                     y0 = nan
 */
      __pyx_5 = (__pyx_v_result == CFitParamsZeroMomentError);
      if (__pyx_5) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":468
 * 
 *                 elif result == fit_params.CFitParamsZeroMomentError:
 *                     x0 = nan             # <<<<<<<<<<<<<<
 *                     y0 = nan
 *                     x0_abs = nan
 */
        __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":469
 *                 elif result == fit_params.CFitParamsZeroMomentError:
 *                     x0 = nan
 *                     y0 = nan             # <<<<<<<<<<<<<<
 *                     x0_abs = nan
 *                     y0_abs = nan
 */
        __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":470
 *                     x0 = nan
 *                     y0 = nan
 *                     x0_abs = nan             # <<<<<<<<<<<<<<
 *                     y0_abs = nan
 *                     found_point = 0
 */
        __pyx_v_x0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":471
 *                     y0 = nan
 *                     x0_abs = nan
 *                     y0_abs = nan             # <<<<<<<<<<<<<<
 *                     found_point = 0
 *                 elif result == fit_params.CFitParamsCentralMomentError:
 */
        __pyx_v_y0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":472
 *                     x0_abs = nan
 *                     y0_abs = nan
 *                     found_point = 0             # <<<<<<<<<<<<<<
 *                 elif result == fit_params.CFitParamsCentralMomentError:
 *                     slope = nan
 */
        __pyx_v_found_point = 0;
        goto __pyx_L24;
      }

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":473
 *                     y0_abs = nan
 *                     found_point = 0
 *                 elif result == fit_params.CFitParamsCentralMomentError:             # <<<<<<<<<<<<<<
 *                     slope = nan
 *                 else: SET_ERR(1)
 */
      __pyx_4 = (__pyx_v_result == CFitParamsCentralMomentError);
      if (__pyx_4) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":474
 *                     found_point = 0
 *                 elif result == fit_params.CFitParamsCentralMomentError:
 *                     slope = nan             # <<<<<<<<<<<<<<
 *                 else: SET_ERR(1)
 * 
 */
        __pyx_v_slope = __pyx_v_23realtime_image_analysis_nan;
        goto __pyx_L24;
      }
      /*else*/ {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":475
 *                 elif result == fit_params.CFitParamsCentralMomentError:
 *                     slope = nan
 *                 else: SET_ERR(1)             # <<<<<<<<<<<<<<
 * 
 *                 # set x0 and y0 relative to whole frame
 */
        SET_ERR(1);
      }
      __pyx_L24:;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":478
 * 
 *                 # set x0 and y0 relative to whole frame
 *                 if found_point:             # <<<<<<<<<<<<<<
 *                     x0_abs = x0+left2
 *                     y0_abs = y0+bottom2
 */
      __pyx_7 = __pyx_v_found_point;
      if (__pyx_7) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":479
 *                 # set x0 and y0 relative to whole frame
 *                 if found_point:
 *                     x0_abs = x0+left2             # <<<<<<<<<<<<<<
 *                     y0_abs = y0+bottom2
 * 
 */
        __pyx_v_x0_abs = (__pyx_v_x0 + __pyx_v_left2);

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":480
 *                 if found_point:
 *                     x0_abs = x0+left2
 *                     y0_abs = y0+bottom2             # <<<<<<<<<<<<<<
 * 
 *             # grab GIL
 */
        __pyx_v_y0_abs = (__pyx_v_y0 + __pyx_v_bottom2);
        goto __pyx_L27;
      }
      __pyx_L27:;
      goto __pyx_L23;
    }
    __pyx_L23:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":483
 * 
 *             # grab GIL
 *             c_python.Py_END_ALLOW_THREADS             # <<<<<<<<<<<<<<
 * 
 *             if found_point:
 */
    Py_END_ALLOW_THREADS;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":485
 *             c_python.Py_END_ALLOW_THREADS
 * 
 *             if found_point:             # <<<<<<<<<<<<<<
 *                 if not (n_found_points+1>=self.max_num_points): # only modify the image if more follow...
 *                     self.absdiff_im_roi2_view.set_val(0, roi2_sz )
 */
    __pyx_7 = __pyx_v_found_point;
    if (__pyx_7) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":486
 * 
 *             if found_point:
 *                 if not (n_found_points+1>=self.max_num_points): # only modify the image if more follow...             # <<<<<<<<<<<<<<
 *                     self.absdiff_im_roi2_view.set_val(0, roi2_sz )
 * 
 */
      __pyx_5 = (!((__pyx_v_n_found_points + 1) >= ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->max_num_points));
      if (__pyx_5) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":487
 *             if found_point:
 *                 if not (n_found_points+1>=self.max_num_points): # only modify the image if more follow...
 *                     self.absdiff_im_roi2_view.set_val(0, roi2_sz )             # <<<<<<<<<<<<<<
 * 
 *             if not found_point:
 */
        __pyx_8 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view), __pyx_kp_set_val); if (unlikely(!__pyx_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        __pyx_1 = PyTuple_New(2); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        Py_INCREF(__pyx_int_0);
        PyTuple_SET_ITEM(__pyx_1, 0, __pyx_int_0);
        Py_INCREF(((PyObject *)__pyx_v_roi2_sz));
        PyTuple_SET_ITEM(__pyx_1, 1, ((PyObject *)__pyx_v_roi2_sz));
        __pyx_6 = PyObject_Call(__pyx_8, ((PyObject *)__pyx_1), NULL); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
        Py_DECREF(__pyx_8); __pyx_8 = 0;
        Py_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
        Py_DECREF(__pyx_6); __pyx_6 = 0;
        goto __pyx_L29;
      }
      __pyx_L29:;
      goto __pyx_L28;
    }
    __pyx_L28:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":489
 *                     self.absdiff_im_roi2_view.set_val(0, roi2_sz )
 * 
 *             if not found_point:             # <<<<<<<<<<<<<<
 *                 break
 * 
 */
    __pyx_4 = (!__pyx_v_found_point);
    if (__pyx_4) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":490
 * 
 *             if not found_point:
 *                 break             # <<<<<<<<<<<<<<
 * 
 *             if return_debug_values:
 */
      goto __pyx_L9;
      goto __pyx_L30;
    }
    __pyx_L30:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":492
 *                 break
 * 
 *             if return_debug_values:             # <<<<<<<<<<<<<<
 *                 pt_tuple = (x0_abs, y0_abs, area, slope, eccentricity, index_x, index_y)
 *             else:
 */
    __pyx_7 = __pyx_v_return_debug_values;
    if (__pyx_7) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":493
 * 
 *             if return_debug_values:
 *                 pt_tuple = (x0_abs, y0_abs, area, slope, eccentricity, index_x, index_y)             # <<<<<<<<<<<<<<
 *             else:
 *                 pt_tuple = (x0_abs, y0_abs, area, slope, eccentricity)
 */
      __pyx_2 = PyFloat_FromDouble(__pyx_v_x0_abs); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_8 = PyFloat_FromDouble(__pyx_v_y0_abs); if (unlikely(!__pyx_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_1 = PyFloat_FromDouble(__pyx_v_area); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_6 = PyFloat_FromDouble(__pyx_v_slope); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_9 = PyFloat_FromDouble(__pyx_v_eccentricity); if (unlikely(!__pyx_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_10 = PyInt_FromLong(__pyx_v_index_x); if (unlikely(!__pyx_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_11 = PyInt_FromLong(__pyx_v_index_y); if (unlikely(!__pyx_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_12 = PyTuple_New(7); if (unlikely(!__pyx_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      PyTuple_SET_ITEM(__pyx_12, 0, __pyx_2);
      PyTuple_SET_ITEM(__pyx_12, 1, __pyx_8);
      PyTuple_SET_ITEM(__pyx_12, 2, __pyx_1);
      PyTuple_SET_ITEM(__pyx_12, 3, __pyx_6);
      PyTuple_SET_ITEM(__pyx_12, 4, __pyx_9);
      PyTuple_SET_ITEM(__pyx_12, 5, __pyx_10);
      PyTuple_SET_ITEM(__pyx_12, 6, __pyx_11);
      __pyx_2 = 0;
      __pyx_8 = 0;
      __pyx_1 = 0;
      __pyx_6 = 0;
      __pyx_9 = 0;
      __pyx_10 = 0;
      __pyx_11 = 0;
      Py_DECREF(__pyx_v_pt_tuple);
      __pyx_v_pt_tuple = ((PyObject *)__pyx_12);
      __pyx_12 = 0;
      goto __pyx_L31;
    }
    /*else*/ {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":495
 *                 pt_tuple = (x0_abs, y0_abs, area, slope, eccentricity, index_x, index_y)
 *             else:
 *                 pt_tuple = (x0_abs, y0_abs, area, slope, eccentricity)             # <<<<<<<<<<<<<<
 * 
 *             all_points_found.append(pt_tuple)
 */
      __pyx_2 = PyFloat_FromDouble(__pyx_v_x0_abs); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_8 = PyFloat_FromDouble(__pyx_v_y0_abs); if (unlikely(!__pyx_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_1 = PyFloat_FromDouble(__pyx_v_area); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_6 = PyFloat_FromDouble(__pyx_v_slope); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_9 = PyFloat_FromDouble(__pyx_v_eccentricity); if (unlikely(!__pyx_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      __pyx_10 = PyTuple_New(5); if (unlikely(!__pyx_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
      PyTuple_SET_ITEM(__pyx_10, 0, __pyx_2);
      PyTuple_SET_ITEM(__pyx_10, 1, __pyx_8);
      PyTuple_SET_ITEM(__pyx_10, 2, __pyx_1);
      PyTuple_SET_ITEM(__pyx_10, 3, __pyx_6);
      PyTuple_SET_ITEM(__pyx_10, 4, __pyx_9);
      __pyx_2 = 0;
      __pyx_8 = 0;
      __pyx_1 = 0;
      __pyx_6 = 0;
      __pyx_9 = 0;
      Py_DECREF(__pyx_v_pt_tuple);
      __pyx_v_pt_tuple = ((PyObject *)__pyx_10);
      __pyx_10 = 0;
    }
    __pyx_L31:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":497
 *                 pt_tuple = (x0_abs, y0_abs, area, slope, eccentricity)
 * 
 *             all_points_found.append(pt_tuple)             # <<<<<<<<<<<<<<
 *             n_found_points = n_found_points+1
 * 
 */
    __pyx_11 = __Pyx_PyObject_Append(__pyx_v_all_points_found, __pyx_v_pt_tuple); if (unlikely(!__pyx_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_11); __pyx_11 = 0;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":498
 * 
 *             all_points_found.append(pt_tuple)
 *             n_found_points = n_found_points+1             # <<<<<<<<<<<<<<
 * 
 *         return all_points_found
 */
    __pyx_v_n_found_points = (__pyx_v_n_found_points + 1);
  }
  __pyx_L9:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":500
 *             n_found_points = n_found_points+1
 * 
 *         return all_points_found             # <<<<<<<<<<<<<<
 * 
 *     def get_image_view(self,which='mean'):
 */
  Py_INCREF(__pyx_v_all_points_found);
  __pyx_r = __pyx_v_all_points_found;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_6);
  Py_XDECREF(__pyx_8);
  Py_XDECREF(__pyx_9);
  Py_XDECREF(__pyx_10);
  Py_XDECREF(__pyx_11);
  Py_XDECREF(__pyx_12);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.do_work");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_roi2_sz);
  Py_DECREF(__pyx_v_all_points_found);
  Py_DECREF(__pyx_v_pt_tuple);
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":502
 *         return all_points_found
 * 
 *     def get_image_view(self,which='mean'):             # <<<<<<<<<<<<<<
 *         im = self.imname2im[which]
 *         return im
 */

static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_get_image_view(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_get_image_view(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_which = 0;
  PyObject *__pyx_v_im;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_which,0};
  __pyx_v_which = __pyx_kp_12;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[1] = {0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "get_image_view") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 502; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    if (values[0]) {
      __pyx_v_which = values[0];
    }
  } else {
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  1: __pyx_v_which = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("get_image_view", 0, 0, 1, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 502; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.get_image_view");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_im = Py_None; Py_INCREF(Py_None);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":503
 * 
 *     def get_image_view(self,which='mean'):
 *         im = self.imname2im[which]             # <<<<<<<<<<<<<<
 *         return im
 * 
 */
  __pyx_1 = PyObject_GetItem(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->imname2im, __pyx_v_which); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_v_im);
  __pyx_v_im = __pyx_1;
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":504
 *     def get_image_view(self,which='mean'):
 *         im = self.imname2im[which]
 *         return im             # <<<<<<<<<<<<<<
 * 
 *     property roi2_radius:
 */
  Py_INCREF(__pyx_v_im);
  __pyx_r = __pyx_v_im;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.get_image_view");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_im);
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":507
 * 
 *     property roi2_radius:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._roi2_radius
 *         def __set__(self,value):
 */

static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":508
 *     property roi2_radius:
 *         def __get__(self):
 *             return self._roi2_radius             # <<<<<<<<<<<<<<
 *         def __set__(self,value):
 *             self._roi2_radius = value
 */
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 508; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.roi2_radius.__get__");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":509
 *         def __get__(self):
 *             return self._roi2_radius
 *         def __set__(self,value):             # <<<<<<<<<<<<<<
 *             self._roi2_radius = value
 * 
 */

static int __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  int __pyx_1;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":510
 *             return self._roi2_radius
 *         def __set__(self,value):
 *             self._roi2_radius = value             # <<<<<<<<<<<<<<
 * 
 *     property clear_threshold:
 */
  __pyx_1 = __pyx_PyInt_int(__pyx_v_value); if (unlikely((__pyx_1 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 510; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius = __pyx_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.roi2_radius.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":513
 * 
 *     property clear_threshold:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._clear_threshold
 *         def __set__(self,value):
 */

static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":514
 *     property clear_threshold:
 *         def __get__(self):
 *             return self._clear_threshold             # <<<<<<<<<<<<<<
 *         def __set__(self,value):
 *             self._clear_threshold = value
 */
  __pyx_1 = PyFloat_FromDouble(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.clear_threshold.__get__");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":515
 *         def __get__(self):
 *             return self._clear_threshold
 *         def __set__(self,value):             # <<<<<<<<<<<<<<
 *             self._clear_threshold = value
 * 
 */

static int __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  float __pyx_1;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":516
 *             return self._clear_threshold
 *         def __set__(self,value):
 *             self._clear_threshold = value             # <<<<<<<<<<<<<<
 * 
 *     property diff_threshold:
 */
  __pyx_1 = __pyx_PyFloat_AsDouble(__pyx_v_value); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold = __pyx_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.clear_threshold.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":519
 * 
 *     property diff_threshold:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._diff_threshold
 *         def __set__(self,value):
 */

static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":520
 *     property diff_threshold:
 *         def __get__(self):
 *             return self._diff_threshold             # <<<<<<<<<<<<<<
 *         def __set__(self,value):
 *             self._diff_threshold = value
 */
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.diff_threshold.__get__");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":521
 *         def __get__(self):
 *             return self._diff_threshold
 *         def __set__(self,value):             # <<<<<<<<<<<<<<
 *             self._diff_threshold = value
 * 
 */

static int __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  Fw8u __pyx_1;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":522
 *             return self._diff_threshold
 *         def __set__(self,value):
 *             self._diff_threshold = value             # <<<<<<<<<<<<<<
 * 
 *     property scale_factor:
 */
  __pyx_1 = __pyx_PyInt_unsigned_char(__pyx_v_value); if (unlikely((__pyx_1 == (unsigned char)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold = __pyx_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.diff_threshold.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":525
 * 
 *     property scale_factor:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return self._scale_factor
 *         def __set__(self,value):
 */

static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":526
 *     property scale_factor:
 *         def __get__(self):
 *             return self._scale_factor             # <<<<<<<<<<<<<<
 *         def __set__(self,value):
 *             print 'setting scale_factor to',value
 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_kp__scale_factor); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.scale_factor.__get__");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":527
 *         def __get__(self):
 *             return self._scale_factor
 *         def __set__(self,value):             # <<<<<<<<<<<<<<
 *             print 'setting scale_factor to',value
 *             self._scale_factor = value
 */

static int __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  PyObject *__pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":528
 *             return self._scale_factor
 *         def __set__(self,value):
 *             print 'setting scale_factor to',value             # <<<<<<<<<<<<<<
 *             self._scale_factor = value
 * 
 */
  __pyx_1 = PyTuple_New(2); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_kp_22);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_kp_22);
  Py_INCREF(__pyx_v_value);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_v_value);
  if (__Pyx_Print(((PyObject *)__pyx_1), 1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":529
 *         def __set__(self,value):
 *             print 'setting scale_factor to',value
 *             self._scale_factor = value             # <<<<<<<<<<<<<<
 * 
 *     property roi:
 */
  if (PyObject_SetAttr(__pyx_v_self, __pyx_kp__scale_factor, __pyx_v_value) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.scale_factor.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":532
 * 
 *     property roi:
 *         def __get__(self):             # <<<<<<<<<<<<<<
 *             return (self._left,self._bottom,self._right,self._top)
 *         def __set__(self,object lbrt):
 */

static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_3roi___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_3roi___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":533
 *     property roi:
 *         def __get__(self):
 *             return (self._left,self._bottom,self._right,self._top)             # <<<<<<<<<<<<<<
 *         def __set__(self,object lbrt):
 *             cdef int l,b,r,t
 */
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_3 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_5 = PyTuple_New(4); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_5, 1, __pyx_2);
  PyTuple_SET_ITEM(__pyx_5, 2, __pyx_3);
  PyTuple_SET_ITEM(__pyx_5, 3, __pyx_4);
  __pyx_1 = 0;
  __pyx_2 = 0;
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_r = ((PyObject *)__pyx_5);
  __pyx_5 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.roi.__get__");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":534
 *         def __get__(self):
 *             return (self._left,self._bottom,self._right,self._top)
 *         def __set__(self,object lbrt):             # <<<<<<<<<<<<<<
 *             cdef int l,b,r,t
 * 
 */

static int __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_3roi___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_lbrt); /*proto*/
static int __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_3roi___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_lbrt) {
  int __pyx_v_l;
  int __pyx_v_b;
  int __pyx_v_r;
  int __pyx_v_t;
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  int __pyx_4;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  PyObject *__pyx_t_1 = NULL;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":537
 *             cdef int l,b,r,t
 * 
 *             l,b,r,t = lbrt             # <<<<<<<<<<<<<<
 *             if (l==self._left and b==self._bottom and
 *                 r==self._right and t==self._top):
 */
  if (PyTuple_CheckExact(__pyx_v_lbrt) && PyTuple_GET_SIZE(__pyx_v_lbrt) == 4) {
    PyObject* tuple = __pyx_v_lbrt;
    __pyx_2 = PyTuple_GET_ITEM(tuple, 0);
    Py_INCREF(__pyx_2);
    __pyx_3 = __pyx_PyInt_int(__pyx_2); if (unlikely((__pyx_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_v_l = __pyx_3;
    __pyx_2 = PyTuple_GET_ITEM(tuple, 1);
    Py_INCREF(__pyx_2);
    __pyx_3 = __pyx_PyInt_int(__pyx_2); if (unlikely((__pyx_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_v_b = __pyx_3;
    __pyx_2 = PyTuple_GET_ITEM(tuple, 2);
    Py_INCREF(__pyx_2);
    __pyx_3 = __pyx_PyInt_int(__pyx_2); if (unlikely((__pyx_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_v_r = __pyx_3;
    __pyx_2 = PyTuple_GET_ITEM(tuple, 3);
    Py_INCREF(__pyx_2);
    __pyx_3 = __pyx_PyInt_int(__pyx_2); if (unlikely((__pyx_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_v_t = __pyx_3;
  }
  else {
    __pyx_1 = PyObject_GetIter(__pyx_v_lbrt); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_2 = __Pyx_UnpackItem(__pyx_1, 0); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_3 = __pyx_PyInt_int(__pyx_2); if (unlikely((__pyx_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_v_l = __pyx_3;
    __pyx_2 = __Pyx_UnpackItem(__pyx_1, 1); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_3 = __pyx_PyInt_int(__pyx_2); if (unlikely((__pyx_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_v_b = __pyx_3;
    __pyx_2 = __Pyx_UnpackItem(__pyx_1, 2); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_3 = __pyx_PyInt_int(__pyx_2); if (unlikely((__pyx_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_v_r = __pyx_3;
    __pyx_2 = __Pyx_UnpackItem(__pyx_1, 3); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_3 = __pyx_PyInt_int(__pyx_2); if (unlikely((__pyx_3 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_v_t = __pyx_3;
    if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
  }

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":538
 * 
 *             l,b,r,t = lbrt
 *             if (l==self._left and b==self._bottom and             # <<<<<<<<<<<<<<
 *                 r==self._right and t==self._top):
 *                 # nothing to do
 */
  __pyx_4 = (__pyx_v_l == ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);
  if (__pyx_4) {
    __pyx_4 = (__pyx_v_b == ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);
    if (__pyx_4) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":539
 *             l,b,r,t = lbrt
 *             if (l==self._left and b==self._bottom and
 *                 r==self._right and t==self._top):             # <<<<<<<<<<<<<<
 *                 # nothing to do
 *                 return
 */
      __pyx_4 = (__pyx_v_r == ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right);
      if (__pyx_4) {
        __pyx_4 = (__pyx_v_t == ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top);
      }
    }
  }
  if (__pyx_4) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":541
 *                 r==self._right and t==self._top):
 *                 # nothing to do
 *                 return             # <<<<<<<<<<<<<<
 * 
 *             self._left = l
 */
    __pyx_r = 0;
    goto __pyx_L0;
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":543
 *                 return
 * 
 *             self._left = l             # <<<<<<<<<<<<<<
 *             self._bottom = b
 *             self._right = r
 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left = __pyx_v_l;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":544
 * 
 *             self._left = l
 *             self._bottom = b             # <<<<<<<<<<<<<<
 *             self._right = r
 *             self._top = t
 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom = __pyx_v_b;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":545
 *             self._left = l
 *             self._bottom = b
 *             self._right = r             # <<<<<<<<<<<<<<
 *             self._top = t
 * 
 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right = __pyx_v_r;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":546
 *             self._bottom = b
 *             self._right = r
 *             self._top = t             # <<<<<<<<<<<<<<
 * 
 *             if self._left < 0:
 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top = __pyx_v_t;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":548
 *             self._top = t
 * 
 *             if self._left < 0:             # <<<<<<<<<<<<<<
 *                 raise ValueError('attempting to set ROI left %d'%(self._left))
 *             if self._bottom < 0:
 */
  __pyx_4 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left < 0);
  if (__pyx_4) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":549
 * 
 *             if self._left < 0:
 *                 raise ValueError('attempting to set ROI left %d'%(self._left))             # <<<<<<<<<<<<<<
 *             if self._bottom < 0:
 *                 raise ValueError('attempting to set ROI bottom %d'%(self._bottom))
 */
    __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = PyNumber_Remainder(__pyx_kp_23, __pyx_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_1 = PyTuple_New(1); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_2 = PyObject_Call(__pyx_builtin_ValueError, ((PyObject *)__pyx_1), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 549; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":550
 *             if self._left < 0:
 *                 raise ValueError('attempting to set ROI left %d'%(self._left))
 *             if self._bottom < 0:             # <<<<<<<<<<<<<<
 *                 raise ValueError('attempting to set ROI bottom %d'%(self._bottom))
 *             if self._right >= self.maxwidth:
 */
  __pyx_4 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom < 0);
  if (__pyx_4) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":551
 *                 raise ValueError('attempting to set ROI left %d'%(self._left))
 *             if self._bottom < 0:
 *                 raise ValueError('attempting to set ROI bottom %d'%(self._bottom))             # <<<<<<<<<<<<<<
 *             if self._right >= self.maxwidth:
 *                 raise ValueError('attempting to set ROI right to %d (width %d)'%(self._right,self.maxwidth))
 */
    __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_t_1 = PyNumber_Remainder(__pyx_kp_24, __pyx_1); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_2 = PyTuple_New(1); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_1 = PyObject_Call(__pyx_builtin_ValueError, ((PyObject *)__pyx_2), NULL); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
    __Pyx_Raise(__pyx_1, 0, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":552
 *             if self._bottom < 0:
 *                 raise ValueError('attempting to set ROI bottom %d'%(self._bottom))
 *             if self._right >= self.maxwidth:             # <<<<<<<<<<<<<<
 *                 raise ValueError('attempting to set ROI right to %d (width %d)'%(self._right,self.maxwidth))
 *             if self._top >= self.maxheight:
 */
  __pyx_4 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right >= ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxwidth);
  if (__pyx_4) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":553
 *                 raise ValueError('attempting to set ROI bottom %d'%(self._bottom))
 *             if self._right >= self.maxwidth:
 *                 raise ValueError('attempting to set ROI right to %d (width %d)'%(self._right,self.maxwidth))             # <<<<<<<<<<<<<<
 *             if self._top >= self.maxheight:
 *                 raise ValueError('attempting to set ROI top to %d (height %d)'%(self._top,self.maxheight))
 */
    __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxwidth); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_5 = PyTuple_New(2); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_2);
    PyTuple_SET_ITEM(__pyx_5, 1, __pyx_1);
    __pyx_2 = 0;
    __pyx_1 = 0;
    __pyx_t_1 = PyNumber_Remainder(__pyx_kp_25, ((PyObject *)__pyx_5)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(((PyObject *)__pyx_5)); __pyx_5 = 0;
    __pyx_2 = PyTuple_New(1); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_1 = PyObject_Call(__pyx_builtin_ValueError, ((PyObject *)__pyx_2), NULL); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
    __Pyx_Raise(__pyx_1, 0, 0);
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L8;
  }
  __pyx_L8:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":554
 *             if self._right >= self.maxwidth:
 *                 raise ValueError('attempting to set ROI right to %d (width %d)'%(self._right,self.maxwidth))
 *             if self._top >= self.maxheight:             # <<<<<<<<<<<<<<
 *                 raise ValueError('attempting to set ROI top to %d (height %d)'%(self._top,self.maxheight))
 * 
 */
  __pyx_4 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top >= ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxheight);
  if (__pyx_4) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":555
 *                 raise ValueError('attempting to set ROI right to %d (width %d)'%(self._right,self.maxwidth))
 *             if self._top >= self.maxheight:
 *                 raise ValueError('attempting to set ROI top to %d (height %d)'%(self._top,self.maxheight))             # <<<<<<<<<<<<<<
 * 
 *             self._roi_sz = FastImage.Size( self._right-self._left+1, self._top-self._bottom+1 )
 */
    __pyx_5 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxheight); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_1 = PyTuple_New(2); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_5);
    PyTuple_SET_ITEM(__pyx_1, 1, __pyx_2);
    __pyx_5 = 0;
    __pyx_2 = 0;
    __pyx_t_1 = PyNumber_Remainder(__pyx_kp_26, ((PyObject *)__pyx_1)); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
    __pyx_5 = PyTuple_New(1); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_2 = PyObject_Call(__pyx_builtin_ValueError, ((PyObject *)__pyx_5), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    Py_DECREF(((PyObject *)__pyx_5)); __pyx_5 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 555; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    goto __pyx_L9;
  }
  __pyx_L9:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":557
 *                 raise ValueError('attempting to set ROI top to %d (height %d)'%(self._top,self.maxheight))
 * 
 *             self._roi_sz = FastImage.Size( self._right-self._left+1, self._top-self._bottom+1 )             # <<<<<<<<<<<<<<
 * 
 *             self.absdiff_im_roi_view = self.absdiff_im.roi(self._left,self._bottom,self._roi_sz)
 */
  __pyx_1 = PyInt_FromLong(((((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left) + 1)); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_5 = PyInt_FromLong(((((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom) + 1)); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyTuple_New(2); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_5);
  __pyx_1 = 0;
  __pyx_5 = 0;
  __pyx_1 = PyObject_Call(((PyObject *)((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_Size)), ((PyObject *)__pyx_2), NULL); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
  if (!(__Pyx_TypeTest(__pyx_1, __pyx_ptype_6motmot_9FastImage_9FastImage_Size))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 557; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":559
 *             self._roi_sz = FastImage.Size( self._right-self._left+1, self._top-self._bottom+1 )
 * 
 *             self.absdiff_im_roi_view = self.absdiff_im.roi(self._left,self._bottom,self._roi_sz)             # <<<<<<<<<<<<<<
 *             self.mean_im_roi_view = self.mean_im.roi(self._left,self._bottom,self._roi_sz)
 *             self.cmp_im_roi_view = self.cmp_im.roi(self._left,self._bottom,self._roi_sz)
 */
  __pyx_5 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im), __pyx_kp_roi); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_6 = PyTuple_New(3); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  PyTuple_SET_ITEM(__pyx_6, 0, __pyx_2);
  PyTuple_SET_ITEM(__pyx_6, 1, __pyx_1);
  Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  PyTuple_SET_ITEM(__pyx_6, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  __pyx_2 = 0;
  __pyx_1 = 0;
  __pyx_2 = PyObject_Call(__pyx_5, ((PyObject *)__pyx_6), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(((PyObject *)__pyx_6)); __pyx_6 = 0;
  if (!(__Pyx_TypeTest(__pyx_2, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":560
 * 
 *             self.absdiff_im_roi_view = self.absdiff_im.roi(self._left,self._bottom,self._roi_sz)
 *             self.mean_im_roi_view = self.mean_im.roi(self._left,self._bottom,self._roi_sz)             # <<<<<<<<<<<<<<
 *             self.cmp_im_roi_view = self.cmp_im.roi(self._left,self._bottom,self._roi_sz)
 *             self.cmpdiff_im_roi_view = self.cmpdiff_im.roi(self._left,self._bottom,self._roi_sz)
 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im), __pyx_kp_roi); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_5 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_6 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyTuple_New(3); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_5);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_6);
  Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  PyTuple_SET_ITEM(__pyx_2, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  __pyx_5 = 0;
  __pyx_6 = 0;
  __pyx_5 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_2), NULL); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
  if (!(__Pyx_TypeTest(__pyx_5, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 560; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_5);
  __pyx_5 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":561
 *             self.absdiff_im_roi_view = self.absdiff_im.roi(self._left,self._bottom,self._roi_sz)
 *             self.mean_im_roi_view = self.mean_im.roi(self._left,self._bottom,self._roi_sz)
 *             self.cmp_im_roi_view = self.cmp_im.roi(self._left,self._bottom,self._roi_sz)             # <<<<<<<<<<<<<<
 *             self.cmpdiff_im_roi_view = self.cmpdiff_im.roi(self._left,self._bottom,self._roi_sz)
 * 
 */
  __pyx_6 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im), __pyx_kp_roi); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_5 = PyTuple_New(3); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_5, 1, __pyx_2);
  Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  PyTuple_SET_ITEM(__pyx_5, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  __pyx_1 = 0;
  __pyx_2 = 0;
  __pyx_1 = PyObject_Call(__pyx_6, ((PyObject *)__pyx_5), NULL); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_6); __pyx_6 = 0;
  Py_DECREF(((PyObject *)__pyx_5)); __pyx_5 = 0;
  if (!(__Pyx_TypeTest(__pyx_1, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 561; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":562
 *             self.mean_im_roi_view = self.mean_im.roi(self._left,self._bottom,self._roi_sz)
 *             self.cmp_im_roi_view = self.cmp_im.roi(self._left,self._bottom,self._roi_sz)
 *             self.cmpdiff_im_roi_view = self.cmpdiff_im.roi(self._left,self._bottom,self._roi_sz)             # <<<<<<<<<<<<<<
 * 
 * def fit_slope(FastImage.FastImage8u im):
 */
  __pyx_2 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im), __pyx_kp_roi); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_6 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_5 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_1 = PyTuple_New(3); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_6);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_5);
  Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  PyTuple_SET_ITEM(__pyx_1, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  __pyx_6 = 0;
  __pyx_5 = 0;
  __pyx_6 = PyObject_Call(__pyx_2, ((PyObject *)__pyx_1), NULL); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
  if (!(__Pyx_TypeTest(__pyx_6, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_6);
  __pyx_6 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.roi.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":564
 *             self.cmpdiff_im_roi_view = self.cmpdiff_im.roi(self._left,self._bottom,self._roi_sz)
 * 
 * def fit_slope(FastImage.FastImage8u im):             # <<<<<<<<<<<<<<
 *     cdef fit_params.cFitParamsMomentState_64f *pState
 *     cdef double x0, y0
 */

static PyObject *__pyx_pf_23realtime_image_analysis_fit_slope(PyObject *__pyx_self, PyObject *__pyx_v_im); /*proto*/
static PyObject *__pyx_pf_23realtime_image_analysis_fit_slope(PyObject *__pyx_self, PyObject *__pyx_v_im) {
  cFitParamsMomentState_64f *__pyx_v_pState;
  double __pyx_v_x0;
  double __pyx_v_y0;
  double __pyx_v_rise;
  double __pyx_v_run;
  double __pyx_v_slope;
  double __pyx_v_eccentricity;
  double __pyx_v_evalA;
  double __pyx_v_evalB;
  double __pyx_v_evecA1;
  double __pyx_v_evecB1;
  double __pyx_v_Mu00;
  double __pyx_v_Uu11;
  double __pyx_v_Uu02;
  double __pyx_v_Uu20;
  int __pyx_v_result;
  int __pyx_v_eigen_err;
  PyObject *__pyx_v_area;
  PyObject *__pyx_v_x0_abs;
  PyObject *__pyx_v_y0_abs;
  PyObject *__pyx_v_found_point;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_t_1 = NULL;
  __pyx_self = __pyx_self;
  __pyx_v_area = Py_None; Py_INCREF(Py_None);
  __pyx_v_x0_abs = Py_None; Py_INCREF(Py_None);
  __pyx_v_y0_abs = Py_None; Py_INCREF(Py_None);
  __pyx_v_found_point = Py_None; Py_INCREF(Py_None);
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "im", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 564; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":574
 *     cdef int result, eigen_err
 * 
 *     CHK_HAVEGIL( fit_params.cFitParamsMomentInitAlloc_64f( &pState ))             # <<<<<<<<<<<<<<
 *     try:
 *         result = fit_params.fit_params( pState, &x0, &y0,
 */
  __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(cFitParamsMomentInitAlloc_64f((&__pyx_v_pState))); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 574; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":575
 * 
 *     CHK_HAVEGIL( fit_params.cFitParamsMomentInitAlloc_64f( &pState ))
 *     try:             # <<<<<<<<<<<<<<
 *         result = fit_params.fit_params( pState, &x0, &y0,
 *                                         &Mu00,
 */
  /*try:*/ {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":581
 *                                         im.imsiz.sz.width, im.imsiz.sz.height,
 *                                         <unsigned char*>im.im,
 *                                         im.step)             # <<<<<<<<<<<<<<
 * 
 *         # See note at top of file about determining orientation from
 */
    __pyx_v_result = fit_params(__pyx_v_pState, (&__pyx_v_x0), (&__pyx_v_y0), (&__pyx_v_Mu00), (&__pyx_v_Uu11), (&__pyx_v_Uu20), (&__pyx_v_Uu02), ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_v_im)->__pyx_base.imsiz->sz.width, ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_v_im)->__pyx_base.imsiz->sz.height, ((unsigned char *)((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_v_im)->__pyx_base.im), ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_v_im)->__pyx_base.step);

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":587
 * 
 *         # note that x0 and y0 are now relative to the ROI origin
 *         if result == fit_params.CFitParamsNoError:             # <<<<<<<<<<<<<<
 *             area = Mu00
 *             eigen_err = eigen_2x2_real( Uu20, Uu11,
 */
    __pyx_1 = (__pyx_v_result == CFitParamsNoError);
    if (__pyx_1) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":588
 *         # note that x0 and y0 are now relative to the ROI origin
 *         if result == fit_params.CFitParamsNoError:
 *             area = Mu00             # <<<<<<<<<<<<<<
 *             eigen_err = eigen_2x2_real( Uu20, Uu11,
 *                                         Uu11, Uu02,
 */
      __pyx_2 = PyFloat_FromDouble(__pyx_v_Mu00); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 588; __pyx_clineno = __LINE__; goto __pyx_L6;}
      Py_DECREF(__pyx_v_area);
      __pyx_v_area = __pyx_2;
      __pyx_2 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":592
 *                                         Uu11, Uu02,
 *                                         &evalA, &evecA1,
 *                                         &evalB, &evecB1)             # <<<<<<<<<<<<<<
 *             if eigen_err:
 *                 slope = nan
 */
      __pyx_v_eigen_err = eigen_2x2_real(__pyx_v_Uu20, __pyx_v_Uu11, __pyx_v_Uu11, __pyx_v_Uu02, (&__pyx_v_evalA), (&__pyx_v_evecA1), (&__pyx_v_evalB), (&__pyx_v_evecB1));

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":593
 *                                         &evalA, &evecA1,
 *                                         &evalB, &evecB1)
 *             if eigen_err:             # <<<<<<<<<<<<<<
 *                 slope = nan
 *                 eccentricity = 0.0
 */
      __pyx_3 = __pyx_v_eigen_err;
      if (__pyx_3) {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":594
 *                                         &evalB, &evecB1)
 *             if eigen_err:
 *                 slope = nan             # <<<<<<<<<<<<<<
 *                 eccentricity = 0.0
 *             else:
 */
        __pyx_v_slope = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":595
 *             if eigen_err:
 *                 slope = nan
 *                 eccentricity = 0.0             # <<<<<<<<<<<<<<
 *             else:
 *                 rise = 1.0 # 2nd component of eigenvectors will always be 1.0
 */
        __pyx_v_eccentricity = 0.0;
        goto __pyx_L9;
      }
      /*else*/ {

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":597
 *                 eccentricity = 0.0
 *             else:
 *                 rise = 1.0 # 2nd component of eigenvectors will always be 1.0             # <<<<<<<<<<<<<<
 *                 if evalA > evalB:
 *                     run = evecA1
 */
        __pyx_v_rise = 1.0;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":598
 *             else:
 *                 rise = 1.0 # 2nd component of eigenvectors will always be 1.0
 *                 if evalA > evalB:             # <<<<<<<<<<<<<<
 *                     run = evecA1
 *                     eccentricity = evalA/evalB
 */
        __pyx_1 = (__pyx_v_evalA > __pyx_v_evalB);
        if (__pyx_1) {

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":599
 *                 rise = 1.0 # 2nd component of eigenvectors will always be 1.0
 *                 if evalA > evalB:
 *                     run = evecA1             # <<<<<<<<<<<<<<
 *                     eccentricity = evalA/evalB
 *                 else:
 */
          __pyx_v_run = __pyx_v_evecA1;

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":600
 *                 if evalA > evalB:
 *                     run = evecA1
 *                     eccentricity = evalA/evalB             # <<<<<<<<<<<<<<
 *                 else:
 *                     run = evecB1
 */
          __pyx_v_eccentricity = (__pyx_v_evalA / __pyx_v_evalB);
          goto __pyx_L10;
        }
        /*else*/ {

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":602
 *                     eccentricity = evalA/evalB
 *                 else:
 *                     run = evecB1             # <<<<<<<<<<<<<<
 *                     eccentricity = evalB/evalA
 *                 slope = rise/run
 */
          __pyx_v_run = __pyx_v_evecB1;

          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":603
 *                 else:
 *                     run = evecB1
 *                     eccentricity = evalB/evalA             # <<<<<<<<<<<<<<
 *                 slope = rise/run
 * 
 */
          __pyx_v_eccentricity = (__pyx_v_evalB / __pyx_v_evalA);
        }
        __pyx_L10:;

        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":604
 *                     run = evecB1
 *                     eccentricity = evalB/evalA
 *                 slope = rise/run             # <<<<<<<<<<<<<<
 * 
 *         elif result == fit_params.CFitParamsZeroMomentError:
 */
        __pyx_v_slope = (__pyx_v_rise / __pyx_v_run);
      }
      __pyx_L9:;
      goto __pyx_L8;
    }

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":606
 *                 slope = rise/run
 * 
 *         elif result == fit_params.CFitParamsZeroMomentError:             # <<<<<<<<<<<<<<
 *             x0 = nan
 *             y0 = nan
 */
    __pyx_1 = (__pyx_v_result == CFitParamsZeroMomentError);
    if (__pyx_1) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":607
 * 
 *         elif result == fit_params.CFitParamsZeroMomentError:
 *             x0 = nan             # <<<<<<<<<<<<<<
 *             y0 = nan
 *             x0_abs = nan
 */
      __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":608
 *         elif result == fit_params.CFitParamsZeroMomentError:
 *             x0 = nan
 *             y0 = nan             # <<<<<<<<<<<<<<
 *             x0_abs = nan
 *             y0_abs = nan
 */
      __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":609
 *             x0 = nan
 *             y0 = nan
 *             x0_abs = nan             # <<<<<<<<<<<<<<
 *             y0_abs = nan
 *             found_point = 0
 */
      __pyx_2 = PyFloat_FromDouble(__pyx_v_23realtime_image_analysis_nan); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; __pyx_clineno = __LINE__; goto __pyx_L6;}
      Py_DECREF(__pyx_v_x0_abs);
      __pyx_v_x0_abs = __pyx_2;
      __pyx_2 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":610
 *             y0 = nan
 *             x0_abs = nan
 *             y0_abs = nan             # <<<<<<<<<<<<<<
 *             found_point = 0
 *         elif result == fit_params.CFitParamsCentralMomentError:
 */
      __pyx_2 = PyFloat_FromDouble(__pyx_v_23realtime_image_analysis_nan); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; __pyx_clineno = __LINE__; goto __pyx_L6;}
      Py_DECREF(__pyx_v_y0_abs);
      __pyx_v_y0_abs = __pyx_2;
      __pyx_2 = 0;

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":611
 *             x0_abs = nan
 *             y0_abs = nan
 *             found_point = 0             # <<<<<<<<<<<<<<
 *         elif result == fit_params.CFitParamsCentralMomentError:
 *             slope = nan
 */
      Py_INCREF(__pyx_int_0);
      Py_DECREF(__pyx_v_found_point);
      __pyx_v_found_point = __pyx_int_0;
      goto __pyx_L8;
    }

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":612
 *             y0_abs = nan
 *             found_point = 0
 *         elif result == fit_params.CFitParamsCentralMomentError:             # <<<<<<<<<<<<<<
 *             slope = nan
 *         else:
 */
    __pyx_1 = (__pyx_v_result == CFitParamsCentralMomentError);
    if (__pyx_1) {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":613
 *             found_point = 0
 *         elif result == fit_params.CFitParamsCentralMomentError:
 *             slope = nan             # <<<<<<<<<<<<<<
 *         else:
 *             raise ValueError('unknown result (%d)'%result)
 */
      __pyx_v_slope = __pyx_v_23realtime_image_analysis_nan;
      goto __pyx_L8;
    }
    /*else*/ {

      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":615
 *             slope = nan
 *         else:
 *             raise ValueError('unknown result (%d)'%result)             # <<<<<<<<<<<<<<
 *     finally:
 *         CHK_HAVEGIL( fit_params.cFitParamsMomentFree_64f( pState ))
 */
      __pyx_2 = PyInt_FromLong(__pyx_v_result); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 615; __pyx_clineno = __LINE__; goto __pyx_L6;}
      __pyx_t_1 = PyNumber_Remainder(__pyx_kp_27, __pyx_2); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 615; __pyx_clineno = __LINE__; goto __pyx_L6;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __pyx_2 = PyTuple_New(1); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 615; __pyx_clineno = __LINE__; goto __pyx_L6;}
      PyTuple_SET_ITEM(__pyx_2, 0, __pyx_t_1);
      __pyx_t_1 = 0;
      __pyx_4 = PyObject_Call(__pyx_builtin_ValueError, ((PyObject *)__pyx_2), NULL); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 615; __pyx_clineno = __LINE__; goto __pyx_L6;}
      Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
      __Pyx_Raise(__pyx_4, 0, 0);
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 615; __pyx_clineno = __LINE__; goto __pyx_L6;}
    }
    __pyx_L8:;
  }
  /*finally:*/ {
    int __pyx_why;
    PyObject *__pyx_exc_type, *__pyx_exc_value, *__pyx_exc_tb;
    int __pyx_exc_lineno;
    __pyx_exc_type = 0; __pyx_exc_value = 0; __pyx_exc_tb = 0; __pyx_exc_lineno = 0;
    __pyx_why = 0; goto __pyx_L7;
    __pyx_L6: {
      __pyx_why = 4;
      Py_XDECREF(__pyx_2); __pyx_2 = 0;
      Py_XDECREF(__pyx_4); __pyx_4 = 0;
      __Pyx_ErrFetch(&__pyx_exc_type, &__pyx_exc_value, &__pyx_exc_tb);
      __pyx_exc_lineno = __pyx_lineno;
      goto __pyx_L7;
    }
    __pyx_L7:;

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":617
 *             raise ValueError('unknown result (%d)'%result)
 *     finally:
 *         CHK_HAVEGIL( fit_params.cFitParamsMomentFree_64f( pState ))             # <<<<<<<<<<<<<<
 * 
 *     return slope, eccentricity
 */
    __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(cFitParamsMomentFree_64f(__pyx_v_pState)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 617; __pyx_clineno = __LINE__; goto __pyx_L11_error;}
    goto __pyx_L12;
    __pyx_L11_error:;
    if (__pyx_why == 4) {
      Py_XDECREF(__pyx_exc_type);
      Py_XDECREF(__pyx_exc_value);
      Py_XDECREF(__pyx_exc_tb);
    }
    goto __pyx_L1_error;
    __pyx_L12:;
    switch (__pyx_why) {
      case 4: {
        __Pyx_ErrRestore(__pyx_exc_type, __pyx_exc_value, __pyx_exc_tb);
        __pyx_lineno = __pyx_exc_lineno;
        __pyx_exc_type = 0;
        __pyx_exc_value = 0;
        __pyx_exc_tb = 0;
        goto __pyx_L1_error;
      }
    }
  }

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":619
 *         CHK_HAVEGIL( fit_params.cFitParamsMomentFree_64f( pState ))
 * 
 *     return slope, eccentricity             # <<<<<<<<<<<<<<
 * 
 * def bg_help_slow( FastImage.FastImage32f running_mean_im,
 */
  __pyx_2 = PyFloat_FromDouble(__pyx_v_slope); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_4 = PyFloat_FromDouble(__pyx_v_eccentricity); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_5 = PyTuple_New(2); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_2);
  PyTuple_SET_ITEM(__pyx_5, 1, __pyx_4);
  __pyx_2 = 0;
  __pyx_4 = 0;
  __pyx_r = ((PyObject *)__pyx_5);
  __pyx_5 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("realtime_image_analysis.fit_slope");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_area);
  Py_DECREF(__pyx_v_x0_abs);
  Py_DECREF(__pyx_v_y0_abs);
  Py_DECREF(__pyx_v_found_point);
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":621
 *     return slope, eccentricity
 * 
 * def bg_help_slow( FastImage.FastImage32f running_mean_im,             # <<<<<<<<<<<<<<
 *                   FastImage.FastImage32f fastframef32_tmp,
 *                   FastImage.FastImage32f running_sumsqf,
 */

static PyObject *__pyx_pf_23realtime_image_analysis_bg_help_slow(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_23realtime_image_analysis_bg_help_slow(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_mean_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_fastframef32_tmp = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_sumsqf = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_mean2 = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_stdframe = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_running_mean8u_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_hw_roi_frame = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_noisy_pixels_mask = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_compareframe8u = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *__pyx_v_max_frame_size = 0;
  double __pyx_v_ALPHA;
  double __pyx_v_C;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_running_mean_im,&__pyx_kp_3,&__pyx_kp_running_sumsqf,&__pyx_kp_4,&__pyx_kp_running_stdframe,&__pyx_kp_5,&__pyx_kp_hw_roi_frame,&__pyx_kp_noisy_pixels_mask,&__pyx_kp_6,&__pyx_kp_max_frame_size,&__pyx_kp_ALPHA,&__pyx_kp_C,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[12] = {0,0,0,0,0,0,0,0,0,0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case 12: values[11] = PyTuple_GET_ITEM(__pyx_args, 11);
      case 11: values[10] = PyTuple_GET_ITEM(__pyx_args, 10);
      case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
      case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
      case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
      case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
      case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_running_mean_im);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_3);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help_slow", 1, 12, 12, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_running_sumsqf);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help_slow", 1, 12, 12, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_4);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help_slow", 1, 12, 12, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  4:
      values[4] = PyDict_GetItem(__pyx_kwds, __pyx_kp_running_stdframe);
      if (likely(values[4])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help_slow", 1, 12, 12, 4); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  5:
      values[5] = PyDict_GetItem(__pyx_kwds, __pyx_kp_5);
      if (likely(values[5])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help_slow", 1, 12, 12, 5); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  6:
      values[6] = PyDict_GetItem(__pyx_kwds, __pyx_kp_hw_roi_frame);
      if (likely(values[6])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help_slow", 1, 12, 12, 6); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  7:
      values[7] = PyDict_GetItem(__pyx_kwds, __pyx_kp_noisy_pixels_mask);
      if (likely(values[7])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help_slow", 1, 12, 12, 7); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  8:
      values[8] = PyDict_GetItem(__pyx_kwds, __pyx_kp_6);
      if (likely(values[8])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help_slow", 1, 12, 12, 8); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  9:
      values[9] = PyDict_GetItem(__pyx_kwds, __pyx_kp_max_frame_size);
      if (likely(values[9])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help_slow", 1, 12, 12, 9); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case 10:
      values[10] = PyDict_GetItem(__pyx_kwds, __pyx_kp_ALPHA);
      if (likely(values[10])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help_slow", 1, 12, 12, 10); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case 11:
      values[11] = PyDict_GetItem(__pyx_kwds, __pyx_kp_C);
      if (likely(values[11])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help_slow", 1, 12, 12, 11); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "bg_help_slow") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_running_mean_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[0]);
    __pyx_v_fastframef32_tmp = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[1]);
    __pyx_v_running_sumsqf = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[2]);
    __pyx_v_mean2 = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[3]);
    __pyx_v_running_stdframe = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[4]);
    __pyx_v_running_mean8u_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)values[5]);
    __pyx_v_hw_roi_frame = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)values[6]);
    __pyx_v_noisy_pixels_mask = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)values[7]);
    __pyx_v_compareframe8u = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)values[8]);
    __pyx_v_max_frame_size = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)values[9]);
    __pyx_v_ALPHA = __pyx_PyFloat_AsDouble(values[10]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 631; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_C = __pyx_PyFloat_AsDouble(values[11]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 12) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_running_mean_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 0));
    __pyx_v_fastframef32_tmp = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 1));
    __pyx_v_running_sumsqf = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 2));
    __pyx_v_mean2 = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 3));
    __pyx_v_running_stdframe = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 4));
    __pyx_v_running_mean8u_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)PyTuple_GET_ITEM(__pyx_args, 5));
    __pyx_v_hw_roi_frame = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)PyTuple_GET_ITEM(__pyx_args, 6));
    __pyx_v_noisy_pixels_mask = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)PyTuple_GET_ITEM(__pyx_args, 7));
    __pyx_v_compareframe8u = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)PyTuple_GET_ITEM(__pyx_args, 8));
    __pyx_v_max_frame_size = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)PyTuple_GET_ITEM(__pyx_args, 9));
    __pyx_v_ALPHA = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 10)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 631; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_C = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 11)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 632; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("bg_help_slow", 1, 12, 12, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("realtime_image_analysis.bg_help_slow");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_mean_im", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 621; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "fastframef32_tmp", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 622; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_sumsqf), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_sumsqf", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 623; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_mean2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "mean2", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 624; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_stdframe), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_stdframe", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 625; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean8u_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "running_mean8u_im", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 626; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_hw_roi_frame), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "hw_roi_frame", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 627; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_noisy_pixels_mask), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "noisy_pixels_mask", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 628; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_compareframe8u), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "compareframe8u", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 629; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_max_frame_size), __pyx_ptype_6motmot_9FastImage_9FastImage_Size, 1, "max_frame_size", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 630; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":634
 *                   double C):
 *     # maintain running average
 *     running_mean_im.toself_add_weighted( hw_roi_frame, max_frame_size, ALPHA )             # <<<<<<<<<<<<<<
 *     # maintain 8bit unsigned background image
 *     running_mean_im.get_8u_copy_put( running_mean8u_im, max_frame_size )
 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean_im), __pyx_kp_toself_add_weighted); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyFloat_FromDouble(__pyx_v_ALPHA); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_3 = PyTuple_New(3); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(((PyObject *)__pyx_v_hw_roi_frame));
  PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_hw_roi_frame));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 2, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_3), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 634; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_3)); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":636
 *     running_mean_im.toself_add_weighted( hw_roi_frame, max_frame_size, ALPHA )
 *     # maintain 8bit unsigned background image
 *     running_mean_im.get_8u_copy_put( running_mean8u_im, max_frame_size )             # <<<<<<<<<<<<<<
 * 
 *     # standard deviation calculation
 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean_im), __pyx_kp_28); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 636; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_3 = PyTuple_New(2); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 636; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(((PyObject *)__pyx_v_running_mean8u_im));
  PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_running_mean8u_im));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_3), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 636; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_3)); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":639
 * 
 *     # standard deviation calculation
 *     hw_roi_frame.get_32f_copy_put(fastframef32_tmp,max_frame_size)             # <<<<<<<<<<<<<<
 *     fastframef32_tmp.toself_square(max_frame_size) # current**2
 *     running_sumsqf.toself_add_weighted( fastframef32_tmp, max_frame_size, ALPHA)
 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_hw_roi_frame), __pyx_kp_29); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_3 = PyTuple_New(2); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(((PyObject *)__pyx_v_fastframef32_tmp));
  PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_fastframef32_tmp));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_3), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 639; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_3)); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":640
 *     # standard deviation calculation
 *     hw_roi_frame.get_32f_copy_put(fastframef32_tmp,max_frame_size)
 *     fastframef32_tmp.toself_square(max_frame_size) # current**2             # <<<<<<<<<<<<<<
 *     running_sumsqf.toself_add_weighted( fastframef32_tmp, max_frame_size, ALPHA)
 *     running_mean_im.get_square_put(mean2,max_frame_size)
 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_kp_toself_square); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_3 = PyTuple_New(1); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_3), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 640; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_3)); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":641
 *     hw_roi_frame.get_32f_copy_put(fastframef32_tmp,max_frame_size)
 *     fastframef32_tmp.toself_square(max_frame_size) # current**2
 *     running_sumsqf.toself_add_weighted( fastframef32_tmp, max_frame_size, ALPHA)             # <<<<<<<<<<<<<<
 *     running_mean_im.get_square_put(mean2,max_frame_size)
 *     running_sumsqf.get_subtracted_put(mean2,running_stdframe,max_frame_size)
 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_sumsqf), __pyx_kp_toself_add_weighted); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_3 = PyFloat_FromDouble(__pyx_v_ALPHA); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyTuple_New(3); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(((PyObject *)__pyx_v_fastframef32_tmp));
  PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_fastframef32_tmp));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 2, __pyx_3);
  __pyx_3 = 0;
  __pyx_3 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_2), NULL); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 641; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":642
 *     fastframef32_tmp.toself_square(max_frame_size) # current**2
 *     running_sumsqf.toself_add_weighted( fastframef32_tmp, max_frame_size, ALPHA)
 *     running_mean_im.get_square_put(mean2,max_frame_size)             # <<<<<<<<<<<<<<
 *     running_sumsqf.get_subtracted_put(mean2,running_stdframe,max_frame_size)
 * 
 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean_im), __pyx_kp_get_square_put); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyTuple_New(2); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(((PyObject *)__pyx_v_mean2));
  PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_mean2));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_3 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_2), NULL); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 642; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":643
 *     running_sumsqf.toself_add_weighted( fastframef32_tmp, max_frame_size, ALPHA)
 *     running_mean_im.get_square_put(mean2,max_frame_size)
 *     running_sumsqf.get_subtracted_put(mean2,running_stdframe,max_frame_size)             # <<<<<<<<<<<<<<
 * 
 *     # now create frame for comparison
 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_sumsqf), __pyx_kp_get_subtracted_put); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 643; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyTuple_New(3); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 643; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(((PyObject *)__pyx_v_mean2));
  PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_mean2));
  Py_INCREF(((PyObject *)__pyx_v_running_stdframe));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_running_stdframe));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 2, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_3 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_2), NULL); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 643; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":646
 * 
 *     # now create frame for comparison
 *     C = 6.0             # <<<<<<<<<<<<<<
 *     running_stdframe.toself_multiply(C,max_frame_size)
 *     running_stdframe.get_8u_copy_put(compareframe8u,max_frame_size)
 */
  __pyx_v_C = 6.0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":647
 *     # now create frame for comparison
 *     C = 6.0
 *     running_stdframe.toself_multiply(C,max_frame_size)             # <<<<<<<<<<<<<<
 *     running_stdframe.get_8u_copy_put(compareframe8u,max_frame_size)
 * 
 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_stdframe), __pyx_kp_toself_multiply); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 647; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyFloat_FromDouble(__pyx_v_C); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 647; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_3 = PyTuple_New(2); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 647; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = 0;
  __pyx_2 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_3), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 647; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_3)); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":648
 *     C = 6.0
 *     running_stdframe.toself_multiply(C,max_frame_size)
 *     running_stdframe.get_8u_copy_put(compareframe8u,max_frame_size)             # <<<<<<<<<<<<<<
 * 
 *     # now we do hack, erm, heuristic for bright points, which aren't gaussian.
 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_stdframe), __pyx_kp_28); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_3 = PyTuple_New(2); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(((PyObject *)__pyx_v_compareframe8u));
  PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_compareframe8u));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_3), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 648; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_3)); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":651
 * 
 *     # now we do hack, erm, heuristic for bright points, which aren't gaussian.
 *     running_mean8u_im.get_compare_put( 200, noisy_pixels_mask, max_frame_size, FastImage.CmpGreater)             # <<<<<<<<<<<<<<
 *     compareframe8u.set_val_masked(25, noisy_pixels_mask, max_frame_size)
 * 
 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean8u_im), __pyx_kp_get_compare_put); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_3 = __Pyx_GetName(__pyx_m, __pyx_kp_FastImage); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyObject_GetAttr(__pyx_3, __pyx_kp_CmpGreater); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  __pyx_3 = PyTuple_New(4); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_int_200);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_int_200);
  Py_INCREF(((PyObject *)__pyx_v_noisy_pixels_mask));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_noisy_pixels_mask));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 2, ((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 3, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_3), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 651; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_3)); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":652
 *     # now we do hack, erm, heuristic for bright points, which aren't gaussian.
 *     running_mean8u_im.get_compare_put( 200, noisy_pixels_mask, max_frame_size, FastImage.CmpGreater)
 *     compareframe8u.set_val_masked(25, noisy_pixels_mask, max_frame_size)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_compareframe8u), __pyx_kp_set_val_masked); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_3 = PyTuple_New(3); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_int_25);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_int_25);
  Py_INCREF(((PyObject *)__pyx_v_noisy_pixels_mask));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_noisy_pixels_mask));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 2, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = PyObject_Call(__pyx_1, ((PyObject *)__pyx_3), NULL); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 652; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(((PyObject *)__pyx_3)); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("realtime_image_analysis.bg_help_slow");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":655
 * 
 * 
 * def bg_help( FastImage.FastImage32f running_mean_im,             # <<<<<<<<<<<<<<
 *              FastImage.FastImage32f fastframef32_tmp,
 *              FastImage.FastImage32f running_sumsqf,
 */

static PyObject *__pyx_pf_23realtime_image_analysis_bg_help(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pf_23realtime_image_analysis_bg_help(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_mean_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_fastframef32_tmp = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_sumsqf = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_mean2 = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_stdframe = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_running_mean8u_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_hw_roi_frame = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_noisy_pixels_mask = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_compareframe8u = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *__pyx_v_max_frame_size = 0;
  float __pyx_v_ALPHA;
  double __pyx_v_C;
  PyObject *__pyx_r;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_running_mean_im,&__pyx_kp_3,&__pyx_kp_running_sumsqf,&__pyx_kp_4,&__pyx_kp_running_stdframe,&__pyx_kp_5,&__pyx_kp_hw_roi_frame,&__pyx_kp_noisy_pixels_mask,&__pyx_kp_6,&__pyx_kp_max_frame_size,&__pyx_kp_ALPHA,&__pyx_kp_C,0};
  __pyx_self = __pyx_self;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[12] = {0,0,0,0,0,0,0,0,0,0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case 12: values[11] = PyTuple_GET_ITEM(__pyx_args, 11);
      case 11: values[10] = PyTuple_GET_ITEM(__pyx_args, 10);
      case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
      case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
      case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
      case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
      case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_running_mean_im);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_3);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help", 1, 12, 12, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_running_sumsqf);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help", 1, 12, 12, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_4);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help", 1, 12, 12, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  4:
      values[4] = PyDict_GetItem(__pyx_kwds, __pyx_kp_running_stdframe);
      if (likely(values[4])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help", 1, 12, 12, 4); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  5:
      values[5] = PyDict_GetItem(__pyx_kwds, __pyx_kp_5);
      if (likely(values[5])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help", 1, 12, 12, 5); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  6:
      values[6] = PyDict_GetItem(__pyx_kwds, __pyx_kp_hw_roi_frame);
      if (likely(values[6])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help", 1, 12, 12, 6); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  7:
      values[7] = PyDict_GetItem(__pyx_kwds, __pyx_kp_noisy_pixels_mask);
      if (likely(values[7])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help", 1, 12, 12, 7); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  8:
      values[8] = PyDict_GetItem(__pyx_kwds, __pyx_kp_6);
      if (likely(values[8])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help", 1, 12, 12, 8); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  9:
      values[9] = PyDict_GetItem(__pyx_kwds, __pyx_kp_max_frame_size);
      if (likely(values[9])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help", 1, 12, 12, 9); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case 10:
      values[10] = PyDict_GetItem(__pyx_kwds, __pyx_kp_ALPHA);
      if (likely(values[10])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help", 1, 12, 12, 10); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case 11:
      values[11] = PyDict_GetItem(__pyx_kwds, __pyx_kp_C);
      if (likely(values[11])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("bg_help", 1, 12, 12, 11); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "bg_help") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_running_mean_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[0]);
    __pyx_v_fastframef32_tmp = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[1]);
    __pyx_v_running_sumsqf = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[2]);
    __pyx_v_mean2 = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[3]);
    __pyx_v_running_stdframe = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[4]);
    __pyx_v_running_mean8u_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)values[5]);
    __pyx_v_hw_roi_frame = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)values[6]);
    __pyx_v_noisy_pixels_mask = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)values[7]);
    __pyx_v_compareframe8u = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)values[8]);
    __pyx_v_max_frame_size = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)values[9]);
    __pyx_v_ALPHA = __pyx_PyFloat_AsDouble(values[10]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_C = __pyx_PyFloat_AsDouble(values[11]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  } else if (PyTuple_GET_SIZE(__pyx_args) != 12) {
    goto __pyx_L5_argtuple_error;
  } else {
    __pyx_v_running_mean_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 0));
    __pyx_v_fastframef32_tmp = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 1));
    __pyx_v_running_sumsqf = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 2));
    __pyx_v_mean2 = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 3));
    __pyx_v_running_stdframe = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 4));
    __pyx_v_running_mean8u_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)PyTuple_GET_ITEM(__pyx_args, 5));
    __pyx_v_hw_roi_frame = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)PyTuple_GET_ITEM(__pyx_args, 6));
    __pyx_v_noisy_pixels_mask = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)PyTuple_GET_ITEM(__pyx_args, 7));
    __pyx_v_compareframe8u = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)PyTuple_GET_ITEM(__pyx_args, 8));
    __pyx_v_max_frame_size = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)PyTuple_GET_ITEM(__pyx_args, 9));
    __pyx_v_ALPHA = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 10)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_C = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 11)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("bg_help", 1, 12, 12, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("realtime_image_analysis.bg_help");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_mean_im", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 655; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "fastframef32_tmp", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 656; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_sumsqf), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_sumsqf", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 657; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_mean2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "mean2", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 658; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_stdframe), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_stdframe", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 659; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean8u_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "running_mean8u_im", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 660; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_hw_roi_frame), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "hw_roi_frame", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 661; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_noisy_pixels_mask), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "noisy_pixels_mask", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 662; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_compareframe8u), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "compareframe8u", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 663; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_max_frame_size), __pyx_ptype_6motmot_9FastImage_9FastImage_Size, 1, "max_frame_size", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 664; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":668
 *              double C):
 * 
 *     c_python.Py_BEGIN_ALLOW_THREADS # release GIL             # <<<<<<<<<<<<<<
 *     # maintain running average
 *     #running_mean_im.fast_toself_add_weighted_8u( hw_roi_frame, max_frame_size, ALPHA ) # done
 */
  Py_BEGIN_ALLOW_THREADS;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":673
 *     CHK_NOGIL( fw.fwiAddWeighted_8u32f_C1IR( <fw.Fw8u*>hw_roi_frame.im, hw_roi_frame.step,
 *                                                <fw.Fw32f*>running_mean_im.im, running_mean_im.step,
 *                                                max_frame_size.sz, ALPHA))             # <<<<<<<<<<<<<<
 * 
 *     # maintain 8bit unsigned background image
 */
  CHK_NOGIL(fwiAddWeighted_8u32f_C1IR(((Fw8u *)__pyx_v_hw_roi_frame->__pyx_base.im), __pyx_v_hw_roi_frame->__pyx_base.step, ((Fw32f *)__pyx_v_running_mean_im->__pyx_base.im), __pyx_v_running_mean_im->__pyx_base.step, __pyx_v_max_frame_size->sz, __pyx_v_ALPHA));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":680
 *         <fw.Fw32f*>running_mean_im.im,running_mean_im.step,
 *         <fw.Fw8u*>running_mean8u_im.im,running_mean8u_im.step,
 *         max_frame_size.sz))             # <<<<<<<<<<<<<<
 * 
 *     # standard deviation calculation
 */
  CHK_NOGIL(fwiConvert_32f8u_C1R(((Fw32f *)__pyx_v_running_mean_im->__pyx_base.im), __pyx_v_running_mean_im->__pyx_base.step, ((Fw8u *)__pyx_v_running_mean8u_im->__pyx_base.im), __pyx_v_running_mean8u_im->__pyx_base.step, __pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":686
 *     CHK_NOGIL( fw.fwiConvert_8u32f_C1R(<fw.Fw8u*>hw_roi_frame.im, hw_roi_frame.step,
 *                                          <fw.Fw32f*>fastframef32_tmp.im, fastframef32_tmp.step,
 *                                          max_frame_size.sz ))             # <<<<<<<<<<<<<<
 * 
 *     #fastframef32_tmp.fast_toself_square(max_frame_size) # current**2 # done
 */
  CHK_NOGIL(fwiConvert_8u32f_C1R(((Fw8u *)__pyx_v_hw_roi_frame->__pyx_base.im), __pyx_v_hw_roi_frame->__pyx_base.step, ((Fw32f *)__pyx_v_fastframef32_tmp->__pyx_base.im), __pyx_v_fastframef32_tmp->__pyx_base.step, __pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":690
 *     #fastframef32_tmp.fast_toself_square(max_frame_size) # current**2 # done
 *     CHK_NOGIL( fw.fwiSqr_32f_C1IR( <fw.Fw32f*>fastframef32_tmp.im, fastframef32_tmp.step,
 *                                      max_frame_size.sz))             # <<<<<<<<<<<<<<
 * 
 *     #running_sumsqf.fast_toself_add_weighted_32f( fastframef32_tmp, max_frame_size, ALPHA) # done
 */
  CHK_NOGIL(fwiSqr_32f_C1IR(((Fw32f *)__pyx_v_fastframef32_tmp->__pyx_base.im), __pyx_v_fastframef32_tmp->__pyx_base.step, __pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":695
 *     CHK_NOGIL( fw.fwiAddWeighted_32f_C1IR( <fw.Fw32f*>fastframef32_tmp.im, fastframef32_tmp.step,
 *                                              <fw.Fw32f*>running_sumsqf.im, running_sumsqf.step,
 *                                              max_frame_size.sz, ALPHA))             # <<<<<<<<<<<<<<
 *     #running_mean_im.fast_get_square_put(mean2,max_frame_size) # done
 *     CHK_NOGIL( fw.fwiSqr_32f_C1R( <fw.Fw32f*>running_mean_im.im, running_mean_im.step,
 */
  CHK_NOGIL(fwiAddWeighted_32f_C1IR(((Fw32f *)__pyx_v_fastframef32_tmp->__pyx_base.im), __pyx_v_fastframef32_tmp->__pyx_base.step, ((Fw32f *)__pyx_v_running_sumsqf->__pyx_base.im), __pyx_v_running_sumsqf->__pyx_base.step, __pyx_v_max_frame_size->sz, __pyx_v_ALPHA));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":699
 *     CHK_NOGIL( fw.fwiSqr_32f_C1R( <fw.Fw32f*>running_mean_im.im, running_mean_im.step,
 *                                     <fw.Fw32f*>mean2.im, mean2.step,
 *                                     max_frame_size.sz))             # <<<<<<<<<<<<<<
 *     #running_sumsqf.fast_get_subtracted_put(mean2,running_stdframe,max_frame_size) # done
 *     CHK_NOGIL( fw.fwiSub_32f_C1R(<fw.Fw32f*>mean2.im, mean2.step,
 */
  CHK_NOGIL(fwiSqr_32f_C1R(((Fw32f *)__pyx_v_running_mean_im->__pyx_base.im), __pyx_v_running_mean_im->__pyx_base.step, ((Fw32f *)__pyx_v_mean2->__pyx_base.im), __pyx_v_mean2->__pyx_base.step, __pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":704
 *                                    <fw.Fw32f*>running_sumsqf.im, running_sumsqf.step,
 *                                    <fw.Fw32f*>running_stdframe.im, running_stdframe.step,
 *                                    max_frame_size.sz))             # <<<<<<<<<<<<<<
 * 
 *     # now create frame for comparison
 */
  CHK_NOGIL(fwiSub_32f_C1R(((Fw32f *)__pyx_v_mean2->__pyx_base.im), __pyx_v_mean2->__pyx_base.step, ((Fw32f *)__pyx_v_running_sumsqf->__pyx_base.im), __pyx_v_running_sumsqf->__pyx_base.step, ((Fw32f *)__pyx_v_running_stdframe->__pyx_base.im), __pyx_v_running_stdframe->__pyx_base.step, __pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":708
 *     # now create frame for comparison
 *     #running_stdframe.fast_toself_multiply(C,max_frame_size) # done
 *     CHK_NOGIL( fw.fwiMulC_32f_C1IR(C, <fw.Fw32f*>running_stdframe.im, running_stdframe.step, max_frame_size.sz))             # <<<<<<<<<<<<<<
 * 
 *     #running_stdframe.fast_get_8u_copy_put(compareframe8u,max_frame_size) # done
 */
  CHK_NOGIL(fwiMulC_32f_C1IR(__pyx_v_C, ((Fw32f *)__pyx_v_running_stdframe->__pyx_base.im), __pyx_v_running_stdframe->__pyx_base.step, __pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":714
 *         <fw.Fw32f*>running_stdframe.im,running_stdframe.step,
 *         <fw.Fw8u*>compareframe8u.im,compareframe8u.step,
 *         max_frame_size.sz))             # <<<<<<<<<<<<<<
 * 
 *     # now we do hack, erm, heuristic for bright points, which aren't gaussian.
 */
  CHK_NOGIL(fwiConvert_32f8u_C1R(((Fw32f *)__pyx_v_running_stdframe->__pyx_base.im), __pyx_v_running_stdframe->__pyx_base.step, ((Fw8u *)__pyx_v_compareframe8u->__pyx_base.im), __pyx_v_compareframe8u->__pyx_base.step, __pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":722
 *                                         <fw.Fw8u*>noisy_pixels_mask.im,noisy_pixels_mask.step,
 *                                         max_frame_size.sz,
 *                                         fw.fwCmpGreater))             # <<<<<<<<<<<<<<
 * 
 *     #compareframe8u.fast_set_val_masked(25, noisy_pixels_mask, max_frame_size) # done
 */
  CHK_NOGIL(fwiCompareC_8u_C1R(((Fw8u *)__pyx_v_running_mean8u_im->__pyx_base.im), __pyx_v_running_mean8u_im->__pyx_base.step, 200, ((Fw8u *)__pyx_v_noisy_pixels_mask->__pyx_base.im), __pyx_v_noisy_pixels_mask->__pyx_base.step, __pyx_v_max_frame_size->sz, fwCmpGreater));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":726
 *     #compareframe8u.fast_set_val_masked(25, noisy_pixels_mask, max_frame_size) # done
 *     CHK_NOGIL( fw.fwiSet_8u_C1MR( 25, <fw.Fw8u*>compareframe8u.im, compareframe8u.step, max_frame_size.sz,
 *                                     <fw.Fw8u*>noisy_pixels_mask.im, noisy_pixels_mask.step))             # <<<<<<<<<<<<<<
 *     c_python.Py_END_ALLOW_THREADS # acquire GIL
 * 
 */
  CHK_NOGIL(fwiSet_8u_C1MR(25, ((Fw8u *)__pyx_v_compareframe8u->__pyx_base.im), __pyx_v_compareframe8u->__pyx_base.step, __pyx_v_max_frame_size->sz, ((Fw8u *)__pyx_v_noisy_pixels_mask->__pyx_base.im), __pyx_v_noisy_pixels_mask->__pyx_base.step));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":727
 *     CHK_NOGIL( fw.fwiSet_8u_C1MR( 25, <fw.Fw8u*>compareframe8u.im, compareframe8u.step, max_frame_size.sz,
 *                                     <fw.Fw8u*>noisy_pixels_mask.im, noisy_pixels_mask.step))
 *     c_python.Py_END_ALLOW_THREADS # acquire GIL             # <<<<<<<<<<<<<<
 * 
 * def do_bg_maint( FastImage.FastImage32f running_mean_im,
 */
  Py_END_ALLOW_THREADS;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_AddTraceback("realtime_image_analysis.bg_help");
  __pyx_r = NULL;
  __pyx_L0:;
  return __pyx_r;
}

/* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":729
 *     c_python.Py_END_ALLOW_THREADS # acquire GIL
 * 
 * def do_bg_maint( FastImage.FastImage32f running_mean_im,             # <<<<<<<<<<<<<<
 *                  FastImage.FastImage8u hw_roi_frame,
 *                  FastImage.Size max_frame_size,
 */

static PyObject *__pyx_pf_23realtime_image_analysis_do_bg_maint(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_23realtime_image_analysis_do_bg_maint[] = "\n    = Arguments =\n\n    FastImage.FastImage32f running_mean_im   IO - current estimate of mean of x\n    FastImage.FastImage8u hw_roi_frame       Input - current image\n    FastImage.Size max_frame_size            Input - size of all images\n    float ALPHA                              Input\n    FastImage.FastImage8u running_mean8u_im  Output\n    FastImage.FastImage32f fastframef32_tmp  Output (temp/scratch)\n    FastImage.FastImage32f running_sumsqf    IO - current estimate of mean of x^2\n    FastImage.FastImage32f mean2             Output - running_mean_im^2\n    FastImage.FastImage32f std2              Output - running_sumsqf-mean2\n    FastImage.FastImage32f running_stdframe  Output - sqrt(std2)\n    float n_sigma                            Input\n    FastImage.FastImage8u compareframe8u     Output\n    int bright_non_gaussian_cutoff           Input\n    FastImage.FastImage8u noisy_pixels_mask  Input\n    int bright_non_gaussian_replacement      Input\n    int bench                                Input\n\n    = Returns =\n    Benchmarking information if bench != 0\n\n    ";
static PyObject *__pyx_pf_23realtime_image_analysis_do_bg_maint(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_mean_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_hw_roi_frame = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *__pyx_v_max_frame_size = 0;
  float __pyx_v_ALPHA;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_running_mean8u_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_fastframef32_tmp = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_sumsqf = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_mean2 = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_std2 = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_stdframe = 0;
  float __pyx_v_n_sigma;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_compareframe8u = 0;
  int __pyx_v_bright_non_gaussian_cutoff;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_noisy_pixels_mask = 0;
  int __pyx_v_bright_non_gaussian_replacement;
  int __pyx_v_bench;
  int __pyx_v_BENCHMARK;
  FwStatus __pyx_v_errval;
  double __pyx_v_t41;
  double __pyx_v_t42;
  double __pyx_v_t43;
  double __pyx_v_t44;
  double __pyx_v_t45;
  double __pyx_v_t46;
  double __pyx_v_t47;
  double __pyx_v_t48;
  double __pyx_v_t49;
  double __pyx_v_t491;
  double __pyx_v_t492;
  PyObject *__pyx_v_res;
  PyObject *__pyx_r;
  int __pyx_1;
  int __pyx_2;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  PyObject *__pyx_7 = 0;
  PyObject *__pyx_8 = 0;
  PyObject *__pyx_9 = 0;
  PyObject *__pyx_10 = 0;
  PyObject *__pyx_11 = 0;
  PyObject *__pyx_12 = 0;
  PyObject *__pyx_13 = 0;
  PyObject *__pyx_14 = 0;
  static PyObject **__pyx_pyargnames[] = {&__pyx_kp_running_mean_im,&__pyx_kp_hw_roi_frame,&__pyx_kp_max_frame_size,&__pyx_kp_ALPHA,&__pyx_kp_5,&__pyx_kp_3,&__pyx_kp_running_sumsqf,&__pyx_kp_4,&__pyx_kp_7,&__pyx_kp_running_stdframe,&__pyx_kp_n_sigma,&__pyx_kp_6,&__pyx_kp_8,&__pyx_kp_noisy_pixels_mask,&__pyx_kp_9,&__pyx_kp_bench,0};
  __pyx_self = __pyx_self;
  __pyx_v_bench = 0;
  if (unlikely(__pyx_kwds)) {
    PyObject* values[16] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    Py_ssize_t kw_args = PyDict_Size(__pyx_kwds);
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case 16: values[15] = PyTuple_GET_ITEM(__pyx_args, 15);
      case 15: values[14] = PyTuple_GET_ITEM(__pyx_args, 14);
      case 14: values[13] = PyTuple_GET_ITEM(__pyx_args, 13);
      case 13: values[12] = PyTuple_GET_ITEM(__pyx_args, 12);
      case 12: values[11] = PyTuple_GET_ITEM(__pyx_args, 11);
      case 11: values[10] = PyTuple_GET_ITEM(__pyx_args, 10);
      case 10: values[9] = PyTuple_GET_ITEM(__pyx_args, 9);
      case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
      case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
      case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
      case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
      case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
      case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
      case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
      case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
      case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
      case  0: break;
      default: goto __pyx_L5_argtuple_error;
    }
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case  0:
      values[0] = PyDict_GetItem(__pyx_kwds, __pyx_kp_running_mean_im);
      if (likely(values[0])) kw_args--;
      else goto __pyx_L5_argtuple_error;
      case  1:
      values[1] = PyDict_GetItem(__pyx_kwds, __pyx_kp_hw_roi_frame);
      if (likely(values[1])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_bg_maint", 0, 15, 16, 1); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  2:
      values[2] = PyDict_GetItem(__pyx_kwds, __pyx_kp_max_frame_size);
      if (likely(values[2])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_bg_maint", 0, 15, 16, 2); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  3:
      values[3] = PyDict_GetItem(__pyx_kwds, __pyx_kp_ALPHA);
      if (likely(values[3])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_bg_maint", 0, 15, 16, 3); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  4:
      values[4] = PyDict_GetItem(__pyx_kwds, __pyx_kp_5);
      if (likely(values[4])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_bg_maint", 0, 15, 16, 4); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  5:
      values[5] = PyDict_GetItem(__pyx_kwds, __pyx_kp_3);
      if (likely(values[5])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_bg_maint", 0, 15, 16, 5); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  6:
      values[6] = PyDict_GetItem(__pyx_kwds, __pyx_kp_running_sumsqf);
      if (likely(values[6])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_bg_maint", 0, 15, 16, 6); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  7:
      values[7] = PyDict_GetItem(__pyx_kwds, __pyx_kp_4);
      if (likely(values[7])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_bg_maint", 0, 15, 16, 7); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  8:
      values[8] = PyDict_GetItem(__pyx_kwds, __pyx_kp_7);
      if (likely(values[8])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_bg_maint", 0, 15, 16, 8); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case  9:
      values[9] = PyDict_GetItem(__pyx_kwds, __pyx_kp_running_stdframe);
      if (likely(values[9])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_bg_maint", 0, 15, 16, 9); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case 10:
      values[10] = PyDict_GetItem(__pyx_kwds, __pyx_kp_n_sigma);
      if (likely(values[10])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_bg_maint", 0, 15, 16, 10); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case 11:
      values[11] = PyDict_GetItem(__pyx_kwds, __pyx_kp_6);
      if (likely(values[11])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_bg_maint", 0, 15, 16, 11); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case 12:
      values[12] = PyDict_GetItem(__pyx_kwds, __pyx_kp_8);
      if (likely(values[12])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_bg_maint", 0, 15, 16, 12); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case 13:
      values[13] = PyDict_GetItem(__pyx_kwds, __pyx_kp_noisy_pixels_mask);
      if (likely(values[13])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_bg_maint", 0, 15, 16, 13); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
      case 14:
      values[14] = PyDict_GetItem(__pyx_kwds, __pyx_kp_9);
      if (likely(values[14])) kw_args--;
      else {
        __Pyx_RaiseArgtupleInvalid("do_bg_maint", 0, 15, 16, 14); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      }
    }
    if (unlikely(kw_args > 0)) {
      if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, PyTuple_GET_SIZE(__pyx_args), "do_bg_maint") < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
    __pyx_v_running_mean_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[0]);
    __pyx_v_hw_roi_frame = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)values[1]);
    __pyx_v_max_frame_size = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)values[2]);
    __pyx_v_ALPHA = __pyx_PyFloat_AsDouble(values[3]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_running_mean8u_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)values[4]);
    __pyx_v_fastframef32_tmp = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[5]);
    __pyx_v_running_sumsqf = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[6]);
    __pyx_v_mean2 = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[7]);
    __pyx_v_std2 = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[8]);
    __pyx_v_running_stdframe = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)values[9]);
    __pyx_v_n_sigma = __pyx_PyFloat_AsDouble(values[10]); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 739; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_compareframe8u = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)values[11]);
    __pyx_v_bright_non_gaussian_cutoff = __pyx_PyInt_int(values[12]); if (unlikely((__pyx_v_bright_non_gaussian_cutoff == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 741; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    __pyx_v_noisy_pixels_mask = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)values[13]);
    __pyx_v_bright_non_gaussian_replacement = __pyx_PyInt_int(values[14]); if (unlikely((__pyx_v_bright_non_gaussian_replacement == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 743; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    if (values[15]) {
      __pyx_v_bench = __pyx_PyInt_int(values[15]); if (unlikely((__pyx_v_bench == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
    }
  } else {
    switch (PyTuple_GET_SIZE(__pyx_args)) {
      case 16:
      __pyx_v_bench = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 15)); if (unlikely((__pyx_v_bench == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      case 15:
      __pyx_v_bright_non_gaussian_replacement = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 14)); if (unlikely((__pyx_v_bright_non_gaussian_replacement == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 743; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_noisy_pixels_mask = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)PyTuple_GET_ITEM(__pyx_args, 13));
      __pyx_v_bright_non_gaussian_cutoff = __pyx_PyInt_int(PyTuple_GET_ITEM(__pyx_args, 12)); if (unlikely((__pyx_v_bright_non_gaussian_cutoff == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 741; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_compareframe8u = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)PyTuple_GET_ITEM(__pyx_args, 11));
      __pyx_v_n_sigma = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 10)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 739; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_running_stdframe = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 9));
      __pyx_v_std2 = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 8));
      __pyx_v_mean2 = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 7));
      __pyx_v_running_sumsqf = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 6));
      __pyx_v_fastframef32_tmp = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 5));
      __pyx_v_running_mean8u_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)PyTuple_GET_ITEM(__pyx_args, 4));
      __pyx_v_ALPHA = __pyx_PyFloat_AsDouble(PyTuple_GET_ITEM(__pyx_args, 3)); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 732; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
      __pyx_v_max_frame_size = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)PyTuple_GET_ITEM(__pyx_args, 2));
      __pyx_v_hw_roi_frame = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)PyTuple_GET_ITEM(__pyx_args, 1));
      __pyx_v_running_mean_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *)PyTuple_GET_ITEM(__pyx_args, 0));
      break;
      default: goto __pyx_L5_argtuple_error;
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  __Pyx_RaiseArgtupleInvalid("do_bg_maint", 0, 15, 16, PyTuple_GET_SIZE(__pyx_args)); {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L3_error;}
  __pyx_L3_error:;
  __Pyx_AddTraceback("realtime_image_analysis.do_bg_maint");
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_v_res = Py_None; Py_INCREF(Py_None);
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_mean_im", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 729; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_hw_roi_frame), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "hw_roi_frame", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 730; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_max_frame_size), __pyx_ptype_6motmot_9FastImage_9FastImage_Size, 1, "max_frame_size", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 731; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean8u_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "running_mean8u_im", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 733; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "fastframef32_tmp", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 734; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_sumsqf), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_sumsqf", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 735; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_mean2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "mean2", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 736; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_std2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "std2", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 737; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_stdframe), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_stdframe", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 738; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_compareframe8u), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "compareframe8u", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 740; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_noisy_pixels_mask), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "noisy_pixels_mask", 0))) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 742; __pyx_clineno = __LINE__; goto __pyx_L1_error;}

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":773
 *     cdef fw.FwStatus errval
 * 
 *     BENCHMARK = bench             # <<<<<<<<<<<<<<
 *     cdef double t41, t42, t43, t44, t45, t46, t47, t48, t49, t491, t492
 * 
 */
  __pyx_v_BENCHMARK = __pyx_v_bench;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":776
 *     cdef double t41, t42, t43, t44, t45, t46, t47, t48, t49, t491, t492
 * 
 *     c_python.Py_BEGIN_ALLOW_THREADS             # <<<<<<<<<<<<<<
 * 
 *     # maintain running average
 */
  Py_BEGIN_ALLOW_THREADS;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":782
 *     CHK_NOGIL( fw.fwiAddWeighted_8u32f_C1IR( <fw.Fw8u*>hw_roi_frame.im, hw_roi_frame.step,
 *                                                <fw.Fw32f*>running_mean_im.im, running_mean_im.step,
 *                                                max_frame_size.sz, ALPHA))             # <<<<<<<<<<<<<<
 *     if BENCHMARK:
 *         t41 = time_time()
 */
  CHK_NOGIL(fwiAddWeighted_8u32f_C1IR(((Fw8u *)__pyx_v_hw_roi_frame->__pyx_base.im), __pyx_v_hw_roi_frame->__pyx_base.step, ((Fw32f *)__pyx_v_running_mean_im->__pyx_base.im), __pyx_v_running_mean_im->__pyx_base.step, __pyx_v_max_frame_size->sz, __pyx_v_ALPHA));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":783
 *                                                <fw.Fw32f*>running_mean_im.im, running_mean_im.step,
 *                                                max_frame_size.sz, ALPHA))
 *     if BENCHMARK:             # <<<<<<<<<<<<<<
 *         t41 = time_time()
 * 
 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":784
 *                                                max_frame_size.sz, ALPHA))
 *     if BENCHMARK:
 *         t41 = time_time()             # <<<<<<<<<<<<<<
 * 
 *     CHK_NOGIL( fw.fwiConvert_32f8u_C1R(
 */
    __pyx_v_t41 = time_time();
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":789
 *         <fw.Fw32f*>running_mean_im.im,running_mean_im.step,
 *         <fw.Fw8u*>running_mean8u_im.im,running_mean8u_im.step,
 *         max_frame_size.sz))             # <<<<<<<<<<<<<<
 * 
 *     if BENCHMARK:
 */
  CHK_NOGIL(fwiConvert_32f8u_C1R(((Fw32f *)__pyx_v_running_mean_im->__pyx_base.im), __pyx_v_running_mean_im->__pyx_base.step, ((Fw8u *)__pyx_v_running_mean8u_im->__pyx_base.im), __pyx_v_running_mean8u_im->__pyx_base.step, __pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":791
 *         max_frame_size.sz))
 * 
 *     if BENCHMARK:             # <<<<<<<<<<<<<<
 *         t42 = time_time()
 * 
 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":792
 * 
 *     if BENCHMARK:
 *         t42 = time_time()             # <<<<<<<<<<<<<<
 * 
 *     # standard deviation calculation
 */
    __pyx_v_t42 = time_time();
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":797
 *     CHK_NOGIL( fw.fwiConvert_8u32f_C1R(<fw.Fw8u*>hw_roi_frame.im, hw_roi_frame.step,
 *                                          <fw.Fw32f*>fastframef32_tmp.im, fastframef32_tmp.step,
 *                                          max_frame_size.sz ))             # <<<<<<<<<<<<<<
 *     if BENCHMARK:
 *         t43 = time_time()
 */
  CHK_NOGIL(fwiConvert_8u32f_C1R(((Fw8u *)__pyx_v_hw_roi_frame->__pyx_base.im), __pyx_v_hw_roi_frame->__pyx_base.step, ((Fw32f *)__pyx_v_fastframef32_tmp->__pyx_base.im), __pyx_v_fastframef32_tmp->__pyx_base.step, __pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":798
 *                                          <fw.Fw32f*>fastframef32_tmp.im, fastframef32_tmp.step,
 *                                          max_frame_size.sz ))
 *     if BENCHMARK:             # <<<<<<<<<<<<<<
 *         t43 = time_time()
 * 
 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":799
 *                                          max_frame_size.sz ))
 *     if BENCHMARK:
 *         t43 = time_time()             # <<<<<<<<<<<<<<
 * 
 *     # x^2
 */
    __pyx_v_t43 = time_time();
    goto __pyx_L8;
  }
  __pyx_L8:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":803
 *     # x^2
 *     CHK_NOGIL( fw.fwiSqr_32f_C1IR( <fw.Fw32f*>fastframef32_tmp.im, fastframef32_tmp.step,
 *                                      max_frame_size.sz))             # <<<<<<<<<<<<<<
 *     if BENCHMARK:
 *         t44 = time_time()
 */
  CHK_NOGIL(fwiSqr_32f_C1IR(((Fw32f *)__pyx_v_fastframef32_tmp->__pyx_base.im), __pyx_v_fastframef32_tmp->__pyx_base.step, __pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":804
 *     CHK_NOGIL( fw.fwiSqr_32f_C1IR( <fw.Fw32f*>fastframef32_tmp.im, fastframef32_tmp.step,
 *                                      max_frame_size.sz))
 *     if BENCHMARK:             # <<<<<<<<<<<<<<
 *         t44 = time_time()
 * 
 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":805
 *                                      max_frame_size.sz))
 *     if BENCHMARK:
 *         t44 = time_time()             # <<<<<<<<<<<<<<
 * 
 *     # <x^2>
 */
    __pyx_v_t44 = time_time();
    goto __pyx_L9;
  }
  __pyx_L9:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":810
 *     CHK_NOGIL( fw.fwiAddWeighted_32f_C1IR( <fw.Fw32f*>fastframef32_tmp.im, fastframef32_tmp.step,
 *                                              <fw.Fw32f*>running_sumsqf.im, running_sumsqf.step,
 *                                              max_frame_size.sz, ALPHA))             # <<<<<<<<<<<<<<
 *     if BENCHMARK:
 *         t45 = time_time()
 */
  CHK_NOGIL(fwiAddWeighted_32f_C1IR(((Fw32f *)__pyx_v_fastframef32_tmp->__pyx_base.im), __pyx_v_fastframef32_tmp->__pyx_base.step, ((Fw32f *)__pyx_v_running_sumsqf->__pyx_base.im), __pyx_v_running_sumsqf->__pyx_base.step, __pyx_v_max_frame_size->sz, __pyx_v_ALPHA));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":811
 *                                              <fw.Fw32f*>running_sumsqf.im, running_sumsqf.step,
 *                                              max_frame_size.sz, ALPHA))
 *     if BENCHMARK:             # <<<<<<<<<<<<<<
 *         t45 = time_time()
 * 
 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":812
 *                                              max_frame_size.sz, ALPHA))
 *     if BENCHMARK:
 *         t45 = time_time()             # <<<<<<<<<<<<<<
 * 
 *     ### GETS SLOWER
 */
    __pyx_v_t45 = time_time();
    goto __pyx_L10;
  }
  __pyx_L10:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":818
 *     CHK_NOGIL( fw.fwiSqr_32f_C1R( <fw.Fw32f*>running_mean_im.im, running_mean_im.step,
 *                                     <fw.Fw32f*>mean2.im, mean2.step,
 *                                     max_frame_size.sz))             # <<<<<<<<<<<<<<
 *     if BENCHMARK:
 *         t46 = time_time()
 */
  CHK_NOGIL(fwiSqr_32f_C1R(((Fw32f *)__pyx_v_running_mean_im->__pyx_base.im), __pyx_v_running_mean_im->__pyx_base.step, ((Fw32f *)__pyx_v_mean2->__pyx_base.im), __pyx_v_mean2->__pyx_base.step, __pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":819
 *                                     <fw.Fw32f*>mean2.im, mean2.step,
 *                                     max_frame_size.sz))
 *     if BENCHMARK:             # <<<<<<<<<<<<<<
 *         t46 = time_time()
 * 
 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":820
 *                                     max_frame_size.sz))
 *     if BENCHMARK:
 *         t46 = time_time()             # <<<<<<<<<<<<<<
 * 
 *     # <x^2> - <x>^2
 */
    __pyx_v_t46 = time_time();
    goto __pyx_L11;
  }
  __pyx_L11:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":826
 *                                    <fw.Fw32f*>running_sumsqf.im, running_sumsqf.step,
 *                                    <fw.Fw32f*>std2.im, std2.step,
 *                                    max_frame_size.sz))             # <<<<<<<<<<<<<<
 * 
 *     # sqrt( |<x^2> - <x>^2| )
 */
  CHK_NOGIL(fwiSub_32f_C1R(((Fw32f *)__pyx_v_mean2->__pyx_base.im), __pyx_v_mean2->__pyx_base.step, ((Fw32f *)__pyx_v_running_sumsqf->__pyx_base.im), __pyx_v_running_sumsqf->__pyx_base.step, ((Fw32f *)__pyx_v_std2->__pyx_base.im), __pyx_v_std2->__pyx_base.step, __pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":834
 *                                    <fw.Fw32f*>running_stdframe.im,
 *                                    running_stdframe.step,
 *                                    max_frame_size.sz))             # <<<<<<<<<<<<<<
 *     errval= fw.fwiSqrt_32f_C1IR(<fw.Fw32f*>running_stdframe.im,
 *                                   running_stdframe.step,
 */
  CHK_NOGIL(fwiAbs_32f_C1R(((Fw32f *)__pyx_v_std2->__pyx_base.im), __pyx_v_std2->__pyx_base.step, ((Fw32f *)__pyx_v_running_stdframe->__pyx_base.im), __pyx_v_running_stdframe->__pyx_base.step, __pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":837
 *     errval= fw.fwiSqrt_32f_C1IR(<fw.Fw32f*>running_stdframe.im,
 *                                   running_stdframe.step,
 *                                   max_frame_size.sz)             # <<<<<<<<<<<<<<
 *     CHK_NOGIL(errval)
 * 
 */
  __pyx_v_errval = fwiSqrt_32f_C1IR(((Fw32f *)__pyx_v_running_stdframe->__pyx_base.im), __pyx_v_running_stdframe->__pyx_base.step, __pyx_v_max_frame_size->sz);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":838
 *                                   running_stdframe.step,
 *                                   max_frame_size.sz)
 *     CHK_NOGIL(errval)             # <<<<<<<<<<<<<<
 * 
 *     if BENCHMARK:
 */
  CHK_NOGIL(__pyx_v_errval);

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":840
 *     CHK_NOGIL(errval)
 * 
 *     if BENCHMARK:             # <<<<<<<<<<<<<<
 *         t47 = time_time()
 * 
 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":841
 * 
 *     if BENCHMARK:
 *         t47 = time_time()             # <<<<<<<<<<<<<<
 * 
 *     # now create frame for comparison
 */
    __pyx_v_t47 = time_time();
    goto __pyx_L12;
  }
  __pyx_L12:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":844
 * 
 *     # now create frame for comparison
 *     if n_sigma != 1.0:             # <<<<<<<<<<<<<<
 *         CHK_NOGIL( fw.fwiMulC_32f_C1IR(n_sigma, <fw.Fw32f*>running_stdframe.im, running_stdframe.step, max_frame_size.sz))
 * 
 */
  __pyx_2 = (__pyx_v_n_sigma != 1.0);
  if (__pyx_2) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":845
 *     # now create frame for comparison
 *     if n_sigma != 1.0:
 *         CHK_NOGIL( fw.fwiMulC_32f_C1IR(n_sigma, <fw.Fw32f*>running_stdframe.im, running_stdframe.step, max_frame_size.sz))             # <<<<<<<<<<<<<<
 * 
 *     if BENCHMARK:
 */
    CHK_NOGIL(fwiMulC_32f_C1IR(__pyx_v_n_sigma, ((Fw32f *)__pyx_v_running_stdframe->__pyx_base.im), __pyx_v_running_stdframe->__pyx_base.step, __pyx_v_max_frame_size->sz));
    goto __pyx_L13;
  }
  __pyx_L13:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":847
 *         CHK_NOGIL( fw.fwiMulC_32f_C1IR(n_sigma, <fw.Fw32f*>running_stdframe.im, running_stdframe.step, max_frame_size.sz))
 * 
 *     if BENCHMARK:             # <<<<<<<<<<<<<<
 *         t48 = time_time()
 * 
 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":848
 * 
 *     if BENCHMARK:
 *         t48 = time_time()             # <<<<<<<<<<<<<<
 * 
 *     CHK_NOGIL( fw.fwiConvert_32f8u_C1R(
 */
    __pyx_v_t48 = time_time();
    goto __pyx_L14;
  }
  __pyx_L14:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":853
 *         <fw.Fw32f*>running_stdframe.im,running_stdframe.step,
 *         <fw.Fw8u*>compareframe8u.im,compareframe8u.step,
 *         max_frame_size.sz))             # <<<<<<<<<<<<<<
 * 
 *     if BENCHMARK:
 */
  CHK_NOGIL(fwiConvert_32f8u_C1R(((Fw32f *)__pyx_v_running_stdframe->__pyx_base.im), __pyx_v_running_stdframe->__pyx_base.step, ((Fw8u *)__pyx_v_compareframe8u->__pyx_base.im), __pyx_v_compareframe8u->__pyx_base.step, __pyx_v_max_frame_size->sz));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":855
 *         max_frame_size.sz))
 * 
 *     if BENCHMARK:             # <<<<<<<<<<<<<<
 *         t49 = time_time()
 * 
 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":856
 * 
 *     if BENCHMARK:
 *         t49 = time_time()             # <<<<<<<<<<<<<<
 * 
 *     # now we do hack, erm, heuristic for bright points, which aren't gaussian.
 */
    __pyx_v_t49 = time_time();
    goto __pyx_L15;
  }
  __pyx_L15:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":862
 *                                         bright_non_gaussian_cutoff,
 *                                         <fw.Fw8u*>noisy_pixels_mask.im,noisy_pixels_mask.step,
 *                                         max_frame_size.sz,fw.fwCmpGreater))             # <<<<<<<<<<<<<<
 * 
 *     if BENCHMARK:
 */
  CHK_NOGIL(fwiCompareC_8u_C1R(((Fw8u *)__pyx_v_running_mean8u_im->__pyx_base.im), __pyx_v_running_mean8u_im->__pyx_base.step, __pyx_v_bright_non_gaussian_cutoff, ((Fw8u *)__pyx_v_noisy_pixels_mask->__pyx_base.im), __pyx_v_noisy_pixels_mask->__pyx_base.step, __pyx_v_max_frame_size->sz, fwCmpGreater));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":864
 *                                         max_frame_size.sz,fw.fwCmpGreater))
 * 
 *     if BENCHMARK:             # <<<<<<<<<<<<<<
 *         t491 = time_time()
 * 
 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":865
 * 
 *     if BENCHMARK:
 *         t491 = time_time()             # <<<<<<<<<<<<<<
 * 
 *     CHK_NOGIL( fw.fwiSet_8u_C1MR( bright_non_gaussian_replacement,
 */
    __pyx_v_t491 = time_time();
    goto __pyx_L16;
  }
  __pyx_L16:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":869
 *     CHK_NOGIL( fw.fwiSet_8u_C1MR( bright_non_gaussian_replacement,
 *                                     <fw.Fw8u*>compareframe8u.im, compareframe8u.step, max_frame_size.sz,
 *                                     <fw.Fw8u*>noisy_pixels_mask.im, noisy_pixels_mask.step))             # <<<<<<<<<<<<<<
 *     if BENCHMARK:
 *         t492 = time_time()
 */
  CHK_NOGIL(fwiSet_8u_C1MR(__pyx_v_bright_non_gaussian_replacement, ((Fw8u *)__pyx_v_compareframe8u->__pyx_base.im), __pyx_v_compareframe8u->__pyx_base.step, __pyx_v_max_frame_size->sz, ((Fw8u *)__pyx_v_noisy_pixels_mask->__pyx_base.im), __pyx_v_noisy_pixels_mask->__pyx_base.step));

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":870
 *                                     <fw.Fw8u*>compareframe8u.im, compareframe8u.step, max_frame_size.sz,
 *                                     <fw.Fw8u*>noisy_pixels_mask.im, noisy_pixels_mask.step))
 *     if BENCHMARK:             # <<<<<<<<<<<<<<
 *         t492 = time_time()
 * 
 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":871
 *                                     <fw.Fw8u*>noisy_pixels_mask.im, noisy_pixels_mask.step))
 *     if BENCHMARK:
 *         t492 = time_time()             # <<<<<<<<<<<<<<
 * 
 *     c_python.Py_END_ALLOW_THREADS
 */
    __pyx_v_t492 = time_time();
    goto __pyx_L17;
  }
  __pyx_L17:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":873
 *         t492 = time_time()
 * 
 *     c_python.Py_END_ALLOW_THREADS             # <<<<<<<<<<<<<<
 * 
 *     if BENCHMARK:
 */
  Py_END_ALLOW_THREADS;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":875
 *     c_python.Py_END_ALLOW_THREADS
 * 
 *     if BENCHMARK:             # <<<<<<<<<<<<<<
 *         res = t41, t42, t43, t44, t45, t46, t47, t48, t49, t491, t492
 *     else:
 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":876
 * 
 *     if BENCHMARK:
 *         res = t41, t42, t43, t44, t45, t46, t47, t48, t49, t491, t492             # <<<<<<<<<<<<<<
 *     else:
 *         res = None
 */
    __pyx_3 = PyFloat_FromDouble(__pyx_v_t41); if (unlikely(!__pyx_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_4 = PyFloat_FromDouble(__pyx_v_t42); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_5 = PyFloat_FromDouble(__pyx_v_t43); if (unlikely(!__pyx_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_6 = PyFloat_FromDouble(__pyx_v_t44); if (unlikely(!__pyx_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_7 = PyFloat_FromDouble(__pyx_v_t45); if (unlikely(!__pyx_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_8 = PyFloat_FromDouble(__pyx_v_t46); if (unlikely(!__pyx_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_9 = PyFloat_FromDouble(__pyx_v_t47); if (unlikely(!__pyx_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_10 = PyFloat_FromDouble(__pyx_v_t48); if (unlikely(!__pyx_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_11 = PyFloat_FromDouble(__pyx_v_t49); if (unlikely(!__pyx_11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_12 = PyFloat_FromDouble(__pyx_v_t491); if (unlikely(!__pyx_12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_13 = PyFloat_FromDouble(__pyx_v_t492); if (unlikely(!__pyx_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    __pyx_14 = PyTuple_New(11); if (unlikely(!__pyx_14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
    PyTuple_SET_ITEM(__pyx_14, 0, __pyx_3);
    PyTuple_SET_ITEM(__pyx_14, 1, __pyx_4);
    PyTuple_SET_ITEM(__pyx_14, 2, __pyx_5);
    PyTuple_SET_ITEM(__pyx_14, 3, __pyx_6);
    PyTuple_SET_ITEM(__pyx_14, 4, __pyx_7);
    PyTuple_SET_ITEM(__pyx_14, 5, __pyx_8);
    PyTuple_SET_ITEM(__pyx_14, 6, __pyx_9);
    PyTuple_SET_ITEM(__pyx_14, 7, __pyx_10);
    PyTuple_SET_ITEM(__pyx_14, 8, __pyx_11);
    PyTuple_SET_ITEM(__pyx_14, 9, __pyx_12);
    PyTuple_SET_ITEM(__pyx_14, 10, __pyx_13);
    __pyx_3 = 0;
    __pyx_4 = 0;
    __pyx_5 = 0;
    __pyx_6 = 0;
    __pyx_7 = 0;
    __pyx_8 = 0;
    __pyx_9 = 0;
    __pyx_10 = 0;
    __pyx_11 = 0;
    __pyx_12 = 0;
    __pyx_13 = 0;
    Py_DECREF(__pyx_v_res);
    __pyx_v_res = ((PyObject *)__pyx_14);
    __pyx_14 = 0;
    goto __pyx_L18;
  }
  /*else*/ {

    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":878
 *         res = t41, t42, t43, t44, t45, t46, t47, t48, t49, t491, t492
 *     else:
 *         res = None             # <<<<<<<<<<<<<<
 *     return res
 * 
 */
    Py_INCREF(Py_None);
    Py_DECREF(__pyx_v_res);
    __pyx_v_res = Py_None;
  }
  __pyx_L18:;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":879
 *     else:
 *         res = None
 *     return res             # <<<<<<<<<<<<<<
 * 
 * 
 */
  Py_INCREF(__pyx_v_res);
  __pyx_r = __pyx_v_res;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  Py_XDECREF(__pyx_7);
  Py_XDECREF(__pyx_8);
  Py_XDECREF(__pyx_9);
  Py_XDECREF(__pyx_10);
  Py_XDECREF(__pyx_11);
  Py_XDECREF(__pyx_12);
  Py_XDECREF(__pyx_13);
  Py_XDECREF(__pyx_14);
  __Pyx_AddTraceback("realtime_image_analysis.do_bg_maint");
  __pyx_r = NULL;
  __pyx_L0:;
  Py_DECREF(__pyx_v_res);
  return __pyx_r;
}

static PyObject *__pyx_tp_new_23realtime_image_analysis_FitParamsClass(PyTypeObject *t, PyObject *a, PyObject *k) {
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  if (__pyx_pf_23realtime_image_analysis_14FitParamsClass___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_23realtime_image_analysis_FitParamsClass(PyObject *o) {
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pf_23realtime_image_analysis_14FitParamsClass___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  (*Py_TYPE(o)->tp_free)(o);
}

static struct PyMethodDef __pyx_methods_23realtime_image_analysis_FitParamsClass[] = {
  {"fit", (PyCFunction)__pyx_pf_23realtime_image_analysis_14FitParamsClass_fit, METH_O, 0},
  {0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_FitParamsClass = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_FitParamsClass = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_FitParamsClass = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_FitParamsClass = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_23realtime_image_analysis_FitParamsClass = {
  PyVarObject_HEAD_INIT(0, 0)
  "realtime_image_analysis.FitParamsClass", /*tp_name*/
  sizeof(struct __pyx_obj_23realtime_image_analysis_FitParamsClass), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_23realtime_image_analysis_FitParamsClass, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_FitParamsClass, /*tp_as_number*/
  &__pyx_tp_as_sequence_FitParamsClass, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_FitParamsClass, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_FitParamsClass, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER, /*tp_flags*/
  0, /*tp_doc*/
  0, /*tp_traverse*/
  0, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_23realtime_image_analysis_FitParamsClass, /*tp_methods*/
  0, /*tp_members*/
  0, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  0, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_23realtime_image_analysis_FitParamsClass, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static PyObject *__pyx_tp_new_23realtime_image_analysis_RealtimeAnalyzer(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *p;
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  p = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)o);
  p->_roi_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)Py_None); Py_INCREF(Py_None);
  p->absdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->cmpdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->absdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->cmpdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->absdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->cmpdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->mask_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->mean_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->cmp_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->mean_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->cmp_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->imname2im = Py_None; Py_INCREF(Py_None);
  if (__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer___cinit__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_23realtime_image_analysis_RealtimeAnalyzer(PyObject *o) {
  struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *p = (struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)o;
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++Py_REFCNT(o);
    __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --Py_REFCNT(o);
    PyErr_Restore(etype, eval, etb);
  }
  Py_XDECREF(((PyObject *)p->_roi_sz));
  Py_XDECREF(((PyObject *)p->absdiff_im));
  Py_XDECREF(((PyObject *)p->cmpdiff_im));
  Py_XDECREF(((PyObject *)p->absdiff_im_roi_view));
  Py_XDECREF(((PyObject *)p->cmpdiff_im_roi_view));
  Py_XDECREF(((PyObject *)p->absdiff_im_roi2_view));
  Py_XDECREF(((PyObject *)p->cmpdiff_im_roi2_view));
  Py_XDECREF(((PyObject *)p->mask_im));
  Py_XDECREF(((PyObject *)p->mean_im));
  Py_XDECREF(((PyObject *)p->cmp_im));
  Py_XDECREF(((PyObject *)p->mean_im_roi_view));
  Py_XDECREF(((PyObject *)p->cmp_im_roi_view));
  Py_XDECREF(p->imname2im);
  (*Py_TYPE(o)->tp_free)(o);
}

static int __pyx_tp_traverse_23realtime_image_analysis_RealtimeAnalyzer(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *p = (struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)o;
  if (p->_roi_sz) {
    e = (*v)(((PyObject*)p->_roi_sz), a); if (e) return e;
  }
  if (p->absdiff_im) {
    e = (*v)(((PyObject*)p->absdiff_im), a); if (e) return e;
  }
  if (p->cmpdiff_im) {
    e = (*v)(((PyObject*)p->cmpdiff_im), a); if (e) return e;
  }
  if (p->absdiff_im_roi_view) {
    e = (*v)(((PyObject*)p->absdiff_im_roi_view), a); if (e) return e;
  }
  if (p->cmpdiff_im_roi_view) {
    e = (*v)(((PyObject*)p->cmpdiff_im_roi_view), a); if (e) return e;
  }
  if (p->absdiff_im_roi2_view) {
    e = (*v)(((PyObject*)p->absdiff_im_roi2_view), a); if (e) return e;
  }
  if (p->cmpdiff_im_roi2_view) {
    e = (*v)(((PyObject*)p->cmpdiff_im_roi2_view), a); if (e) return e;
  }
  if (p->mask_im) {
    e = (*v)(((PyObject*)p->mask_im), a); if (e) return e;
  }
  if (p->mean_im) {
    e = (*v)(((PyObject*)p->mean_im), a); if (e) return e;
  }
  if (p->cmp_im) {
    e = (*v)(((PyObject*)p->cmp_im), a); if (e) return e;
  }
  if (p->mean_im_roi_view) {
    e = (*v)(((PyObject*)p->mean_im_roi_view), a); if (e) return e;
  }
  if (p->cmp_im_roi_view) {
    e = (*v)(((PyObject*)p->cmp_im_roi_view), a); if (e) return e;
  }
  if (p->imname2im) {
    e = (*v)(p->imname2im, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_23realtime_image_analysis_RealtimeAnalyzer(PyObject *o) {
  struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *p = (struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)o;
  PyObject* tmp;
  tmp = ((PyObject*)p->_roi_sz);
  p->_roi_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->absdiff_im);
  p->absdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->cmpdiff_im);
  p->cmpdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->absdiff_im_roi_view);
  p->absdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->cmpdiff_im_roi_view);
  p->cmpdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->absdiff_im_roi2_view);
  p->absdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->cmpdiff_im_roi2_view);
  p->cmpdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->mask_im);
  p->mask_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->mean_im);
  p->mean_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->cmp_im);
  p->cmp_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->mean_im_roi_view);
  p->mean_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->cmp_im_roi_view);
  p->cmp_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  tmp = ((PyObject*)p->imname2im);
  p->imname2im = Py_None; Py_INCREF(Py_None);
  Py_XDECREF(tmp);
  return 0;
}

static PyObject *__pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_roi2_radius(PyObject *o, void *x) {
  return __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___get__(o);
}

static int __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_roi2_radius(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_clear_threshold(PyObject *o, void *x) {
  return __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___get__(o);
}

static int __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_clear_threshold(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_diff_threshold(PyObject *o, void *x) {
  return __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___get__(o);
}

static int __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_diff_threshold(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_scale_factor(PyObject *o, void *x) {
  return __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___get__(o);
}

static int __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_scale_factor(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_roi(PyObject *o, void *x) {
  return __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_3roi___get__(o);
}

static int __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_roi(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_3roi___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static struct PyMethodDef __pyx_methods_23realtime_image_analysis_RealtimeAnalyzer[] = {
  {"distort", (PyCFunction)__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_distort, METH_VARARGS|METH_KEYWORDS, 0},
  {"do_work", (PyCFunction)__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_do_work, METH_VARARGS|METH_KEYWORDS, __pyx_doc_23realtime_image_analysis_16RealtimeAnalyzer_do_work},
  {"get_image_view", (PyCFunction)__pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer_get_image_view, METH_VARARGS|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_23realtime_image_analysis_RealtimeAnalyzer[] = {
  {"roi2_radius", __pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_roi2_radius, __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_roi2_radius, 0, 0},
  {"clear_threshold", __pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_clear_threshold, __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_clear_threshold, 0, 0},
  {"diff_threshold", __pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_diff_threshold, __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_diff_threshold, 0, 0},
  {"scale_factor", __pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_scale_factor, __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_scale_factor, 0, 0},
  {"roi", __pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_roi, __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_roi, 0, 0},
  {0, 0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_RealtimeAnalyzer = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_divide*/
  #endif
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_coerce*/
  #endif
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_oct*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*nb_hex*/
  #endif
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  #if PY_MAJOR_VERSION < 3
  0, /*nb_inplace_divide*/
  #endif
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if (PY_MAJOR_VERSION >= 3) || (Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX)
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_RealtimeAnalyzer = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_RealtimeAnalyzer = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_RealtimeAnalyzer = {
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getreadbuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getwritebuffer*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getsegcount*/
  #endif
  #if PY_MAJOR_VERSION < 3
  0, /*bf_getcharbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_getbuffer*/
  #endif
  #if PY_VERSION_HEX >= 0x02060000
  0, /*bf_releasebuffer*/
  #endif
};

PyTypeObject __pyx_type_23realtime_image_analysis_RealtimeAnalyzer = {
  PyVarObject_HEAD_INIT(0, 0)
  "realtime_image_analysis.RealtimeAnalyzer", /*tp_name*/
  sizeof(struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_23realtime_image_analysis_RealtimeAnalyzer, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_RealtimeAnalyzer, /*tp_as_number*/
  &__pyx_tp_as_sequence_RealtimeAnalyzer, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_RealtimeAnalyzer, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_RealtimeAnalyzer, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_23realtime_image_analysis_RealtimeAnalyzer, /*tp_traverse*/
  __pyx_tp_clear_23realtime_image_analysis_RealtimeAnalyzer, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_23realtime_image_analysis_RealtimeAnalyzer, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_23realtime_image_analysis_RealtimeAnalyzer, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_pf_23realtime_image_analysis_16RealtimeAnalyzer___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_23realtime_image_analysis_RealtimeAnalyzer, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static struct PyMethodDef __pyx_methods[] = {
  {"py_fit_params", (PyCFunction)__pyx_pf_23realtime_image_analysis_py_fit_params, METH_O, 0},
  {"fit_slope", (PyCFunction)__pyx_pf_23realtime_image_analysis_fit_slope, METH_O, 0},
  {"bg_help_slow", (PyCFunction)__pyx_pf_23realtime_image_analysis_bg_help_slow, METH_VARARGS|METH_KEYWORDS, 0},
  {"bg_help", (PyCFunction)__pyx_pf_23realtime_image_analysis_bg_help, METH_VARARGS|METH_KEYWORDS, 0},
  {"do_bg_maint", (PyCFunction)__pyx_pf_23realtime_image_analysis_do_bg_maint, METH_VARARGS|METH_KEYWORDS, __pyx_doc_23realtime_image_analysis_do_bg_maint},
  {0, 0, 0, 0}
};

static void __pyx_init_filenames(void); /*proto*/

#if PY_MAJOR_VERSION >= 3
static struct PyModuleDef __pyx_moduledef = {
    PyModuleDef_HEAD_INIT,
    "realtime_image_analysis",
    0, /* m_doc */
    -1, /* m_size */
    __pyx_methods /* m_methods */,
    NULL, /* m_reload */
    NULL, /* m_traverse */
    NULL, /* m_clear */
    NULL /* m_free */
};
#endif

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_kp___cinit__, __pyx_k___cinit__, sizeof(__pyx_k___cinit__), 1, 1, 1},
  {&__pyx_kp___dealloc__, __pyx_k___dealloc__, sizeof(__pyx_k___dealloc__), 1, 1, 1},
  {&__pyx_kp_fit, __pyx_k_fit, sizeof(__pyx_k_fit), 1, 1, 1},
  {&__pyx_kp___init__, __pyx_k___init__, sizeof(__pyx_k___init__), 1, 1, 1},
  {&__pyx_kp_distort, __pyx_k_distort, sizeof(__pyx_k_distort), 1, 1, 1},
  {&__pyx_kp_do_work, __pyx_k_do_work, sizeof(__pyx_k_do_work), 1, 1, 1},
  {&__pyx_kp_get_image_view, __pyx_k_get_image_view, sizeof(__pyx_k_get_image_view), 1, 1, 1},
  {&__pyx_kp_im, __pyx_k_im, sizeof(__pyx_k_im), 1, 1, 1},
  {&__pyx_kp_lbrt, __pyx_k_lbrt, sizeof(__pyx_k_lbrt), 1, 1, 1},
  {&__pyx_kp_maxwidth, __pyx_k_maxwidth, sizeof(__pyx_k_maxwidth), 1, 1, 1},
  {&__pyx_kp_maxheight, __pyx_k_maxheight, sizeof(__pyx_k_maxheight), 1, 1, 1},
  {&__pyx_kp_max_num_points, __pyx_k_max_num_points, sizeof(__pyx_k_max_num_points), 1, 1, 1},
  {&__pyx_kp_1, __pyx_k_1, sizeof(__pyx_k_1), 1, 1, 1},
  {&__pyx_kp_x0, __pyx_k_x0, sizeof(__pyx_k_x0), 1, 1, 1},
  {&__pyx_kp_y0, __pyx_k_y0, sizeof(__pyx_k_y0), 1, 1, 1},
  {&__pyx_kp_raw_im_small, __pyx_k_raw_im_small, sizeof(__pyx_k_raw_im_small), 1, 1, 1},
  {&__pyx_kp_timestamp, __pyx_k_timestamp, sizeof(__pyx_k_timestamp), 1, 1, 1},
  {&__pyx_kp_framenumber, __pyx_k_framenumber, sizeof(__pyx_k_framenumber), 1, 1, 1},
  {&__pyx_kp_2, __pyx_k_2, sizeof(__pyx_k_2), 1, 1, 1},
  {&__pyx_kp_use_cmp, __pyx_k_use_cmp, sizeof(__pyx_k_use_cmp), 1, 1, 1},
  {&__pyx_kp_max_duration_sec, __pyx_k_max_duration_sec, sizeof(__pyx_k_max_duration_sec), 1, 1, 1},
  {&__pyx_kp_return_debug_values, __pyx_k_return_debug_values, sizeof(__pyx_k_return_debug_values), 1, 1, 1},
  {&__pyx_kp_which, __pyx_k_which, sizeof(__pyx_k_which), 1, 1, 1},
  {&__pyx_kp_value, __pyx_k_value, sizeof(__pyx_k_value), 1, 1, 1},
  {&__pyx_kp_running_mean_im, __pyx_k_running_mean_im, sizeof(__pyx_k_running_mean_im), 1, 1, 1},
  {&__pyx_kp_3, __pyx_k_3, sizeof(__pyx_k_3), 1, 1, 1},
  {&__pyx_kp_running_sumsqf, __pyx_k_running_sumsqf, sizeof(__pyx_k_running_sumsqf), 1, 1, 1},
  {&__pyx_kp_4, __pyx_k_4, sizeof(__pyx_k_4), 1, 1, 1},
  {&__pyx_kp_running_stdframe, __pyx_k_running_stdframe, sizeof(__pyx_k_running_stdframe), 1, 1, 1},
  {&__pyx_kp_5, __pyx_k_5, sizeof(__pyx_k_5), 1, 1, 1},
  {&__pyx_kp_hw_roi_frame, __pyx_k_hw_roi_frame, sizeof(__pyx_k_hw_roi_frame), 1, 1, 1},
  {&__pyx_kp_noisy_pixels_mask, __pyx_k_noisy_pixels_mask, sizeof(__pyx_k_noisy_pixels_mask), 1, 1, 1},
  {&__pyx_kp_6, __pyx_k_6, sizeof(__pyx_k_6), 1, 1, 1},
  {&__pyx_kp_max_frame_size, __pyx_k_max_frame_size, sizeof(__pyx_k_max_frame_size), 1, 1, 1},
  {&__pyx_kp_ALPHA, __pyx_k_ALPHA, sizeof(__pyx_k_ALPHA), 1, 1, 1},
  {&__pyx_kp_C, __pyx_k_C, sizeof(__pyx_k_C), 1, 1, 1},
  {&__pyx_kp_7, __pyx_k_7, sizeof(__pyx_k_7), 1, 1, 1},
  {&__pyx_kp_n_sigma, __pyx_k_n_sigma, sizeof(__pyx_k_n_sigma), 1, 1, 1},
  {&__pyx_kp_8, __pyx_k_8, sizeof(__pyx_k_8), 1, 1, 1},
  {&__pyx_kp_9, __pyx_k_9, sizeof(__pyx_k_9), 1, 1, 1},
  {&__pyx_kp_bench, __pyx_k_bench, sizeof(__pyx_k_bench), 1, 1, 1},
  {&__pyx_kp_time, __pyx_k_time, sizeof(__pyx_k_time), 1, 1, 1},
  {&__pyx_kp_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 1, 1, 1},
  {&__pyx_kp_nx, __pyx_k_nx, sizeof(__pyx_k_nx), 0, 1, 1},
  {&__pyx_kp_warnings, __pyx_k_warnings, sizeof(__pyx_k_warnings), 1, 1, 1},
  {&__pyx_kp_10, __pyx_k_10, sizeof(__pyx_k_10), 1, 1, 1},
  {&__pyx_kp_FastImage, __pyx_k_FastImage, sizeof(__pyx_k_FastImage), 0, 1, 1},
  {&__pyx_kp_nan, __pyx_k_nan, sizeof(__pyx_k_nan), 1, 1, 1},
  {&__pyx_kp_FitParamsError, __pyx_k_FitParamsError, sizeof(__pyx_k_FitParamsError), 0, 1, 1},
  {&__pyx_kp_Exception, __pyx_k_Exception, sizeof(__pyx_k_Exception), 1, 1, 1},
  {&__pyx_kp_12, __pyx_k_12, sizeof(__pyx_k_12), 0, 1, 0},
  {&__pyx_kp_FwError, __pyx_k_FwError, sizeof(__pyx_k_FwError), 1, 1, 1},
  {&__pyx_kp_set_val, __pyx_k_set_val, sizeof(__pyx_k_set_val), 1, 1, 1},
  {&__pyx_kp_15, __pyx_k_15, sizeof(__pyx_k_15), 0, 1, 0},
  {&__pyx_kp_16, __pyx_k_16, sizeof(__pyx_k_16), 0, 1, 0},
  {&__pyx_kp_17, __pyx_k_17, sizeof(__pyx_k_17), 0, 1, 0},
  {&__pyx_kp_18, __pyx_k_18, sizeof(__pyx_k_18), 0, 1, 0},
  {&__pyx_kp_19, __pyx_k_19, sizeof(__pyx_k_19), 0, 1, 0},
  {&__pyx_kp_roi, __pyx_k_roi, sizeof(__pyx_k_roi), 1, 1, 1},
  {&__pyx_kp__helper, __pyx_k__helper, sizeof(__pyx_k__helper), 1, 1, 1},
  {&__pyx_kp_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 1, 1, 1},
  {&__pyx_kp_warn, __pyx_k_warn, sizeof(__pyx_k_warn), 1, 1, 1},
  {&__pyx_kp_stacklevel, __pyx_k_stacklevel, sizeof(__pyx_k_stacklevel), 1, 1, 1},
  {&__pyx_kp_append, __pyx_k_append, sizeof(__pyx_k_append), 1, 1, 1},
  {&__pyx_kp__scale_factor, __pyx_k__scale_factor, sizeof(__pyx_k__scale_factor), 1, 1, 1},
  {&__pyx_kp_toself_add_weighted, __pyx_k_toself_add_weighted, sizeof(__pyx_k_toself_add_weighted), 1, 1, 1},
  {&__pyx_kp_28, __pyx_k_28, sizeof(__pyx_k_28), 1, 1, 1},
  {&__pyx_kp_29, __pyx_k_29, sizeof(__pyx_k_29), 1, 1, 1},
  {&__pyx_kp_toself_square, __pyx_k_toself_square, sizeof(__pyx_k_toself_square), 1, 1, 1},
  {&__pyx_kp_get_square_put, __pyx_k_get_square_put, sizeof(__pyx_k_get_square_put), 1, 1, 1},
  {&__pyx_kp_get_subtracted_put, __pyx_k_get_subtracted_put, sizeof(__pyx_k_get_subtracted_put), 1, 1, 1},
  {&__pyx_kp_toself_multiply, __pyx_k_toself_multiply, sizeof(__pyx_k_toself_multiply), 1, 1, 1},
  {&__pyx_kp_get_compare_put, __pyx_k_get_compare_put, sizeof(__pyx_k_get_compare_put), 1, 1, 1},
  {&__pyx_kp_CmpGreater, __pyx_k_CmpGreater, sizeof(__pyx_k_CmpGreater), 1, 1, 1},
  {&__pyx_kp_set_val_masked, __pyx_k_set_val_masked, sizeof(__pyx_k_set_val_masked), 1, 1, 1},
  {&__pyx_kp_11, __pyx_k_11, sizeof(__pyx_k_11), 1, 0, 0},
  {&__pyx_kp_13, __pyx_k_13, sizeof(__pyx_k_13), 0, 0, 0},
  {&__pyx_kp_14, __pyx_k_14, sizeof(__pyx_k_14), 0, 0, 0},
  {&__pyx_kp_20, __pyx_k_20, sizeof(__pyx_k_20), 0, 0, 0},
  {&__pyx_kp_21, __pyx_k_21, sizeof(__pyx_k_21), 0, 0, 0},
  {&__pyx_kp_22, __pyx_k_22, sizeof(__pyx_k_22), 0, 0, 0},
  {&__pyx_kp_23, __pyx_k_23, sizeof(__pyx_k_23), 0, 0, 0},
  {&__pyx_kp_24, __pyx_k_24, sizeof(__pyx_k_24), 0, 0, 0},
  {&__pyx_kp_25, __pyx_k_25, sizeof(__pyx_k_25), 0, 0, 0},
  {&__pyx_kp_26, __pyx_k_26, sizeof(__pyx_k_26), 0, 0, 0},
  {&__pyx_kp_27, __pyx_k_27, sizeof(__pyx_k_27), 0, 0, 0},
  {0, 0, 0, 0, 0, 0}
};
static int __Pyx_InitCachedBuiltins(void) {
  __pyx_builtin_Exception = __Pyx_GetName(__pyx_b, __pyx_kp_Exception); if (!__pyx_builtin_Exception) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_builtin_ValueError = __Pyx_GetName(__pyx_b, __pyx_kp_ValueError); if (!__pyx_builtin_ValueError) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 300; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  return 0;
  __pyx_L1_error:;
  return -1;
}

static int __Pyx_InitGlobals(void) {
  __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_21 = PyInt_FromLong(21); if (unlikely(!__pyx_int_21)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_200 = PyInt_FromLong(200); if (unlikely(!__pyx_int_200)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  __pyx_int_25 = PyInt_FromLong(25); if (unlikely(!__pyx_int_25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  return 0;
  __pyx_L1_error:;
  return -1;
}

#if PY_MAJOR_VERSION < 3
PyMODINIT_FUNC initrealtime_image_analysis(void); /*proto*/
PyMODINIT_FUNC initrealtime_image_analysis(void)
#else
PyMODINIT_FUNC PyInit_realtime_image_analysis(void); /*proto*/
PyMODINIT_FUNC PyInit_realtime_image_analysis(void)
#endif
{
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  double __pyx_3;
  PyObject *__pyx_4 = 0;
  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Library function declarations ---*/
  __pyx_init_filenames();
  /*--- Initialize various global constants etc. ---*/
  if (unlikely(__Pyx_InitGlobals() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Module creation code ---*/
  #if PY_MAJOR_VERSION < 3
  __pyx_m = Py_InitModule4("realtime_image_analysis", __pyx_methods, 0, 0, PYTHON_API_VERSION);
  #else
  __pyx_m = PyModule_Create(&__pyx_moduledef);
  #endif
  if (!__pyx_m) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  #if PY_MAJOR_VERSION < 3
  Py_INCREF(__pyx_m);
  #endif
  __pyx_b = PyImport_AddModule(__Pyx_BUILTIN_MODULE_NAME);
  if (!__pyx_b) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  /*--- Builtin init code ---*/
  if (unlikely(__Pyx_InitCachedBuiltins() < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_skip_dispatch = 0;
  /*--- Global init code ---*/
  /*--- Function export code ---*/
  /*--- Type init code ---*/
  if (PyType_Ready(&__pyx_type_23realtime_image_analysis_FitParamsClass) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyObject_SetAttrString(__pyx_m, "FitParamsClass", (PyObject *)&__pyx_type_23realtime_image_analysis_FitParamsClass) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 76; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_23realtime_image_analysis_FitParamsClass = &__pyx_type_23realtime_image_analysis_FitParamsClass;
  if (PyType_Ready(&__pyx_type_23realtime_image_analysis_RealtimeAnalyzer) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyObject_SetAttrString(__pyx_m, "RealtimeAnalyzer", (PyObject *)&__pyx_type_23realtime_image_analysis_RealtimeAnalyzer) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 130; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_23realtime_image_analysis_RealtimeAnalyzer = &__pyx_type_23realtime_image_analysis_RealtimeAnalyzer;
  /*--- Type import code ---*/
  __pyx_ptype_6motmot_9FastImage_9FastImage_Size = __Pyx_ImportType("motmot.FastImage.FastImage", "Size", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_Size)); if (unlikely(!__pyx_ptype_6motmot_9FastImage_9FastImage_Size)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_Point = __Pyx_ImportType("motmot.FastImage.FastImage", "Point", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_Point)); if (unlikely(!__pyx_ptype_6motmot_9FastImage_9FastImage_Point)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 12; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_FastImageBase = __Pyx_ImportType("motmot.FastImage.FastImage", "FastImageBase", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase)); if (unlikely(!__pyx_ptype_6motmot_9FastImage_9FastImage_FastImageBase)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_GetVtable(__pyx_ptype_6motmot_9FastImage_9FastImage_FastImageBase->tp_dict, &__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImageBase) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f = __Pyx_ImportType("motmot.FastImage.FastImage", "FastImage32f", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f)); if (unlikely(!__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_GetVtable(__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f->tp_dict, &__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage32f) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 27; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u = __Pyx_ImportType("motmot.FastImage.FastImage", "FastImage8u", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u)); if (unlikely(!__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (__Pyx_GetVtable(__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u->tp_dict, &__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage8u) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 29; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_LazyOp = __Pyx_ImportType("motmot.FastImage.FastImage", "LazyOp", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp)); if (unlikely(!__pyx_ptype_6motmot_9FastImage_9FastImage_LazyOp)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 47; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_square = __Pyx_ImportType("motmot.FastImage.FastImage", "square", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_square)); if (unlikely(!__pyx_ptype_6motmot_9FastImage_9FastImage_square)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 50; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_sqrt = __Pyx_ImportType("motmot.FastImage.FastImage", "sqrt", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_sqrt)); if (unlikely(!__pyx_ptype_6motmot_9FastImage_9FastImage_sqrt)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 53; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_blend_with = __Pyx_ImportType("motmot.FastImage.FastImage", "blend_with", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_blend_with)); if (unlikely(!__pyx_ptype_6motmot_9FastImage_9FastImage_blend_with)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 58; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_8u = __Pyx_ImportType("motmot.FastImage.FastImage", "convert_to_8u", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_convert_to_8u)); if (unlikely(!__pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_8u)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 62; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_32f = __Pyx_ImportType("motmot.FastImage.FastImage", "convert_to_32f", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_convert_to_32f)); if (unlikely(!__pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_32f)) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 65; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Function import code ---*/
  /*--- Execution code ---*/

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":9
 * # processing images on one CPU while grabbing them on another.
 * 
 * import time             # <<<<<<<<<<<<<<
 * import numpy as nx
 * import warnings
 */
  __pyx_1 = __Pyx_Import(__pyx_kp_time, 0); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_time, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":10
 * 
 * import time
 * import numpy as nx             # <<<<<<<<<<<<<<
 * import warnings
 * 
 */
  __pyx_1 = __Pyx_Import(__pyx_kp_numpy, 0); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_nx, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":11
 * import time
 * import numpy as nx
 * import warnings             # <<<<<<<<<<<<<<
 * 
 * #cimport FastImage
 */
  __pyx_1 = __Pyx_Import(__pyx_kp_warnings, 0); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_warnings, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":15
 * #cimport FastImage
 * cimport motmot.FastImage.FastImage as FastImage
 * import motmot.FastImage.FastImage as FastImage             # <<<<<<<<<<<<<<
 * 
 * cdef double nan
 */
  __pyx_1 = PyList_New(1); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_kp_11);
  PyList_SET_ITEM(__pyx_1, 0, __pyx_kp_11);
  __pyx_2 = __Pyx_Import(__pyx_kp_10, ((PyObject *)__pyx_1)); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_FastImage, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":18
 * 
 * cdef double nan
 * nan = nx.nan             # <<<<<<<<<<<<<<
 * 
 * cimport c_lib
 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_kp_nx); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_kp_nan); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_3 = __pyx_PyFloat_AsDouble(__pyx_2); if (unlikely(PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_v_23realtime_image_analysis_nan = __pyx_3;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":73
 *   print
 * 
 * class FitParamsError(Exception):             # <<<<<<<<<<<<<<
 *     pass
 * 
 */
  __pyx_1 = PyDict_New(); if (unlikely(!__pyx_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_2 = PyTuple_New(1); if (unlikely(!__pyx_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_INCREF(__pyx_builtin_Exception);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_builtin_Exception);
  __pyx_4 = __Pyx_CreateClass(((PyObject *)__pyx_2), ((PyObject *)__pyx_1), __pyx_kp_FitParamsError, "realtime_image_analysis"); if (unlikely(!__pyx_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(((PyObject *)__pyx_2)); __pyx_2 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_kp_FitParamsError, __pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 73; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  Py_DECREF(((PyObject *)__pyx_1)); __pyx_1 = 0;

  /* "/home/astraw/src/motmot/realtime_image_analysis/src/motmot.FastImage.FastImage.pxd":1
 * #emacs, this is -*-Python-*- mode             # <<<<<<<<<<<<<<
 * 
 * cimport c_python
 */
  #if PY_MAJOR_VERSION < 3
  return;
  #else
  return __pyx_m;
  #endif
  __pyx_L1_error:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("realtime_image_analysis");
  #if PY_MAJOR_VERSION >= 3
  return NULL;
  #endif
}

static const char *__pyx_filenames[] = {
  "realtime_image_analysis.pyx",
  "motmot.FastImage.FastImage.pxd",
};

/* Runtime support code */

static void __pyx_init_filenames(void) {
  __pyx_f = __pyx_filenames;
}

static INLINE int __Pyx_CheckKeywordStrings(
    PyObject *kwdict,
    const char* function_name,
    int kw_allowed)
{
    PyObject* key = 0;
    Py_ssize_t pos = 0;
    while (PyDict_Next(kwdict, &pos, &key, 0)) {
        #if PY_MAJOR_VERSION < 3
        if (unlikely(!PyString_CheckExact(key)) && unlikely(!PyString_Check(key)))
        #else
        if (unlikely(!PyUnicode_CheckExact(key)) && unlikely(!PyUnicode_Check(key)))
        #endif
            goto invalid_keyword_type;
    }
    if ((!kw_allowed) && unlikely(key))
        goto invalid_keyword;
    return 1;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%s() keywords must be strings", function_name);
    return 0;
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%s() got an unexpected keyword argument '%s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
    return 0;
}

static void __Pyx_RaiseDoubleKeywordsError(
    const char* func_name,
    PyObject* kw_name)
{
    PyErr_Format(PyExc_TypeError,
        #if PY_MAJOR_VERSION >= 3
        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
        #else
        "%s() got multiple values for keyword argument '%s'", func_name,
        PyString_AS_STRING(kw_name));
        #endif
}

static void __Pyx_RaiseArgtupleInvalid(
    const char* func_name,
    int exact,
    Py_ssize_t num_min,
    Py_ssize_t num_max,
    Py_ssize_t num_found)
{
    Py_ssize_t num_expected;
    const char *number, *more_or_less;

    if (num_found < num_min) {
        num_expected = num_min;
        more_or_less = "at least";
    } else {
        num_expected = num_max;
        more_or_less = "at most";
    }
    if (exact) {
        more_or_less = "exactly";
    }
    number = (num_expected == 1) ? "" : "s";
    PyErr_Format(PyExc_TypeError,
        #if PY_VERSION_HEX < 0x02050000
            "%s() takes %s %d positional argument%s (%d given)",
        #else
            "%s() takes %s %zd positional argument%s (%zd given)",
        #endif
        func_name, more_or_less, num_expected, number, num_found);
}

static int __Pyx_ParseOptionalKeywords(
    PyObject *kwds,
    PyObject **argnames[],
    PyObject *kwds2,
    PyObject *values[],
    Py_ssize_t num_pos_args,
    const char* function_name)
{
    PyObject *key = 0, *value = 0;
    Py_ssize_t pos = 0;
    PyObject*** name;
    PyObject*** first_kw_arg = argnames + num_pos_args;

    while (PyDict_Next(kwds, &pos, &key, &value)) {
        #if PY_MAJOR_VERSION < 3
        if (unlikely(!PyString_CheckExact(key)) && unlikely(!PyString_Check(key))) {
        #else
        if (unlikely(!PyUnicode_CheckExact(key)) && unlikely(!PyUnicode_Check(key))) {
        #endif
            goto invalid_keyword_type;
        } else {
            name = argnames;
            while (*name && (**name != key)) name++;
            if (*name) {
                if (name < first_kw_arg) goto arg_passed_twice;
                values[name-argnames] = value;
            } else {
                for (name = first_kw_arg; *name; name++) {
                    #if PY_MAJOR_VERSION >= 3
                    if (PyUnicode_GET_SIZE(**name) == PyUnicode_GET_SIZE(key) &&
                        PyUnicode_Compare(**name, key) == 0) break;
                    #else
                    if (PyString_GET_SIZE(**name) == PyString_GET_SIZE(key) &&
                        strcmp(PyString_AS_STRING(**name),
                               PyString_AS_STRING(key)) == 0) break;
                    #endif
                }
                if (*name) {
                    values[name-argnames] = value;
                } else {
                    /* unexpected keyword found */
                    for (name=argnames; name != first_kw_arg; name++) {
                        if (**name == key) goto arg_passed_twice;
                        #if PY_MAJOR_VERSION >= 3
                        if (PyUnicode_GET_SIZE(**name) == PyUnicode_GET_SIZE(key) &&
                            PyUnicode_Compare(**name, key) == 0) goto arg_passed_twice;
                        #else
                        if (PyString_GET_SIZE(**name) == PyString_GET_SIZE(key) &&
                            strcmp(PyString_AS_STRING(**name),
                                   PyString_AS_STRING(key)) == 0) goto arg_passed_twice;
                        #endif
                    }
                    if (kwds2) {
                        if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
                    } else {
                        goto invalid_keyword;
                    }
                }
            }
        }
    }
    return 0;
arg_passed_twice:
    __Pyx_RaiseDoubleKeywordsError(function_name, **name);
    goto bad;
invalid_keyword_type:
    PyErr_Format(PyExc_TypeError,
        "%s() keywords must be strings", function_name);
    goto bad;
invalid_keyword:
    PyErr_Format(PyExc_TypeError,
    #if PY_MAJOR_VERSION < 3
        "%s() got an unexpected keyword argument '%s'",
        function_name, PyString_AsString(key));
    #else
        "%s() got an unexpected keyword argument '%U'",
        function_name, key);
    #endif
bad:
    return -1;
}

static INLINE void __Pyx_ErrRestore(PyObject *type, PyObject *value, PyObject *tb) {
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    PyThreadState *tstate = PyThreadState_GET();

    tmp_type = tstate->curexc_type;
    tmp_value = tstate->curexc_value;
    tmp_tb = tstate->curexc_traceback;
    tstate->curexc_type = type;
    tstate->curexc_value = value;
    tstate->curexc_traceback = tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
}

static INLINE void __Pyx_ErrFetch(PyObject **type, PyObject **value, PyObject **tb) {
    PyThreadState *tstate = PyThreadState_GET();
    *type = tstate->curexc_type;
    *value = tstate->curexc_value;
    *tb = tstate->curexc_traceback;

    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
}


static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed,
    const char *name, int exact)
{
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (none_allowed && obj == Py_None) return 1;
    else if (exact) {
        if (Py_TYPE(obj) == type) return 1;
    }
    else {
        if (PyObject_TypeCheck(obj, type)) return 1;
    }
    PyErr_Format(PyExc_TypeError,
        "Argument '%s' has incorrect type (expected %s, got %s)",
        name, type->tp_name, Py_TYPE(obj)->tp_name);
    return 0;
}

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list) {
    PyObject *__import__ = 0;
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    __import__ = PyObject_GetAttrString(__pyx_b, "__import__");
    if (!__import__)
        goto bad;
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    module = PyObject_CallFunction(__import__, "OOOO",
        name, global_dict, empty_dict, list);
bad:
    Py_XDECREF(empty_list);
    Py_XDECREF(__import__);
    Py_XDECREF(empty_dict);
    return module;
}

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name) {
    PyObject *result;
    result = PyObject_GetAttr(dict, name);
    if (!result)
        PyErr_SetObject(PyExc_NameError, name);
    return result;
}

static PyObject *__Pyx_CreateClass(
    PyObject *bases, PyObject *dict, PyObject *name, char *modname)
{
    PyObject *py_modname;
    PyObject *result = 0;

    #if PY_MAJOR_VERSION < 3
    py_modname = PyString_FromString(modname);
    #else
    py_modname = PyUnicode_FromString(modname);
    #endif
    if (!py_modname)
        goto bad;
    if (PyDict_SetItemString(dict, "__module__", py_modname) < 0)
        goto bad;
    #if PY_MAJOR_VERSION < 3
    result = PyClass_New(bases, dict, name);
    #else
    result = PyObject_CallFunctionObjArgs((PyObject *)&PyType_Type, name, bases, dict, NULL);
    #endif
bad:
    Py_XDECREF(py_modname);
    return result;
}

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb) {
    Py_XINCREF(type);
    Py_XINCREF(value);
    Py_XINCREF(tb);
    /* First, check the traceback argument, replacing None with NULL. */
    if (tb == Py_None) {
        Py_DECREF(tb);
        tb = 0;
    }
    else if (tb != NULL && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto raise_error;
    }
    /* Next, replace a missing value with None */
    if (value == NULL) {
        value = Py_None;
        Py_INCREF(value);
    }
    #if PY_VERSION_HEX < 0x02050000
    if (!PyClass_Check(type))
    #else
    if (!PyType_Check(type))
    #endif
    {
        /* Raising an instance.  The value should be a dummy. */
        if (value != Py_None) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        /* Normalize to raise <class>, <instance> */
        Py_DECREF(value);
        value = type;
        #if PY_VERSION_HEX < 0x02050000
            if (PyInstance_Check(type)) {
                type = (PyObject*) ((PyInstanceObject*)type)->in_class;
                Py_INCREF(type);
            }
            else {
                type = 0;
                PyErr_SetString(PyExc_TypeError,
                    "raise: exception must be an old-style class or instance");
                goto raise_error;
            }
        #else
            type = (PyObject*) Py_TYPE(type);
            Py_INCREF(type);
            if (!PyType_IsSubtype((PyTypeObject *)type, (PyTypeObject *)PyExc_BaseException)) {
                PyErr_SetString(PyExc_TypeError,
                    "raise: exception class must be a subclass of BaseException");
                goto raise_error;
            }
        #endif
    }
    __Pyx_ErrRestore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}

#if PY_MAJOR_VERSION < 3
static PyObject *__Pyx_GetStdout(void) {
    PyObject *f = PySys_GetObject("stdout");
    if (!f) {
        PyErr_SetString(PyExc_RuntimeError, "lost sys.stdout");
    }
    return f;
}

static int __Pyx_Print(PyObject *arg_tuple, int newline) {
    PyObject *f;
    PyObject* v;
    int i;
    
    if (!(f = __Pyx_GetStdout()))
        return -1;
    for (i=0; i < PyTuple_GET_SIZE(arg_tuple); i++) {
        if (PyFile_SoftSpace(f, 1)) {
            if (PyFile_WriteString(" ", f) < 0)
                return -1;
        }
        v = PyTuple_GET_ITEM(arg_tuple, i);
        if (PyFile_WriteObject(v, f, Py_PRINT_RAW) < 0)
            return -1;
        if (PyString_Check(v)) {
            char *s = PyString_AsString(v);
            Py_ssize_t len = PyString_Size(v);
            if (len > 0 &&
                isspace(Py_CHARMASK(s[len-1])) &&
                s[len-1] != ' ')
                    PyFile_SoftSpace(f, 0);
        }
    }
    if (newline) {
        if (PyFile_WriteString("\n", f) < 0)
            return -1;
        PyFile_SoftSpace(f, 0);
    }
    return 0;
}

#else /* Python 3 has a print function */
static int __Pyx_Print(PyObject *arg_tuple, int newline) {
    PyObject* kwargs = 0;
    PyObject* result = 0;
    PyObject* end_string;
    if (!__pyx_print) {
        __pyx_print = PyObject_GetAttrString(__pyx_b, "print");
        if (!__pyx_print)
            return -1;
    }
    if (!newline) {
        if (!__pyx_print_kwargs) {
            __pyx_print_kwargs = PyDict_New();
            if (!__pyx_print_kwargs)
                return -1;
            end_string = PyUnicode_FromStringAndSize(" ", 1);
            if (!end_string)
                return -1;
            if (PyDict_SetItemString(__pyx_print_kwargs, "end", end_string) < 0) {
                Py_DECREF(end_string);
                return -1;
            }
            Py_DECREF(end_string);
        }
        kwargs = __pyx_print_kwargs;
    }
    result = PyObject_Call(__pyx_print, arg_tuple, kwargs);
    if (!result)
        return -1;
    Py_DECREF(result);
    return 0;
}
#endif

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (obj == Py_None || PyObject_TypeCheck(obj, type))
        return 1;
    PyErr_Format(PyExc_TypeError, "Cannot convert %s to %s",
        Py_TYPE(obj)->tp_name, type->tp_name);
    return 0;
}

static PyObject *__Pyx_UnpackItem(PyObject *iter, Py_ssize_t index) {
    PyObject *item;
    if (!(item = PyIter_Next(iter))) {
        if (!PyErr_Occurred()) {
            PyErr_Format(PyExc_ValueError,
                #if PY_VERSION_HEX < 0x02050000
                    "need more than %d values to unpack", (int)index);
                #else
                    "need more than %zd values to unpack", index);
                #endif
        }
    }
    return item;
}

static int __Pyx_EndUnpack(PyObject *iter) {
    PyObject *item;
    if ((item = PyIter_Next(iter))) {
        Py_DECREF(item);
        PyErr_SetString(PyExc_ValueError, "too many values to unpack");
        return -1;
    }
    else if (!PyErr_Occurred())
        return 0;
    else
        return -1;
}

#ifndef __PYX_HAVE_RT_ImportType
#define __PYX_HAVE_RT_ImportType
static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name,
    long size)
{
    PyObject *py_module = 0;
    PyObject *result = 0;
    PyObject *py_name = 0;

    py_module = __Pyx_ImportModule(module_name);
    if (!py_module)
        goto bad;
    #if PY_MAJOR_VERSION < 3
    py_name = PyString_FromString(class_name);
    #else
    py_name = PyUnicode_FromString(class_name);
    #endif
    if (!py_name)
        goto bad;
    result = PyObject_GetAttr(py_module, py_name);
    Py_DECREF(py_name);
    py_name = 0;
    Py_DECREF(py_module);
    py_module = 0;
    if (!result)
        goto bad;
    if (!PyType_Check(result)) {
        PyErr_Format(PyExc_TypeError, 
            "%s.%s is not a type object",
            module_name, class_name);
        goto bad;
    }
    if (((PyTypeObject *)result)->tp_basicsize != size) {
        PyErr_Format(PyExc_ValueError, 
            "%s.%s does not appear to be the correct type object",
            module_name, class_name);
        goto bad;
    }
    return (PyTypeObject *)result;
bad:
    Py_XDECREF(py_module);
    Py_XDECREF(result);
    return 0;
}
#endif

#ifndef __PYX_HAVE_RT_ImportModule
#define __PYX_HAVE_RT_ImportModule
static PyObject *__Pyx_ImportModule(const char *name) {
    PyObject *py_name = 0;
    PyObject *py_module = 0;

    #if PY_MAJOR_VERSION < 3
    py_name = PyString_FromString(name);
    #else
    py_name = PyUnicode_FromString(name);
    #endif
    if (!py_name)
        goto bad;
    py_module = PyImport_Import(py_name);
    Py_DECREF(py_name);
    return py_module;
bad:
    Py_XDECREF(py_name);
    return 0;
}
#endif

static int __Pyx_GetVtable(PyObject *dict, void *vtabptr) {
    int result;
    PyObject *pycobj;
    
    pycobj = PyMapping_GetItemString(dict, "__pyx_vtable__");
    if (!pycobj)
        goto bad;
    *(void **)vtabptr = PyCObject_AsVoidPtr(pycobj);
    if (!*(void **)vtabptr)
        goto bad;
    result = 0;
    goto done;

bad:
    result = -1;
done:
    Py_XDECREF(pycobj);
    return result;
}

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"

static void __Pyx_AddTraceback(const char *funcname) {
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    PyObject *py_globals = 0;
    PyObject *empty_string = 0;
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;

    #if PY_MAJOR_VERSION < 3
    py_srcfile = PyString_FromString(__pyx_filename);
    #else
    py_srcfile = PyUnicode_FromString(__pyx_filename);
    #endif
    if (!py_srcfile) goto bad;
    if (__pyx_clineno) {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, __pyx_clineno);
        #else
        py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, __pyx_clineno);
        #endif
    }
    else {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromString(funcname);
        #else
        py_funcname = PyUnicode_FromString(funcname);
        #endif
    }
    if (!py_funcname) goto bad;
    py_globals = PyModule_GetDict(__pyx_m);
    if (!py_globals) goto bad;
    #if PY_MAJOR_VERSION < 3
    empty_string = PyString_FromStringAndSize("", 0);
    #else
    empty_string = PyBytes_FromStringAndSize("", 0);
    #endif
    if (!empty_string) goto bad;
    py_code = PyCode_New(
        0,            /*int argcount,*/
        #if PY_MAJOR_VERSION >= 3
        0,            /*int kwonlyargcount,*/
        #endif
        0,            /*int nlocals,*/
        0,            /*int stacksize,*/
        0,            /*int flags,*/
        empty_string, /*PyObject *code,*/
        __pyx_empty_tuple,  /*PyObject *consts,*/
        __pyx_empty_tuple,  /*PyObject *names,*/
        __pyx_empty_tuple,  /*PyObject *varnames,*/
        __pyx_empty_tuple,  /*PyObject *freevars,*/
        __pyx_empty_tuple,  /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        __pyx_lineno,   /*int firstlineno,*/
        empty_string  /*PyObject *lnotab*/
    );
    if (!py_code) goto bad;
    py_frame = PyFrame_New(
        PyThreadState_GET(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        py_globals,          /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = __pyx_lineno;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    Py_XDECREF(empty_string);
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        #if PY_MAJOR_VERSION < 3
        if (t->is_unicode && (!t->is_identifier)) {
            *t->p = PyUnicode_DecodeUTF8(t->s, t->n - 1, NULL);
        } else if (t->intern) {
            *t->p = PyString_InternFromString(t->s);
        } else {
            *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        }
        #else  /* Python 3+ has unicode identifiers */
        if (t->is_identifier || (t->is_unicode && t->intern)) {
            *t->p = PyUnicode_InternFromString(t->s);
        } else if (t->is_unicode) {
            *t->p = PyUnicode_FromStringAndSize(t->s, t->n - 1);
        } else {
            *t->p = PyBytes_FromStringAndSize(t->s, t->n - 1);
        }
        #endif
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

/* Type Conversion Functions */

static INLINE Py_ssize_t __pyx_PyIndex_AsSsize_t(PyObject* b) {
  Py_ssize_t ival;
  PyObject* x = PyNumber_Index(b);
  if (!x) return -1;
  ival = PyInt_AsSsize_t(x);
  Py_DECREF(x);
  return ival;
}

static INLINE int __Pyx_PyObject_IsTrue(PyObject* x) {
   if (x == Py_True) return 1;
   else if (x == Py_False) return 0;
   else return PyObject_IsTrue(x);
}

static INLINE PY_LONG_LONG __pyx_PyInt_AsLongLong(PyObject* x) {
    if (PyInt_CheckExact(x)) {
        return PyInt_AS_LONG(x);
    }
    else if (PyLong_CheckExact(x)) {
        return PyLong_AsLongLong(x);
    }
    else {
        PY_LONG_LONG val;
        PyObject* tmp = PyNumber_Int(x); if (!tmp) return (PY_LONG_LONG)-1;
        val = __pyx_PyInt_AsLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static INLINE unsigned PY_LONG_LONG __pyx_PyInt_AsUnsignedLongLong(PyObject* x) {
    if (PyInt_CheckExact(x)) {
        long val = PyInt_AS_LONG(x);
        if (unlikely(val < 0)) {
            PyErr_SetString(PyExc_TypeError, "Negative assignment to unsigned type.");
            return (unsigned PY_LONG_LONG)-1;
        }
        return val;
    }
    else if (PyLong_CheckExact(x)) {
        return PyLong_AsUnsignedLongLong(x);
    }
    else {
        PY_LONG_LONG val;
        PyObject* tmp = PyNumber_Int(x); if (!tmp) return (PY_LONG_LONG)-1;
        val = __pyx_PyInt_AsUnsignedLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}


static INLINE unsigned char __pyx_PyInt_unsigned_char(PyObject* x) {
    if (sizeof(unsigned char) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        unsigned char val = (unsigned char)long_val;
        if (unlikely((val != long_val)  || (long_val < 0))) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to unsigned char");
            return (unsigned char)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE unsigned short __pyx_PyInt_unsigned_short(PyObject* x) {
    if (sizeof(unsigned short) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        unsigned short val = (unsigned short)long_val;
        if (unlikely((val != long_val)  || (long_val < 0))) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to unsigned short");
            return (unsigned short)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE char __pyx_PyInt_char(PyObject* x) {
    if (sizeof(char) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        char val = (char)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to char");
            return (char)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE short __pyx_PyInt_short(PyObject* x) {
    if (sizeof(short) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        short val = (short)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to short");
            return (short)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE int __pyx_PyInt_int(PyObject* x) {
    if (sizeof(int) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        int val = (int)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to int");
            return (int)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE long __pyx_PyInt_long(PyObject* x) {
    if (sizeof(long) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        long val = (long)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to long");
            return (long)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE signed char __pyx_PyInt_signed_char(PyObject* x) {
    if (sizeof(signed char) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        signed char val = (signed char)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to signed char");
            return (signed char)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE signed short __pyx_PyInt_signed_short(PyObject* x) {
    if (sizeof(signed short) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        signed short val = (signed short)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to signed short");
            return (signed short)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE signed int __pyx_PyInt_signed_int(PyObject* x) {
    if (sizeof(signed int) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        signed int val = (signed int)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to signed int");
            return (signed int)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE signed long __pyx_PyInt_signed_long(PyObject* x) {
    if (sizeof(signed long) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        signed long val = (signed long)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to signed long");
            return (signed long)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE long double __pyx_PyInt_long_double(PyObject* x) {
    if (sizeof(long double) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        long double val = (long double)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to long double");
            return (long double)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

