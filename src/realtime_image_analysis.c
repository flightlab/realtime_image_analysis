/* Generated by Pyrex 0.9.6.4 on Sun May 25 18:04:33 2008 */

#define PY_SSIZE_T_CLEAN
#include "Python.h"
#include "structmember.h"
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#if PY_VERSION_HEX < 0x02050000
  typedef int Py_ssize_t;
  #define PY_SSIZE_T_MAX INT_MAX
  #define PY_SSIZE_T_MIN INT_MIN
  #define PyInt_FromSsize_t(z) PyInt_FromLong(z)
  #define PyInt_AsSsize_t(o)	PyInt_AsLong(o)
#endif
#ifndef WIN32
  #ifndef __stdcall
    #define __stdcall
  #endif
  #ifndef __cdecl
    #define __cdecl
  #endif
#endif
#ifdef __cplusplus
#define __PYX_EXTERN_C extern "C"
#else
#define __PYX_EXTERN_C extern
#endif
#include <math.h>
#include "unistd.h"
#include "c_fit_params.h"
#include "eigen.h"
#include "motmot_ipp_macros.h"
#include "c_time_time.h"
#include "stdlib.h"
#include "math.h"
#include "ads_wrap_system.h"
#include "stdio.h"
#include "fi_ipp.h"


typedef struct {PyObject **p; char *s;} __Pyx_InternTabEntry; /*proto*/
typedef struct {PyObject **p; char *s; long n;} __Pyx_StringTabEntry; /*proto*/

static PyObject *__pyx_m;
static PyObject *__pyx_b;
static int __pyx_lineno;
static char *__pyx_filename;
static char **__pyx_f;

static int __Pyx_GetStarArgs(PyObject **args, PyObject **kwds, char *kwd_list[],     Py_ssize_t nargs, PyObject **args2, PyObject **kwds2, char rqd_kwds[]); /*proto*/

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed, char *name); /*proto*/

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list); /*proto*/

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name); /*proto*/

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb); /*proto*/

static int __Pyx_PrintItem(PyObject *); /*proto*/
static int __Pyx_PrintNewline(void); /*proto*/

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type); /*proto*/

static PyObject *__Pyx_UnpackItem(PyObject *); /*proto*/
static int __Pyx_EndUnpack(PyObject *); /*proto*/

static int __Pyx_InternStrings(__Pyx_InternTabEntry *t); /*proto*/

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t); /*proto*/

static PyTypeObject *__Pyx_ImportType(char *module_name, char *class_name, long size);  /*proto*/

static PyObject *__Pyx_ImportModule(char *name); /*proto*/

static int __Pyx_GetVtable(PyObject *dict, void *vtabptr); /*proto*/

static void __Pyx_AddTraceback(char *funcname); /*proto*/

/* Declarations from c_lib */


/* Declarations from c_python */


/* Declarations from ipp */


/* Declarations from motmot.FastImage.FastImage */

typedef void *__pyx_t_6motmot_9FastImage_9FastImage_fiptr;

struct __pyx_obj_6motmot_9FastImage_9FastImage_Size {
  PyObject_HEAD
  IppiSize sz;
};

struct __pyx_obj_6motmot_9FastImage_9FastImage_Point {
  PyObject_HEAD
  IppiPoint pt;
};

struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase {
  PyObject_HEAD
  struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase *__pyx_vtab;
  __pyx_t_6motmot_9FastImage_9FastImage_fiptr im;
  Py_intptr_t shape[2];
  Py_intptr_t strides[2];
  int step;
  int view;
  PyObject *basetype;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *imsiz;
  PyObject *source_data;
};

struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
};

struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
};

struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp {
  PyObject_HEAD
};

struct __pyx_obj_6motmot_9FastImage_9FastImage_square {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *base;
};

struct __pyx_obj_6motmot_9FastImage_9FastImage_sqrt {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *base;
};

struct __pyx_obj_6motmot_9FastImage_9FastImage_blend_with {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *other8u;
  float alpha;
};

struct __pyx_obj_6motmot_9FastImage_9FastImage_convert_to_8u {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *orig32f;
};

struct __pyx_obj_6motmot_9FastImage_9FastImage_convert_to_32f {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *orig8u;
};




struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *(*c_roi)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *,int,int,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
};
static struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase *__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImageBase;


struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage32f {
  struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
  void (*fast_toself_add_weighted_8u)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *,float);
  void (*fast_toself_add_weighted_32f)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *,float);
  void (*fast_get_8u_copy_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_toself_square)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_get_square_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_get_subtracted_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_toself_multiply)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,float,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
};
static struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage32f;


struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage8u {
  struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
  void (*fast_get_absdiff_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_get_sub_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_set_val_masked)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,Ipp8u,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_get_32f_copy_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
  void (*fast_get_compare_int_put_greater)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,int,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
};
static struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage8u;







static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_Size = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_Point = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_FastImageBase = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_LazyOp = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_square = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_sqrt = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_blend_with = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_8u = 0;
static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_32f = 0;

/* Declarations from realtime_image_analysis */

struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer {
  PyObject_HEAD
  int maxwidth;
  int maxheight;
  int _left;
  int _bottom;
  int _right;
  int _top;
  int _roi2_radius;
  Ipp8u _diff_threshold;
  float _clear_threshold;
  Ipp8u _despeckle_threshold;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *_roi_sz;
  int n_rot_samples;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *absdiff_im;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmpdiff_im;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *absdiff_im_roi_view;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmpdiff_im_roi_view;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *absdiff_im_roi2_view;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmpdiff_im_roi2_view;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *mask_im;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *mean_im;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmp_im;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *mean_im_roi_view;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmp_im_roi_view;
  IppiMomentState_64f *pState;
  PyObject *imname2im;
  int max_num_points;
};


static PyTypeObject *__pyx_ptype_23realtime_image_analysis_RealtimeAnalyzer = 0;
static double __pyx_v_23realtime_image_analysis_nan;
static int __pyx_k6;
static double __pyx_k7;
static int __pyx_k8;
static PyObject *__pyx_k10;
static int __pyx_k11;
static void __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(IppStatus); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_print_8u_arr(Ipp8u *,int,int,int); /*proto*/


/* Implementation of realtime_image_analysis */

static char __pyx_k4[] = "motmot.FastImage.FastImage";
static char __pyx_k5[] = "*";

static PyObject *__pyx_n_time;
static PyObject *__pyx_n_numpy;
static PyObject *__pyx_n_nx;
static PyObject *__pyx_n_warnings;
static PyObject *__pyx_n_FastImage;
static PyObject *__pyx_n_nan;
static PyObject *__pyx_n_mean;

static PyObject *__pyx_k4p;
static PyObject *__pyx_k5p;

static PyObject *__pyx_n_IppError;

static void __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(IppStatus __pyx_v_errval) {
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  __pyx_1 = (__pyx_v_errval != ippStsNoErr);
  if (__pyx_1) {
    __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_FastImage); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; goto __pyx_L1;}
    __pyx_3 = PyObject_GetAttr(__pyx_2, __pyx_n_IppError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_2 = PyInt_FromLong(__pyx_v_errval); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; goto __pyx_L1;}
    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
    __pyx_2 = 0;
    __pyx_2 = PyObject_CallObject(__pyx_3, __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; goto __pyx_L1;}
    Py_DECREF(__pyx_3); __pyx_3 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    __Pyx_Raise(__pyx_2, 0, 0);
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("realtime_image_analysis.CHK_HAVEGIL");
  __pyx_L0:;
}

static PyObject *__pyx_k12p;

static char __pyx_k12[] = "%d";

static PyObject *__pyx_f_23realtime_image_analysis_print_8u_arr(Ipp8u *__pyx_v_src,int __pyx_v_width,int __pyx_v_height,int __pyx_v_src_step) {
  int __pyx_v_row;
  int __pyx_v_col;
  Ipp8u *__pyx_v_src_rowstart;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":67 */
  for (__pyx_v_row = 0; __pyx_v_row < __pyx_v_height; ++__pyx_v_row) {

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":68 */
    __pyx_v_src_rowstart = (__pyx_v_src + (__pyx_v_row * __pyx_v_src_step));

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":69 */
    for (__pyx_v_col = 0; __pyx_v_col < __pyx_v_width; ++__pyx_v_col) {
      __pyx_1 = PyInt_FromLong((__pyx_v_src_rowstart[__pyx_v_col])); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; goto __pyx_L1;}
      __pyx_2 = PyNumber_Remainder(__pyx_k12p, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      if (__Pyx_PrintItem(__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
    }

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":71 */
    if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 71; goto __pyx_L1;}
  }

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":72 */
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; goto __pyx_L1;}

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("realtime_image_analysis.print_8u_arr");
  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___new__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kw = 0;
  int __pyx_r;
  static char *__pyx_argnames[] = {0};
  if (__Pyx_GetStarArgs(&__pyx_args, &__pyx_kwds, __pyx_argnames, 0, &__pyx_v_args, &__pyx_v_kw, 0) < 0) return -1;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) {
    Py_XDECREF(__pyx_args);
    Py_XDECREF(__pyx_kwds);
    Py_XDECREF(__pyx_v_args);
    Py_XDECREF(__pyx_v_kw);
    return -1;
  }
  Py_INCREF(__pyx_v_self);
  __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(ippiMomentInitAlloc_64f((&((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->pState),ippAlgHintFast)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; goto __pyx_L1;}

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.__cinit__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_XDECREF(__pyx_v_args);
  Py_XDECREF(__pyx_v_kw);
  Py_DECREF(__pyx_v_self);
  Py_XDECREF(__pyx_args);
  Py_XDECREF(__pyx_kwds);
  return __pyx_r;
}

static void __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___dealloc__(PyObject *__pyx_v_self) {
  Py_INCREF(__pyx_v_self);
  __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(ippiMomentFree_64f(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->pState)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; goto __pyx_L1;}

  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.__dealloc__");
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
}

static PyObject *__pyx_n_set_val;
static PyObject *__pyx_n_absdiff;
static PyObject *__pyx_n_mask;
static PyObject *__pyx_n_cmp;
static PyObject *__pyx_n_cmpdiff;
static PyObject *__pyx_n_roi;


static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_lbrt = 0;
  int __pyx_v_maxwidth;
  int __pyx_v_maxheight;
  int __pyx_v_max_num_points;
  int __pyx_v_roi2_radius;
  PyObject *__pyx_v_sz;
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  static char *__pyx_argnames[] = {"lbrt","maxwidth","maxheight","max_num_points","roi2_radius",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "Oiiii", __pyx_argnames, &__pyx_v_lbrt, &__pyx_v_maxwidth, &__pyx_v_maxheight, &__pyx_v_max_num_points, &__pyx_v_roi2_radius)) return -1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_lbrt);
  __pyx_v_sz = Py_None; Py_INCREF(Py_None);

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":132 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxwidth = __pyx_v_maxwidth;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":133 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxheight = __pyx_v_maxheight;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":135 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->max_num_points = __pyx_v_max_num_points;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":138 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius = __pyx_v_roi2_radius;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":139 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold = 11;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":140 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold = 0.2;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":142 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_despeckle_threshold = 5;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":143 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->n_rot_samples = (100 * 60);

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":145 */
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxwidth); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxheight); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_3, 1, __pyx_2);
  __pyx_1 = 0;
  __pyx_2 = 0;
  __pyx_1 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_Size), __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 145; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_v_sz);
  __pyx_v_sz = __pyx_1;
  __pyx_1 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":147 */
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; goto __pyx_L1;}
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_sz);
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 147; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":150 */
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; goto __pyx_L1;}
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_sz);
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u), __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 150; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":151 */
  __pyx_3 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im), __pyx_n_set_val); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_v_sz);
  __pyx_1 = 0;
  __pyx_1 = PyObject_CallObject(__pyx_3, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 151; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":153 */
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; goto __pyx_L1;}
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_v_sz);
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u), __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 153; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":154 */
  __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 154; goto __pyx_L1;}
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_v_sz);
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u), __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 154; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 154; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":155 */
  __pyx_2 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im), __pyx_n_set_val); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_1);
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_3, 1, __pyx_v_sz);
  __pyx_1 = 0;
  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 155; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":157 */
  __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; goto __pyx_L1;}
  Py_INCREF(__pyx_v_sz);
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_v_sz);
  __pyx_3 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u), __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_3, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 157; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_3);
  __pyx_3 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":160 */
  __pyx_1 = PyDict_New(); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; goto __pyx_L1;}
  if (PyDict_SetItem(__pyx_1, __pyx_n_absdiff, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; goto __pyx_L1;}
  if (PyDict_SetItem(__pyx_1, __pyx_n_mean, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; goto __pyx_L1;}
  if (PyDict_SetItem(__pyx_1, __pyx_n_mask, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; goto __pyx_L1;}
  if (PyDict_SetItem(__pyx_1, __pyx_n_cmp, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; goto __pyx_L1;}
  if (PyDict_SetItem(__pyx_1, __pyx_n_cmpdiff, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im)) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 160; goto __pyx_L1;}
  Py_DECREF(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->imname2im);
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->imname2im = __pyx_1;
  __pyx_1 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":167 */
  if (PyObject_SetAttr(__pyx_v_self, __pyx_n_roi, __pyx_v_lbrt) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 167; goto __pyx_L1;}

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":170 */
  __pyx_2 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view), __pyx_n_set_val); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; goto __pyx_L1;}
  __pyx_3 = PyInt_FromLong(0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_3);
  Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  PyTuple_SET_ITEM(__pyx_1, 1, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  __pyx_3 = 0;
  __pyx_3 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 170; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.__init__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_sz);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_lbrt);
  return __pyx_r;
}

static PyObject *__pyx_n__helper;
static PyObject *__pyx_n_distort;

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_distort(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_distort(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  float __pyx_v_x0;
  float __pyx_v_y0;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  int __pyx_2;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  static char *__pyx_argnames[] = {"x0","y0",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "ff", __pyx_argnames, &__pyx_v_x0, &__pyx_v_y0)) return 0;
  Py_INCREF(__pyx_v_self);

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":173 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n__helper); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 173; goto __pyx_L1;}
  __pyx_2 = __pyx_1 == Py_None;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (__pyx_2) {
    __pyx_1 = PyFloat_FromDouble(__pyx_v_x0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; goto __pyx_L1;}
    __pyx_3 = PyFloat_FromDouble(__pyx_v_y0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; goto __pyx_L1;}
    __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 174; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_1);
    PyTuple_SET_ITEM(__pyx_4, 1, __pyx_3);
    __pyx_1 = 0;
    __pyx_3 = 0;
    __pyx_r = __pyx_4;
    __pyx_4 = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":175 */
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n__helper); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; goto __pyx_L1;}
  __pyx_3 = PyObject_GetAttr(__pyx_1, __pyx_n_distort); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_4 = PyFloat_FromDouble(__pyx_v_x0); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; goto __pyx_L1;}
  __pyx_1 = PyFloat_FromDouble(__pyx_v_y0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; goto __pyx_L1;}
  __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_4);
  PyTuple_SET_ITEM(__pyx_5, 1, __pyx_1);
  __pyx_4 = 0;
  __pyx_1 = 0;
  __pyx_4 = PyObject_CallObject(__pyx_3, __pyx_5); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 175; goto __pyx_L1;}
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  __pyx_r = __pyx_4;
  __pyx_4 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.distort");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_n_ValueError;
static PyObject *__pyx_n_str;
static PyObject *__pyx_n_warn;
static PyObject *__pyx_n_stacklevel;
static PyObject *__pyx_n_return_max_abs_diff;
static PyObject *__pyx_n_append;

static PyObject *__pyx_k18p;
static PyObject *__pyx_k19p;

static char __pyx_k18[] = "input image size (%s) does not correspond to ROI (%s)(set RealtimeAnalyzer.roi before calling)";
static char __pyx_k19[] = "stopped looking for points (this frame only) because it was taking longer than max_duration_sec";

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_do_work(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_23realtime_image_analysis_16RealtimeAnalyzer_do_work[] = "find location and orientation of local points (fast enough for realtime use)\n\n        inputs\n        ------\n\n        timestamp\n        framenumber\n        use_roi2\n\n        optional inputs (default to 0)\n        ------------------------------\n        use_cmp -- perform more detailed analysis against cmp image (used with ongoing variance estimation)\n\n        outputs\n        -------\n\n        [ (x0_abs, y0_abs, area, slope, eccentricity) ] -- with a tuple for each point found\n\n        ";
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_do_work(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_raw_im_small = 0;
  double __pyx_v_timestamp;
  int __pyx_v_framenumber;
  int __pyx_v_use_roi2;
  int __pyx_v_use_cmp;
  double __pyx_v_max_duration_sec;
  int __pyx_v_return_max_diff_values;
  double __pyx_v_x0;
  double __pyx_v_y0;
  double __pyx_v_x0_abs;
  double __pyx_v_y0_abs;
  double __pyx_v_area;
  double __pyx_v_rise;
  double __pyx_v_run;
  double __pyx_v_slope;
  double __pyx_v_eccentricity;
  double __pyx_v_evalA;
  double __pyx_v_evalB;
  double __pyx_v_evecA1;
  double __pyx_v_evecB1;
  double __pyx_v_Mu00;
  double __pyx_v_Uu11;
  double __pyx_v_Uu02;
  double __pyx_v_Uu20;
  int __pyx_v_result;
  int __pyx_v_eigen_err;
  int __pyx_v_index_x;
  int __pyx_v_index_y;
  Ipp8u __pyx_v_max_abs_diff;
  Ipp8u *__pyx_v_max_abs_diff_ptr;
  Ipp8u __pyx_v_max_std_diff;
  Ipp8u __pyx_v_clear_despeckle_thresh;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *__pyx_v_roi2_sz;
  int __pyx_v_left2;
  int __pyx_v_right2;
  int __pyx_v_bottom2;
  int __pyx_v_top2;
  int __pyx_v_found_point;
  int __pyx_v_n_found_points;
  double __pyx_v_entry_time;
  double __pyx_v_now;
  PyObject *__pyx_v_all_points_found;
  PyObject *__pyx_v_pt_tuple;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  double __pyx_3;
  PyObject *__pyx_4 = 0;
  int __pyx_5;
  int __pyx_6;
  PyObject *__pyx_7 = 0;
  PyObject *__pyx_8 = 0;
  PyObject *__pyx_9 = 0;
  PyObject *__pyx_10 = 0;
  PyObject *__pyx_11 = 0;
  static char *__pyx_argnames[] = {"raw_im_small","timestamp","framenumber","use_roi2","use_cmp","max_duration_sec","return_max_diff_values",0};
  __pyx_v_use_cmp = __pyx_k6;
  __pyx_v_max_duration_sec = __pyx_k7;
  __pyx_v_return_max_diff_values = __pyx_k8;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "Odii|idi", __pyx_argnames, &__pyx_v_raw_im_small, &__pyx_v_timestamp, &__pyx_v_framenumber, &__pyx_v_use_roi2, &__pyx_v_use_cmp, &__pyx_v_max_duration_sec, &__pyx_v_return_max_diff_values)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF((PyObject *)__pyx_v_raw_im_small);
  __pyx_v_roi2_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)Py_None); Py_INCREF(Py_None);
  __pyx_v_all_points_found = Py_None; Py_INCREF(Py_None);
  __pyx_v_pt_tuple = Py_None; Py_INCREF(Py_None);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_raw_im_small), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "raw_im_small")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 178; goto __pyx_L1;}

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":232 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_time); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_time); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_1 = PyObject_CallObject(__pyx_2, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_3 = PyFloat_AsDouble(__pyx_1); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 232; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_v_entry_time = __pyx_3;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":234 */
  __pyx_2 = PyInt_FromLong(21); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(21); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_1);
  __pyx_2 = 0;
  __pyx_1 = 0;
  __pyx_2 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_Size), __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_6motmot_9FastImage_9FastImage_Size)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; goto __pyx_L1;}
  Py_DECREF(((PyObject *)__pyx_v_roi2_sz));
  __pyx_v_roi2_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":236 */
  __pyx_1 = PyList_New(0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 236; goto __pyx_L1;}
  Py_DECREF(__pyx_v_all_points_found);
  __pyx_v_all_points_found = __pyx_1;
  __pyx_1 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":237 */
  __pyx_v_n_found_points = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":240 */
  __pyx_5 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.width == __pyx_v_raw_im_small->__pyx_base.imsiz->sz.width);
  if (__pyx_5) {
    __pyx_5 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.height == __pyx_v_raw_im_small->__pyx_base.imsiz->sz.height);
  }
  __pyx_6 = (!__pyx_5);
  if (__pyx_6) {
    __pyx_4 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; goto __pyx_L1;}
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_str); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; goto __pyx_L1;}
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; goto __pyx_L1;}
    Py_INCREF(((PyObject *)__pyx_v_raw_im_small->__pyx_base.imsiz));
    PyTuple_SET_ITEM(__pyx_1, 0, ((PyObject *)__pyx_v_raw_im_small->__pyx_base.imsiz));
    __pyx_7 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_str); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; goto __pyx_L1;}
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; goto __pyx_L1;}
    Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
    PyTuple_SET_ITEM(__pyx_1, 0, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
    __pyx_8 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_2, 0, __pyx_7);
    PyTuple_SET_ITEM(__pyx_2, 1, __pyx_8);
    __pyx_7 = 0;
    __pyx_8 = 0;
    __pyx_1 = PyNumber_Remainder(__pyx_k18p, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    __pyx_7 = PyTuple_New(1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_7, 0, __pyx_1);
    __pyx_1 = 0;
    __pyx_8 = PyObject_CallObject(__pyx_4, __pyx_7); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; goto __pyx_L1;}
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    Py_DECREF(__pyx_7); __pyx_7 = 0;
    __Pyx_Raise(__pyx_8, 0, 0);
    Py_DECREF(__pyx_8); __pyx_8 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 242; goto __pyx_L1;}
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":247 */
  Py_BEGIN_ALLOW_THREADS;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":252 */
  CHK_NOGIL(ippiAbsDiff_8u_C1R(((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view->__pyx_base.step,((Ipp8u *)__pyx_v_raw_im_small->__pyx_base.im),__pyx_v_raw_im_small->__pyx_base.step,((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":262 */
  CHK_NOGIL(ippiSet_8u_C1MR(0,((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im->__pyx_base.imsiz->sz,((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im->__pyx_base.step));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":265 */
  __pyx_5 = __pyx_v_use_cmp;
  if (__pyx_5) {
    CHK_NOGIL(ippiThreshold_Val_8u_C1IR(((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold,ippCmpLess));
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":271 */
  Py_END_ALLOW_THREADS;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":273 */
  while (1) {
    __pyx_6 = (__pyx_v_n_found_points < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->max_num_points);
    if (!__pyx_6) break;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":274 */
    __pyx_5 = (__pyx_v_max_duration_sec != 0.0);
    if (__pyx_5) {

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":275 */
      __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_time); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
      __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_time); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
      Py_DECREF(__pyx_2); __pyx_2 = 0;
      __pyx_4 = PyObject_CallObject(__pyx_1, 0); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      __pyx_3 = PyFloat_AsDouble(__pyx_4); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
      Py_DECREF(__pyx_4); __pyx_4 = 0;
      __pyx_v_now = __pyx_3;

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":276 */
      __pyx_6 = ((__pyx_v_now - __pyx_v_entry_time) > __pyx_v_max_duration_sec);
      if (__pyx_6) {

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":277 */
        __pyx_7 = __Pyx_GetName(__pyx_m, __pyx_n_warnings); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; goto __pyx_L1;}
        __pyx_8 = PyObject_GetAttr(__pyx_7, __pyx_n_warn); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; goto __pyx_L1;}
        Py_DECREF(__pyx_7); __pyx_7 = 0;
        __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; goto __pyx_L1;}
        Py_INCREF(__pyx_k19p);
        PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k19p);
        __pyx_1 = PyDict_New(); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; goto __pyx_L1;}
        __pyx_4 = PyInt_FromLong(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 278; goto __pyx_L1;}
        if (PyDict_SetItem(__pyx_1, __pyx_n_stacklevel, __pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; goto __pyx_L1;}
        Py_DECREF(__pyx_4); __pyx_4 = 0;
        __pyx_7 = PyEval_CallObjectWithKeywords(__pyx_8, __pyx_2, __pyx_1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 277; goto __pyx_L1;}
        Py_DECREF(__pyx_8); __pyx_8 = 0;
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        Py_DECREF(__pyx_1); __pyx_1 = 0;
        Py_DECREF(__pyx_7); __pyx_7 = 0;

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":279 */
        goto __pyx_L5;
        goto __pyx_L7;
      }
      __pyx_L7:;
      goto __pyx_L6;
    }
    __pyx_L6:;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":281 */
    Py_BEGIN_ALLOW_THREADS;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":297 */
    __pyx_5 = __pyx_v_use_cmp;
    if (__pyx_5) {

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":302 */
      CHK_NOGIL(ippiSub_8u_C1RSfs(((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.step,((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step,((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,0));

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":306 */
      CHK_NOGIL(ippiMaxIndx_8u_C1R(((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,(&__pyx_v_max_std_diff),(&__pyx_v_index_x),(&__pyx_v_index_y)));

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":309 */
      __pyx_v_max_abs_diff_ptr = ((((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im) + (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step * __pyx_v_index_y)) + __pyx_v_index_x);

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":310 */
      __pyx_v_max_abs_diff = (__pyx_v_max_abs_diff_ptr[0]);
      goto __pyx_L8;
    }
    /*else*/ {

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":312 */
      __pyx_v_max_std_diff = 0;

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":313 */
      CHK_NOGIL(ippiMaxIndx_8u_C1R(((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,(&__pyx_v_max_abs_diff),(&__pyx_v_index_x),(&__pyx_v_index_y)));
    }
    __pyx_L8:;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":317 */
    __pyx_6 = __pyx_v_use_roi2;
    if (__pyx_6) {

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":319 */
      __pyx_v_left2 = ((__pyx_v_index_x - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":320 */
      __pyx_v_right2 = ((__pyx_v_index_x + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":321 */
      __pyx_v_bottom2 = ((__pyx_v_index_y - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":322 */
      __pyx_v_top2 = ((__pyx_v_index_y + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":324 */
      __pyx_5 = (__pyx_v_left2 < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);
      if (__pyx_5) {
        __pyx_v_left2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left;
        goto __pyx_L10;
      }
      __pyx_L10:;

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":325 */
      __pyx_6 = (__pyx_v_right2 > ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right);
      if (__pyx_6) {
        __pyx_v_right2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right;
        goto __pyx_L11;
      }
      __pyx_L11:;

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":326 */
      __pyx_5 = (__pyx_v_bottom2 < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);
      if (__pyx_5) {
        __pyx_v_bottom2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom;
        goto __pyx_L12;
      }
      __pyx_L12:;

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":327 */
      __pyx_6 = (__pyx_v_top2 > ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top);
      if (__pyx_6) {
        __pyx_v_top2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top;
        goto __pyx_L13;
      }
      __pyx_L13:;

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":328 */
      __pyx_v_roi2_sz->sz.width = ((__pyx_v_right2 - __pyx_v_left2) + 1);

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":329 */
      __pyx_v_roi2_sz->sz.height = ((__pyx_v_top2 - __pyx_v_bottom2) + 1);
      goto __pyx_L9;
    }
    /*else*/ {

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":331 */
      __pyx_v_left2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left;

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":332 */
      __pyx_v_right2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right;

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":333 */
      __pyx_v_bottom2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom;

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":334 */
      __pyx_v_top2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top;

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":335 */
      __pyx_v_roi2_sz->sz.width = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.width;

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":336 */
      __pyx_v_roi2_sz->sz.height = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.height;
    }
    __pyx_L9:;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":338 */
    Py_END_ALLOW_THREADS;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":340 */
    __pyx_4 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im), __pyx_n_roi); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; goto __pyx_L1;}
    __pyx_8 = PyInt_FromLong(__pyx_v_left2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; goto __pyx_L1;}
    __pyx_2 = PyInt_FromLong(__pyx_v_bottom2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; goto __pyx_L1;}
    __pyx_1 = PyTuple_New(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_8);
    PyTuple_SET_ITEM(__pyx_1, 1, __pyx_2);
    Py_INCREF(((PyObject *)__pyx_v_roi2_sz));
    PyTuple_SET_ITEM(__pyx_1, 2, ((PyObject *)__pyx_v_roi2_sz));
    __pyx_8 = 0;
    __pyx_2 = 0;
    __pyx_7 = PyObject_CallObject(__pyx_4, __pyx_1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; goto __pyx_L1;}
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    if (!__Pyx_TypeTest(__pyx_7, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 340; goto __pyx_L1;}
    Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view));
    ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_7);
    __pyx_7 = 0;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":341 */
    __pyx_5 = __pyx_v_use_cmp;
    if (__pyx_5) {
      __pyx_8 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im), __pyx_n_roi); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
      __pyx_2 = PyInt_FromLong(__pyx_v_left2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
      __pyx_4 = PyInt_FromLong(__pyx_v_bottom2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
      __pyx_1 = PyTuple_New(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_1, 0, __pyx_2);
      PyTuple_SET_ITEM(__pyx_1, 1, __pyx_4);
      Py_INCREF(((PyObject *)__pyx_v_roi2_sz));
      PyTuple_SET_ITEM(__pyx_1, 2, ((PyObject *)__pyx_v_roi2_sz));
      __pyx_2 = 0;
      __pyx_4 = 0;
      __pyx_7 = PyObject_CallObject(__pyx_8, __pyx_1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
      Py_DECREF(__pyx_8); __pyx_8 = 0;
      Py_DECREF(__pyx_1); __pyx_1 = 0;
      if (!__Pyx_TypeTest(__pyx_7, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; goto __pyx_L1;}
      Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi2_view));
      ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_7);
      __pyx_7 = 0;
      goto __pyx_L14;
    }
    __pyx_L14:;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":343 */
    Py_BEGIN_ALLOW_THREADS;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":347 */
    __pyx_v_clear_despeckle_thresh = ((Ipp8u)(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold * __pyx_v_max_abs_diff));

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":348 */
    __pyx_6 = (__pyx_v_clear_despeckle_thresh < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_despeckle_threshold);
    if (__pyx_6) {
      __pyx_v_clear_despeckle_thresh = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_despeckle_threshold;
      goto __pyx_L15;
    }
    __pyx_L15:;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":351 */
    CHK_NOGIL(ippiThreshold_Val_8u_C1IR(((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.step,__pyx_v_roi2_sz->sz,__pyx_v_clear_despeckle_thresh,0,ippCmpLess));

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":355 */
    __pyx_v_found_point = 1;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":357 */
    __pyx_5 = (!__pyx_v_use_cmp);
    if (__pyx_5) {
      __pyx_6 = (__pyx_v_max_abs_diff < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold);
      if (__pyx_6) {

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":359 */
        __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":360 */
        __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":361 */
        __pyx_v_x0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":362 */
        __pyx_v_y0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":363 */
        __pyx_v_found_point = 0;

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":364 */
        __pyx_v_max_abs_diff = 0;
        goto __pyx_L17;
      }
      __pyx_L17:;
      goto __pyx_L16;
    }
    /*else*/ {
      __pyx_5 = (__pyx_v_max_std_diff == 0);
      if (__pyx_5) {

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":367 */
        __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":368 */
        __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":369 */
        __pyx_v_x0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":370 */
        __pyx_v_y0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":371 */
        __pyx_v_found_point = 0;
        goto __pyx_L18;
      }
      __pyx_L18:;
    }
    __pyx_L16:;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":372 */
    __pyx_6 = __pyx_v_found_point;
    if (__pyx_6) {

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":373 */
      __pyx_v_result = fit_params(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->pState,(&__pyx_v_x0),(&__pyx_v_y0),(&__pyx_v_Mu00),(&__pyx_v_Uu11),(&__pyx_v_Uu20),(&__pyx_v_Uu02),__pyx_v_roi2_sz->sz.width,__pyx_v_roi2_sz->sz.height,((unsigned char *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.step);

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":380 */
      __pyx_5 = (__pyx_v_result == CFitParamsNoError);
      if (__pyx_5) {

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":381 */
        __pyx_v_area = __pyx_v_Mu00;

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":382 */
        __pyx_v_eigen_err = eigen_2x2_real(__pyx_v_Uu20,__pyx_v_Uu11,__pyx_v_Uu11,__pyx_v_Uu02,(&__pyx_v_evalA),(&__pyx_v_evecA1),(&__pyx_v_evalB),(&__pyx_v_evecB1));

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":386 */
        __pyx_6 = __pyx_v_eigen_err;
        if (__pyx_6) {

          /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":387 */
          __pyx_v_slope = __pyx_v_23realtime_image_analysis_nan;

          /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":388 */
          __pyx_v_eccentricity = 0.0;
          goto __pyx_L21;
        }
        /*else*/ {

          /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":390 */
          __pyx_v_rise = 1.0;

          /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":391 */
          __pyx_5 = (__pyx_v_evalA > __pyx_v_evalB);
          if (__pyx_5) {

            /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":392 */
            __pyx_v_run = __pyx_v_evecA1;

            /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":393 */
            __pyx_v_eccentricity = (__pyx_v_evalA / __pyx_v_evalB);
            goto __pyx_L22;
          }
          /*else*/ {

            /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":395 */
            __pyx_v_run = __pyx_v_evecB1;

            /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":396 */
            __pyx_v_eccentricity = (__pyx_v_evalB / __pyx_v_evalA);
          }
          __pyx_L22:;

          /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":397 */
          __pyx_v_slope = (__pyx_v_rise / __pyx_v_run);
        }
        __pyx_L21:;
        goto __pyx_L20;
      }
      __pyx_6 = (__pyx_v_result == CFitParamsZeroMomentError);
      if (__pyx_6) {

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":400 */
        __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":401 */
        __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":402 */
        __pyx_v_x0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":403 */
        __pyx_v_y0_abs = __pyx_v_23realtime_image_analysis_nan;

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":404 */
        __pyx_v_found_point = 0;
        goto __pyx_L20;
      }
      __pyx_5 = (__pyx_v_result == CFitParamsCentralMomentError);
      if (__pyx_5) {
        __pyx_v_slope = __pyx_v_23realtime_image_analysis_nan;
        goto __pyx_L20;
      }
      /*else*/ {
        SET_ERR(1);
      }
      __pyx_L20:;

      /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":410 */
      __pyx_6 = __pyx_v_found_point;
      if (__pyx_6) {

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":411 */
        __pyx_v_x0_abs = (__pyx_v_x0 + __pyx_v_left2);

        /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":412 */
        __pyx_v_y0_abs = (__pyx_v_y0 + __pyx_v_bottom2);
        goto __pyx_L23;
      }
      __pyx_L23:;
      goto __pyx_L19;
    }
    __pyx_L19:;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":415 */
    Py_END_ALLOW_THREADS;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":417 */
    __pyx_5 = __pyx_v_found_point;
    if (__pyx_5) {
      __pyx_6 = (!((__pyx_v_n_found_points + 1) >= ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->max_num_points));
      if (__pyx_6) {
        __pyx_2 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view), __pyx_n_set_val); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; goto __pyx_L1;}
        __pyx_4 = PyInt_FromLong(0); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; goto __pyx_L1;}
        __pyx_8 = PyTuple_New(2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; goto __pyx_L1;}
        PyTuple_SET_ITEM(__pyx_8, 0, __pyx_4);
        Py_INCREF(((PyObject *)__pyx_v_roi2_sz));
        PyTuple_SET_ITEM(__pyx_8, 1, ((PyObject *)__pyx_v_roi2_sz));
        __pyx_4 = 0;
        __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_8); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; goto __pyx_L1;}
        Py_DECREF(__pyx_2); __pyx_2 = 0;
        Py_DECREF(__pyx_8); __pyx_8 = 0;
        Py_DECREF(__pyx_1); __pyx_1 = 0;
        goto __pyx_L25;
      }
      __pyx_L25:;
      goto __pyx_L24;
    }
    __pyx_L24:;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":421 */
    __pyx_5 = (!__pyx_v_found_point);
    if (__pyx_5) {
      goto __pyx_L5;
      goto __pyx_L26;
    }
    __pyx_L26:;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":424 */
    __pyx_7 = __Pyx_GetName(__pyx_b, __pyx_n_return_max_abs_diff); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 424; goto __pyx_L1;}
    __pyx_6 = PyObject_IsTrue(__pyx_7); if (__pyx_6 < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 424; goto __pyx_L1;}
    Py_DECREF(__pyx_7); __pyx_7 = 0;
    if (__pyx_6) {
      __pyx_4 = PyFloat_FromDouble(__pyx_v_x0_abs); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; goto __pyx_L1;}
      __pyx_2 = PyFloat_FromDouble(__pyx_v_y0_abs); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; goto __pyx_L1;}
      __pyx_8 = PyFloat_FromDouble(__pyx_v_area); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; goto __pyx_L1;}
      __pyx_1 = PyFloat_FromDouble(__pyx_v_slope); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; goto __pyx_L1;}
      __pyx_7 = PyFloat_FromDouble(__pyx_v_eccentricity); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; goto __pyx_L1;}
      __pyx_9 = PyInt_FromLong(__pyx_v_max_abs_diff); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; goto __pyx_L1;}
      __pyx_10 = PyInt_FromLong(__pyx_v_max_std_diff); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; goto __pyx_L1;}
      __pyx_11 = PyTuple_New(7); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 425; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_11, 0, __pyx_4);
      PyTuple_SET_ITEM(__pyx_11, 1, __pyx_2);
      PyTuple_SET_ITEM(__pyx_11, 2, __pyx_8);
      PyTuple_SET_ITEM(__pyx_11, 3, __pyx_1);
      PyTuple_SET_ITEM(__pyx_11, 4, __pyx_7);
      PyTuple_SET_ITEM(__pyx_11, 5, __pyx_9);
      PyTuple_SET_ITEM(__pyx_11, 6, __pyx_10);
      __pyx_4 = 0;
      __pyx_2 = 0;
      __pyx_8 = 0;
      __pyx_1 = 0;
      __pyx_7 = 0;
      __pyx_9 = 0;
      __pyx_10 = 0;
      Py_DECREF(__pyx_v_pt_tuple);
      __pyx_v_pt_tuple = __pyx_11;
      __pyx_11 = 0;
      goto __pyx_L27;
    }
    /*else*/ {
      __pyx_4 = PyFloat_FromDouble(__pyx_v_x0_abs); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; goto __pyx_L1;}
      __pyx_2 = PyFloat_FromDouble(__pyx_v_y0_abs); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; goto __pyx_L1;}
      __pyx_8 = PyFloat_FromDouble(__pyx_v_area); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; goto __pyx_L1;}
      __pyx_1 = PyFloat_FromDouble(__pyx_v_slope); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; goto __pyx_L1;}
      __pyx_7 = PyFloat_FromDouble(__pyx_v_eccentricity); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; goto __pyx_L1;}
      __pyx_9 = PyTuple_New(5); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 427; goto __pyx_L1;}
      PyTuple_SET_ITEM(__pyx_9, 0, __pyx_4);
      PyTuple_SET_ITEM(__pyx_9, 1, __pyx_2);
      PyTuple_SET_ITEM(__pyx_9, 2, __pyx_8);
      PyTuple_SET_ITEM(__pyx_9, 3, __pyx_1);
      PyTuple_SET_ITEM(__pyx_9, 4, __pyx_7);
      __pyx_4 = 0;
      __pyx_2 = 0;
      __pyx_8 = 0;
      __pyx_1 = 0;
      __pyx_7 = 0;
      Py_DECREF(__pyx_v_pt_tuple);
      __pyx_v_pt_tuple = __pyx_9;
      __pyx_9 = 0;
    }
    __pyx_L27:;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":429 */
    __pyx_10 = PyObject_GetAttr(__pyx_v_all_points_found, __pyx_n_append); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 429; goto __pyx_L1;}
    __pyx_11 = PyTuple_New(1); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 429; goto __pyx_L1;}
    Py_INCREF(__pyx_v_pt_tuple);
    PyTuple_SET_ITEM(__pyx_11, 0, __pyx_v_pt_tuple);
    __pyx_4 = PyObject_CallObject(__pyx_10, __pyx_11); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 429; goto __pyx_L1;}
    Py_DECREF(__pyx_10); __pyx_10 = 0;
    Py_DECREF(__pyx_11); __pyx_11 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;

    /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":430 */
    __pyx_v_n_found_points = (__pyx_v_n_found_points + 1);
  }
  __pyx_L5:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":432 */
  Py_INCREF(__pyx_v_all_points_found);
  __pyx_r = __pyx_v_all_points_found;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_7);
  Py_XDECREF(__pyx_8);
  Py_XDECREF(__pyx_9);
  Py_XDECREF(__pyx_10);
  Py_XDECREF(__pyx_11);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.do_work");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_roi2_sz);
  Py_DECREF(__pyx_v_all_points_found);
  Py_DECREF(__pyx_v_pt_tuple);
  Py_DECREF(__pyx_v_self);
  Py_DECREF((PyObject *)__pyx_v_raw_im_small);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_get_image_view(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_get_image_view(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_which = 0;
  PyObject *__pyx_v_im;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  static char *__pyx_argnames[] = {"which",0};
  __pyx_v_which = __pyx_k10;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "|O", __pyx_argnames, &__pyx_v_which)) return 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_which);
  __pyx_v_im = Py_None; Py_INCREF(Py_None);

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":435 */
  __pyx_1 = PyObject_GetItem(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->imname2im, __pyx_v_which); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 435; goto __pyx_L1;}
  Py_DECREF(__pyx_v_im);
  __pyx_v_im = __pyx_1;
  __pyx_1 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":436 */
  Py_INCREF(__pyx_v_im);
  __pyx_r = __pyx_v_im;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.get_image_view");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_im);
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_which);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 440; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.roi2_radius.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  int __pyx_1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_value);
  __pyx_1 = PyInt_AsLong(__pyx_v_value); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 442; goto __pyx_L1;}
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius = __pyx_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.roi2_radius.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_value);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);
  __pyx_1 = PyFloat_FromDouble(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 446; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.clear_threshold.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  float __pyx_1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_value);
  __pyx_1 = PyFloat_AsDouble(__pyx_v_value); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 448; goto __pyx_L1;}
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold = __pyx_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.clear_threshold.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_value);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 452; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.diff_threshold.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  Ipp8u __pyx_1;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_value);
  __pyx_1 = PyInt_AsLong(__pyx_v_value); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 454; goto __pyx_L1;}
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold = __pyx_1;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.diff_threshold.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_value);
  return __pyx_r;
}

static PyObject *__pyx_n__scale_factor;

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  Py_INCREF(__pyx_v_self);
  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n__scale_factor); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; goto __pyx_L1;}
  __pyx_r = __pyx_1;
  __pyx_1 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.scale_factor.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k21p;

static char __pyx_k21[] = "setting scale_factor to";

static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_value);

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":460 */
  if (__Pyx_PrintItem(__pyx_k21p) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; goto __pyx_L1;}
  if (__Pyx_PrintItem(__pyx_v_value) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; goto __pyx_L1;}
  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; goto __pyx_L1;}

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":461 */
  if (PyObject_SetAttr(__pyx_v_self, __pyx_n__scale_factor, __pyx_v_value) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 461; goto __pyx_L1;}

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.scale_factor.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_value);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_3roi___get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_3roi___get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  Py_INCREF(__pyx_v_self);
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; goto __pyx_L1;}
  __pyx_3 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; goto __pyx_L1;}
  __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; goto __pyx_L1;}
  __pyx_5 = PyTuple_New(4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 465; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_5, 1, __pyx_2);
  PyTuple_SET_ITEM(__pyx_5, 2, __pyx_3);
  PyTuple_SET_ITEM(__pyx_5, 3, __pyx_4);
  __pyx_1 = 0;
  __pyx_2 = 0;
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_r = __pyx_5;
  __pyx_5 = 0;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.roi.__get__");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  return __pyx_r;
}

static PyObject *__pyx_k22p;
static PyObject *__pyx_k23p;
static PyObject *__pyx_k24p;
static PyObject *__pyx_k25p;

static char __pyx_k22[] = "attempting to set ROI left %d";
static char __pyx_k23[] = "attempting to set ROI bottom %d";
static char __pyx_k24[] = "attempting to set ROI right to %d (width %d)";
static char __pyx_k25[] = "attempting to set ROI top to %d (height %d)";

static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_3roi___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_lbrt); /*proto*/
static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_3roi___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_lbrt) {
  int __pyx_v_l;
  int __pyx_v_b;
  int __pyx_v_r;
  int __pyx_v_t;
  int __pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  int __pyx_3;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  Py_INCREF(__pyx_v_self);
  Py_INCREF(__pyx_v_lbrt);

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":469 */
  __pyx_1 = PyObject_GetIter(__pyx_v_lbrt); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; goto __pyx_L1;}
  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; goto __pyx_L1;}
  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_v_l = __pyx_3;
  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; goto __pyx_L1;}
  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_v_b = __pyx_3;
  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; goto __pyx_L1;}
  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_v_r = __pyx_3;
  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; goto __pyx_L1;}
  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_v_t = __pyx_3;
  if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":470 */
  __pyx_3 = (__pyx_v_l == ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);
  if (__pyx_3) {
    __pyx_3 = (__pyx_v_b == ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);
    if (__pyx_3) {
      __pyx_3 = (__pyx_v_r == ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right);
      if (__pyx_3) {
        __pyx_3 = (__pyx_v_t == ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top);
      }
    }
  }
  if (__pyx_3) {
    __pyx_r = 0;
    goto __pyx_L0;
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":475 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left = __pyx_v_l;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":476 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom = __pyx_v_b;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":477 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right = __pyx_v_r;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":478 */
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top = __pyx_v_t;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":480 */
  __pyx_3 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left < 0);
  if (__pyx_3) {
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 481; goto __pyx_L1;}
    __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 481; goto __pyx_L1;}
    __pyx_4 = PyNumber_Remainder(__pyx_k22p, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 481; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 481; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_4);
    __pyx_4 = 0;
    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 481; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_Raise(__pyx_4, 0, 0);
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 481; goto __pyx_L1;}
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":482 */
  __pyx_3 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom < 0);
  if (__pyx_3) {
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; goto __pyx_L1;}
    __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; goto __pyx_L1;}
    __pyx_4 = PyNumber_Remainder(__pyx_k23p, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_1, 0, __pyx_4);
    __pyx_4 = 0;
    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    __Pyx_Raise(__pyx_4, 0, 0);
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 483; goto __pyx_L1;}
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":484 */
  __pyx_3 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right >= ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxwidth);
  if (__pyx_3) {
    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; goto __pyx_L1;}
    __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; goto __pyx_L1;}
    __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxwidth); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; goto __pyx_L1;}
    __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_1);
    PyTuple_SET_ITEM(__pyx_5, 1, __pyx_4);
    __pyx_1 = 0;
    __pyx_4 = 0;
    __pyx_1 = PyNumber_Remainder(__pyx_k24p, __pyx_5); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_1);
    __pyx_1 = 0;
    __pyx_5 = PyObject_CallObject(__pyx_2, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; goto __pyx_L1;}
    Py_DECREF(__pyx_2); __pyx_2 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    __Pyx_Raise(__pyx_5, 0, 0);
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; goto __pyx_L1;}
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":486 */
  __pyx_3 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top >= ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxheight);
  if (__pyx_3) {
    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
    __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
    __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxheight); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
    __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_5, 0, __pyx_2);
    PyTuple_SET_ITEM(__pyx_5, 1, __pyx_4);
    __pyx_2 = 0;
    __pyx_4 = 0;
    __pyx_2 = PyNumber_Remainder(__pyx_k25p, __pyx_5); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
    __pyx_2 = 0;
    __pyx_5 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
    Py_DECREF(__pyx_1); __pyx_1 = 0;
    Py_DECREF(__pyx_4); __pyx_4 = 0;
    __Pyx_Raise(__pyx_5, 0, 0);
    Py_DECREF(__pyx_5); __pyx_5 = 0;
    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":489 */
  __pyx_2 = PyInt_FromLong(((((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left) + 1)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(((((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom) + 1)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_1);
  __pyx_2 = 0;
  __pyx_1 = 0;
  __pyx_5 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_Size), __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  if (!__Pyx_TypeTest(__pyx_5, __pyx_ptype_6motmot_9FastImage_9FastImage_Size)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)__pyx_5);
  __pyx_5 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":491 */
  __pyx_2 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im), __pyx_n_roi); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; goto __pyx_L1;}
  __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; goto __pyx_L1;}
  __pyx_5 = PyTuple_New(3); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_5, 0, __pyx_1);
  PyTuple_SET_ITEM(__pyx_5, 1, __pyx_4);
  Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  PyTuple_SET_ITEM(__pyx_5, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  __pyx_1 = 0;
  __pyx_4 = 0;
  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_5); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_1);
  __pyx_1 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":492 */
  __pyx_4 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im), __pyx_n_roi); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; goto __pyx_L1;}
  __pyx_5 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; goto __pyx_L1;}
  __pyx_1 = PyTuple_New(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_1, 0, __pyx_2);
  PyTuple_SET_ITEM(__pyx_1, 1, __pyx_5);
  Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  PyTuple_SET_ITEM(__pyx_1, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  __pyx_2 = 0;
  __pyx_5 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_4, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_2);
  __pyx_2 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":493 */
  __pyx_5 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im), __pyx_n_roi); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; goto __pyx_L1;}
  __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_4);
  PyTuple_SET_ITEM(__pyx_2, 1, __pyx_1);
  Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  PyTuple_SET_ITEM(__pyx_2, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  __pyx_4 = 0;
  __pyx_1 = 0;
  __pyx_4 = PyObject_CallObject(__pyx_5, __pyx_2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; goto __pyx_L1;}
  Py_DECREF(__pyx_5); __pyx_5 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  if (!__Pyx_TypeTest(__pyx_4, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_4);
  __pyx_4 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":494 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im), __pyx_n_roi); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; goto __pyx_L1;}
  __pyx_5 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; goto __pyx_L1;}
  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; goto __pyx_L1;}
  __pyx_4 = PyTuple_New(3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_4, 0, __pyx_5);
  PyTuple_SET_ITEM(__pyx_4, 1, __pyx_2);
  Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  PyTuple_SET_ITEM(__pyx_4, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
  __pyx_5 = 0;
  __pyx_2 = 0;
  __pyx_5 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  if (!__Pyx_TypeTest(__pyx_5, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; goto __pyx_L1;}
  Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view));
  ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_5);
  __pyx_5 = 0;

  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.roi.__set__");
  __pyx_r = -1;
  __pyx_L0:;
  Py_DECREF(__pyx_v_self);
  Py_DECREF(__pyx_v_lbrt);
  return __pyx_r;
}

static PyObject *__pyx_n_toself_add_weighted;
static PyObject *__pyx_n_get_8u_copy_put;
static PyObject *__pyx_n_get_32f_copy_put;
static PyObject *__pyx_n_toself_square;
static PyObject *__pyx_n_get_square_put;
static PyObject *__pyx_n_get_subtracted_put;
static PyObject *__pyx_n_toself_multiply;
static PyObject *__pyx_n_get_compare_put;
static PyObject *__pyx_n_CmpGreater;
static PyObject *__pyx_n_set_val_masked;

static PyObject *__pyx_f_23realtime_image_analysis_bg_help_slow(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_bg_help_slow(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_mean_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_fastframef32_tmp = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_sumsqf = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_mean2 = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_stdframe = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_running_mean8u_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_hw_roi_frame = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_noisy_pixels_mask = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_compareframe8u = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *__pyx_v_max_frame_size = 0;
  double __pyx_v_ALPHA;
  double __pyx_v_C;
  PyObject *__pyx_r;
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  static char *__pyx_argnames[] = {"running_mean_im","fastframef32_tmp","running_sumsqf","mean2","running_stdframe","running_mean8u_im","hw_roi_frame","noisy_pixels_mask","compareframe8u","max_frame_size","ALPHA","C",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OOOOOOOOOOdd", __pyx_argnames, &__pyx_v_running_mean_im, &__pyx_v_fastframef32_tmp, &__pyx_v_running_sumsqf, &__pyx_v_mean2, &__pyx_v_running_stdframe, &__pyx_v_running_mean8u_im, &__pyx_v_hw_roi_frame, &__pyx_v_noisy_pixels_mask, &__pyx_v_compareframe8u, &__pyx_v_max_frame_size, &__pyx_v_ALPHA, &__pyx_v_C)) return 0;
  Py_INCREF((PyObject *)__pyx_v_running_mean_im);
  Py_INCREF((PyObject *)__pyx_v_fastframef32_tmp);
  Py_INCREF((PyObject *)__pyx_v_running_sumsqf);
  Py_INCREF((PyObject *)__pyx_v_mean2);
  Py_INCREF((PyObject *)__pyx_v_running_stdframe);
  Py_INCREF((PyObject *)__pyx_v_running_mean8u_im);
  Py_INCREF((PyObject *)__pyx_v_hw_roi_frame);
  Py_INCREF((PyObject *)__pyx_v_noisy_pixels_mask);
  Py_INCREF((PyObject *)__pyx_v_compareframe8u);
  Py_INCREF(__pyx_v_max_frame_size);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_mean_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "fastframef32_tmp")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_sumsqf), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_sumsqf")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_mean2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "mean2")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_stdframe), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_stdframe")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean8u_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "running_mean8u_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 501; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_hw_roi_frame), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "hw_roi_frame")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 502; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_noisy_pixels_mask), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "noisy_pixels_mask")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_compareframe8u), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "compareframe8u")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_max_frame_size), __pyx_ptype_6motmot_9FastImage_9FastImage_Size, 1, "max_frame_size")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 505; goto __pyx_L1;}

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":509 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean_im), __pyx_n_toself_add_weighted); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; goto __pyx_L1;}
  __pyx_2 = PyFloat_FromDouble(__pyx_v_ALPHA); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(3); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_hw_roi_frame));
  PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_hw_roi_frame));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 2, __pyx_2);
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":511 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean_im), __pyx_n_get_8u_copy_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_running_mean8u_im));
  PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_running_mean8u_im));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":514 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_hw_roi_frame), __pyx_n_get_32f_copy_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_fastframef32_tmp));
  PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_fastframef32_tmp));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 514; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":515 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_n_toself_square); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":516 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_sumsqf), __pyx_n_toself_add_weighted); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; goto __pyx_L1;}
  __pyx_3 = PyFloat_FromDouble(__pyx_v_ALPHA); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_fastframef32_tmp));
  PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_fastframef32_tmp));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 2, __pyx_3);
  __pyx_3 = 0;
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":517 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean_im), __pyx_n_get_square_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_mean2));
  PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_mean2));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":518 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_sumsqf), __pyx_n_get_subtracted_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_mean2));
  PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_mean2));
  Py_INCREF(((PyObject *)__pyx_v_running_stdframe));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_running_stdframe));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 2, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":521 */
  __pyx_v_C = 6.0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":522 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_stdframe), __pyx_n_toself_multiply); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; goto __pyx_L1;}
  __pyx_2 = PyFloat_FromDouble(__pyx_v_C); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = 0;
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":523 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_stdframe), __pyx_n_get_8u_copy_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; goto __pyx_L1;}
  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; goto __pyx_L1;}
  Py_INCREF(((PyObject *)__pyx_v_compareframe8u));
  PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_compareframe8u));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":526 */
  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean8u_im), __pyx_n_get_compare_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
  __pyx_3 = PyInt_FromLong(200); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_FastImage); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
  __pyx_4 = PyObject_GetAttr(__pyx_2, __pyx_n_CmpGreater); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_2 = PyTuple_New(4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_3);
  Py_INCREF(((PyObject *)__pyx_v_noisy_pixels_mask));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_noisy_pixels_mask));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 2, ((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 3, __pyx_4);
  __pyx_3 = 0;
  __pyx_4 = 0;
  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":527 */
  __pyx_4 = PyObject_GetAttr(((PyObject *)__pyx_v_compareframe8u), __pyx_n_set_val_masked); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; goto __pyx_L1;}
  __pyx_1 = PyInt_FromLong(25); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; goto __pyx_L1;}
  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; goto __pyx_L1;}
  PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
  Py_INCREF(((PyObject *)__pyx_v_noisy_pixels_mask));
  PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_noisy_pixels_mask));
  Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
  PyTuple_SET_ITEM(__pyx_2, 2, ((PyObject *)__pyx_v_max_frame_size));
  __pyx_1 = 0;
  __pyx_3 = PyObject_CallObject(__pyx_4, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; goto __pyx_L1;}
  Py_DECREF(__pyx_4); __pyx_4 = 0;
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  Py_DECREF(__pyx_3); __pyx_3 = 0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  __Pyx_AddTraceback("realtime_image_analysis.bg_help_slow");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF((PyObject *)__pyx_v_running_mean_im);
  Py_DECREF((PyObject *)__pyx_v_fastframef32_tmp);
  Py_DECREF((PyObject *)__pyx_v_running_sumsqf);
  Py_DECREF((PyObject *)__pyx_v_mean2);
  Py_DECREF((PyObject *)__pyx_v_running_stdframe);
  Py_DECREF((PyObject *)__pyx_v_running_mean8u_im);
  Py_DECREF((PyObject *)__pyx_v_hw_roi_frame);
  Py_DECREF((PyObject *)__pyx_v_noisy_pixels_mask);
  Py_DECREF((PyObject *)__pyx_v_compareframe8u);
  Py_DECREF(__pyx_v_max_frame_size);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_bg_help(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_23realtime_image_analysis_bg_help(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_mean_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_fastframef32_tmp = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_sumsqf = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_mean2 = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_stdframe = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_running_mean8u_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_hw_roi_frame = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_noisy_pixels_mask = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_compareframe8u = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *__pyx_v_max_frame_size = 0;
  float __pyx_v_ALPHA;
  double __pyx_v_C;
  PyObject *__pyx_r;
  static char *__pyx_argnames[] = {"running_mean_im","fastframef32_tmp","running_sumsqf","mean2","running_stdframe","running_mean8u_im","hw_roi_frame","noisy_pixels_mask","compareframe8u","max_frame_size","ALPHA","C",0};
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OOOOOOOOOOfd", __pyx_argnames, &__pyx_v_running_mean_im, &__pyx_v_fastframef32_tmp, &__pyx_v_running_sumsqf, &__pyx_v_mean2, &__pyx_v_running_stdframe, &__pyx_v_running_mean8u_im, &__pyx_v_hw_roi_frame, &__pyx_v_noisy_pixels_mask, &__pyx_v_compareframe8u, &__pyx_v_max_frame_size, &__pyx_v_ALPHA, &__pyx_v_C)) return 0;
  Py_INCREF((PyObject *)__pyx_v_running_mean_im);
  Py_INCREF((PyObject *)__pyx_v_fastframef32_tmp);
  Py_INCREF((PyObject *)__pyx_v_running_sumsqf);
  Py_INCREF((PyObject *)__pyx_v_mean2);
  Py_INCREF((PyObject *)__pyx_v_running_stdframe);
  Py_INCREF((PyObject *)__pyx_v_running_mean8u_im);
  Py_INCREF((PyObject *)__pyx_v_hw_roi_frame);
  Py_INCREF((PyObject *)__pyx_v_noisy_pixels_mask);
  Py_INCREF((PyObject *)__pyx_v_compareframe8u);
  Py_INCREF(__pyx_v_max_frame_size);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_mean_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 530; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "fastframef32_tmp")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_sumsqf), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_sumsqf")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 532; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_mean2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "mean2")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 533; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_stdframe), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_stdframe")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean8u_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "running_mean8u_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 535; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_hw_roi_frame), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "hw_roi_frame")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 536; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_noisy_pixels_mask), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "noisy_pixels_mask")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 537; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_compareframe8u), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "compareframe8u")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 538; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_max_frame_size), __pyx_ptype_6motmot_9FastImage_9FastImage_Size, 1, "max_frame_size")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; goto __pyx_L1;}

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":543 */
  Py_BEGIN_ALLOW_THREADS;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":546 */
  CHK_NOGIL(ippiAddWeighted_8u32f_C1IR(((Ipp8u *)__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f *)__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":552 */
  CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f *)__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp8u *)__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":559 */
  CHK_NOGIL(ippiConvert_8u32f_C1R(((Ipp8u *)__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f *)__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":564 */
  CHK_NOGIL(ippiSqr_32f_C1IR(((Ipp32f *)__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":568 */
  CHK_NOGIL(ippiAddWeighted_32f_C1IR(((Ipp32f *)__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,((Ipp32f *)__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":572 */
  CHK_NOGIL(ippiSqr_32f_C1R(((Ipp32f *)__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp32f *)__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":576 */
  CHK_NOGIL(ippiSub_32f_C1R(((Ipp32f *)__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,((Ipp32f *)__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,((Ipp32f *)__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":583 */
  CHK_NOGIL(ippiMulC_32f_C1IR(__pyx_v_C,((Ipp32f *)__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":586 */
  CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f *)__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,((Ipp8u *)__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":593 */
  CHK_NOGIL(ippiCompareC_8u_C1R(((Ipp8u *)__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,200,((Ipp8u *)__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step,__pyx_v_max_frame_size->sz,ippCmpGreater));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":600 */
  CHK_NOGIL(ippiSet_8u_C1MR(25,((Ipp8u *)__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,((Ipp8u *)__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":602 */
  Py_END_ALLOW_THREADS;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  __Pyx_AddTraceback("realtime_image_analysis.bg_help");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF((PyObject *)__pyx_v_running_mean_im);
  Py_DECREF((PyObject *)__pyx_v_fastframef32_tmp);
  Py_DECREF((PyObject *)__pyx_v_running_sumsqf);
  Py_DECREF((PyObject *)__pyx_v_mean2);
  Py_DECREF((PyObject *)__pyx_v_running_stdframe);
  Py_DECREF((PyObject *)__pyx_v_running_mean8u_im);
  Py_DECREF((PyObject *)__pyx_v_hw_roi_frame);
  Py_DECREF((PyObject *)__pyx_v_noisy_pixels_mask);
  Py_DECREF((PyObject *)__pyx_v_compareframe8u);
  Py_DECREF(__pyx_v_max_frame_size);
  return __pyx_r;
}

static PyObject *__pyx_f_23realtime_image_analysis_do_bg_maint(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_23realtime_image_analysis_do_bg_maint[] = "\n    = Arguments =\n\n    FastImage.FastImage32f running_mean_im   IO - current estimate of mean of x\n    FastImage.FastImage8u hw_roi_frame       Input - current image\n    FastImage.Size max_frame_size            Input - size of all images\n    float ALPHA                              Input\n    FastImage.FastImage8u running_mean8u_im  Output\n    FastImage.FastImage32f fastframef32_tmp  Output (temp/scratch)\n    FastImage.FastImage32f running_sumsqf    IO - current estimate of mean of x^2\n    FastImage.FastImage32f mean2             Output - running_mean_im^2\n    FastImage.FastImage32f std2              Output - running_sumsqf-mean2\n    FastImage.FastImage32f running_stdframe  Output - sqrt(std2)\n    float n_sigma                            Input\n    FastImage.FastImage8u compareframe8u     Output\n    int bright_non_gaussian_cutoff           Input\n    FastImage.FastImage8u noisy_pixels_mask  Input\n    int bright_non_gaussian_replacement      Input\n    int bench                                Input\n\n    = Returns =\n    Benchmarking information if bench != 0\n\n    ";
static PyObject *__pyx_f_23realtime_image_analysis_do_bg_maint(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_mean_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_hw_roi_frame = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *__pyx_v_max_frame_size = 0;
  float __pyx_v_ALPHA;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_running_mean8u_im = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_fastframef32_tmp = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_sumsqf = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_mean2 = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_std2 = 0;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_v_running_stdframe = 0;
  float __pyx_v_n_sigma;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_compareframe8u = 0;
  int __pyx_v_bright_non_gaussian_cutoff;
  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_v_noisy_pixels_mask = 0;
  int __pyx_v_bright_non_gaussian_replacement;
  int __pyx_v_bench;
  int __pyx_v_BENCHMARK;
  IppStatus __pyx_v_errval;
  double __pyx_v_t41;
  double __pyx_v_t42;
  double __pyx_v_t43;
  double __pyx_v_t44;
  double __pyx_v_t45;
  double __pyx_v_t46;
  double __pyx_v_t47;
  double __pyx_v_t48;
  double __pyx_v_t49;
  double __pyx_v_t491;
  double __pyx_v_t492;
  PyObject *__pyx_v_res;
  PyObject *__pyx_r;
  int __pyx_1;
  PyObject *__pyx_2 = 0;
  PyObject *__pyx_3 = 0;
  PyObject *__pyx_4 = 0;
  PyObject *__pyx_5 = 0;
  PyObject *__pyx_6 = 0;
  PyObject *__pyx_7 = 0;
  PyObject *__pyx_8 = 0;
  PyObject *__pyx_9 = 0;
  PyObject *__pyx_10 = 0;
  PyObject *__pyx_11 = 0;
  PyObject *__pyx_12 = 0;
  PyObject *__pyx_13 = 0;
  static char *__pyx_argnames[] = {"running_mean_im","hw_roi_frame","max_frame_size","ALPHA","running_mean8u_im","fastframef32_tmp","running_sumsqf","mean2","std2","running_stdframe","n_sigma","compareframe8u","bright_non_gaussian_cutoff","noisy_pixels_mask","bright_non_gaussian_replacement","bench",0};
  __pyx_v_bench = __pyx_k11;
  if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OOOfOOOOOOfOiOi|i", __pyx_argnames, &__pyx_v_running_mean_im, &__pyx_v_hw_roi_frame, &__pyx_v_max_frame_size, &__pyx_v_ALPHA, &__pyx_v_running_mean8u_im, &__pyx_v_fastframef32_tmp, &__pyx_v_running_sumsqf, &__pyx_v_mean2, &__pyx_v_std2, &__pyx_v_running_stdframe, &__pyx_v_n_sigma, &__pyx_v_compareframe8u, &__pyx_v_bright_non_gaussian_cutoff, &__pyx_v_noisy_pixels_mask, &__pyx_v_bright_non_gaussian_replacement, &__pyx_v_bench)) return 0;
  Py_INCREF((PyObject *)__pyx_v_running_mean_im);
  Py_INCREF((PyObject *)__pyx_v_hw_roi_frame);
  Py_INCREF(__pyx_v_max_frame_size);
  Py_INCREF((PyObject *)__pyx_v_running_mean8u_im);
  Py_INCREF((PyObject *)__pyx_v_fastframef32_tmp);
  Py_INCREF((PyObject *)__pyx_v_running_sumsqf);
  Py_INCREF((PyObject *)__pyx_v_mean2);
  Py_INCREF((PyObject *)__pyx_v_std2);
  Py_INCREF((PyObject *)__pyx_v_running_stdframe);
  Py_INCREF((PyObject *)__pyx_v_compareframe8u);
  Py_INCREF((PyObject *)__pyx_v_noisy_pixels_mask);
  __pyx_v_res = Py_None; Py_INCREF(Py_None);
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_mean_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 604; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_hw_roi_frame), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "hw_roi_frame")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_max_frame_size), __pyx_ptype_6motmot_9FastImage_9FastImage_Size, 1, "max_frame_size")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean8u_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "running_mean8u_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "fastframef32_tmp")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_sumsqf), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_sumsqf")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_mean2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "mean2")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 611; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_std2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "std2")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 612; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_stdframe), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_stdframe")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 613; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_compareframe8u), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "compareframe8u")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 615; goto __pyx_L1;}
  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_noisy_pixels_mask), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "noisy_pixels_mask")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 617; goto __pyx_L1;}

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":648 */
  __pyx_v_BENCHMARK = __pyx_v_bench;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":651 */
  Py_BEGIN_ALLOW_THREADS;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":655 */
  CHK_NOGIL(ippiAddWeighted_8u32f_C1IR(((Ipp8u *)__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f *)__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":658 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {
    __pyx_v_t41 = time_time();
    goto __pyx_L2;
  }
  __pyx_L2:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":661 */
  CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f *)__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp8u *)__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":666 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {
    __pyx_v_t42 = time_time();
    goto __pyx_L3;
  }
  __pyx_L3:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":670 */
  CHK_NOGIL(ippiConvert_8u32f_C1R(((Ipp8u *)__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f *)__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":673 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {
    __pyx_v_t43 = time_time();
    goto __pyx_L4;
  }
  __pyx_L4:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":677 */
  CHK_NOGIL(ippiSqr_32f_C1IR(((Ipp32f *)__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":679 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {
    __pyx_v_t44 = time_time();
    goto __pyx_L5;
  }
  __pyx_L5:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":683 */
  CHK_NOGIL(ippiAddWeighted_32f_C1IR(((Ipp32f *)__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,((Ipp32f *)__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":686 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {
    __pyx_v_t45 = time_time();
    goto __pyx_L6;
  }
  __pyx_L6:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":691 */
  CHK_NOGIL(ippiSqr_32f_C1R(((Ipp32f *)__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp32f *)__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":694 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {
    __pyx_v_t46 = time_time();
    goto __pyx_L7;
  }
  __pyx_L7:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":698 */
  CHK_NOGIL(ippiSub_32f_C1R(((Ipp32f *)__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,((Ipp32f *)__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,((Ipp32f *)__pyx_v_std2->__pyx_base.im),__pyx_v_std2->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":706 */
  CHK_NOGIL(ippiAbs_32f_C1R(((Ipp32f *)__pyx_v_std2->__pyx_base.im),__pyx_v_std2->__pyx_base.step,((Ipp32f *)__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":710 */
  __pyx_v_errval = ippiSqrt_32f_C1IR(((Ipp32f *)__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz);

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":713 */
  CHK_NOGIL(__pyx_v_errval);

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":715 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {
    __pyx_v_t47 = time_time();
    goto __pyx_L8;
  }
  __pyx_L8:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":719 */
  __pyx_1 = (__pyx_v_n_sigma != 1.0);
  if (__pyx_1) {
    CHK_NOGIL(ippiMulC_32f_C1IR(__pyx_v_n_sigma,((Ipp32f *)__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));
    goto __pyx_L9;
  }
  __pyx_L9:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":722 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {
    __pyx_v_t48 = time_time();
    goto __pyx_L10;
  }
  __pyx_L10:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":725 */
  CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f *)__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,((Ipp8u *)__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":730 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {
    __pyx_v_t49 = time_time();
    goto __pyx_L11;
  }
  __pyx_L11:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":734 */
  CHK_NOGIL(ippiCompareC_8u_C1R(((Ipp8u *)__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,__pyx_v_bright_non_gaussian_cutoff,((Ipp8u *)__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step,__pyx_v_max_frame_size->sz,ippCmpGreater));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":739 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {
    __pyx_v_t491 = time_time();
    goto __pyx_L12;
  }
  __pyx_L12:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":742 */
  CHK_NOGIL(ippiSet_8u_C1MR(__pyx_v_bright_non_gaussian_replacement,((Ipp8u *)__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,((Ipp8u *)__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step));

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":745 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {
    __pyx_v_t492 = time_time();
    goto __pyx_L13;
  }
  __pyx_L13:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":748 */
  Py_END_ALLOW_THREADS;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":750 */
  __pyx_1 = __pyx_v_BENCHMARK;
  if (__pyx_1) {
    __pyx_2 = PyFloat_FromDouble(__pyx_v_t41); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 751; goto __pyx_L1;}
    __pyx_3 = PyFloat_FromDouble(__pyx_v_t42); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 751; goto __pyx_L1;}
    __pyx_4 = PyFloat_FromDouble(__pyx_v_t43); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 751; goto __pyx_L1;}
    __pyx_5 = PyFloat_FromDouble(__pyx_v_t44); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 751; goto __pyx_L1;}
    __pyx_6 = PyFloat_FromDouble(__pyx_v_t45); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 751; goto __pyx_L1;}
    __pyx_7 = PyFloat_FromDouble(__pyx_v_t46); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 751; goto __pyx_L1;}
    __pyx_8 = PyFloat_FromDouble(__pyx_v_t47); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 751; goto __pyx_L1;}
    __pyx_9 = PyFloat_FromDouble(__pyx_v_t48); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 751; goto __pyx_L1;}
    __pyx_10 = PyFloat_FromDouble(__pyx_v_t49); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 751; goto __pyx_L1;}
    __pyx_11 = PyFloat_FromDouble(__pyx_v_t491); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 751; goto __pyx_L1;}
    __pyx_12 = PyFloat_FromDouble(__pyx_v_t492); if (!__pyx_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 751; goto __pyx_L1;}
    __pyx_13 = PyTuple_New(11); if (!__pyx_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 751; goto __pyx_L1;}
    PyTuple_SET_ITEM(__pyx_13, 0, __pyx_2);
    PyTuple_SET_ITEM(__pyx_13, 1, __pyx_3);
    PyTuple_SET_ITEM(__pyx_13, 2, __pyx_4);
    PyTuple_SET_ITEM(__pyx_13, 3, __pyx_5);
    PyTuple_SET_ITEM(__pyx_13, 4, __pyx_6);
    PyTuple_SET_ITEM(__pyx_13, 5, __pyx_7);
    PyTuple_SET_ITEM(__pyx_13, 6, __pyx_8);
    PyTuple_SET_ITEM(__pyx_13, 7, __pyx_9);
    PyTuple_SET_ITEM(__pyx_13, 8, __pyx_10);
    PyTuple_SET_ITEM(__pyx_13, 9, __pyx_11);
    PyTuple_SET_ITEM(__pyx_13, 10, __pyx_12);
    __pyx_2 = 0;
    __pyx_3 = 0;
    __pyx_4 = 0;
    __pyx_5 = 0;
    __pyx_6 = 0;
    __pyx_7 = 0;
    __pyx_8 = 0;
    __pyx_9 = 0;
    __pyx_10 = 0;
    __pyx_11 = 0;
    __pyx_12 = 0;
    Py_DECREF(__pyx_v_res);
    __pyx_v_res = __pyx_13;
    __pyx_13 = 0;
    goto __pyx_L14;
  }
  /*else*/ {
    Py_INCREF(Py_None);
    Py_DECREF(__pyx_v_res);
    __pyx_v_res = Py_None;
  }
  __pyx_L14:;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":754 */
  Py_INCREF(__pyx_v_res);
  __pyx_r = __pyx_v_res;
  goto __pyx_L0;

  __pyx_r = Py_None; Py_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1:;
  Py_XDECREF(__pyx_2);
  Py_XDECREF(__pyx_3);
  Py_XDECREF(__pyx_4);
  Py_XDECREF(__pyx_5);
  Py_XDECREF(__pyx_6);
  Py_XDECREF(__pyx_7);
  Py_XDECREF(__pyx_8);
  Py_XDECREF(__pyx_9);
  Py_XDECREF(__pyx_10);
  Py_XDECREF(__pyx_11);
  Py_XDECREF(__pyx_12);
  Py_XDECREF(__pyx_13);
  __Pyx_AddTraceback("realtime_image_analysis.do_bg_maint");
  __pyx_r = 0;
  __pyx_L0:;
  Py_DECREF(__pyx_v_res);
  Py_DECREF((PyObject *)__pyx_v_running_mean_im);
  Py_DECREF((PyObject *)__pyx_v_hw_roi_frame);
  Py_DECREF(__pyx_v_max_frame_size);
  Py_DECREF((PyObject *)__pyx_v_running_mean8u_im);
  Py_DECREF((PyObject *)__pyx_v_fastframef32_tmp);
  Py_DECREF((PyObject *)__pyx_v_running_sumsqf);
  Py_DECREF((PyObject *)__pyx_v_mean2);
  Py_DECREF((PyObject *)__pyx_v_std2);
  Py_DECREF((PyObject *)__pyx_v_running_stdframe);
  Py_DECREF((PyObject *)__pyx_v_compareframe8u);
  Py_DECREF((PyObject *)__pyx_v_noisy_pixels_mask);
  return __pyx_r;
}

static __Pyx_InternTabEntry __pyx_intern_tab[] = {
  {&__pyx_n_CmpGreater, "CmpGreater"},
  {&__pyx_n_FastImage, "FastImage"},
  {&__pyx_n_IppError, "IppError"},
  {&__pyx_n_ValueError, "ValueError"},
  {&__pyx_n__helper, "_helper"},
  {&__pyx_n__scale_factor, "_scale_factor"},
  {&__pyx_n_absdiff, "absdiff"},
  {&__pyx_n_append, "append"},
  {&__pyx_n_cmp, "cmp"},
  {&__pyx_n_cmpdiff, "cmpdiff"},
  {&__pyx_n_distort, "distort"},
  {&__pyx_n_get_32f_copy_put, "get_32f_copy_put"},
  {&__pyx_n_get_8u_copy_put, "get_8u_copy_put"},
  {&__pyx_n_get_compare_put, "get_compare_put"},
  {&__pyx_n_get_square_put, "get_square_put"},
  {&__pyx_n_get_subtracted_put, "get_subtracted_put"},
  {&__pyx_n_mask, "mask"},
  {&__pyx_n_mean, "mean"},
  {&__pyx_n_nan, "nan"},
  {&__pyx_n_numpy, "numpy"},
  {&__pyx_n_nx, "nx"},
  {&__pyx_n_return_max_abs_diff, "return_max_abs_diff"},
  {&__pyx_n_roi, "roi"},
  {&__pyx_n_set_val, "set_val"},
  {&__pyx_n_set_val_masked, "set_val_masked"},
  {&__pyx_n_stacklevel, "stacklevel"},
  {&__pyx_n_str, "str"},
  {&__pyx_n_time, "time"},
  {&__pyx_n_toself_add_weighted, "toself_add_weighted"},
  {&__pyx_n_toself_multiply, "toself_multiply"},
  {&__pyx_n_toself_square, "toself_square"},
  {&__pyx_n_warn, "warn"},
  {&__pyx_n_warnings, "warnings"},
  {0, 0}
};

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_k4p, __pyx_k4, sizeof(__pyx_k4)},
  {&__pyx_k5p, __pyx_k5, sizeof(__pyx_k5)},
  {&__pyx_k12p, __pyx_k12, sizeof(__pyx_k12)},
  {&__pyx_k18p, __pyx_k18, sizeof(__pyx_k18)},
  {&__pyx_k19p, __pyx_k19, sizeof(__pyx_k19)},
  {&__pyx_k21p, __pyx_k21, sizeof(__pyx_k21)},
  {&__pyx_k22p, __pyx_k22, sizeof(__pyx_k22)},
  {&__pyx_k23p, __pyx_k23, sizeof(__pyx_k23)},
  {&__pyx_k24p, __pyx_k24, sizeof(__pyx_k24)},
  {&__pyx_k25p, __pyx_k25, sizeof(__pyx_k25)},
  {0, 0, 0}
};

static PyObject *__pyx_tp_new_23realtime_image_analysis_RealtimeAnalyzer(PyTypeObject *t, PyObject *a, PyObject *k) {
  struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *p;
  PyObject *o = (*t->tp_alloc)(t, 0);
  if (!o) return 0;
  p = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)o);
  p->_roi_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)Py_None); Py_INCREF(Py_None);
  p->absdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->cmpdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->absdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->cmpdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->absdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->cmpdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->mask_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->mean_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->cmp_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->mean_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->cmp_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  p->imname2im = Py_None; Py_INCREF(Py_None);
  if (__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___new__(o, a, k) < 0) {
    Py_DECREF(o); o = 0;
  }
  return o;
}

static void __pyx_tp_dealloc_23realtime_image_analysis_RealtimeAnalyzer(PyObject *o) {
  struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *p = (struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)o;
  {
    PyObject *etype, *eval, *etb;
    PyErr_Fetch(&etype, &eval, &etb);
    ++o->ob_refcnt;
    __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___dealloc__(o);
    if (PyErr_Occurred()) PyErr_WriteUnraisable(o);
    --o->ob_refcnt;
    PyErr_Restore(etype, eval, etb);
  }
  Py_XDECREF(((PyObject *)p->_roi_sz));
  Py_XDECREF(((PyObject *)p->absdiff_im));
  Py_XDECREF(((PyObject *)p->cmpdiff_im));
  Py_XDECREF(((PyObject *)p->absdiff_im_roi_view));
  Py_XDECREF(((PyObject *)p->cmpdiff_im_roi_view));
  Py_XDECREF(((PyObject *)p->absdiff_im_roi2_view));
  Py_XDECREF(((PyObject *)p->cmpdiff_im_roi2_view));
  Py_XDECREF(((PyObject *)p->mask_im));
  Py_XDECREF(((PyObject *)p->mean_im));
  Py_XDECREF(((PyObject *)p->cmp_im));
  Py_XDECREF(((PyObject *)p->mean_im_roi_view));
  Py_XDECREF(((PyObject *)p->cmp_im_roi_view));
  Py_XDECREF(p->imname2im);
  (*o->ob_type->tp_free)(o);
}

static int __pyx_tp_traverse_23realtime_image_analysis_RealtimeAnalyzer(PyObject *o, visitproc v, void *a) {
  int e;
  struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *p = (struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)o;
  if (p->_roi_sz) {
    e = (*v)(((PyObject*)p->_roi_sz), a); if (e) return e;
  }
  if (p->absdiff_im) {
    e = (*v)(((PyObject*)p->absdiff_im), a); if (e) return e;
  }
  if (p->cmpdiff_im) {
    e = (*v)(((PyObject*)p->cmpdiff_im), a); if (e) return e;
  }
  if (p->absdiff_im_roi_view) {
    e = (*v)(((PyObject*)p->absdiff_im_roi_view), a); if (e) return e;
  }
  if (p->cmpdiff_im_roi_view) {
    e = (*v)(((PyObject*)p->cmpdiff_im_roi_view), a); if (e) return e;
  }
  if (p->absdiff_im_roi2_view) {
    e = (*v)(((PyObject*)p->absdiff_im_roi2_view), a); if (e) return e;
  }
  if (p->cmpdiff_im_roi2_view) {
    e = (*v)(((PyObject*)p->cmpdiff_im_roi2_view), a); if (e) return e;
  }
  if (p->mask_im) {
    e = (*v)(((PyObject*)p->mask_im), a); if (e) return e;
  }
  if (p->mean_im) {
    e = (*v)(((PyObject*)p->mean_im), a); if (e) return e;
  }
  if (p->cmp_im) {
    e = (*v)(((PyObject*)p->cmp_im), a); if (e) return e;
  }
  if (p->mean_im_roi_view) {
    e = (*v)(((PyObject*)p->mean_im_roi_view), a); if (e) return e;
  }
  if (p->cmp_im_roi_view) {
    e = (*v)(((PyObject*)p->cmp_im_roi_view), a); if (e) return e;
  }
  if (p->imname2im) {
    e = (*v)(p->imname2im, a); if (e) return e;
  }
  return 0;
}

static int __pyx_tp_clear_23realtime_image_analysis_RealtimeAnalyzer(PyObject *o) {
  struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *p = (struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)o;
  Py_XDECREF(((PyObject *)p->_roi_sz));
  p->_roi_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->absdiff_im));
  p->absdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->cmpdiff_im));
  p->cmpdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->absdiff_im_roi_view));
  p->absdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->cmpdiff_im_roi_view));
  p->cmpdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->absdiff_im_roi2_view));
  p->absdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->cmpdiff_im_roi2_view));
  p->cmpdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->mask_im));
  p->mask_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->mean_im));
  p->mean_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->cmp_im));
  p->cmp_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->mean_im_roi_view));
  p->mean_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(((PyObject *)p->cmp_im_roi_view));
  p->cmp_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
  Py_XDECREF(p->imname2im);
  p->imname2im = Py_None; Py_INCREF(Py_None);
  return 0;
}

static PyObject *__pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_roi2_radius(PyObject *o, void *x) {
  return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___get__(o);
}

static int __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_roi2_radius(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_11roi2_radius___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_clear_threshold(PyObject *o, void *x) {
  return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___get__(o);
}

static int __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_clear_threshold(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_15clear_threshold___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_diff_threshold(PyObject *o, void *x) {
  return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___get__(o);
}

static int __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_diff_threshold(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_14diff_threshold___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_scale_factor(PyObject *o, void *x) {
  return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___get__(o);
}

static int __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_scale_factor(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static PyObject *__pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_roi(PyObject *o, void *x) {
  return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_3roi___get__(o);
}

static int __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_roi(PyObject *o, PyObject *v, void *x) {
  if (v) {
    return __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_3roi___set__(o, v);
  }
  else {
    PyErr_SetString(PyExc_NotImplementedError, "__del__");
    return -1;
  }
}

static struct PyMethodDef __pyx_methods_23realtime_image_analysis_RealtimeAnalyzer[] = {
  {"distort", (PyCFunction)__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_distort, METH_VARARGS|METH_KEYWORDS, 0},
  {"do_work", (PyCFunction)__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_do_work, METH_VARARGS|METH_KEYWORDS, __pyx_doc_23realtime_image_analysis_16RealtimeAnalyzer_do_work},
  {"get_image_view", (PyCFunction)__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_get_image_view, METH_VARARGS|METH_KEYWORDS, 0},
  {0, 0, 0, 0}
};

static struct PyGetSetDef __pyx_getsets_23realtime_image_analysis_RealtimeAnalyzer[] = {
  {"roi2_radius", __pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_roi2_radius, __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_roi2_radius, 0, 0},
  {"clear_threshold", __pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_clear_threshold, __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_clear_threshold, 0, 0},
  {"diff_threshold", __pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_diff_threshold, __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_diff_threshold, 0, 0},
  {"scale_factor", __pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_scale_factor, __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_scale_factor, 0, 0},
  {"roi", __pyx_getprop_23realtime_image_analysis_16RealtimeAnalyzer_roi, __pyx_setprop_23realtime_image_analysis_16RealtimeAnalyzer_roi, 0, 0},
  {0, 0, 0, 0, 0}
};

static PyNumberMethods __pyx_tp_as_number_RealtimeAnalyzer = {
  0, /*nb_add*/
  0, /*nb_subtract*/
  0, /*nb_multiply*/
  0, /*nb_divide*/
  0, /*nb_remainder*/
  0, /*nb_divmod*/
  0, /*nb_power*/
  0, /*nb_negative*/
  0, /*nb_positive*/
  0, /*nb_absolute*/
  0, /*nb_nonzero*/
  0, /*nb_invert*/
  0, /*nb_lshift*/
  0, /*nb_rshift*/
  0, /*nb_and*/
  0, /*nb_xor*/
  0, /*nb_or*/
  0, /*nb_coerce*/
  0, /*nb_int*/
  0, /*nb_long*/
  0, /*nb_float*/
  0, /*nb_oct*/
  0, /*nb_hex*/
  0, /*nb_inplace_add*/
  0, /*nb_inplace_subtract*/
  0, /*nb_inplace_multiply*/
  0, /*nb_inplace_divide*/
  0, /*nb_inplace_remainder*/
  0, /*nb_inplace_power*/
  0, /*nb_inplace_lshift*/
  0, /*nb_inplace_rshift*/
  0, /*nb_inplace_and*/
  0, /*nb_inplace_xor*/
  0, /*nb_inplace_or*/
  0, /*nb_floor_divide*/
  0, /*nb_true_divide*/
  0, /*nb_inplace_floor_divide*/
  0, /*nb_inplace_true_divide*/
  #if Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX
  0, /*nb_index*/
  #endif
};

static PySequenceMethods __pyx_tp_as_sequence_RealtimeAnalyzer = {
  0, /*sq_length*/
  0, /*sq_concat*/
  0, /*sq_repeat*/
  0, /*sq_item*/
  0, /*sq_slice*/
  0, /*sq_ass_item*/
  0, /*sq_ass_slice*/
  0, /*sq_contains*/
  0, /*sq_inplace_concat*/
  0, /*sq_inplace_repeat*/
};

static PyMappingMethods __pyx_tp_as_mapping_RealtimeAnalyzer = {
  0, /*mp_length*/
  0, /*mp_subscript*/
  0, /*mp_ass_subscript*/
};

static PyBufferProcs __pyx_tp_as_buffer_RealtimeAnalyzer = {
  0, /*bf_getreadbuffer*/
  0, /*bf_getwritebuffer*/
  0, /*bf_getsegcount*/
  0, /*bf_getcharbuffer*/
};

PyTypeObject __pyx_type_23realtime_image_analysis_RealtimeAnalyzer = {
  PyObject_HEAD_INIT(0)
  0, /*ob_size*/
  "realtime_image_analysis.RealtimeAnalyzer", /*tp_name*/
  sizeof(struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer), /*tp_basicsize*/
  0, /*tp_itemsize*/
  __pyx_tp_dealloc_23realtime_image_analysis_RealtimeAnalyzer, /*tp_dealloc*/
  0, /*tp_print*/
  0, /*tp_getattr*/
  0, /*tp_setattr*/
  0, /*tp_compare*/
  0, /*tp_repr*/
  &__pyx_tp_as_number_RealtimeAnalyzer, /*tp_as_number*/
  &__pyx_tp_as_sequence_RealtimeAnalyzer, /*tp_as_sequence*/
  &__pyx_tp_as_mapping_RealtimeAnalyzer, /*tp_as_mapping*/
  0, /*tp_hash*/
  0, /*tp_call*/
  0, /*tp_str*/
  0, /*tp_getattro*/
  0, /*tp_setattro*/
  &__pyx_tp_as_buffer_RealtimeAnalyzer, /*tp_as_buffer*/
  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_BASETYPE|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
  0, /*tp_doc*/
  __pyx_tp_traverse_23realtime_image_analysis_RealtimeAnalyzer, /*tp_traverse*/
  __pyx_tp_clear_23realtime_image_analysis_RealtimeAnalyzer, /*tp_clear*/
  0, /*tp_richcompare*/
  0, /*tp_weaklistoffset*/
  0, /*tp_iter*/
  0, /*tp_iternext*/
  __pyx_methods_23realtime_image_analysis_RealtimeAnalyzer, /*tp_methods*/
  0, /*tp_members*/
  __pyx_getsets_23realtime_image_analysis_RealtimeAnalyzer, /*tp_getset*/
  0, /*tp_base*/
  0, /*tp_dict*/
  0, /*tp_descr_get*/
  0, /*tp_descr_set*/
  0, /*tp_dictoffset*/
  __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___init__, /*tp_init*/
  0, /*tp_alloc*/
  __pyx_tp_new_23realtime_image_analysis_RealtimeAnalyzer, /*tp_new*/
  0, /*tp_free*/
  0, /*tp_is_gc*/
  0, /*tp_bases*/
  0, /*tp_mro*/
  0, /*tp_cache*/
  0, /*tp_subclasses*/
  0, /*tp_weaklist*/
};

static struct PyMethodDef __pyx_methods[] = {
  {"bg_help_slow", (PyCFunction)__pyx_f_23realtime_image_analysis_bg_help_slow, METH_VARARGS|METH_KEYWORDS, 0},
  {"bg_help", (PyCFunction)__pyx_f_23realtime_image_analysis_bg_help, METH_VARARGS|METH_KEYWORDS, 0},
  {"do_bg_maint", (PyCFunction)__pyx_f_23realtime_image_analysis_do_bg_maint, METH_VARARGS|METH_KEYWORDS, __pyx_doc_23realtime_image_analysis_do_bg_maint},
  {0, 0, 0, 0}
};

static void __pyx_init_filenames(void); /*proto*/

PyMODINIT_FUNC initrealtime_image_analysis(void); /*proto*/
PyMODINIT_FUNC initrealtime_image_analysis(void) {
  PyObject *__pyx_1 = 0;
  PyObject *__pyx_2 = 0;
  double __pyx_3;
  __pyx_init_filenames();
  __pyx_m = Py_InitModule4("realtime_image_analysis", __pyx_methods, 0, 0, PYTHON_API_VERSION);
  if (!__pyx_m) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; goto __pyx_L1;};
  Py_INCREF(__pyx_m);
  __pyx_b = PyImport_AddModule("__builtin__");
  if (!__pyx_b) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; goto __pyx_L1;};
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; goto __pyx_L1;};
  if (__Pyx_InternStrings(__pyx_intern_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; goto __pyx_L1;};
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; goto __pyx_L1;};
  __pyx_type_23realtime_image_analysis_RealtimeAnalyzer.tp_free = _PyObject_GC_Del;
  if (PyType_Ready(&__pyx_type_23realtime_image_analysis_RealtimeAnalyzer) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; goto __pyx_L1;}
  if (PyObject_SetAttrString(__pyx_m, "RealtimeAnalyzer", (PyObject *)&__pyx_type_23realtime_image_analysis_RealtimeAnalyzer) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 74; goto __pyx_L1;}
  __pyx_ptype_23realtime_image_analysis_RealtimeAnalyzer = &__pyx_type_23realtime_image_analysis_RealtimeAnalyzer;
  __pyx_ptype_6motmot_9FastImage_9FastImage_Size = __Pyx_ImportType("motmot.FastImage.FastImage", "Size", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_Size)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_Size) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 6; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_Point = __Pyx_ImportType("motmot.FastImage.FastImage", "Point", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_Point)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_Point) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 9; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_FastImageBase = __Pyx_ImportType("motmot.FastImage.FastImage", "FastImageBase", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_FastImageBase) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 12; goto __pyx_L1;}
  if (__Pyx_GetVtable(__pyx_ptype_6motmot_9FastImage_9FastImage_FastImageBase->tp_dict, &__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImageBase) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 12; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f = __Pyx_ImportType("motmot.FastImage.FastImage", "FastImage32f", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 24; goto __pyx_L1;}
  if (__Pyx_GetVtable(__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f->tp_dict, &__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage32f) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 24; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u = __Pyx_ImportType("motmot.FastImage.FastImage", "FastImage8u", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 26; goto __pyx_L1;}
  if (__Pyx_GetVtable(__pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u->tp_dict, &__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage8u) < 0) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 26; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_LazyOp = __Pyx_ImportType("motmot.FastImage.FastImage", "LazyOp", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_LazyOp) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 44; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_square = __Pyx_ImportType("motmot.FastImage.FastImage", "square", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_square)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_square) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 47; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_sqrt = __Pyx_ImportType("motmot.FastImage.FastImage", "sqrt", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_sqrt)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_sqrt) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 50; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_blend_with = __Pyx_ImportType("motmot.FastImage.FastImage", "blend_with", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_blend_with)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_blend_with) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 55; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_8u = __Pyx_ImportType("motmot.FastImage.FastImage", "convert_to_8u", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_convert_to_8u)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_8u) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 59; goto __pyx_L1;}
  __pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_32f = __Pyx_ImportType("motmot.FastImage.FastImage", "convert_to_32f", sizeof(struct __pyx_obj_6motmot_9FastImage_9FastImage_convert_to_32f)); if (!__pyx_ptype_6motmot_9FastImage_9FastImage_convert_to_32f) {__pyx_filename = __pyx_f[1]; __pyx_lineno = 62; goto __pyx_L1;}

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":9 */
  __pyx_1 = __Pyx_Import(__pyx_n_time, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_time, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":10 */
  __pyx_1 = __Pyx_Import(__pyx_n_numpy, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_nx, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 10; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":11 */
  __pyx_1 = __Pyx_Import(__pyx_n_warnings, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; goto __pyx_L1;}
  if (PyObject_SetAttr(__pyx_m, __pyx_n_warnings, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 11; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":15 */
  __pyx_1 = PyList_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; goto __pyx_L1;}
  Py_INCREF(__pyx_k5p);
  PyList_SET_ITEM(__pyx_1, 0, __pyx_k5p);
  __pyx_2 = __Pyx_Import(__pyx_k4p, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  if (PyObject_SetAttr(__pyx_m, __pyx_n_FastImage, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":18 */
  __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; goto __pyx_L1;}
  __pyx_2 = PyObject_GetAttr(__pyx_1, __pyx_n_nan); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; goto __pyx_L1;}
  Py_DECREF(__pyx_1); __pyx_1 = 0;
  __pyx_3 = PyFloat_AsDouble(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; goto __pyx_L1;}
  Py_DECREF(__pyx_2); __pyx_2 = 0;
  __pyx_v_23realtime_image_analysis_nan = __pyx_3;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":177 */
  __pyx_k6 = 0;
  __pyx_k7 = 0.0;
  __pyx_k8 = 0;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":434 */
  Py_INCREF(__pyx_n_mean);
  __pyx_k10 = __pyx_n_mean;

  /* "/home/aza/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":604 */
  __pyx_k11 = 0;
  return;
  __pyx_L1:;
  Py_XDECREF(__pyx_1);
  Py_XDECREF(__pyx_2);
  __Pyx_AddTraceback("realtime_image_analysis");
}

static char *__pyx_filenames[] = {
  "realtime_image_analysis.pyx",
  "motmot.FastImage.FastImage.pxd",
};

/* Runtime support code */

static void __pyx_init_filenames(void) {
  __pyx_f = __pyx_filenames;
}

static int __Pyx_GetStarArgs(
    PyObject **args, 
    PyObject **kwds,
    char *kwd_list[], 
    Py_ssize_t nargs,
    PyObject **args2, 
    PyObject **kwds2,
    char rqd_kwds[])
{
    PyObject *x = 0, *args1 = 0, *kwds1 = 0;
    int i;
    char **p;
    
    if (args2)
        *args2 = 0;
    if (kwds2)
        *kwds2 = 0;
    
    if (args2) {
        args1 = PyTuple_GetSlice(*args, 0, nargs);
        if (!args1)
            goto bad;
        *args2 = PyTuple_GetSlice(*args, nargs, PyTuple_GET_SIZE(*args));
        if (!*args2)
            goto bad;
    }
    else if (PyTuple_GET_SIZE(*args) > nargs) {
        int m = nargs;
        int n = PyTuple_GET_SIZE(*args);
        PyErr_Format(PyExc_TypeError,
            "function takes at most %d positional arguments (%d given)",
                m, n);
        goto bad;
    }
    else {
        args1 = *args;
        Py_INCREF(args1);
    }
    
    if (rqd_kwds && !*kwds)
            for (i = 0, p = kwd_list; *p; i++, p++)
                if (rqd_kwds[i])
                    goto missing_kwarg;
    
    if (kwds2) {
        if (*kwds) {
            kwds1 = PyDict_New();
            if (!kwds1)
                goto bad;
            *kwds2 = PyDict_Copy(*kwds);
            if (!*kwds2)
                goto bad;
            for (i = 0, p = kwd_list; *p; i++, p++) {
                x = PyDict_GetItemString(*kwds, *p);
                if (x) {
                    if (PyDict_SetItemString(kwds1, *p, x) < 0)
                        goto bad;
                    if (PyDict_DelItemString(*kwds2, *p) < 0)
                        goto bad;
                }
                else if (rqd_kwds && rqd_kwds[i])
                    goto missing_kwarg;
            }
        }
        else {
            *kwds2 = PyDict_New();
            if (!*kwds2)
                goto bad;
        }
    }
    else {
        kwds1 = *kwds;
        Py_XINCREF(kwds1);
        if (rqd_kwds && *kwds)
            for (i = 0, p = kwd_list; *p; i++, p++)
                if (rqd_kwds[i] && !PyDict_GetItemString(*kwds, *p))
                        goto missing_kwarg;
    }
    
    *args = args1;
    *kwds = kwds1;
    return 0;
missing_kwarg:
    PyErr_Format(PyExc_TypeError,
        "required keyword argument '%s' is missing", *p);
bad:
    Py_XDECREF(args1);
    Py_XDECREF(kwds1);
    if (args2) {
        Py_XDECREF(*args2);
    }
    if (kwds2) {
        Py_XDECREF(*kwds2);
    }
    return -1;
}

static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed, char *name) {
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if ((none_allowed && obj == Py_None) || PyObject_TypeCheck(obj, type))
        return 1;
    PyErr_Format(PyExc_TypeError,
        "Argument '%s' has incorrect type (expected %s, got %s)",
        name, type->tp_name, obj->ob_type->tp_name);
    return 0;
}

static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list) {
    PyObject *__import__ = 0;
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    __import__ = PyObject_GetAttrString(__pyx_b, "__import__");
    if (!__import__)
        goto bad;
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    module = PyObject_CallFunction(__import__, "OOOO",
        name, global_dict, empty_dict, list);
bad:
    Py_XDECREF(empty_list);
    Py_XDECREF(__import__);
    Py_XDECREF(empty_dict);
    return module;
}

static PyObject *__Pyx_GetName(PyObject *dict, PyObject *name) {
    PyObject *result;
    result = PyObject_GetAttr(dict, name);
    if (!result)
        PyErr_SetObject(PyExc_NameError, name);
    return result;
}

static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb) {
    Py_XINCREF(type);
    Py_XINCREF(value);
    Py_XINCREF(tb);
    /* First, check the traceback argument, replacing None with NULL. */
    if (tb == Py_None) {
        Py_DECREF(tb);
        tb = 0;
    }
    else if (tb != NULL && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto raise_error;
    }
    /* Next, replace a missing value with None */
    if (value == NULL) {
        value = Py_None;
        Py_INCREF(value);
    }
    #if PY_VERSION_HEX < 0x02050000
    if (!PyClass_Check(type))
    #else
    if (!PyType_Check(type))
    #endif
    {
        /* Raising an instance.  The value should be a dummy. */
        if (value != Py_None) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        /* Normalize to raise <class>, <instance> */
        Py_DECREF(value);
        value = type;
        #if PY_VERSION_HEX < 0x02050000
            if (PyInstance_Check(type)) {
                type = (PyObject*) ((PyInstanceObject*)type)->in_class;
                Py_INCREF(type);
            }
            else {
                PyErr_SetString(PyExc_TypeError,
                    "raise: exception must be an old-style class or instance");
                goto raise_error;
            }
        #else
            type = (PyObject*) type->ob_type;
            Py_INCREF(type);
            if (!PyType_IsSubtype((PyTypeObject *)type, (PyTypeObject *)PyExc_BaseException)) {
                PyErr_SetString(PyExc_TypeError,
                    "raise: exception class must be a subclass of BaseException");
                goto raise_error;
            }
        #endif
    }
    PyErr_Restore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}

static PyObject *__Pyx_GetStdout(void) {
    PyObject *f = PySys_GetObject("stdout");
    if (!f) {
        PyErr_SetString(PyExc_RuntimeError, "lost sys.stdout");
    }
    return f;
}

static int __Pyx_PrintItem(PyObject *v) {
    PyObject *f;
    
    if (!(f = __Pyx_GetStdout()))
        return -1;
    if (PyFile_SoftSpace(f, 1)) {
        if (PyFile_WriteString(" ", f) < 0)
            return -1;
    }
    if (PyFile_WriteObject(v, f, Py_PRINT_RAW) < 0)
        return -1;
    if (PyString_Check(v)) {
        char *s = PyString_AsString(v);
        Py_ssize_t len = PyString_Size(v);
        if (len > 0 &&
            isspace(Py_CHARMASK(s[len-1])) &&
            s[len-1] != ' ')
                PyFile_SoftSpace(f, 0);
    }
    return 0;
}

static int __Pyx_PrintNewline(void) {
    PyObject *f;
    
    if (!(f = __Pyx_GetStdout()))
        return -1;
    if (PyFile_WriteString("\n", f) < 0)
        return -1;
    PyFile_SoftSpace(f, 0);
    return 0;
}

static int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    if (!type) {
        PyErr_Format(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (obj == Py_None || PyObject_TypeCheck(obj, type))
        return 1;
    PyErr_Format(PyExc_TypeError, "Cannot convert %s to %s",
        obj->ob_type->tp_name, type->tp_name);
    return 0;
}

static void __Pyx_UnpackError(void) {
    PyErr_SetString(PyExc_ValueError, "unpack sequence of wrong size");
}

static PyObject *__Pyx_UnpackItem(PyObject *iter) {
    PyObject *item;
    if (!(item = PyIter_Next(iter))) {
        if (!PyErr_Occurred())
            __Pyx_UnpackError();
    }
    return item;
}

static int __Pyx_EndUnpack(PyObject *iter) {
    PyObject *item;
    if ((item = PyIter_Next(iter))) {
        Py_DECREF(item);
        __Pyx_UnpackError();
        return -1;
    }
    else if (!PyErr_Occurred())
        return 0;
    else
        return -1;
}

static int __Pyx_InternStrings(__Pyx_InternTabEntry *t) {
    while (t->p) {
        *t->p = PyString_InternFromString(t->s);
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

#ifndef __PYX_HAVE_RT_ImportType
#define __PYX_HAVE_RT_ImportType
static PyTypeObject *__Pyx_ImportType(char *module_name, char *class_name, 
    long size) 
{
    PyObject *py_module = 0;
    PyObject *result = 0;
    
    py_module = __Pyx_ImportModule(module_name);
    if (!py_module)
        goto bad;
    result = PyObject_GetAttrString(py_module, class_name);
    if (!result)
        goto bad;
    if (!PyType_Check(result)) {
        PyErr_Format(PyExc_TypeError, 
            "%s.%s is not a type object",
            module_name, class_name);
        goto bad;
    }
    if (((PyTypeObject *)result)->tp_basicsize != size) {
        PyErr_Format(PyExc_ValueError, 
            "%s.%s does not appear to be the correct type object",
            module_name, class_name);
        goto bad;
    }
    return (PyTypeObject *)result;
bad:
    Py_XDECREF(result);
    return 0;
}
#endif

#ifndef __PYX_HAVE_RT_ImportModule
#define __PYX_HAVE_RT_ImportModule
static PyObject *__Pyx_ImportModule(char *name) {
    PyObject *py_name = 0;
    
    py_name = PyString_FromString(name);
    if (!py_name)
        goto bad;
    return PyImport_Import(py_name);
bad:
    Py_XDECREF(py_name);
    return 0;
}
#endif

static int __Pyx_GetVtable(PyObject *dict, void *vtabptr) {
    int result;
    PyObject *pycobj;
    
    pycobj = PyMapping_GetItemString(dict, "__pyx_vtable__");
    if (!pycobj)
        goto bad;
    *(void **)vtabptr = PyCObject_AsVoidPtr(pycobj);
    if (!*(void **)vtabptr)
        goto bad;
    result = 0;
    goto done;

bad:
    result = -1;
done:
    Py_XDECREF(pycobj);
    return result;
}

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"

static void __Pyx_AddTraceback(char *funcname) {
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    PyObject *py_globals = 0;
    PyObject *empty_tuple = 0;
    PyObject *empty_string = 0;
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;
    
    py_srcfile = PyString_FromString(__pyx_filename);
    if (!py_srcfile) goto bad;
    py_funcname = PyString_FromString(funcname);
    if (!py_funcname) goto bad;
    py_globals = PyModule_GetDict(__pyx_m);
    if (!py_globals) goto bad;
    empty_tuple = PyTuple_New(0);
    if (!empty_tuple) goto bad;
    empty_string = PyString_FromString("");
    if (!empty_string) goto bad;
    py_code = PyCode_New(
        0,            /*int argcount,*/
        0,            /*int nlocals,*/
        0,            /*int stacksize,*/
        0,            /*int flags,*/
        empty_string, /*PyObject *code,*/
        empty_tuple,  /*PyObject *consts,*/
        empty_tuple,  /*PyObject *names,*/
        empty_tuple,  /*PyObject *varnames,*/
        empty_tuple,  /*PyObject *freevars,*/
        empty_tuple,  /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        __pyx_lineno,   /*int firstlineno,*/
        empty_string  /*PyObject *lnotab*/
    );
    if (!py_code) goto bad;
    py_frame = PyFrame_New(
        PyThreadState_Get(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        py_globals,          /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = __pyx_lineno;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    Py_XDECREF(empty_tuple);
    Py_XDECREF(empty_string);
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}
