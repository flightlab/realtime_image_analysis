Index: src/realtime_image_analysis.pyx
===================================================================
--- src/realtime_image_analysis.pyx	(revision 611)
+++ src/realtime_image_analysis.pyx	(working copy)
@@ -241,31 +241,32 @@
                 str(raw_im_small.imsiz),str(self._roi_sz)))
 
         # find difference from mean
-        c_python.Py_BEGIN_ALLOW_THREADS
-        # absdiff_im = | raw_im - mean_im |
-        #raw_im_small.fast_get_absdiff_put( self.mean_im_roi_view,
-        #                                   self.absdiff_im_roi_view,
-        #                                   self._roi_sz) # does own CHK
-        CHK_NOGIL( ipp.ippiAbsDiff_8u_C1R(<ipp.Ipp8u*>self.mean_im_roi_view.im,self.mean_im_roi_view.step,
-                                          <ipp.Ipp8u*>raw_im_small.im,raw_im_small.step,
-                                          <ipp.Ipp8u*>self.absdiff_im_roi_view.im,self.absdiff_im_roi_view.step,
-                                          self._roi_sz.sz))
+        #c_python.Py_BEGIN_ALLOW_THREADS
+        with nogil:
+            # absdiff_im = | raw_im - mean_im |
+            #raw_im_small.fast_get_absdiff_put( self.mean_im_roi_view,
+            #                                   self.absdiff_im_roi_view,
+            #                                   self._roi_sz) # does own CHK
+            CHK_NOGIL( ipp.ippiAbsDiff_8u_C1R(<ipp.Ipp8u*>self.mean_im_roi_view.im,self.mean_im_roi_view.step,
+                                              <ipp.Ipp8u*>raw_im_small.im,raw_im_small.step,
+                                              <ipp.Ipp8u*>self.absdiff_im_roi_view.im,self.absdiff_im_roi_view.step,
+                                              self._roi_sz.sz))
 
-        # mask unused part of absdiff_im to 0
-        #self.absdiff_im.fast_set_val_masked( 0,
-        #                                     self.mask_im,
-        #                                     self.absdiff_im.imsiz) # does own CHK
+            # mask unused part of absdiff_im to 0
+            #self.absdiff_im.fast_set_val_masked( 0,
+            #                                     self.mask_im,
+            #                                     self.absdiff_im.imsiz) # does own CHK
 
-        CHK_NOGIL( ipp.ippiSet_8u_C1MR( 0, <ipp.Ipp8u*>self.absdiff_im.im, self.absdiff_im.step, self.absdiff_im.imsiz.sz,
-                                        <ipp.Ipp8u*>self.mask_im.im, self.mask_im.step))
+            CHK_NOGIL( ipp.ippiSet_8u_C1MR( 0, <ipp.Ipp8u*>self.absdiff_im.im, self.absdiff_im.step, self.absdiff_im.imsiz.sz,
+                                            <ipp.Ipp8u*>self.mask_im.im, self.mask_im.step))
 
-        if use_cmp:
-            # clip the minimum comparison value to diff_threshold
-            CHK_NOGIL( ipp.ippiThreshold_Val_8u_C1IR(<ipp.Ipp8u*>self.cmp_im_roi_view.im,
-                                               self.cmp_im_roi_view.step,
-                                               self._roi_sz.sz,
-                                               self._diff_threshold, self._diff_threshold, ipp.ippCmpLess))
-        c_python.Py_END_ALLOW_THREADS
+            if use_cmp:
+                # clip the minimum comparison value to diff_threshold
+                CHK_NOGIL( ipp.ippiThreshold_Val_8u_C1IR(<ipp.Ipp8u*>self.cmp_im_roi_view.im,
+                                                   self.cmp_im_roi_view.step,
+                                                   self._roi_sz.sz,
+                                                   self._diff_threshold, self._diff_threshold, ipp.ippCmpLess))
+        #c_python.Py_END_ALLOW_THREADS
 
         while n_found_points < self.max_num_points:
             if max_duration_sec != 0.0:
@@ -275,140 +276,141 @@
                                   stacklevel=1)
                     break
             # release GIL
-            c_python.Py_BEGIN_ALLOW_THREADS
+            #c_python.Py_BEGIN_ALLOW_THREADS
+            with nogil:
+                # WARNING WARNING WARNING WARNING WARNING WARNING WARNING
 
-            # WARNING WARNING WARNING WARNING WARNING WARNING WARNING
+                # Everything from here to Py_END_ALLOW_THREADS must not make
+                # calls to the Python C API.  The Python GIL (Global
+                # Interpreter Lock) has been released, meaning that any calls
+                # to the Python interpreter will have undefined effects,
+                # because the interpreter is presumably in the middle of
+                # another thread right now.
 
-            # Everything from here to Py_END_ALLOW_THREADS must not make
-            # calls to the Python C API.  The Python GIL (Global
-            # Interpreter Lock) has been released, meaning that any calls
-            # to the Python interpreter will have undefined effects,
-            # because the interpreter is presumably in the middle of
-            # another thread right now.
+                # If you are not sure whether or not calls use the Python C
+                # API, check the .c file generated by Pyrex.  Make sure even
+                # function calls do not call the Python C API.
 
-            # If you are not sure whether or not calls use the Python C
-            # API, check the .c file generated by Pyrex.  Make sure even
-            # function calls do not call the Python C API.
+                # find max pixel in ROI
+                if use_cmp:
+                    # cmpdiff_im = absdiff_im - cmp_im (saturates 8u)
+                    #self.absdiff_im_roi_view.fast_get_sub_put( self.cmp_im_roi_view,
+                    #                                           self.cmpdiff_im_roi_view,
+                    #                                           self._roi_sz ) # down own CHK
+                    CHK_NOGIL( ipp.ippiSub_8u_C1RSfs(<ipp.Ipp8u*>self.cmp_im_roi_view.im, self.cmp_im_roi_view.step,
+                                                     <ipp.Ipp8u*>self.absdiff_im_roi_view.im, self.absdiff_im_roi_view.step,
+                                                     <ipp.Ipp8u*>self.cmpdiff_im_roi_view.im, self.cmpdiff_im_roi_view.step,
+                                                     self._roi_sz.sz,0))
+                    CHK_NOGIL( ipp.ippiMaxIndx_8u_C1R(
+                        <ipp.Ipp8u*>self.cmpdiff_im_roi_view.im,self.cmpdiff_im_roi_view.step,
+                        self._roi_sz.sz, &max_std_diff, &index_x, &index_y))
+                    max_val_ptr = (<ipp.Ipp8u*>self.absdiff_im_roi_view.im)+self.absdiff_im_roi_view.step*index_y+index_x
+                    max_val = max_val_ptr[0] # value at maximum difference from std
+                else:
+                    CHK_NOGIL( ipp.ippiMaxIndx_8u_C1R(
+                        <ipp.Ipp8u*>self.absdiff_im_roi_view.im,self.absdiff_im_roi_view.step,
+                        self._roi_sz.sz, &max_val, &index_x, &index_y))
 
-            # find max pixel in ROI
-            if use_cmp:
-                # cmpdiff_im = absdiff_im - cmp_im (saturates 8u)
-                #self.absdiff_im_roi_view.fast_get_sub_put( self.cmp_im_roi_view,
-                #                                           self.cmpdiff_im_roi_view,
-                #                                           self._roi_sz ) # down own CHK
-                CHK_NOGIL( ipp.ippiSub_8u_C1RSfs(<ipp.Ipp8u*>self.cmp_im_roi_view.im, self.cmp_im_roi_view.step,
-                                                 <ipp.Ipp8u*>self.absdiff_im_roi_view.im, self.absdiff_im_roi_view.step,
-                                                 <ipp.Ipp8u*>self.cmpdiff_im_roi_view.im, self.cmpdiff_im_roi_view.step,
-                                                 self._roi_sz.sz,0))
-                CHK_NOGIL( ipp.ippiMaxIndx_8u_C1R(
-                    <ipp.Ipp8u*>self.cmpdiff_im_roi_view.im,self.cmpdiff_im_roi_view.step,
-                    self._roi_sz.sz, &max_std_diff, &index_x, &index_y))
-                max_val_ptr = (<ipp.Ipp8u*>self.absdiff_im_roi_view.im)+self.absdiff_im_roi_view.step*index_y+index_x
-                max_val = max_val_ptr[0] # value at maximum difference from std
-            else:
-                CHK_NOGIL( ipp.ippiMaxIndx_8u_C1R(
-                    <ipp.Ipp8u*>self.absdiff_im_roi_view.im,self.absdiff_im_roi_view.step,
-                    self._roi_sz.sz, &max_val, &index_x, &index_y))
+                if use_roi2:
+                    # find mini-ROI for further analysis (defined in non-ROI space)
+                    left2 = index_x - self._roi2_radius + self._left
+                    right2 = index_x + self._roi2_radius + self._left
+                    bottom2 = index_y - self._roi2_radius + self._bottom
+                    top2 = index_y + self._roi2_radius + self._bottom
 
-            if use_roi2:
-                # find mini-ROI for further analysis (defined in non-ROI space)
-                left2 = index_x - self._roi2_radius + self._left
-                right2 = index_x + self._roi2_radius + self._left
-                bottom2 = index_y - self._roi2_radius + self._bottom
-                top2 = index_y + self._roi2_radius + self._bottom
+                    if left2 < self._left: left2 = self._left
+                    if right2 > self._right: right2 = self._right
+                    if bottom2 < self._bottom: bottom2 = self._bottom
+                    if top2 > self._top: top2 = self._top
+                    roi2_sz.sz.width = right2 - left2 + 1
+                    roi2_sz.sz.height = top2 - bottom2 + 1
+                else:
+                    left2 = self._left
+                    right2 = self._right
+                    bottom2 = self._bottom
+                    top2 = self._top
+                    roi2_sz.sz.width = self._roi_sz.sz.width
+                    roi2_sz.sz.height = self._roi_sz.sz.height
 
-                if left2 < self._left: left2 = self._left
-                if right2 > self._right: right2 = self._right
-                if bottom2 < self._bottom: bottom2 = self._bottom
-                if top2 > self._top: top2 = self._top
-                roi2_sz.sz.width = right2 - left2 + 1
-                roi2_sz.sz.height = top2 - bottom2 + 1
-            else:
-                left2 = self._left
-                right2 = self._right
-                bottom2 = self._bottom
-                top2 = self._top
-                roi2_sz.sz.width = self._roi_sz.sz.width
-                roi2_sz.sz.height = self._roi_sz.sz.height
-
-            c_python.Py_END_ALLOW_THREADS
+            #c_python.Py_END_ALLOW_THREADS
             # XXX should figure out how not to release GIL here...
             self.absdiff_im_roi2_view = self.absdiff_im.roi(left2,bottom2,roi2_sz)
             if use_cmp:
                 self.cmpdiff_im_roi2_view = self.cmpdiff_im.roi(left2,bottom2,roi2_sz)
-            c_python.Py_BEGIN_ALLOW_THREADS
+            #c_python.Py_BEGIN_ALLOW_THREADS
+            with nogil:
 
-            # (to reduce moment arm:) if pixel < self._clear_threshold*max(pixel): pixel=0
+                # (to reduce moment arm:) if pixel < self._clear_threshold*max(pixel): pixel=0
 
-            clear_despeckle_thresh = <ipp.Ipp8u>(self._clear_threshold*max_val)
-            if clear_despeckle_thresh < self._despeckle_threshold:
-                clear_despeckle_thresh = self._despeckle_threshold
+                clear_despeckle_thresh = <ipp.Ipp8u>(self._clear_threshold*max_val)
+                if clear_despeckle_thresh < self._despeckle_threshold:
+                    clear_despeckle_thresh = self._despeckle_threshold
 
-            CHK_NOGIL( ipp.ippiThreshold_Val_8u_C1IR(
-                <ipp.Ipp8u*>self.absdiff_im_roi2_view.im,self.absdiff_im_roi2_view.step,
-                roi2_sz.sz, clear_despeckle_thresh, 0, ipp.ippCmpLess))
+                CHK_NOGIL( ipp.ippiThreshold_Val_8u_C1IR(
+                    <ipp.Ipp8u*>self.absdiff_im_roi2_view.im,self.absdiff_im_roi2_view.step,
+                    roi2_sz.sz, clear_despeckle_thresh, 0, ipp.ippCmpLess))
 
-            found_point = 1
+                found_point = 1
 
-            if not use_cmp:
-                if max_val < self._diff_threshold:
-                    x0=nan
-                    y0=nan
-                    x0_abs = nan
-                    y0_abs = nan
-                    found_point = 0 # c int (bool)
-                    max_val = 0
-            else:
-                if max_std_diff == 0:
-                    x0=nan
-                    y0=nan
-                    x0_abs = nan
-                    y0_abs = nan
-                    found_point = 0 # c int (bool)
-            if found_point:
-                result = fit_params( self.pState, &x0, &y0,
-                                     &Mu00,
-                                     &Uu11, &Uu20, &Uu02,
-                                     roi2_sz.sz.width, roi2_sz.sz.height,
-                                     <unsigned char*>self.absdiff_im_roi2_view.im,
-                                     self.absdiff_im_roi2_view.step)
-                # note that x0 and y0 are now relative to the ROI origin
-                if result == CFitParamsNoError:
-                    area = Mu00
-                    eigen_err = eigen_2x2_real( Uu20, Uu11,
-                                                Uu11, Uu02,
-                                                &evalA, &evecA1,
-                                                &evalB, &evecB1)
-                    if eigen_err:
-                        slope = nan
-                        eccentricity = 0.0
-                    else:
-                        rise = 1.0 # 2nd component of eigenvectors will always be 1.0
-                        if evalA > evalB:
-                            run = evecA1
-                            eccentricity = evalA/evalB
+                if not use_cmp:
+                    if max_val < self._diff_threshold:
+                        x0=nan
+                        y0=nan
+                        x0_abs = nan
+                        y0_abs = nan
+                        found_point = 0 # c int (bool)
+                        max_val = 0
+                else:
+                    if max_std_diff == 0:
+                        x0=nan
+                        y0=nan
+                        x0_abs = nan
+                        y0_abs = nan
+                        found_point = 0 # c int (bool)
+                if found_point:
+                    result = fit_params( self.pState, &x0, &y0,
+                                         &Mu00,
+                                         &Uu11, &Uu20, &Uu02,
+                                         roi2_sz.sz.width, roi2_sz.sz.height,
+                                         <unsigned char*>self.absdiff_im_roi2_view.im,
+                                         self.absdiff_im_roi2_view.step)
+                    # note that x0 and y0 are now relative to the ROI origin
+                    if result == CFitParamsNoError:
+                        area = Mu00
+                        eigen_err = eigen_2x2_real( Uu20, Uu11,
+                                                    Uu11, Uu02,
+                                                    &evalA, &evecA1,
+                                                    &evalB, &evecB1)
+                        if eigen_err:
+                            slope = nan
+                            eccentricity = 0.0
                         else:
-                            run = evecB1
-                            eccentricity = evalB/evalA
-                        slope = rise/run
+                            rise = 1.0 # 2nd component of eigenvectors will always be 1.0
+                            if evalA > evalB:
+                                run = evecA1
+                                eccentricity = evalA/evalB
+                            else:
+                                run = evecB1
+                                eccentricity = evalB/evalA
+                            slope = rise/run
 
-                elif result == CFitParamsZeroMomentError:
-                    x0 = nan
-                    y0 = nan
-                    x0_abs = nan
-                    y0_abs = nan
-                    found_point = 0
-                elif result == CFitParamsCentralMomentError:
-                    slope = nan
-                else: SET_ERR(1)
+                    elif result == CFitParamsZeroMomentError:
+                        x0 = nan
+                        y0 = nan
+                        x0_abs = nan
+                        y0_abs = nan
+                        found_point = 0
+                    elif result == CFitParamsCentralMomentError:
+                        slope = nan
+                    else: SET_ERR(1)
 
-                # set x0 and y0 relative to whole frame
-                if found_point:
-                    x0_abs = x0+left2
-                    y0_abs = y0+bottom2
+                    # set x0 and y0 relative to whole frame
+                    if found_point:
+                        x0_abs = x0+left2
+                        y0_abs = y0+bottom2
 
             # grab GIL
-            c_python.Py_END_ALLOW_THREADS
+            #c_python.Py_END_ALLOW_THREADS
 
             if found_point:
                 if not (n_found_points+1>=self.max_num_points): # only modify the image if more follow...
@@ -533,66 +535,67 @@
              float ALPHA,
              double C):
 
-    c_python.Py_BEGIN_ALLOW_THREADS # release GIL
-    # maintain running average
-    #running_mean_im.fast_toself_add_weighted_8u( hw_roi_frame, max_frame_size, ALPHA ) # done
-    CHK_NOGIL( ipp.ippiAddWeighted_8u32f_C1IR( <ipp.Ipp8u*>hw_roi_frame.im, hw_roi_frame.step,
-                                               <ipp.Ipp32f*>running_mean_im.im, running_mean_im.step,
-                                               max_frame_size.sz, ALPHA))
+    #c_python.Py_BEGIN_ALLOW_THREADS # release GIL
+    with nogil:
+        # maintain running average
+        #running_mean_im.fast_toself_add_weighted_8u( hw_roi_frame, max_frame_size, ALPHA ) # done
+        CHK_NOGIL( ipp.ippiAddWeighted_8u32f_C1IR( <ipp.Ipp8u*>hw_roi_frame.im, hw_roi_frame.step,
+                                                   <ipp.Ipp32f*>running_mean_im.im, running_mean_im.step,
+                                                   max_frame_size.sz, ALPHA))
 
-    # maintain 8bit unsigned background image
-    #running_mean_im.fast_get_8u_copy_put( running_mean8u_im, max_frame_size ) # done
-    CHK_NOGIL( ipp.ippiConvert_32f8u_C1R(
-        <ipp.Ipp32f*>running_mean_im.im,running_mean_im.step,
-        <ipp.Ipp8u*>running_mean8u_im.im,running_mean8u_im.step,
-        max_frame_size.sz, ipp.ippRndNear ))
+        # maintain 8bit unsigned background image
+        #running_mean_im.fast_get_8u_copy_put( running_mean8u_im, max_frame_size ) # done
+        CHK_NOGIL( ipp.ippiConvert_32f8u_C1R(
+            <ipp.Ipp32f*>running_mean_im.im,running_mean_im.step,
+            <ipp.Ipp8u*>running_mean8u_im.im,running_mean8u_im.step,
+            max_frame_size.sz, ipp.ippRndNear ))
 
-    # standard deviation calculation
-    #hw_roi_frame.fast_get_32f_copy_put(fastframef32_tmp,max_frame_size) # done
-    CHK_NOGIL( ipp.ippiConvert_8u32f_C1R(<ipp.Ipp8u*>hw_roi_frame.im, hw_roi_frame.step,
-                                         <ipp.Ipp32f*>fastframef32_tmp.im, fastframef32_tmp.step,
-                                         max_frame_size.sz ))
+        # standard deviation calculation
+        #hw_roi_frame.fast_get_32f_copy_put(fastframef32_tmp,max_frame_size) # done
+        CHK_NOGIL( ipp.ippiConvert_8u32f_C1R(<ipp.Ipp8u*>hw_roi_frame.im, hw_roi_frame.step,
+                                             <ipp.Ipp32f*>fastframef32_tmp.im, fastframef32_tmp.step,
+                                             max_frame_size.sz ))
 
-    #fastframef32_tmp.fast_toself_square(max_frame_size) # current**2 # done
-    CHK_NOGIL( ipp.ippiSqr_32f_C1IR( <ipp.Ipp32f*>fastframef32_tmp.im, fastframef32_tmp.step,
-                                     max_frame_size.sz))
+        #fastframef32_tmp.fast_toself_square(max_frame_size) # current**2 # done
+        CHK_NOGIL( ipp.ippiSqr_32f_C1IR( <ipp.Ipp32f*>fastframef32_tmp.im, fastframef32_tmp.step,
+                                         max_frame_size.sz))
 
-    #running_sumsqf.fast_toself_add_weighted_32f( fastframef32_tmp, max_frame_size, ALPHA) # done
-    CHK_NOGIL( ipp.ippiAddWeighted_32f_C1IR( <ipp.Ipp32f*>fastframef32_tmp.im, fastframef32_tmp.step,
-                                             <ipp.Ipp32f*>running_sumsqf.im, running_sumsqf.step,
-                                             max_frame_size.sz, ALPHA))
-    #running_mean_im.fast_get_square_put(mean2,max_frame_size) # done
-    CHK_NOGIL( ipp.ippiSqr_32f_C1R( <ipp.Ipp32f*>running_mean_im.im, running_mean_im.step,
-                                    <ipp.Ipp32f*>mean2.im, mean2.step,
-                                    max_frame_size.sz))
-    #running_sumsqf.fast_get_subtracted_put(mean2,running_stdframe,max_frame_size) # done
-    CHK_NOGIL( ipp.ippiSub_32f_C1R(<ipp.Ipp32f*>mean2.im, mean2.step,
-                                   <ipp.Ipp32f*>running_sumsqf.im, running_sumsqf.step,
-                                   <ipp.Ipp32f*>running_stdframe.im, running_stdframe.step,
-                                   max_frame_size.sz))
+        #running_sumsqf.fast_toself_add_weighted_32f( fastframef32_tmp, max_frame_size, ALPHA) # done
+        CHK_NOGIL( ipp.ippiAddWeighted_32f_C1IR( <ipp.Ipp32f*>fastframef32_tmp.im, fastframef32_tmp.step,
+                                                 <ipp.Ipp32f*>running_sumsqf.im, running_sumsqf.step,
+                                                 max_frame_size.sz, ALPHA))
+        #running_mean_im.fast_get_square_put(mean2,max_frame_size) # done
+        CHK_NOGIL( ipp.ippiSqr_32f_C1R( <ipp.Ipp32f*>running_mean_im.im, running_mean_im.step,
+                                        <ipp.Ipp32f*>mean2.im, mean2.step,
+                                        max_frame_size.sz))
+        #running_sumsqf.fast_get_subtracted_put(mean2,running_stdframe,max_frame_size) # done
+        CHK_NOGIL( ipp.ippiSub_32f_C1R(<ipp.Ipp32f*>mean2.im, mean2.step,
+                                       <ipp.Ipp32f*>running_sumsqf.im, running_sumsqf.step,
+                                       <ipp.Ipp32f*>running_stdframe.im, running_stdframe.step,
+                                       max_frame_size.sz))
 
-    # now create frame for comparison
-    #running_stdframe.fast_toself_multiply(C,max_frame_size) # done
-    CHK_NOGIL( ipp.ippiMulC_32f_C1IR(C, <ipp.Ipp32f*>running_stdframe.im, running_stdframe.step, max_frame_size.sz))
+        # now create frame for comparison
+        #running_stdframe.fast_toself_multiply(C,max_frame_size) # done
+        CHK_NOGIL( ipp.ippiMulC_32f_C1IR(C, <ipp.Ipp32f*>running_stdframe.im, running_stdframe.step, max_frame_size.sz))
 
-    #running_stdframe.fast_get_8u_copy_put(compareframe8u,max_frame_size) # done
-    CHK_NOGIL( ipp.ippiConvert_32f8u_C1R(
-        <ipp.Ipp32f*>running_stdframe.im,running_stdframe.step,
-        <ipp.Ipp8u*>compareframe8u.im,compareframe8u.step,
-        max_frame_size.sz, ipp.ippRndNear ))
+        #running_stdframe.fast_get_8u_copy_put(compareframe8u,max_frame_size) # done
+        CHK_NOGIL( ipp.ippiConvert_32f8u_C1R(
+            <ipp.Ipp32f*>running_stdframe.im,running_stdframe.step,
+            <ipp.Ipp8u*>compareframe8u.im,compareframe8u.step,
+            max_frame_size.sz, ipp.ippRndNear ))
 
-    # now we do hack, erm, heuristic for bright points, which aren't gaussian.
-    #running_mean8u_im.fast_get_compare_int_put_greater( 200, noisy_pixels_mask, max_frame_size)
-    CHK_NOGIL( ipp.ippiCompareC_8u_C1R( <ipp.Ipp8u*>running_mean8u_im.im,running_mean8u_im.step,
-                                        200,
-                                        <ipp.Ipp8u*>noisy_pixels_mask.im,noisy_pixels_mask.step,
-                                        max_frame_size.sz,
-                                        ipp.ippCmpGreater))
+        # now we do hack, erm, heuristic for bright points, which aren't gaussian.
+        #running_mean8u_im.fast_get_compare_int_put_greater( 200, noisy_pixels_mask, max_frame_size)
+        CHK_NOGIL( ipp.ippiCompareC_8u_C1R( <ipp.Ipp8u*>running_mean8u_im.im,running_mean8u_im.step,
+                                            200,
+                                            <ipp.Ipp8u*>noisy_pixels_mask.im,noisy_pixels_mask.step,
+                                            max_frame_size.sz,
+                                            ipp.ippCmpGreater))
 
-    #compareframe8u.fast_set_val_masked(25, noisy_pixels_mask, max_frame_size) # done
-    CHK_NOGIL( ipp.ippiSet_8u_C1MR( 25, <ipp.Ipp8u*>compareframe8u.im, compareframe8u.step, max_frame_size.sz,
-                                    <ipp.Ipp8u*>noisy_pixels_mask.im, noisy_pixels_mask.step))
-    c_python.Py_END_ALLOW_THREADS # acquire GIL
+        #compareframe8u.fast_set_val_masked(25, noisy_pixels_mask, max_frame_size) # done
+        CHK_NOGIL( ipp.ippiSet_8u_C1MR( 25, <ipp.Ipp8u*>compareframe8u.im, compareframe8u.step, max_frame_size.sz,
+                                        <ipp.Ipp8u*>noisy_pixels_mask.im, noisy_pixels_mask.step))
+    #c_python.Py_END_ALLOW_THREADS # acquire GIL
 
 def do_bg_maint( FastImage.FastImage32f running_mean_im,
                  FastImage.FastImage8u hw_roi_frame,
@@ -641,104 +644,105 @@
     BENCHMARK = bench
     cdef double t41, t42, t43, t44, t45, t46, t47, t48, t49, t491, t492
 
-    c_python.Py_BEGIN_ALLOW_THREADS
+    #c_python.Py_BEGIN_ALLOW_THREADS
+    with nogil:
 
-    # maintain running average
-    # <x>
-    CHK_NOGIL( ipp.ippiAddWeighted_8u32f_C1IR( <ipp.Ipp8u*>hw_roi_frame.im, hw_roi_frame.step,
-                                               <ipp.Ipp32f*>running_mean_im.im, running_mean_im.step,
-                                               max_frame_size.sz, ALPHA))
-    if BENCHMARK:
-        t41 = time_time()
+        # maintain running average
+        # <x>
+        CHK_NOGIL( ipp.ippiAddWeighted_8u32f_C1IR( <ipp.Ipp8u*>hw_roi_frame.im, hw_roi_frame.step,
+                                                   <ipp.Ipp32f*>running_mean_im.im, running_mean_im.step,
+                                                   max_frame_size.sz, ALPHA))
+        if BENCHMARK:
+            t41 = time_time()
 
-    CHK_NOGIL( ipp.ippiConvert_32f8u_C1R(
-        <ipp.Ipp32f*>running_mean_im.im,running_mean_im.step,
-        <ipp.Ipp8u*>running_mean8u_im.im,running_mean8u_im.step,
-        max_frame_size.sz, ipp.ippRndNear ))
+        CHK_NOGIL( ipp.ippiConvert_32f8u_C1R(
+            <ipp.Ipp32f*>running_mean_im.im,running_mean_im.step,
+            <ipp.Ipp8u*>running_mean8u_im.im,running_mean8u_im.step,
+            max_frame_size.sz, ipp.ippRndNear ))
 
-    if BENCHMARK:
-        t42 = time_time()
+        if BENCHMARK:
+            t42 = time_time()
 
-    # standard deviation calculation
-    CHK_NOGIL( ipp.ippiConvert_8u32f_C1R(<ipp.Ipp8u*>hw_roi_frame.im, hw_roi_frame.step,
-                                         <ipp.Ipp32f*>fastframef32_tmp.im, fastframef32_tmp.step,
-                                         max_frame_size.sz ))
-    if BENCHMARK:
-        t43 = time_time()
+        # standard deviation calculation
+        CHK_NOGIL( ipp.ippiConvert_8u32f_C1R(<ipp.Ipp8u*>hw_roi_frame.im, hw_roi_frame.step,
+                                             <ipp.Ipp32f*>fastframef32_tmp.im, fastframef32_tmp.step,
+                                             max_frame_size.sz ))
+        if BENCHMARK:
+            t43 = time_time()
 
-    # x^2
-    CHK_NOGIL( ipp.ippiSqr_32f_C1IR( <ipp.Ipp32f*>fastframef32_tmp.im, fastframef32_tmp.step,
-                                     max_frame_size.sz))
-    if BENCHMARK:
-        t44 = time_time()
+        # x^2
+        CHK_NOGIL( ipp.ippiSqr_32f_C1IR( <ipp.Ipp32f*>fastframef32_tmp.im, fastframef32_tmp.step,
+                                         max_frame_size.sz))
+        if BENCHMARK:
+            t44 = time_time()
 
-    # <x^2>
-    CHK_NOGIL( ipp.ippiAddWeighted_32f_C1IR( <ipp.Ipp32f*>fastframef32_tmp.im, fastframef32_tmp.step,
-                                             <ipp.Ipp32f*>running_sumsqf.im, running_sumsqf.step,
-                                             max_frame_size.sz, ALPHA))
-    if BENCHMARK:
-        t45 = time_time()
+        # <x^2>
+        CHK_NOGIL( ipp.ippiAddWeighted_32f_C1IR( <ipp.Ipp32f*>fastframef32_tmp.im, fastframef32_tmp.step,
+                                                 <ipp.Ipp32f*>running_sumsqf.im, running_sumsqf.step,
+                                                 max_frame_size.sz, ALPHA))
+        if BENCHMARK:
+            t45 = time_time()
 
-    ### GETS SLOWER
-    # <x>^2
-    CHK_NOGIL( ipp.ippiSqr_32f_C1R( <ipp.Ipp32f*>running_mean_im.im, running_mean_im.step,
-                                    <ipp.Ipp32f*>mean2.im, mean2.step,
-                                    max_frame_size.sz))
-    if BENCHMARK:
-        t46 = time_time()
+        ### GETS SLOWER
+        # <x>^2
+        CHK_NOGIL( ipp.ippiSqr_32f_C1R( <ipp.Ipp32f*>running_mean_im.im, running_mean_im.step,
+                                        <ipp.Ipp32f*>mean2.im, mean2.step,
+                                        max_frame_size.sz))
+        if BENCHMARK:
+            t46 = time_time()
 
-    # <x^2> - <x>^2
-    CHK_NOGIL( ipp.ippiSub_32f_C1R(<ipp.Ipp32f*>mean2.im, mean2.step,
-                                   <ipp.Ipp32f*>running_sumsqf.im, running_sumsqf.step,
-                                   <ipp.Ipp32f*>std2.im, std2.step,
-                                   max_frame_size.sz))
+        # <x^2> - <x>^2
+        CHK_NOGIL( ipp.ippiSub_32f_C1R(<ipp.Ipp32f*>mean2.im, mean2.step,
+                                       <ipp.Ipp32f*>running_sumsqf.im, running_sumsqf.step,
+                                       <ipp.Ipp32f*>std2.im, std2.step,
+                                       max_frame_size.sz))
 
-    # sqrt( |<x^2> - <x>^2| )
-    # clip
-    # XXX should use copy version
-    CHK_NOGIL( ipp.ippiAbs_32f_C1R(<ipp.Ipp32f*>std2.im, std2.step,
-                                   <ipp.Ipp32f*>running_stdframe.im,
-                                   running_stdframe.step,
-                                   max_frame_size.sz))
-    errval= ipp.ippiSqrt_32f_C1IR(<ipp.Ipp32f*>running_stdframe.im,
-                                  running_stdframe.step,
-                                  max_frame_size.sz)
-    CHK_NOGIL(errval)
+        # sqrt( |<x^2> - <x>^2| )
+        # clip
+        # XXX should use copy version
+        CHK_NOGIL( ipp.ippiAbs_32f_C1R(<ipp.Ipp32f*>std2.im, std2.step,
+                                       <ipp.Ipp32f*>running_stdframe.im,
+                                       running_stdframe.step,
+                                       max_frame_size.sz))
+        errval= ipp.ippiSqrt_32f_C1IR(<ipp.Ipp32f*>running_stdframe.im,
+                                      running_stdframe.step,
+                                      max_frame_size.sz)
+        CHK_NOGIL(errval)
 
-    if BENCHMARK:
-        t47 = time_time()
+        if BENCHMARK:
+            t47 = time_time()
 
-    # now create frame for comparison
-    if n_sigma != 1.0:
-        CHK_NOGIL( ipp.ippiMulC_32f_C1IR(n_sigma, <ipp.Ipp32f*>running_stdframe.im, running_stdframe.step, max_frame_size.sz))
+        # now create frame for comparison
+        if n_sigma != 1.0:
+            CHK_NOGIL( ipp.ippiMulC_32f_C1IR(n_sigma, <ipp.Ipp32f*>running_stdframe.im, running_stdframe.step, max_frame_size.sz))
 
-    if BENCHMARK:
-        t48 = time_time()
+        if BENCHMARK:
+            t48 = time_time()
 
-    CHK_NOGIL( ipp.ippiConvert_32f8u_C1R(
-        <ipp.Ipp32f*>running_stdframe.im,running_stdframe.step,
-        <ipp.Ipp8u*>compareframe8u.im,compareframe8u.step,
-        max_frame_size.sz, ipp.ippRndNear ))
+        CHK_NOGIL( ipp.ippiConvert_32f8u_C1R(
+            <ipp.Ipp32f*>running_stdframe.im,running_stdframe.step,
+            <ipp.Ipp8u*>compareframe8u.im,compareframe8u.step,
+            max_frame_size.sz, ipp.ippRndNear ))
 
-    if BENCHMARK:
-        t49 = time_time()
+        if BENCHMARK:
+            t49 = time_time()
 
-    # now we do hack, erm, heuristic for bright points, which aren't gaussian.
-    CHK_NOGIL( ipp.ippiCompareC_8u_C1R( <ipp.Ipp8u*>running_mean8u_im.im,running_mean8u_im.step,
-                                        bright_non_gaussian_cutoff,
-                                        <ipp.Ipp8u*>noisy_pixels_mask.im,noisy_pixels_mask.step,
-                                        max_frame_size.sz,ipp.ippCmpGreater))
+        # now we do hack, erm, heuristic for bright points, which aren't gaussian.
+        CHK_NOGIL( ipp.ippiCompareC_8u_C1R( <ipp.Ipp8u*>running_mean8u_im.im,running_mean8u_im.step,
+                                            bright_non_gaussian_cutoff,
+                                            <ipp.Ipp8u*>noisy_pixels_mask.im,noisy_pixels_mask.step,
+                                            max_frame_size.sz,ipp.ippCmpGreater))
 
-    if BENCHMARK:
-        t491 = time_time()
+        if BENCHMARK:
+            t491 = time_time()
 
-    CHK_NOGIL( ipp.ippiSet_8u_C1MR( bright_non_gaussian_replacement,
-                                    <ipp.Ipp8u*>compareframe8u.im, compareframe8u.step, max_frame_size.sz,
-                                    <ipp.Ipp8u*>noisy_pixels_mask.im, noisy_pixels_mask.step))
-    if BENCHMARK:
-        t492 = time_time()
+        CHK_NOGIL( ipp.ippiSet_8u_C1MR( bright_non_gaussian_replacement,
+                                        <ipp.Ipp8u*>compareframe8u.im, compareframe8u.step, max_frame_size.sz,
+                                        <ipp.Ipp8u*>noisy_pixels_mask.im, noisy_pixels_mask.step))
+        if BENCHMARK:
+            t492 = time_time()
 
-    c_python.Py_END_ALLOW_THREADS
+    #c_python.Py_END_ALLOW_THREADS
 
     if BENCHMARK:
         res = t41, t42, t43, t44, t45, t46, t47, t48, t49, t491, t492
Index: src/realtime_image_analysis.c
===================================================================
--- src/realtime_image_analysis.c	(revision 611)
+++ src/realtime_image_analysis.c	(working copy)
@@ -1,16 +1,32 @@
-/* Generated by Pyrex 0.9.5.1a on Thu Mar 13 11:47:35 2008 */
+/* Generated by Pyrex 0.9.6.4 on Fri May 16 01:39:09 2008 */
 
+#define PY_SSIZE_T_CLEAN
 #include "Python.h"
 #include "structmember.h"
 #ifndef PY_LONG_LONG
   #define PY_LONG_LONG LONG_LONG
 #endif
+#if PY_VERSION_HEX < 0x02050000
+  typedef int Py_ssize_t;
+  #define PY_SSIZE_T_MAX INT_MAX
+  #define PY_SSIZE_T_MIN INT_MIN
+  #define PyInt_FromSsize_t(z) PyInt_FromLong(z)
+  #define PyInt_AsSsize_t(o)	PyInt_AsLong(o)
+#endif
+#ifndef WIN32
+  #ifndef __stdcall
+    #define __stdcall
+  #endif
+  #ifndef __cdecl
+    #define __cdecl
+  #endif
+#endif
 #ifdef __cplusplus
 #define __PYX_EXTERN_C extern "C"
 #else
 #define __PYX_EXTERN_C extern
 #endif
-__PYX_EXTERN_C double pow(double, double);
+#include <math.h>
 #include "unistd.h"
 #include "c_fit_params.h"
 #include "eigen.h"
@@ -32,7 +48,7 @@
 static char *__pyx_filename;
 static char **__pyx_f;
 
-static int __Pyx_GetStarArgs(PyObject **args, PyObject **kwds, char *kwd_list[], int nargs, PyObject **args2, PyObject **kwds2); /*proto*/
+static int __Pyx_GetStarArgs(PyObject **args, PyObject **kwds, char *kwd_list[],     Py_ssize_t nargs, PyObject **args2, PyObject **kwds2, char rqd_kwds[]); /*proto*/
 
 static int __Pyx_ArgTypeTest(PyObject *obj, PyTypeObject *type, int none_allowed, char *name); /*proto*/
 
@@ -56,6 +72,8 @@
 
 static PyTypeObject *__Pyx_ImportType(char *module_name, char *class_name, long size);  /*proto*/
 
+static PyObject *__Pyx_ImportModule(char *name); /*proto*/
+
 static int __Pyx_GetVtable(PyObject *dict, void *vtabptr); /*proto*/
 
 static void __Pyx_AddTraceback(char *funcname); /*proto*/
@@ -71,25 +89,24 @@
 
 /* Declarations from motmot.FastImage.FastImage */
 
+typedef void *__pyx_t_6motmot_9FastImage_9FastImage_fiptr;
 
 struct __pyx_obj_6motmot_9FastImage_9FastImage_Size {
   PyObject_HEAD
   IppiSize sz;
 };
 
-
 struct __pyx_obj_6motmot_9FastImage_9FastImage_Point {
   PyObject_HEAD
   IppiPoint pt;
 };
 
-
 struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase {
   PyObject_HEAD
   struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase *__pyx_vtab;
-  void (*im);
-  Py_intptr_t (shape[2]);
-  Py_intptr_t (strides[2]);
+  __pyx_t_6motmot_9FastImage_9FastImage_fiptr im;
+  Py_intptr_t shape[2];
+  Py_intptr_t strides[2];
   int step;
   int view;
   PyObject *basetype;
@@ -97,79 +114,82 @@
   PyObject *source_data;
 };
 
-struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase {
-  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *((*c_roi)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *,int ,int ,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
+struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u {
+  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
 };
-static struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase *__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImageBase;
 
-
 struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f {
   struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
 };
 
-struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage32f {
-  struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
-  void ((*fast_toself_add_weighted_8u)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *,float ));
-  void ((*fast_toself_add_weighted_32f)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *,float ));
-  void ((*fast_get_8u_copy_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
-  void ((*fast_toself_square)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
-  void ((*fast_get_square_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
-  void ((*fast_get_subtracted_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
-  void ((*fast_toself_multiply)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,float ,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
-};
-static struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage32f;
-
-
-struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u {
-  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
-};
-
-struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage8u {
-  struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
-  void ((*fast_get_absdiff_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
-  void ((*fast_get_sub_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
-  void ((*fast_set_val_masked)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,Ipp8u ,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
-  void ((*fast_get_32f_copy_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
-  void ((*fast_get_compare_int_put_greater)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,int ,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *));
-};
-static struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage8u;
-
-
 struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp {
   PyObject_HEAD
 };
 
-
 struct __pyx_obj_6motmot_9FastImage_9FastImage_square {
   struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
   struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *base;
 };
 
-
 struct __pyx_obj_6motmot_9FastImage_9FastImage_sqrt {
   struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
   struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *base;
 };
 
-
 struct __pyx_obj_6motmot_9FastImage_9FastImage_blend_with {
   struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
   struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *other8u;
   float alpha;
 };
 
-
 struct __pyx_obj_6motmot_9FastImage_9FastImage_convert_to_8u {
   struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
   struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *orig32f;
 };
 
-
 struct __pyx_obj_6motmot_9FastImage_9FastImage_convert_to_32f {
   struct __pyx_obj_6motmot_9FastImage_9FastImage_LazyOp __pyx_base;
   struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *orig8u;
 };
 
+
+
+
+struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase {
+  struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *(*c_roi)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImageBase *,int,int,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
+};
+static struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase *__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImageBase;
+
+
+struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage32f {
+  struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
+  void (*fast_toself_add_weighted_8u)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *,float);
+  void (*fast_toself_add_weighted_32f)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *,float);
+  void (*fast_get_8u_copy_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
+  void (*fast_toself_square)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
+  void (*fast_get_square_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
+  void (*fast_get_subtracted_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
+  void (*fast_toself_multiply)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,float,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
+};
+static struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage32f *__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage32f;
+
+
+struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage8u {
+  struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImageBase __pyx_base;
+  void (*fast_get_absdiff_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
+  void (*fast_get_sub_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
+  void (*fast_set_val_masked)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,Ipp8u,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
+  void (*fast_get_32f_copy_put)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage32f *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
+  void (*fast_get_compare_int_put_greater)(struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,int,struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *,struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *);
+};
+static struct __pyx_vtabstruct_6motmot_9FastImage_9FastImage_FastImage8u *__pyx_vtabptr_6motmot_9FastImage_9FastImage_FastImage8u;
+
+
+
+
+
+
+
 static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_Size = 0;
 static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_Point = 0;
 static PyTypeObject *__pyx_ptype_6motmot_9FastImage_9FastImage_FastImageBase = 0;
@@ -184,7 +204,6 @@
 
 /* Declarations from realtime_image_analysis */
 
-
 struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer {
   PyObject_HEAD
   int maxwidth;
@@ -210,40 +229,37 @@
   struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmp_im;
   struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *mean_im_roi_view;
   struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *cmp_im_roi_view;
-  IppiMomentState_64f (*pState);
+  IppiMomentState_64f *pState;
   PyObject *imname2im;
   int max_num_points;
 };
 
+
 static PyTypeObject *__pyx_ptype_23realtime_image_analysis_RealtimeAnalyzer = 0;
 static double __pyx_v_23realtime_image_analysis_nan;
-static int __pyx_k5;
-static double __pyx_k6;
-static PyObject *__pyx_k8;
-static int __pyx_k9;
-static void (__pyx_f_23realtime_image_analysis_CHK_HAVEGIL(IppStatus )); /*proto*/
-static PyObject *(__pyx_f_23realtime_image_analysis_print_8u_arr(Ipp8u (*),int ,int ,int )); /*proto*/
+static int __pyx_k6;
+static double __pyx_k7;
+static PyObject *__pyx_k9;
+static int __pyx_k10;
+static void __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(IppStatus); /*proto*/
+static PyObject *__pyx_f_23realtime_image_analysis_print_8u_arr(Ipp8u *,int,int,int); /*proto*/
 
 
 /* Implementation of realtime_image_analysis */
 
-static char (__pyx_k4[]) = "motmot.FastImage.FastImage";
+static char __pyx_k4[] = "motmot.FastImage.FastImage";
+static char __pyx_k5[] = "*";
 
 static PyObject *__pyx_n_time;
+static PyObject *__pyx_n_numpy;
 static PyObject *__pyx_n_nx;
 static PyObject *__pyx_n_warnings;
 static PyObject *__pyx_n_FastImage;
-static PyObject *__pyx_n_c_lib;
-static PyObject *__pyx_n_c_python;
-static PyObject *__pyx_n_ipp;
-static PyObject *__pyx_n_bg_help_slow;
-static PyObject *__pyx_n_bg_help;
-static PyObject *__pyx_n_do_bg_maint;
-static PyObject *__pyx_n_numpy;
 static PyObject *__pyx_n_nan;
 static PyObject *__pyx_n_mean;
 
 static PyObject *__pyx_k4p;
+static PyObject *__pyx_k5p;
 
 static PyObject *__pyx_n_IppError;
 
@@ -252,12 +268,8 @@
   PyObject *__pyx_2 = 0;
   PyObject *__pyx_3 = 0;
   PyObject *__pyx_4 = 0;
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":54 */
   __pyx_1 = (__pyx_v_errval != ippStsNoErr);
   if (__pyx_1) {
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":55 */
     __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_FastImage); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; goto __pyx_L1;}
     __pyx_3 = PyObject_GetAttr(__pyx_2, __pyx_n_IppError); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 55; goto __pyx_L1;}
     Py_DECREF(__pyx_2); __pyx_2 = 0;
@@ -284,14 +296,14 @@
   __pyx_L0:;
 }
 
-static PyObject *__pyx_k10p;
+static PyObject *__pyx_k11p;
 
-static char (__pyx_k10[]) = "%d";
+static char __pyx_k11[] = "%d";
 
-static PyObject *__pyx_f_23realtime_image_analysis_print_8u_arr(Ipp8u (*__pyx_v_src),int __pyx_v_width,int __pyx_v_height,int __pyx_v_src_step) {
+static PyObject *__pyx_f_23realtime_image_analysis_print_8u_arr(Ipp8u *__pyx_v_src,int __pyx_v_width,int __pyx_v_height,int __pyx_v_src_step) {
   int __pyx_v_row;
   int __pyx_v_col;
-  Ipp8u (*__pyx_v_src_rowstart);
+  Ipp8u *__pyx_v_src_rowstart;
   PyObject *__pyx_r;
   PyObject *__pyx_1 = 0;
   PyObject *__pyx_2 = 0;
@@ -304,10 +316,8 @@
 
     /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":69 */
     for (__pyx_v_col = 0; __pyx_v_col < __pyx_v_width; ++__pyx_v_col) {
-
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":70 */
       __pyx_1 = PyInt_FromLong((__pyx_v_src_rowstart[__pyx_v_col])); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; goto __pyx_L1;}
-      __pyx_2 = PyNumber_Remainder(__pyx_k10p, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; goto __pyx_L1;}
+      __pyx_2 = PyNumber_Remainder(__pyx_k11p, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; goto __pyx_L1;}
       Py_DECREF(__pyx_1); __pyx_1 = 0;
       if (__Pyx_PrintItem(__pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 70; goto __pyx_L1;}
       Py_DECREF(__pyx_2); __pyx_2 = 0;
@@ -337,7 +347,7 @@
   PyObject *__pyx_v_kw = 0;
   int __pyx_r;
   static char *__pyx_argnames[] = {0};
-  if (__Pyx_GetStarArgs(&__pyx_args, &__pyx_kwds, __pyx_argnames, 0, &__pyx_v_args, &__pyx_v_kw) < 0) return -1;
+  if (__Pyx_GetStarArgs(&__pyx_args, &__pyx_kwds, __pyx_argnames, 0, &__pyx_v_args, &__pyx_v_kw, 0) < 0) return -1;
   if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "", __pyx_argnames)) {
     Py_XDECREF(__pyx_args);
     Py_XDECREF(__pyx_kwds);
@@ -346,14 +356,12 @@
     return -1;
   }
   Py_INCREF(__pyx_v_self);
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":125 */
   __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(ippiMomentInitAlloc_64f((&((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->pState),ippAlgHintFast)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 125; goto __pyx_L1;}
 
   __pyx_r = 0;
   goto __pyx_L0;
   __pyx_L1:;
-  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.__new__");
+  __Pyx_AddTraceback("realtime_image_analysis.RealtimeAnalyzer.__cinit__");
   __pyx_r = -1;
   __pyx_L0:;
   Py_XDECREF(__pyx_v_args);
@@ -367,8 +375,6 @@
 static void __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___dealloc__(PyObject *__pyx_v_self); /*proto*/
 static void __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer___dealloc__(PyObject *__pyx_v_self) {
   Py_INCREF(__pyx_v_self);
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":128 */
   __pyx_f_23realtime_image_analysis_CHK_HAVEGIL(ippiMomentFree_64f(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->pState)); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 128; goto __pyx_L1;}
 
   goto __pyx_L0;
@@ -574,8 +580,6 @@
   __pyx_2 = __pyx_1 == Py_None;
   Py_DECREF(__pyx_1); __pyx_1 = 0;
   if (__pyx_2) {
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":172 */
     __pyx_1 = PyFloat_FromDouble(__pyx_v_x0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; goto __pyx_L1;}
     __pyx_3 = PyFloat_FromDouble(__pyx_v_y0); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; goto __pyx_L1;}
     __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; goto __pyx_L1;}
@@ -628,11 +632,11 @@
 static PyObject *__pyx_n_stacklevel;
 static PyObject *__pyx_n_append;
 
-static PyObject *__pyx_k16p;
 static PyObject *__pyx_k17p;
+static PyObject *__pyx_k18p;
 
-static char (__pyx_k16[]) = "input image size (%s) does not correspond to ROI (%s)(set RealtimeAnalyzer.roi before calling)";
-static char (__pyx_k17[]) = "stopped looking for points (this frame only) because it was taking longer than max_duration_sec";
+static char __pyx_k17[] = "input image size (%s) does not correspond to ROI (%s)(set RealtimeAnalyzer.roi before calling)";
+static char __pyx_k18[] = "stopped looking for points (this frame only) because it was taking longer than max_duration_sec";
 
 static PyObject *__pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_do_work(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static char __pyx_doc_23realtime_image_analysis_16RealtimeAnalyzer_do_work[] = "find location and orientation of local points (fast enough for realtime use)\n\n        inputs\n        ------\n\n        timestamp\n        framenumber\n        use_roi2\n\n        optional inputs (default to 0)\n        ------------------------------\n        use_cmp -- perform more detailed analysis against cmp image (used with ongoing variance estimation)\n\n        outputs\n        -------\n\n        [ (x0_abs, y0_abs, area, slope, eccentricity) ] -- with a tuple for each point found\n\n        ";
@@ -665,7 +669,7 @@
   int __pyx_v_index_x;
   int __pyx_v_index_y;
   Ipp8u __pyx_v_max_val;
-  Ipp8u (*__pyx_v_max_val_ptr);
+  Ipp8u *__pyx_v_max_val_ptr;
   Ipp8u __pyx_v_max_std_diff;
   Ipp8u __pyx_v_clear_despeckle_thresh;
   struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *__pyx_v_roi2_sz;
@@ -690,8 +694,8 @@
   PyObject *__pyx_9 = 0;
   PyObject *__pyx_10 = 0;
   static char *__pyx_argnames[] = {"raw_im_small","timestamp","framenumber","use_roi2","use_cmp","max_duration_sec",0};
-  __pyx_v_use_cmp = __pyx_k5;
-  __pyx_v_max_duration_sec = __pyx_k6;
+  __pyx_v_use_cmp = __pyx_k6;
+  __pyx_v_max_duration_sec = __pyx_k7;
   if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "Odii|id", __pyx_argnames, &__pyx_v_raw_im_small, &__pyx_v_timestamp, &__pyx_v_framenumber, &__pyx_v_use_roi2, &__pyx_v_use_cmp, &__pyx_v_max_duration_sec)) return 0;
   Py_INCREF(__pyx_v_self);
   Py_INCREF((PyObject *)__pyx_v_raw_im_small);
@@ -740,8 +744,6 @@
   }
   __pyx_6 = (!__pyx_5);
   if (__pyx_6) {
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":239 */
     __pyx_4 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; goto __pyx_L1;}
     __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_str); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; goto __pyx_L1;}
     __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; goto __pyx_L1;}
@@ -762,7 +764,7 @@
     PyTuple_SET_ITEM(__pyx_2, 1, __pyx_8);
     __pyx_7 = 0;
     __pyx_8 = 0;
-    __pyx_1 = PyNumber_Remainder(__pyx_k16p, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; goto __pyx_L1;}
+    __pyx_1 = PyNumber_Remainder(__pyx_k17p, __pyx_2); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 240; goto __pyx_L1;}
     Py_DECREF(__pyx_2); __pyx_2 = 0;
     __pyx_7 = PyTuple_New(1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 239; goto __pyx_L1;}
     PyTuple_SET_ITEM(__pyx_7, 0, __pyx_1);
@@ -777,462 +779,457 @@
   }
   __pyx_L2:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":244 */
-  Py_BEGIN_ALLOW_THREADS;
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":245 */
+  /*with nogil:*/ {
+    PyThreadState *_save;
+    Py_UNBLOCK_THREADS
+    /*try:*/ {
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":249 */
-  CHK_NOGIL(ippiAbsDiff_8u_C1R(((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view->__pyx_base.step,((Ipp8u (*))__pyx_v_raw_im_small->__pyx_base.im),__pyx_v_raw_im_small->__pyx_base.step,((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":250 */
+      CHK_NOGIL(ippiAbsDiff_8u_C1R(((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view->__pyx_base.step,((Ipp8u *)__pyx_v_raw_im_small->__pyx_base.im),__pyx_v_raw_im_small->__pyx_base.step,((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":259 */
-  CHK_NOGIL(ippiSet_8u_C1MR(0,((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im->__pyx_base.imsiz->sz,((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im->__pyx_base.step));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":260 */
+      CHK_NOGIL(ippiSet_8u_C1MR(0,((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im->__pyx_base.imsiz->sz,((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mask_im->__pyx_base.step));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":262 */
-  __pyx_5 = __pyx_v_use_cmp;
-  if (__pyx_5) {
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":264 */
-    CHK_NOGIL(ippiThreshold_Val_8u_C1IR(((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold,ippCmpLess));
-    goto __pyx_L3;
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":263 */
+      __pyx_5 = __pyx_v_use_cmp;
+      if (__pyx_5) {
+        CHK_NOGIL(ippiThreshold_Val_8u_C1IR(((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold,ippCmpLess));
+        goto __pyx_L6;
+      }
+      __pyx_L6:;
+    }
+    /*finally:*/ {
+      Py_BLOCK_THREADS
+    }
   }
-  __pyx_L3:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":268 */
-  Py_END_ALLOW_THREADS;
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":270 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":271 */
   while (1) {
     __pyx_6 = (__pyx_v_n_found_points < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->max_num_points);
     if (!__pyx_6) break;
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":271 */
+    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":272 */
     __pyx_5 = (__pyx_v_max_duration_sec != 0.0);
     if (__pyx_5) {
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":272 */
-      __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_time); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; goto __pyx_L1;}
-      __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_time); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; goto __pyx_L1;}
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":273 */
+      __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_time); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; goto __pyx_L1;}
+      __pyx_1 = PyObject_GetAttr(__pyx_2, __pyx_n_time); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; goto __pyx_L1;}
       Py_DECREF(__pyx_2); __pyx_2 = 0;
-      __pyx_4 = PyObject_CallObject(__pyx_1, 0); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; goto __pyx_L1;}
+      __pyx_4 = PyObject_CallObject(__pyx_1, 0); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; goto __pyx_L1;}
       Py_DECREF(__pyx_1); __pyx_1 = 0;
-      __pyx_3 = PyFloat_AsDouble(__pyx_4); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 272; goto __pyx_L1;}
+      __pyx_3 = PyFloat_AsDouble(__pyx_4); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 273; goto __pyx_L1;}
       Py_DECREF(__pyx_4); __pyx_4 = 0;
       __pyx_v_now = __pyx_3;
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":273 */
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":274 */
       __pyx_6 = ((__pyx_v_now - __pyx_v_entry_time) > __pyx_v_max_duration_sec);
       if (__pyx_6) {
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":274 */
-        __pyx_7 = __Pyx_GetName(__pyx_m, __pyx_n_warnings); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L1;}
-        __pyx_8 = PyObject_GetAttr(__pyx_7, __pyx_n_warn); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L1;}
+        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":275 */
+        __pyx_7 = __Pyx_GetName(__pyx_m, __pyx_n_warnings); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
+        __pyx_8 = PyObject_GetAttr(__pyx_7, __pyx_n_warn); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
         Py_DECREF(__pyx_7); __pyx_7 = 0;
-        __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L1;}
-        Py_INCREF(__pyx_k17p);
-        PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k17p);
-        __pyx_1 = PyDict_New(); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L1;}
-        __pyx_4 = PyInt_FromLong(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
-        if (PyDict_SetItem(__pyx_1, __pyx_n_stacklevel, __pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L1;}
+        __pyx_2 = PyTuple_New(1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
+        Py_INCREF(__pyx_k18p);
+        PyTuple_SET_ITEM(__pyx_2, 0, __pyx_k18p);
+        __pyx_1 = PyDict_New(); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
+        __pyx_4 = PyInt_FromLong(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 276; goto __pyx_L1;}
+        if (PyDict_SetItem(__pyx_1, __pyx_n_stacklevel, __pyx_4) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
         Py_DECREF(__pyx_4); __pyx_4 = 0;
-        __pyx_7 = PyEval_CallObjectWithKeywords(__pyx_8, __pyx_2, __pyx_1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; goto __pyx_L1;}
+        __pyx_7 = PyEval_CallObjectWithKeywords(__pyx_8, __pyx_2, __pyx_1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 275; goto __pyx_L1;}
         Py_DECREF(__pyx_8); __pyx_8 = 0;
         Py_DECREF(__pyx_2); __pyx_2 = 0;
         Py_DECREF(__pyx_1); __pyx_1 = 0;
         Py_DECREF(__pyx_7); __pyx_7 = 0;
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":276 */
-        goto __pyx_L5;
-        goto __pyx_L7;
+        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":277 */
+        goto __pyx_L8;
+        goto __pyx_L10;
       }
-      __pyx_L7:;
-      goto __pyx_L6;
+      __pyx_L10:;
+      goto __pyx_L9;
     }
-    __pyx_L6:;
+    __pyx_L9:;
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":278 */
-    Py_BEGIN_ALLOW_THREADS;
+    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":280 */
+    /*with nogil:*/ {
+      PyThreadState *_save;
+      Py_UNBLOCK_THREADS
+      /*try:*/ {
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":294 */
-    __pyx_5 = __pyx_v_use_cmp;
-    if (__pyx_5) {
+        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":295 */
+        __pyx_5 = __pyx_v_use_cmp;
+        if (__pyx_5) {
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":299 */
-      CHK_NOGIL(ippiSub_8u_C1RSfs(((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.step,((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step,((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,0));
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":300 */
+          CHK_NOGIL(ippiSub_8u_C1RSfs(((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view->__pyx_base.step,((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step,((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,0));
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":303 */
-      CHK_NOGIL(ippiMaxIndx_8u_C1R(((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,(&__pyx_v_max_std_diff),(&__pyx_v_index_x),(&__pyx_v_index_y)));
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":304 */
+          CHK_NOGIL(ippiMaxIndx_8u_C1R(((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,(&__pyx_v_max_std_diff),(&__pyx_v_index_x),(&__pyx_v_index_y)));
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":306 */
-      __pyx_v_max_val_ptr = ((((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im) + (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step * __pyx_v_index_y)) + __pyx_v_index_x);
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":307 */
+          __pyx_v_max_val_ptr = ((((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im) + (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step * __pyx_v_index_y)) + __pyx_v_index_x);
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":307 */
-      __pyx_v_max_val = (__pyx_v_max_val_ptr[0]);
-      goto __pyx_L8;
-    }
-    /*else*/ {
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":308 */
+          __pyx_v_max_val = (__pyx_v_max_val_ptr[0]);
+          goto __pyx_L16;
+        }
+        /*else*/ {
+          CHK_NOGIL(ippiMaxIndx_8u_C1R(((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,(&__pyx_v_max_val),(&__pyx_v_index_x),(&__pyx_v_index_y)));
+        }
+        __pyx_L16:;
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":309 */
-      CHK_NOGIL(ippiMaxIndx_8u_C1R(((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view->__pyx_base.step,((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz,(&__pyx_v_max_val),(&__pyx_v_index_x),(&__pyx_v_index_y)));
-    }
-    __pyx_L8:;
+        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":314 */
+        __pyx_6 = __pyx_v_use_roi2;
+        if (__pyx_6) {
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":313 */
-    __pyx_6 = __pyx_v_use_roi2;
-    if (__pyx_6) {
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":316 */
+          __pyx_v_left2 = ((__pyx_v_index_x - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":315 */
-      __pyx_v_left2 = ((__pyx_v_index_x - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":317 */
+          __pyx_v_right2 = ((__pyx_v_index_x + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":316 */
-      __pyx_v_right2 = ((__pyx_v_index_x + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":318 */
+          __pyx_v_bottom2 = ((__pyx_v_index_y - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":317 */
-      __pyx_v_bottom2 = ((__pyx_v_index_y - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":319 */
+          __pyx_v_top2 = ((__pyx_v_index_y + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":318 */
-      __pyx_v_top2 = ((__pyx_v_index_y + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius) + ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":321 */
+          __pyx_5 = (__pyx_v_left2 < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);
+          if (__pyx_5) {
+            __pyx_v_left2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left;
+            goto __pyx_L18;
+          }
+          __pyx_L18:;
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":320 */
-      __pyx_5 = (__pyx_v_left2 < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);
-      if (__pyx_5) {
-        __pyx_v_left2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left;
-        goto __pyx_L10;
-      }
-      __pyx_L10:;
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":322 */
+          __pyx_6 = (__pyx_v_right2 > ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right);
+          if (__pyx_6) {
+            __pyx_v_right2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right;
+            goto __pyx_L19;
+          }
+          __pyx_L19:;
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":321 */
-      __pyx_6 = (__pyx_v_right2 > ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right);
-      if (__pyx_6) {
-        __pyx_v_right2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right;
-        goto __pyx_L11;
-      }
-      __pyx_L11:;
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":323 */
+          __pyx_5 = (__pyx_v_bottom2 < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);
+          if (__pyx_5) {
+            __pyx_v_bottom2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom;
+            goto __pyx_L20;
+          }
+          __pyx_L20:;
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":322 */
-      __pyx_5 = (__pyx_v_bottom2 < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);
-      if (__pyx_5) {
-        __pyx_v_bottom2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom;
-        goto __pyx_L12;
-      }
-      __pyx_L12:;
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":324 */
+          __pyx_6 = (__pyx_v_top2 > ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top);
+          if (__pyx_6) {
+            __pyx_v_top2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top;
+            goto __pyx_L21;
+          }
+          __pyx_L21:;
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":323 */
-      __pyx_6 = (__pyx_v_top2 > ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top);
-      if (__pyx_6) {
-        __pyx_v_top2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top;
-        goto __pyx_L13;
-      }
-      __pyx_L13:;
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":325 */
+          __pyx_v_roi2_sz->sz.width = ((__pyx_v_right2 - __pyx_v_left2) + 1);
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":324 */
-      __pyx_v_roi2_sz->sz.width = ((__pyx_v_right2 - __pyx_v_left2) + 1);
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":326 */
+          __pyx_v_roi2_sz->sz.height = ((__pyx_v_top2 - __pyx_v_bottom2) + 1);
+          goto __pyx_L17;
+        }
+        /*else*/ {
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":325 */
-      __pyx_v_roi2_sz->sz.height = ((__pyx_v_top2 - __pyx_v_bottom2) + 1);
-      goto __pyx_L9;
-    }
-    /*else*/ {
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":328 */
+          __pyx_v_left2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left;
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":327 */
-      __pyx_v_left2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left;
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":329 */
+          __pyx_v_right2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right;
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":328 */
-      __pyx_v_right2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right;
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":330 */
+          __pyx_v_bottom2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom;
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":329 */
-      __pyx_v_bottom2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom;
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":331 */
+          __pyx_v_top2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top;
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":330 */
-      __pyx_v_top2 = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top;
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":332 */
+          __pyx_v_roi2_sz->sz.width = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.width;
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":331 */
-      __pyx_v_roi2_sz->sz.width = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.width;
-
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":332 */
-      __pyx_v_roi2_sz->sz.height = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.height;
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":333 */
+          __pyx_v_roi2_sz->sz.height = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz->sz.height;
+        }
+        __pyx_L17:;
+      }
+      /*finally:*/ {
+        Py_BLOCK_THREADS
+      }
     }
-    __pyx_L9:;
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":334 */
-    Py_END_ALLOW_THREADS;
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":336 */
-    __pyx_4 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im), __pyx_n_roi); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; goto __pyx_L1;}
-    __pyx_8 = PyInt_FromLong(__pyx_v_left2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; goto __pyx_L1;}
-    __pyx_2 = PyInt_FromLong(__pyx_v_bottom2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; goto __pyx_L1;}
-    __pyx_1 = PyTuple_New(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; goto __pyx_L1;}
+    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":337 */
+    __pyx_4 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im), __pyx_n_roi); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; goto __pyx_L1;}
+    __pyx_8 = PyInt_FromLong(__pyx_v_left2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; goto __pyx_L1;}
+    __pyx_2 = PyInt_FromLong(__pyx_v_bottom2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; goto __pyx_L1;}
+    __pyx_1 = PyTuple_New(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; goto __pyx_L1;}
     PyTuple_SET_ITEM(__pyx_1, 0, __pyx_8);
     PyTuple_SET_ITEM(__pyx_1, 1, __pyx_2);
     Py_INCREF(((PyObject *)__pyx_v_roi2_sz));
     PyTuple_SET_ITEM(__pyx_1, 2, ((PyObject *)__pyx_v_roi2_sz));
     __pyx_8 = 0;
     __pyx_2 = 0;
-    __pyx_7 = PyObject_CallObject(__pyx_4, __pyx_1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; goto __pyx_L1;}
+    __pyx_7 = PyObject_CallObject(__pyx_4, __pyx_1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; goto __pyx_L1;}
     Py_DECREF(__pyx_4); __pyx_4 = 0;
     Py_DECREF(__pyx_1); __pyx_1 = 0;
-    if (!__Pyx_TypeTest(__pyx_7, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; goto __pyx_L1;}
+    if (!__Pyx_TypeTest(__pyx_7, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 337; goto __pyx_L1;}
     Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view));
     ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_7);
     __pyx_7 = 0;
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":337 */
+    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":338 */
     __pyx_5 = __pyx_v_use_cmp;
     if (__pyx_5) {
-
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":338 */
-      __pyx_8 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im), __pyx_n_roi); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; goto __pyx_L1;}
-      __pyx_2 = PyInt_FromLong(__pyx_v_left2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; goto __pyx_L1;}
-      __pyx_4 = PyInt_FromLong(__pyx_v_bottom2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; goto __pyx_L1;}
-      __pyx_1 = PyTuple_New(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; goto __pyx_L1;}
+      __pyx_8 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im), __pyx_n_roi); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; goto __pyx_L1;}
+      __pyx_2 = PyInt_FromLong(__pyx_v_left2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; goto __pyx_L1;}
+      __pyx_4 = PyInt_FromLong(__pyx_v_bottom2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; goto __pyx_L1;}
+      __pyx_1 = PyTuple_New(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; goto __pyx_L1;}
       PyTuple_SET_ITEM(__pyx_1, 0, __pyx_2);
       PyTuple_SET_ITEM(__pyx_1, 1, __pyx_4);
       Py_INCREF(((PyObject *)__pyx_v_roi2_sz));
       PyTuple_SET_ITEM(__pyx_1, 2, ((PyObject *)__pyx_v_roi2_sz));
       __pyx_2 = 0;
       __pyx_4 = 0;
-      __pyx_7 = PyObject_CallObject(__pyx_8, __pyx_1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; goto __pyx_L1;}
+      __pyx_7 = PyObject_CallObject(__pyx_8, __pyx_1); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; goto __pyx_L1;}
       Py_DECREF(__pyx_8); __pyx_8 = 0;
       Py_DECREF(__pyx_1); __pyx_1 = 0;
-      if (!__Pyx_TypeTest(__pyx_7, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; goto __pyx_L1;}
+      if (!__Pyx_TypeTest(__pyx_7, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; goto __pyx_L1;}
       Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi2_view));
       ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi2_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_7);
       __pyx_7 = 0;
-      goto __pyx_L14;
+      goto __pyx_L22;
     }
-    __pyx_L14:;
+    __pyx_L22:;
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":339 */
-    Py_BEGIN_ALLOW_THREADS;
+    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":341 */
+    /*with nogil:*/ {
+      PyThreadState *_save;
+      Py_UNBLOCK_THREADS
+      /*try:*/ {
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":343 */
-    __pyx_v_clear_despeckle_thresh = ((unsigned char )(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold * __pyx_v_max_val));
+        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":345 */
+        __pyx_v_clear_despeckle_thresh = ((Ipp8u)(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold * __pyx_v_max_val));
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":344 */
-    __pyx_6 = (__pyx_v_clear_despeckle_thresh < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_despeckle_threshold);
-    if (__pyx_6) {
+        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":346 */
+        __pyx_6 = (__pyx_v_clear_despeckle_thresh < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_despeckle_threshold);
+        if (__pyx_6) {
+          __pyx_v_clear_despeckle_thresh = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_despeckle_threshold;
+          goto __pyx_L28;
+        }
+        __pyx_L28:;
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":345 */
-      __pyx_v_clear_despeckle_thresh = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_despeckle_threshold;
-      goto __pyx_L15;
-    }
-    __pyx_L15:;
+        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":349 */
+        CHK_NOGIL(ippiThreshold_Val_8u_C1IR(((Ipp8u *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.step,__pyx_v_roi2_sz->sz,__pyx_v_clear_despeckle_thresh,0,ippCmpLess));
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":347 */
-    CHK_NOGIL(ippiThreshold_Val_8u_C1IR(((Ipp8u (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.step,__pyx_v_roi2_sz->sz,__pyx_v_clear_despeckle_thresh,0,ippCmpLess));
+        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":353 */
+        __pyx_v_found_point = 1;
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":351 */
-    __pyx_v_found_point = 1;
+        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":355 */
+        __pyx_5 = (!__pyx_v_use_cmp);
+        if (__pyx_5) {
+          __pyx_6 = (__pyx_v_max_val < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold);
+          if (__pyx_6) {
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":353 */
-    __pyx_5 = (!__pyx_v_use_cmp);
-    if (__pyx_5) {
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":357 */
+            __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":354 */
-      __pyx_6 = (__pyx_v_max_val < ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold);
-      if (__pyx_6) {
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":358 */
+            __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":355 */
-        __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":359 */
+            __pyx_v_x0_abs = __pyx_v_23realtime_image_analysis_nan;
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":356 */
-        __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":360 */
+            __pyx_v_y0_abs = __pyx_v_23realtime_image_analysis_nan;
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":357 */
-        __pyx_v_x0_abs = __pyx_v_23realtime_image_analysis_nan;
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":361 */
+            __pyx_v_found_point = 0;
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":358 */
-        __pyx_v_y0_abs = __pyx_v_23realtime_image_analysis_nan;
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":362 */
+            __pyx_v_max_val = 0;
+            goto __pyx_L30;
+          }
+          __pyx_L30:;
+          goto __pyx_L29;
+        }
+        /*else*/ {
+          __pyx_5 = (__pyx_v_max_std_diff == 0);
+          if (__pyx_5) {
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":359 */
-        __pyx_v_found_point = 0;
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":365 */
+            __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":360 */
-        __pyx_v_max_val = 0;
-        goto __pyx_L17;
-      }
-      __pyx_L17:;
-      goto __pyx_L16;
-    }
-    /*else*/ {
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":366 */
+            __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":362 */
-      __pyx_5 = (__pyx_v_max_std_diff == 0);
-      if (__pyx_5) {
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":367 */
+            __pyx_v_x0_abs = __pyx_v_23realtime_image_analysis_nan;
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":363 */
-        __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":368 */
+            __pyx_v_y0_abs = __pyx_v_23realtime_image_analysis_nan;
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":364 */
-        __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":369 */
+            __pyx_v_found_point = 0;
+            goto __pyx_L31;
+          }
+          __pyx_L31:;
+        }
+        __pyx_L29:;
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":365 */
-        __pyx_v_x0_abs = __pyx_v_23realtime_image_analysis_nan;
+        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":370 */
+        __pyx_6 = __pyx_v_found_point;
+        if (__pyx_6) {
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":366 */
-        __pyx_v_y0_abs = __pyx_v_23realtime_image_analysis_nan;
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":371 */
+          __pyx_v_result = fit_params(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->pState,(&__pyx_v_x0),(&__pyx_v_y0),(&__pyx_v_Mu00),(&__pyx_v_Uu11),(&__pyx_v_Uu20),(&__pyx_v_Uu02),__pyx_v_roi2_sz->sz.width,__pyx_v_roi2_sz->sz.height,((unsigned char *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.step);
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":367 */
-        __pyx_v_found_point = 0;
-        goto __pyx_L18;
-      }
-      __pyx_L18:;
-    }
-    __pyx_L16:;
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":378 */
+          __pyx_5 = (__pyx_v_result == CFitParamsNoError);
+          if (__pyx_5) {
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":368 */
-    __pyx_6 = __pyx_v_found_point;
-    if (__pyx_6) {
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":379 */
+            __pyx_v_area = __pyx_v_Mu00;
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":369 */
-      __pyx_v_result = fit_params(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->pState,(&__pyx_v_x0),(&__pyx_v_y0),(&__pyx_v_Mu00),(&__pyx_v_Uu11),(&__pyx_v_Uu20),(&__pyx_v_Uu02),__pyx_v_roi2_sz->sz.width,__pyx_v_roi2_sz->sz.height,((unsigned char (*))((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.im),((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view->__pyx_base.step);
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":380 */
+            __pyx_v_eigen_err = eigen_2x2_real(__pyx_v_Uu20,__pyx_v_Uu11,__pyx_v_Uu11,__pyx_v_Uu02,(&__pyx_v_evalA),(&__pyx_v_evecA1),(&__pyx_v_evalB),(&__pyx_v_evecB1));
 
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":376 */
-      __pyx_5 = (__pyx_v_result == CFitParamsNoError);
-      if (__pyx_5) {
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":384 */
+            __pyx_6 = __pyx_v_eigen_err;
+            if (__pyx_6) {
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":377 */
-        __pyx_v_area = __pyx_v_Mu00;
+              /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":385 */
+              __pyx_v_slope = __pyx_v_23realtime_image_analysis_nan;
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":378 */
-        __pyx_v_eigen_err = eigen_2x2_real(__pyx_v_Uu20,__pyx_v_Uu11,__pyx_v_Uu11,__pyx_v_Uu02,(&__pyx_v_evalA),(&__pyx_v_evecA1),(&__pyx_v_evalB),(&__pyx_v_evecB1));
+              /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":386 */
+              __pyx_v_eccentricity = 0.0;
+              goto __pyx_L34;
+            }
+            /*else*/ {
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":382 */
-        __pyx_6 = __pyx_v_eigen_err;
-        if (__pyx_6) {
+              /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":388 */
+              __pyx_v_rise = 1.0;
 
-          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":383 */
-          __pyx_v_slope = __pyx_v_23realtime_image_analysis_nan;
+              /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":389 */
+              __pyx_5 = (__pyx_v_evalA > __pyx_v_evalB);
+              if (__pyx_5) {
 
-          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":384 */
-          __pyx_v_eccentricity = 0.0;
-          goto __pyx_L21;
-        }
-        /*else*/ {
+                /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":390 */
+                __pyx_v_run = __pyx_v_evecA1;
 
-          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":386 */
-          __pyx_v_rise = 1.0;
+                /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":391 */
+                __pyx_v_eccentricity = (__pyx_v_evalA / __pyx_v_evalB);
+                goto __pyx_L35;
+              }
+              /*else*/ {
 
-          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":387 */
-          __pyx_5 = (__pyx_v_evalA > __pyx_v_evalB);
-          if (__pyx_5) {
+                /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":393 */
+                __pyx_v_run = __pyx_v_evecB1;
 
-            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":388 */
-            __pyx_v_run = __pyx_v_evecA1;
+                /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":394 */
+                __pyx_v_eccentricity = (__pyx_v_evalB / __pyx_v_evalA);
+              }
+              __pyx_L35:;
 
-            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":389 */
-            __pyx_v_eccentricity = (__pyx_v_evalA / __pyx_v_evalB);
-            goto __pyx_L22;
+              /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":395 */
+              __pyx_v_slope = (__pyx_v_rise / __pyx_v_run);
+            }
+            __pyx_L34:;
+            goto __pyx_L33;
           }
-          /*else*/ {
+          __pyx_6 = (__pyx_v_result == CFitParamsZeroMomentError);
+          if (__pyx_6) {
 
-            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":391 */
-            __pyx_v_run = __pyx_v_evecB1;
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":398 */
+            __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;
 
-            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":392 */
-            __pyx_v_eccentricity = (__pyx_v_evalB / __pyx_v_evalA);
-          }
-          __pyx_L22:;
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":399 */
+            __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;
 
-          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":393 */
-          __pyx_v_slope = (__pyx_v_rise / __pyx_v_run);
-        }
-        __pyx_L21:;
-        goto __pyx_L20;
-      }
-      __pyx_6 = (__pyx_v_result == CFitParamsZeroMomentError);
-      if (__pyx_6) {
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":400 */
+            __pyx_v_x0_abs = __pyx_v_23realtime_image_analysis_nan;
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":396 */
-        __pyx_v_x0 = __pyx_v_23realtime_image_analysis_nan;
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":401 */
+            __pyx_v_y0_abs = __pyx_v_23realtime_image_analysis_nan;
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":397 */
-        __pyx_v_y0 = __pyx_v_23realtime_image_analysis_nan;
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":402 */
+            __pyx_v_found_point = 0;
+            goto __pyx_L33;
+          }
+          __pyx_5 = (__pyx_v_result == CFitParamsCentralMomentError);
+          if (__pyx_5) {
+            __pyx_v_slope = __pyx_v_23realtime_image_analysis_nan;
+            goto __pyx_L33;
+          }
+          /*else*/ {
+            SET_ERR(1);
+          }
+          __pyx_L33:;
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":398 */
-        __pyx_v_x0_abs = __pyx_v_23realtime_image_analysis_nan;
+          /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":408 */
+          __pyx_6 = __pyx_v_found_point;
+          if (__pyx_6) {
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":399 */
-        __pyx_v_y0_abs = __pyx_v_23realtime_image_analysis_nan;
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":409 */
+            __pyx_v_x0_abs = (__pyx_v_x0 + __pyx_v_left2);
 
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":400 */
-        __pyx_v_found_point = 0;
-        goto __pyx_L20;
+            /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":410 */
+            __pyx_v_y0_abs = (__pyx_v_y0 + __pyx_v_bottom2);
+            goto __pyx_L36;
+          }
+          __pyx_L36:;
+          goto __pyx_L32;
+        }
+        __pyx_L32:;
       }
-      __pyx_5 = (__pyx_v_result == CFitParamsCentralMomentError);
-      if (__pyx_5) {
-
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":402 */
-        __pyx_v_slope = __pyx_v_23realtime_image_analysis_nan;
-        goto __pyx_L20;
+      /*finally:*/ {
+        Py_BLOCK_THREADS
       }
-      /*else*/ {
-        SET_ERR(1);
-      }
-      __pyx_L20:;
-
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":406 */
-      __pyx_6 = __pyx_v_found_point;
-      if (__pyx_6) {
-
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":407 */
-        __pyx_v_x0_abs = (__pyx_v_x0 + __pyx_v_left2);
-
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":408 */
-        __pyx_v_y0_abs = (__pyx_v_y0 + __pyx_v_bottom2);
-        goto __pyx_L23;
-      }
-      __pyx_L23:;
-      goto __pyx_L19;
     }
-    __pyx_L19:;
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":411 */
-    Py_END_ALLOW_THREADS;
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":413 */
+    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":415 */
     __pyx_5 = __pyx_v_found_point;
     if (__pyx_5) {
-
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":414 */
       __pyx_6 = (!((__pyx_v_n_found_points + 1) >= ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->max_num_points));
       if (__pyx_6) {
-
-        /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":415 */
-        __pyx_2 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view), __pyx_n_set_val); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; goto __pyx_L1;}
-        __pyx_4 = PyInt_FromLong(0); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; goto __pyx_L1;}
-        __pyx_8 = PyTuple_New(2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; goto __pyx_L1;}
+        __pyx_2 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi2_view), __pyx_n_set_val); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; goto __pyx_L1;}
+        __pyx_4 = PyInt_FromLong(0); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; goto __pyx_L1;}
+        __pyx_8 = PyTuple_New(2); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; goto __pyx_L1;}
         PyTuple_SET_ITEM(__pyx_8, 0, __pyx_4);
         Py_INCREF(((PyObject *)__pyx_v_roi2_sz));
         PyTuple_SET_ITEM(__pyx_8, 1, ((PyObject *)__pyx_v_roi2_sz));
         __pyx_4 = 0;
-        __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_8); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 415; goto __pyx_L1;}
+        __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_8); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 417; goto __pyx_L1;}
         Py_DECREF(__pyx_2); __pyx_2 = 0;
         Py_DECREF(__pyx_8); __pyx_8 = 0;
         Py_DECREF(__pyx_1); __pyx_1 = 0;
-        goto __pyx_L25;
+        goto __pyx_L38;
       }
-      __pyx_L25:;
-      goto __pyx_L24;
+      __pyx_L38:;
+      goto __pyx_L37;
     }
-    __pyx_L24:;
+    __pyx_L37:;
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":417 */
+    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":419 */
     __pyx_5 = (!__pyx_v_found_point);
     if (__pyx_5) {
-
-      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":418 */
-      goto __pyx_L5;
-      goto __pyx_L26;
+      goto __pyx_L8;
+      goto __pyx_L39;
     }
-    __pyx_L26:;
+    __pyx_L39:;
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":420 */
-    __pyx_7 = PyObject_GetAttr(__pyx_v_all_points_found, __pyx_n_append); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; goto __pyx_L1;}
-    __pyx_4 = PyFloat_FromDouble(__pyx_v_x0_abs); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; goto __pyx_L1;}
-    __pyx_2 = PyFloat_FromDouble(__pyx_v_y0_abs); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; goto __pyx_L1;}
-    __pyx_8 = PyFloat_FromDouble(__pyx_v_area); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; goto __pyx_L1;}
-    __pyx_1 = PyFloat_FromDouble(__pyx_v_slope); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; goto __pyx_L1;}
-    __pyx_9 = PyFloat_FromDouble(__pyx_v_eccentricity); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; goto __pyx_L1;}
-    __pyx_10 = PyTuple_New(5); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; goto __pyx_L1;}
+    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":422 */
+    __pyx_7 = PyObject_GetAttr(__pyx_v_all_points_found, __pyx_n_append); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; goto __pyx_L1;}
+    __pyx_4 = PyFloat_FromDouble(__pyx_v_x0_abs); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; goto __pyx_L1;}
+    __pyx_2 = PyFloat_FromDouble(__pyx_v_y0_abs); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; goto __pyx_L1;}
+    __pyx_8 = PyFloat_FromDouble(__pyx_v_area); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; goto __pyx_L1;}
+    __pyx_1 = PyFloat_FromDouble(__pyx_v_slope); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; goto __pyx_L1;}
+    __pyx_9 = PyFloat_FromDouble(__pyx_v_eccentricity); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; goto __pyx_L1;}
+    __pyx_10 = PyTuple_New(5); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 423; goto __pyx_L1;}
     PyTuple_SET_ITEM(__pyx_10, 0, __pyx_4);
     PyTuple_SET_ITEM(__pyx_10, 1, __pyx_2);
     PyTuple_SET_ITEM(__pyx_10, 2, __pyx_8);
@@ -1243,20 +1240,20 @@
     __pyx_8 = 0;
     __pyx_1 = 0;
     __pyx_9 = 0;
-    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; goto __pyx_L1;}
+    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; goto __pyx_L1;}
     PyTuple_SET_ITEM(__pyx_4, 0, __pyx_10);
     __pyx_10 = 0;
-    __pyx_2 = PyObject_CallObject(__pyx_7, __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 420; goto __pyx_L1;}
+    __pyx_2 = PyObject_CallObject(__pyx_7, __pyx_4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 422; goto __pyx_L1;}
     Py_DECREF(__pyx_7); __pyx_7 = 0;
     Py_DECREF(__pyx_4); __pyx_4 = 0;
     Py_DECREF(__pyx_2); __pyx_2 = 0;
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":423 */
+    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":425 */
     __pyx_v_n_found_points = (__pyx_v_n_found_points + 1);
   }
-  __pyx_L5:;
+  __pyx_L8:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":425 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":427 */
   Py_INCREF(__pyx_v_all_points_found);
   __pyx_r = __pyx_v_all_points_found;
   goto __pyx_L0;
@@ -1288,19 +1285,19 @@
   PyObject *__pyx_r;
   PyObject *__pyx_1 = 0;
   static char *__pyx_argnames[] = {"which",0};
-  __pyx_v_which = __pyx_k8;
+  __pyx_v_which = __pyx_k9;
   if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "|O", __pyx_argnames, &__pyx_v_which)) return 0;
   Py_INCREF(__pyx_v_self);
   Py_INCREF(__pyx_v_which);
   __pyx_v_im = Py_None; Py_INCREF(Py_None);
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":428 */
-  __pyx_1 = PyObject_GetItem(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->imname2im, __pyx_v_which); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 428; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":430 */
+  __pyx_1 = PyObject_GetItem(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->imname2im, __pyx_v_which); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 430; goto __pyx_L1;}
   Py_DECREF(__pyx_v_im);
   __pyx_v_im = __pyx_1;
   __pyx_1 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":429 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":431 */
   Py_INCREF(__pyx_v_im);
   __pyx_r = __pyx_v_im;
   goto __pyx_L0;
@@ -1323,9 +1320,7 @@
   PyObject *__pyx_r;
   PyObject *__pyx_1 = 0;
   Py_INCREF(__pyx_v_self);
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":433 */
-  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 433; goto __pyx_L1;}
+  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 435; goto __pyx_L1;}
   __pyx_r = __pyx_1;
   __pyx_1 = 0;
   goto __pyx_L0;
@@ -1347,9 +1342,7 @@
   int __pyx_1;
   Py_INCREF(__pyx_v_self);
   Py_INCREF(__pyx_v_value);
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":435 */
-  __pyx_1 = PyInt_AsLong(__pyx_v_value); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 435; goto __pyx_L1;}
+  __pyx_1 = PyInt_AsLong(__pyx_v_value); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 437; goto __pyx_L1;}
   ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi2_radius = __pyx_1;
 
   __pyx_r = 0;
@@ -1368,9 +1361,7 @@
   PyObject *__pyx_r;
   PyObject *__pyx_1 = 0;
   Py_INCREF(__pyx_v_self);
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":439 */
-  __pyx_1 = PyFloat_FromDouble(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 439; goto __pyx_L1;}
+  __pyx_1 = PyFloat_FromDouble(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 441; goto __pyx_L1;}
   __pyx_r = __pyx_1;
   __pyx_1 = 0;
   goto __pyx_L0;
@@ -1392,9 +1383,7 @@
   float __pyx_1;
   Py_INCREF(__pyx_v_self);
   Py_INCREF(__pyx_v_value);
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":441 */
-  __pyx_1 = PyFloat_AsDouble(__pyx_v_value); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 441; goto __pyx_L1;}
+  __pyx_1 = PyFloat_AsDouble(__pyx_v_value); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 443; goto __pyx_L1;}
   ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_clear_threshold = __pyx_1;
 
   __pyx_r = 0;
@@ -1413,9 +1402,7 @@
   PyObject *__pyx_r;
   PyObject *__pyx_1 = 0;
   Py_INCREF(__pyx_v_self);
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":445 */
-  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 445; goto __pyx_L1;}
+  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; goto __pyx_L1;}
   __pyx_r = __pyx_1;
   __pyx_1 = 0;
   goto __pyx_L0;
@@ -1437,9 +1424,7 @@
   Ipp8u __pyx_1;
   Py_INCREF(__pyx_v_self);
   Py_INCREF(__pyx_v_value);
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":447 */
-  __pyx_1 = PyInt_AsLong(__pyx_v_value); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 447; goto __pyx_L1;}
+  __pyx_1 = PyInt_AsLong(__pyx_v_value); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 449; goto __pyx_L1;}
   ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_diff_threshold = __pyx_1;
 
   __pyx_r = 0;
@@ -1460,9 +1445,7 @@
   PyObject *__pyx_r;
   PyObject *__pyx_1 = 0;
   Py_INCREF(__pyx_v_self);
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":451 */
-  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n__scale_factor); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 451; goto __pyx_L1;}
+  __pyx_1 = PyObject_GetAttr(__pyx_v_self, __pyx_n__scale_factor); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 453; goto __pyx_L1;}
   __pyx_r = __pyx_1;
   __pyx_1 = 0;
   goto __pyx_L0;
@@ -1478,9 +1461,9 @@
   return __pyx_r;
 }
 
-static PyObject *__pyx_k19p;
+static PyObject *__pyx_k20p;
 
-static char (__pyx_k19[]) = "setting scale_factor to";
+static char __pyx_k20[] = "setting scale_factor to";
 
 static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
 static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_12scale_factor___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
@@ -1488,13 +1471,13 @@
   Py_INCREF(__pyx_v_self);
   Py_INCREF(__pyx_v_value);
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":453 */
-  if (__Pyx_PrintItem(__pyx_k19p) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 453; goto __pyx_L1;}
-  if (__Pyx_PrintItem(__pyx_v_value) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 453; goto __pyx_L1;}
-  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 453; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":455 */
+  if (__Pyx_PrintItem(__pyx_k20p) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 455; goto __pyx_L1;}
+  if (__Pyx_PrintItem(__pyx_v_value) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 455; goto __pyx_L1;}
+  if (__Pyx_PrintNewline() < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 455; goto __pyx_L1;}
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":454 */
-  if (PyObject_SetAttr(__pyx_v_self, __pyx_n__scale_factor, __pyx_v_value) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 454; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":456 */
+  if (PyObject_SetAttr(__pyx_v_self, __pyx_n__scale_factor, __pyx_v_value) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 456; goto __pyx_L1;}
 
   __pyx_r = 0;
   goto __pyx_L0;
@@ -1516,13 +1499,11 @@
   PyObject *__pyx_4 = 0;
   PyObject *__pyx_5 = 0;
   Py_INCREF(__pyx_v_self);
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":458 */
-  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; goto __pyx_L1;}
-  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; goto __pyx_L1;}
-  __pyx_3 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; goto __pyx_L1;}
-  __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; goto __pyx_L1;}
-  __pyx_5 = PyTuple_New(4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 458; goto __pyx_L1;}
+  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; goto __pyx_L1;}
+  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; goto __pyx_L1;}
+  __pyx_3 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; goto __pyx_L1;}
+  __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; goto __pyx_L1;}
+  __pyx_5 = PyTuple_New(4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 460; goto __pyx_L1;}
   PyTuple_SET_ITEM(__pyx_5, 0, __pyx_1);
   PyTuple_SET_ITEM(__pyx_5, 1, __pyx_2);
   PyTuple_SET_ITEM(__pyx_5, 2, __pyx_3);
@@ -1550,15 +1531,15 @@
   return __pyx_r;
 }
 
-static PyObject *__pyx_k20p;
 static PyObject *__pyx_k21p;
 static PyObject *__pyx_k22p;
 static PyObject *__pyx_k23p;
+static PyObject *__pyx_k24p;
 
-static char (__pyx_k20[]) = "attempting to set ROI left %d";
-static char (__pyx_k21[]) = "attempting to set ROI bottom %d";
-static char (__pyx_k22[]) = "attempting to set ROI right to %d (width %d)";
-static char (__pyx_k23[]) = "attempting to set ROI top to %d (height %d)";
+static char __pyx_k21[] = "attempting to set ROI left %d";
+static char __pyx_k22[] = "attempting to set ROI bottom %d";
+static char __pyx_k23[] = "attempting to set ROI right to %d (width %d)";
+static char __pyx_k24[] = "attempting to set ROI top to %d (height %d)";
 
 static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_3roi___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_lbrt); /*proto*/
 static int __pyx_f_23realtime_image_analysis_16RealtimeAnalyzer_3roi___set__(PyObject *__pyx_v_self, PyObject *__pyx_v_lbrt) {
@@ -1575,28 +1556,28 @@
   Py_INCREF(__pyx_v_self);
   Py_INCREF(__pyx_v_lbrt);
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":462 */
-  __pyx_1 = PyObject_GetIter(__pyx_v_lbrt); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; goto __pyx_L1;}
-  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; goto __pyx_L1;}
-  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":464 */
+  __pyx_1 = PyObject_GetIter(__pyx_v_lbrt); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; goto __pyx_L1;}
+  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; goto __pyx_L1;}
+  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; goto __pyx_L1;}
   Py_DECREF(__pyx_2); __pyx_2 = 0;
   __pyx_v_l = __pyx_3;
-  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; goto __pyx_L1;}
-  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; goto __pyx_L1;}
+  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; goto __pyx_L1;}
+  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; goto __pyx_L1;}
   Py_DECREF(__pyx_2); __pyx_2 = 0;
   __pyx_v_b = __pyx_3;
-  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; goto __pyx_L1;}
-  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; goto __pyx_L1;}
+  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; goto __pyx_L1;}
+  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; goto __pyx_L1;}
   Py_DECREF(__pyx_2); __pyx_2 = 0;
   __pyx_v_r = __pyx_3;
-  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; goto __pyx_L1;}
-  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; goto __pyx_L1;}
+  __pyx_2 = __Pyx_UnpackItem(__pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; goto __pyx_L1;}
+  __pyx_3 = PyInt_AsLong(__pyx_2); if (PyErr_Occurred()) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; goto __pyx_L1;}
   Py_DECREF(__pyx_2); __pyx_2 = 0;
   __pyx_v_t = __pyx_3;
-  if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 462; goto __pyx_L1;}
+  if (__Pyx_EndUnpack(__pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 464; goto __pyx_L1;}
   Py_DECREF(__pyx_1); __pyx_1 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":463 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":465 */
   __pyx_3 = (__pyx_v_l == ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left);
   if (__pyx_3) {
     __pyx_3 = (__pyx_v_b == ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom);
@@ -1608,213 +1589,203 @@
     }
   }
   if (__pyx_3) {
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":466 */
     __pyx_r = 0;
     goto __pyx_L0;
     goto __pyx_L2;
   }
   __pyx_L2:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":468 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":470 */
   ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left = __pyx_v_l;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":469 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":471 */
   ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom = __pyx_v_b;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":470 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":472 */
   ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right = __pyx_v_r;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":471 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":473 */
   ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top = __pyx_v_t;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":473 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":475 */
   __pyx_3 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left < 0);
   if (__pyx_3) {
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":474 */
-    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; goto __pyx_L1;}
-    __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; goto __pyx_L1;}
-    __pyx_4 = PyNumber_Remainder(__pyx_k20p, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; goto __pyx_L1;}
+    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; goto __pyx_L1;}
+    __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; goto __pyx_L1;}
+    __pyx_4 = PyNumber_Remainder(__pyx_k21p, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; goto __pyx_L1;}
     Py_DECREF(__pyx_1); __pyx_1 = 0;
-    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; goto __pyx_L1;}
+    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; goto __pyx_L1;}
     PyTuple_SET_ITEM(__pyx_1, 0, __pyx_4);
     __pyx_4 = 0;
-    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; goto __pyx_L1;}
+    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; goto __pyx_L1;}
     Py_DECREF(__pyx_2); __pyx_2 = 0;
     Py_DECREF(__pyx_1); __pyx_1 = 0;
     __Pyx_Raise(__pyx_4, 0, 0);
     Py_DECREF(__pyx_4); __pyx_4 = 0;
-    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 474; goto __pyx_L1;}
+    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; goto __pyx_L1;}
     goto __pyx_L3;
   }
   __pyx_L3:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":475 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":477 */
   __pyx_3 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom < 0);
   if (__pyx_3) {
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":476 */
-    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; goto __pyx_L1;}
-    __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; goto __pyx_L1;}
-    __pyx_4 = PyNumber_Remainder(__pyx_k21p, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; goto __pyx_L1;}
+    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; goto __pyx_L1;}
+    __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; goto __pyx_L1;}
+    __pyx_4 = PyNumber_Remainder(__pyx_k22p, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; goto __pyx_L1;}
     Py_DECREF(__pyx_1); __pyx_1 = 0;
-    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; goto __pyx_L1;}
+    __pyx_1 = PyTuple_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; goto __pyx_L1;}
     PyTuple_SET_ITEM(__pyx_1, 0, __pyx_4);
     __pyx_4 = 0;
-    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; goto __pyx_L1;}
+    __pyx_4 = PyObject_CallObject(__pyx_2, __pyx_1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; goto __pyx_L1;}
     Py_DECREF(__pyx_2); __pyx_2 = 0;
     Py_DECREF(__pyx_1); __pyx_1 = 0;
     __Pyx_Raise(__pyx_4, 0, 0);
     Py_DECREF(__pyx_4); __pyx_4 = 0;
-    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 476; goto __pyx_L1;}
+    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; goto __pyx_L1;}
     goto __pyx_L4;
   }
   __pyx_L4:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":477 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":479 */
   __pyx_3 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right >= ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxwidth);
   if (__pyx_3) {
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":478 */
-    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; goto __pyx_L1;}
-    __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; goto __pyx_L1;}
-    __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxwidth); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; goto __pyx_L1;}
-    __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; goto __pyx_L1;}
+    __pyx_2 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
+    __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
+    __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxwidth); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
+    __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
     PyTuple_SET_ITEM(__pyx_5, 0, __pyx_1);
     PyTuple_SET_ITEM(__pyx_5, 1, __pyx_4);
     __pyx_1 = 0;
     __pyx_4 = 0;
-    __pyx_1 = PyNumber_Remainder(__pyx_k22p, __pyx_5); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; goto __pyx_L1;}
+    __pyx_1 = PyNumber_Remainder(__pyx_k23p, __pyx_5); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
     Py_DECREF(__pyx_5); __pyx_5 = 0;
-    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; goto __pyx_L1;}
+    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
     PyTuple_SET_ITEM(__pyx_4, 0, __pyx_1);
     __pyx_1 = 0;
-    __pyx_5 = PyObject_CallObject(__pyx_2, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; goto __pyx_L1;}
+    __pyx_5 = PyObject_CallObject(__pyx_2, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
     Py_DECREF(__pyx_2); __pyx_2 = 0;
     Py_DECREF(__pyx_4); __pyx_4 = 0;
     __Pyx_Raise(__pyx_5, 0, 0);
     Py_DECREF(__pyx_5); __pyx_5 = 0;
-    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; goto __pyx_L1;}
+    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
     goto __pyx_L5;
   }
   __pyx_L5:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":479 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":481 */
   __pyx_3 = (((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top >= ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxheight);
   if (__pyx_3) {
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":480 */
-    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
-    __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
-    __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxheight); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
-    __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
+    __pyx_1 = __Pyx_GetName(__pyx_b, __pyx_n_ValueError); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; goto __pyx_L1;}
+    __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; goto __pyx_L1;}
+    __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->maxheight); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; goto __pyx_L1;}
+    __pyx_5 = PyTuple_New(2); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; goto __pyx_L1;}
     PyTuple_SET_ITEM(__pyx_5, 0, __pyx_2);
     PyTuple_SET_ITEM(__pyx_5, 1, __pyx_4);
     __pyx_2 = 0;
     __pyx_4 = 0;
-    __pyx_2 = PyNumber_Remainder(__pyx_k23p, __pyx_5); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
+    __pyx_2 = PyNumber_Remainder(__pyx_k24p, __pyx_5); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; goto __pyx_L1;}
     Py_DECREF(__pyx_5); __pyx_5 = 0;
-    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
+    __pyx_4 = PyTuple_New(1); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; goto __pyx_L1;}
     PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
     __pyx_2 = 0;
-    __pyx_5 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
+    __pyx_5 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; goto __pyx_L1;}
     Py_DECREF(__pyx_1); __pyx_1 = 0;
     Py_DECREF(__pyx_4); __pyx_4 = 0;
     __Pyx_Raise(__pyx_5, 0, 0);
     Py_DECREF(__pyx_5); __pyx_5 = 0;
-    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 480; goto __pyx_L1;}
+    {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; goto __pyx_L1;}
     goto __pyx_L6;
   }
   __pyx_L6:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":482 */
-  __pyx_2 = PyInt_FromLong(((((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left) + 1)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; goto __pyx_L1;}
-  __pyx_1 = PyInt_FromLong(((((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom) + 1)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; goto __pyx_L1;}
-  __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":484 */
+  __pyx_2 = PyInt_FromLong(((((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_right - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left) + 1)); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; goto __pyx_L1;}
+  __pyx_1 = PyInt_FromLong(((((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_top - ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom) + 1)); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; goto __pyx_L1;}
+  __pyx_4 = PyTuple_New(2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; goto __pyx_L1;}
   PyTuple_SET_ITEM(__pyx_4, 0, __pyx_2);
   PyTuple_SET_ITEM(__pyx_4, 1, __pyx_1);
   __pyx_2 = 0;
   __pyx_1 = 0;
-  __pyx_5 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_Size), __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; goto __pyx_L1;}
+  __pyx_5 = PyObject_CallObject(((PyObject*)__pyx_ptype_6motmot_9FastImage_9FastImage_Size), __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; goto __pyx_L1;}
   Py_DECREF(__pyx_4); __pyx_4 = 0;
-  if (!__Pyx_TypeTest(__pyx_5, __pyx_ptype_6motmot_9FastImage_9FastImage_Size)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 482; goto __pyx_L1;}
+  if (!__Pyx_TypeTest(__pyx_5, __pyx_ptype_6motmot_9FastImage_9FastImage_Size)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; goto __pyx_L1;}
   Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
   ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)__pyx_5);
   __pyx_5 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":484 */
-  __pyx_2 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im), __pyx_n_roi); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; goto __pyx_L1;}
-  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; goto __pyx_L1;}
-  __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; goto __pyx_L1;}
-  __pyx_5 = PyTuple_New(3); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":486 */
+  __pyx_2 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im), __pyx_n_roi); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; goto __pyx_L1;}
+  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; goto __pyx_L1;}
+  __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; goto __pyx_L1;}
+  __pyx_5 = PyTuple_New(3); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; goto __pyx_L1;}
   PyTuple_SET_ITEM(__pyx_5, 0, __pyx_1);
   PyTuple_SET_ITEM(__pyx_5, 1, __pyx_4);
   Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
   PyTuple_SET_ITEM(__pyx_5, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
   __pyx_1 = 0;
   __pyx_4 = 0;
-  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_5); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; goto __pyx_L1;}
+  __pyx_1 = PyObject_CallObject(__pyx_2, __pyx_5); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; goto __pyx_L1;}
   Py_DECREF(__pyx_2); __pyx_2 = 0;
   Py_DECREF(__pyx_5); __pyx_5 = 0;
-  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 484; goto __pyx_L1;}
+  if (!__Pyx_TypeTest(__pyx_1, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; goto __pyx_L1;}
   Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view));
   ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->absdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_1);
   __pyx_1 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":485 */
-  __pyx_4 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im), __pyx_n_roi); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; goto __pyx_L1;}
-  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; goto __pyx_L1;}
-  __pyx_5 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; goto __pyx_L1;}
-  __pyx_1 = PyTuple_New(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":487 */
+  __pyx_4 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im), __pyx_n_roi); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
+  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
+  __pyx_5 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
+  __pyx_1 = PyTuple_New(3); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
   PyTuple_SET_ITEM(__pyx_1, 0, __pyx_2);
   PyTuple_SET_ITEM(__pyx_1, 1, __pyx_5);
   Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
   PyTuple_SET_ITEM(__pyx_1, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
   __pyx_2 = 0;
   __pyx_5 = 0;
-  __pyx_2 = PyObject_CallObject(__pyx_4, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; goto __pyx_L1;}
+  __pyx_2 = PyObject_CallObject(__pyx_4, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
   Py_DECREF(__pyx_4); __pyx_4 = 0;
   Py_DECREF(__pyx_1); __pyx_1 = 0;
-  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 485; goto __pyx_L1;}
+  if (!__Pyx_TypeTest(__pyx_2, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
   Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view));
   ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->mean_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_2);
   __pyx_2 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":486 */
-  __pyx_5 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im), __pyx_n_roi); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; goto __pyx_L1;}
-  __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; goto __pyx_L1;}
-  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; goto __pyx_L1;}
-  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":488 */
+  __pyx_5 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im), __pyx_n_roi); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; goto __pyx_L1;}
+  __pyx_4 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; goto __pyx_L1;}
+  __pyx_1 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; goto __pyx_L1;}
+  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; goto __pyx_L1;}
   PyTuple_SET_ITEM(__pyx_2, 0, __pyx_4);
   PyTuple_SET_ITEM(__pyx_2, 1, __pyx_1);
   Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
   PyTuple_SET_ITEM(__pyx_2, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
   __pyx_4 = 0;
   __pyx_1 = 0;
-  __pyx_4 = PyObject_CallObject(__pyx_5, __pyx_2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; goto __pyx_L1;}
+  __pyx_4 = PyObject_CallObject(__pyx_5, __pyx_2); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; goto __pyx_L1;}
   Py_DECREF(__pyx_5); __pyx_5 = 0;
   Py_DECREF(__pyx_2); __pyx_2 = 0;
-  if (!__Pyx_TypeTest(__pyx_4, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 486; goto __pyx_L1;}
+  if (!__Pyx_TypeTest(__pyx_4, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; goto __pyx_L1;}
   Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view));
   ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmp_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_4);
   __pyx_4 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":487 */
-  __pyx_1 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im), __pyx_n_roi); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
-  __pyx_5 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
-  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
-  __pyx_4 = PyTuple_New(3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":489 */
+  __pyx_1 = PyObject_GetAttr(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im), __pyx_n_roi); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
+  __pyx_5 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_left); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
+  __pyx_2 = PyInt_FromLong(((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_bottom); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
+  __pyx_4 = PyTuple_New(3); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
   PyTuple_SET_ITEM(__pyx_4, 0, __pyx_5);
   PyTuple_SET_ITEM(__pyx_4, 1, __pyx_2);
   Py_INCREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
   PyTuple_SET_ITEM(__pyx_4, 2, ((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->_roi_sz));
   __pyx_5 = 0;
   __pyx_2 = 0;
-  __pyx_5 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
+  __pyx_5 = PyObject_CallObject(__pyx_1, __pyx_4); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
   Py_DECREF(__pyx_1); __pyx_1 = 0;
   Py_DECREF(__pyx_4); __pyx_4 = 0;
-  if (!__Pyx_TypeTest(__pyx_5, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; goto __pyx_L1;}
+  if (!__Pyx_TypeTest(__pyx_5, __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
   Py_DECREF(((PyObject *)((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view));
   ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)__pyx_v_self)->cmpdiff_im_roi_view = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)__pyx_5);
   __pyx_5 = 0;
@@ -1876,142 +1847,142 @@
   Py_INCREF((PyObject *)__pyx_v_noisy_pixels_mask);
   Py_INCREF((PyObject *)__pyx_v_compareframe8u);
   Py_INCREF(__pyx_v_max_frame_size);
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_mean_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "fastframef32_tmp")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 490; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_sumsqf), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_sumsqf")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_mean2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "mean2")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_stdframe), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_stdframe")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean8u_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "running_mean8u_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_hw_roi_frame), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "hw_roi_frame")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_noisy_pixels_mask), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "noisy_pixels_mask")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_compareframe8u), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "compareframe8u")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_max_frame_size), __pyx_ptype_6motmot_9FastImage_9FastImage_Size, 1, "max_frame_size")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_mean_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "fastframef32_tmp")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 492; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_sumsqf), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_sumsqf")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_mean2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "mean2")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 494; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_stdframe), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_stdframe")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 495; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean8u_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "running_mean8u_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 496; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_hw_roi_frame), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "hw_roi_frame")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 497; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_noisy_pixels_mask), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "noisy_pixels_mask")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 498; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_compareframe8u), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "compareframe8u")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_max_frame_size), __pyx_ptype_6motmot_9FastImage_9FastImage_Size, 1, "max_frame_size")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; goto __pyx_L1;}
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":502 */
-  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean_im), __pyx_n_toself_add_weighted); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 502; goto __pyx_L1;}
-  __pyx_2 = PyFloat_FromDouble(__pyx_v_ALPHA); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 502; goto __pyx_L1;}
-  __pyx_3 = PyTuple_New(3); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 502; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":504 */
+  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean_im), __pyx_n_toself_add_weighted); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; goto __pyx_L1;}
+  __pyx_2 = PyFloat_FromDouble(__pyx_v_ALPHA); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; goto __pyx_L1;}
+  __pyx_3 = PyTuple_New(3); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; goto __pyx_L1;}
   Py_INCREF(((PyObject *)__pyx_v_hw_roi_frame));
   PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_hw_roi_frame));
   Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
   PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
   PyTuple_SET_ITEM(__pyx_3, 2, __pyx_2);
   __pyx_2 = 0;
-  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 502; goto __pyx_L1;}
+  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; goto __pyx_L1;}
   Py_DECREF(__pyx_1); __pyx_1 = 0;
   Py_DECREF(__pyx_3); __pyx_3 = 0;
   Py_DECREF(__pyx_2); __pyx_2 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":504 */
-  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean_im), __pyx_n_get_8u_copy_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; goto __pyx_L1;}
-  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":506 */
+  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean_im), __pyx_n_get_8u_copy_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; goto __pyx_L1;}
+  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; goto __pyx_L1;}
   Py_INCREF(((PyObject *)__pyx_v_running_mean8u_im));
   PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_running_mean8u_im));
   Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
   PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
-  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 504; goto __pyx_L1;}
+  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 506; goto __pyx_L1;}
   Py_DECREF(__pyx_1); __pyx_1 = 0;
   Py_DECREF(__pyx_3); __pyx_3 = 0;
   Py_DECREF(__pyx_2); __pyx_2 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":507 */
-  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_hw_roi_frame), __pyx_n_get_32f_copy_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 507; goto __pyx_L1;}
-  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 507; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":509 */
+  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_hw_roi_frame), __pyx_n_get_32f_copy_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; goto __pyx_L1;}
+  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; goto __pyx_L1;}
   Py_INCREF(((PyObject *)__pyx_v_fastframef32_tmp));
   PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_fastframef32_tmp));
   Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
   PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
-  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 507; goto __pyx_L1;}
+  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; goto __pyx_L1;}
   Py_DECREF(__pyx_1); __pyx_1 = 0;
   Py_DECREF(__pyx_3); __pyx_3 = 0;
   Py_DECREF(__pyx_2); __pyx_2 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":508 */
-  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_n_toself_square); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 508; goto __pyx_L1;}
-  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 508; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":510 */
+  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_n_toself_square); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 510; goto __pyx_L1;}
+  __pyx_3 = PyTuple_New(1); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 510; goto __pyx_L1;}
   Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
   PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_max_frame_size));
-  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 508; goto __pyx_L1;}
+  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 510; goto __pyx_L1;}
   Py_DECREF(__pyx_1); __pyx_1 = 0;
   Py_DECREF(__pyx_3); __pyx_3 = 0;
   Py_DECREF(__pyx_2); __pyx_2 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":509 */
-  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_sumsqf), __pyx_n_toself_add_weighted); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; goto __pyx_L1;}
-  __pyx_3 = PyFloat_FromDouble(__pyx_v_ALPHA); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; goto __pyx_L1;}
-  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":511 */
+  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_sumsqf), __pyx_n_toself_add_weighted); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; goto __pyx_L1;}
+  __pyx_3 = PyFloat_FromDouble(__pyx_v_ALPHA); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; goto __pyx_L1;}
+  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; goto __pyx_L1;}
   Py_INCREF(((PyObject *)__pyx_v_fastframef32_tmp));
   PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_fastframef32_tmp));
   Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
   PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_max_frame_size));
   PyTuple_SET_ITEM(__pyx_2, 2, __pyx_3);
   __pyx_3 = 0;
-  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 509; goto __pyx_L1;}
+  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; goto __pyx_L1;}
   Py_DECREF(__pyx_1); __pyx_1 = 0;
   Py_DECREF(__pyx_2); __pyx_2 = 0;
   Py_DECREF(__pyx_3); __pyx_3 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":510 */
-  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean_im), __pyx_n_get_square_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 510; goto __pyx_L1;}
-  __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 510; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":512 */
+  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean_im), __pyx_n_get_square_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 512; goto __pyx_L1;}
+  __pyx_2 = PyTuple_New(2); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 512; goto __pyx_L1;}
   Py_INCREF(((PyObject *)__pyx_v_mean2));
   PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_mean2));
   Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
   PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_max_frame_size));
-  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 510; goto __pyx_L1;}
+  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 512; goto __pyx_L1;}
   Py_DECREF(__pyx_1); __pyx_1 = 0;
   Py_DECREF(__pyx_2); __pyx_2 = 0;
   Py_DECREF(__pyx_3); __pyx_3 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":511 */
-  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_sumsqf), __pyx_n_get_subtracted_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; goto __pyx_L1;}
-  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":513 */
+  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_sumsqf), __pyx_n_get_subtracted_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; goto __pyx_L1;}
+  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; goto __pyx_L1;}
   Py_INCREF(((PyObject *)__pyx_v_mean2));
   PyTuple_SET_ITEM(__pyx_2, 0, ((PyObject *)__pyx_v_mean2));
   Py_INCREF(((PyObject *)__pyx_v_running_stdframe));
   PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_running_stdframe));
   Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
   PyTuple_SET_ITEM(__pyx_2, 2, ((PyObject *)__pyx_v_max_frame_size));
-  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; goto __pyx_L1;}
+  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; goto __pyx_L1;}
   Py_DECREF(__pyx_1); __pyx_1 = 0;
   Py_DECREF(__pyx_2); __pyx_2 = 0;
   Py_DECREF(__pyx_3); __pyx_3 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":514 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":516 */
   __pyx_v_C = 6.0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":515 */
-  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_stdframe), __pyx_n_toself_multiply); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; goto __pyx_L1;}
-  __pyx_2 = PyFloat_FromDouble(__pyx_v_C); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; goto __pyx_L1;}
-  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":517 */
+  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_stdframe), __pyx_n_toself_multiply); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; goto __pyx_L1;}
+  __pyx_2 = PyFloat_FromDouble(__pyx_v_C); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; goto __pyx_L1;}
+  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; goto __pyx_L1;}
   PyTuple_SET_ITEM(__pyx_3, 0, __pyx_2);
   Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
   PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
   __pyx_2 = 0;
-  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 515; goto __pyx_L1;}
+  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 517; goto __pyx_L1;}
   Py_DECREF(__pyx_1); __pyx_1 = 0;
   Py_DECREF(__pyx_3); __pyx_3 = 0;
   Py_DECREF(__pyx_2); __pyx_2 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":516 */
-  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_stdframe), __pyx_n_get_8u_copy_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; goto __pyx_L1;}
-  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":518 */
+  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_stdframe), __pyx_n_get_8u_copy_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; goto __pyx_L1;}
+  __pyx_3 = PyTuple_New(2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; goto __pyx_L1;}
   Py_INCREF(((PyObject *)__pyx_v_compareframe8u));
   PyTuple_SET_ITEM(__pyx_3, 0, ((PyObject *)__pyx_v_compareframe8u));
   Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
   PyTuple_SET_ITEM(__pyx_3, 1, ((PyObject *)__pyx_v_max_frame_size));
-  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; goto __pyx_L1;}
+  __pyx_2 = PyObject_CallObject(__pyx_1, __pyx_3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 518; goto __pyx_L1;}
   Py_DECREF(__pyx_1); __pyx_1 = 0;
   Py_DECREF(__pyx_3); __pyx_3 = 0;
   Py_DECREF(__pyx_2); __pyx_2 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":519 */
-  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean8u_im), __pyx_n_get_compare_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; goto __pyx_L1;}
-  __pyx_3 = PyInt_FromLong(200); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; goto __pyx_L1;}
-  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_FastImage); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; goto __pyx_L1;}
-  __pyx_4 = PyObject_GetAttr(__pyx_2, __pyx_n_CmpGreater); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":521 */
+  __pyx_1 = PyObject_GetAttr(((PyObject *)__pyx_v_running_mean8u_im), __pyx_n_get_compare_put); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; goto __pyx_L1;}
+  __pyx_3 = PyInt_FromLong(200); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; goto __pyx_L1;}
+  __pyx_2 = __Pyx_GetName(__pyx_m, __pyx_n_FastImage); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; goto __pyx_L1;}
+  __pyx_4 = PyObject_GetAttr(__pyx_2, __pyx_n_CmpGreater); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; goto __pyx_L1;}
   Py_DECREF(__pyx_2); __pyx_2 = 0;
-  __pyx_2 = PyTuple_New(4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; goto __pyx_L1;}
+  __pyx_2 = PyTuple_New(4); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; goto __pyx_L1;}
   PyTuple_SET_ITEM(__pyx_2, 0, __pyx_3);
   Py_INCREF(((PyObject *)__pyx_v_noisy_pixels_mask));
   PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_noisy_pixels_mask));
@@ -2020,22 +1991,22 @@
   PyTuple_SET_ITEM(__pyx_2, 3, __pyx_4);
   __pyx_3 = 0;
   __pyx_4 = 0;
-  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; goto __pyx_L1;}
+  __pyx_3 = PyObject_CallObject(__pyx_1, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 521; goto __pyx_L1;}
   Py_DECREF(__pyx_1); __pyx_1 = 0;
   Py_DECREF(__pyx_2); __pyx_2 = 0;
   Py_DECREF(__pyx_3); __pyx_3 = 0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":520 */
-  __pyx_4 = PyObject_GetAttr(((PyObject *)__pyx_v_compareframe8u), __pyx_n_set_val_masked); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; goto __pyx_L1;}
-  __pyx_1 = PyInt_FromLong(25); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; goto __pyx_L1;}
-  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; goto __pyx_L1;}
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":522 */
+  __pyx_4 = PyObject_GetAttr(((PyObject *)__pyx_v_compareframe8u), __pyx_n_set_val_masked); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; goto __pyx_L1;}
+  __pyx_1 = PyInt_FromLong(25); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; goto __pyx_L1;}
+  __pyx_2 = PyTuple_New(3); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; goto __pyx_L1;}
   PyTuple_SET_ITEM(__pyx_2, 0, __pyx_1);
   Py_INCREF(((PyObject *)__pyx_v_noisy_pixels_mask));
   PyTuple_SET_ITEM(__pyx_2, 1, ((PyObject *)__pyx_v_noisy_pixels_mask));
   Py_INCREF(((PyObject *)__pyx_v_max_frame_size));
   PyTuple_SET_ITEM(__pyx_2, 2, ((PyObject *)__pyx_v_max_frame_size));
   __pyx_1 = 0;
-  __pyx_3 = PyObject_CallObject(__pyx_4, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; goto __pyx_L1;}
+  __pyx_3 = PyObject_CallObject(__pyx_4, __pyx_2); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 522; goto __pyx_L1;}
   Py_DECREF(__pyx_4); __pyx_4 = 0;
   Py_DECREF(__pyx_2); __pyx_2 = 0;
   Py_DECREF(__pyx_3); __pyx_3 = 0;
@@ -2090,56 +2061,59 @@
   Py_INCREF((PyObject *)__pyx_v_noisy_pixels_mask);
   Py_INCREF((PyObject *)__pyx_v_compareframe8u);
   Py_INCREF(__pyx_v_max_frame_size);
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_mean_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "fastframef32_tmp")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_sumsqf), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_sumsqf")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_mean2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "mean2")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_stdframe), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_stdframe")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean8u_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "running_mean8u_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_hw_roi_frame), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "hw_roi_frame")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_noisy_pixels_mask), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "noisy_pixels_mask")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 530; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_compareframe8u), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "compareframe8u")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_max_frame_size), __pyx_ptype_6motmot_9FastImage_9FastImage_Size, 1, "max_frame_size")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 532; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_mean_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "fastframef32_tmp")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 526; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_sumsqf), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_sumsqf")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_mean2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "mean2")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_stdframe), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_stdframe")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean8u_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "running_mean8u_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 530; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_hw_roi_frame), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "hw_roi_frame")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_noisy_pixels_mask), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "noisy_pixels_mask")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 532; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_compareframe8u), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "compareframe8u")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 533; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_max_frame_size), __pyx_ptype_6motmot_9FastImage_9FastImage_Size, 1, "max_frame_size")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 534; goto __pyx_L1;}
+  /*with nogil:*/ {
+    PyThreadState *_save;
+    Py_UNBLOCK_THREADS
+    /*try:*/ {
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":536 */
-  Py_BEGIN_ALLOW_THREADS;
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":542 */
+      CHK_NOGIL(ippiAddWeighted_8u32f_C1IR(((Ipp8u *)__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f *)__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":539 */
-  CHK_NOGIL(ippiAddWeighted_8u32f_C1IR(((Ipp8u (*))__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f (*))__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":548 */
+      CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f *)__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp8u *)__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":545 */
-  CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f (*))__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp8u (*))__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":555 */
+      CHK_NOGIL(ippiConvert_8u32f_C1R(((Ipp8u *)__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f *)__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":552 */
-  CHK_NOGIL(ippiConvert_8u32f_C1R(((Ipp8u (*))__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f (*))__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":560 */
+      CHK_NOGIL(ippiSqr_32f_C1IR(((Ipp32f *)__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":557 */
-  CHK_NOGIL(ippiSqr_32f_C1IR(((Ipp32f (*))__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":564 */
+      CHK_NOGIL(ippiAddWeighted_32f_C1IR(((Ipp32f *)__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,((Ipp32f *)__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":561 */
-  CHK_NOGIL(ippiAddWeighted_32f_C1IR(((Ipp32f (*))__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,((Ipp32f (*))__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":568 */
+      CHK_NOGIL(ippiSqr_32f_C1R(((Ipp32f *)__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp32f *)__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,__pyx_v_max_frame_size->sz));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":565 */
-  CHK_NOGIL(ippiSqr_32f_C1R(((Ipp32f (*))__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp32f (*))__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,__pyx_v_max_frame_size->sz));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":572 */
+      CHK_NOGIL(ippiSub_32f_C1R(((Ipp32f *)__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,((Ipp32f *)__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,((Ipp32f *)__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":569 */
-  CHK_NOGIL(ippiSub_32f_C1R(((Ipp32f (*))__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,((Ipp32f (*))__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,((Ipp32f (*))__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":579 */
+      CHK_NOGIL(ippiMulC_32f_C1IR(__pyx_v_C,((Ipp32f *)__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":576 */
-  CHK_NOGIL(ippiMulC_32f_C1IR(__pyx_v_C,((Ipp32f (*))__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":582 */
+      CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f *)__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,((Ipp8u *)__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":579 */
-  CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f (*))__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,((Ipp8u (*))__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":589 */
+      CHK_NOGIL(ippiCompareC_8u_C1R(((Ipp8u *)__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,200,((Ipp8u *)__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step,__pyx_v_max_frame_size->sz,ippCmpGreater));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":586 */
-  CHK_NOGIL(ippiCompareC_8u_C1R(((Ipp8u (*))__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,200,((Ipp8u (*))__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step,__pyx_v_max_frame_size->sz,ippCmpGreater));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":596 */
+      CHK_NOGIL(ippiSet_8u_C1MR(25,((Ipp8u *)__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,((Ipp8u *)__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step));
+    }
+    /*finally:*/ {
+      Py_BLOCK_THREADS
+    }
+  }
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":593 */
-  CHK_NOGIL(ippiSet_8u_C1MR(25,((Ipp8u (*))__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,((Ipp8u (*))__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step));
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":595 */
-  Py_END_ALLOW_THREADS;
-
   __pyx_r = Py_None; Py_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1:;
@@ -2207,7 +2181,7 @@
   PyObject *__pyx_12 = 0;
   PyObject *__pyx_13 = 0;
   static char *__pyx_argnames[] = {"running_mean_im","hw_roi_frame","max_frame_size","ALPHA","running_mean8u_im","fastframef32_tmp","running_sumsqf","mean2","std2","running_stdframe","n_sigma","compareframe8u","bright_non_gaussian_cutoff","noisy_pixels_mask","bright_non_gaussian_replacement","bench",0};
-  __pyx_v_bench = __pyx_k9;
+  __pyx_v_bench = __pyx_k10;
   if (!PyArg_ParseTupleAndKeywords(__pyx_args, __pyx_kwds, "OOOfOOOOOOfOiOi|i", __pyx_argnames, &__pyx_v_running_mean_im, &__pyx_v_hw_roi_frame, &__pyx_v_max_frame_size, &__pyx_v_ALPHA, &__pyx_v_running_mean8u_im, &__pyx_v_fastframef32_tmp, &__pyx_v_running_sumsqf, &__pyx_v_mean2, &__pyx_v_std2, &__pyx_v_running_stdframe, &__pyx_v_n_sigma, &__pyx_v_compareframe8u, &__pyx_v_bright_non_gaussian_cutoff, &__pyx_v_noisy_pixels_mask, &__pyx_v_bright_non_gaussian_replacement, &__pyx_v_bench)) return 0;
   Py_INCREF((PyObject *)__pyx_v_running_mean_im);
   Py_INCREF((PyObject *)__pyx_v_hw_roi_frame);
@@ -2221,203 +2195,182 @@
   Py_INCREF((PyObject *)__pyx_v_compareframe8u);
   Py_INCREF((PyObject *)__pyx_v_noisy_pixels_mask);
   __pyx_v_res = Py_None; Py_INCREF(Py_None);
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_mean_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 597; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_hw_roi_frame), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "hw_roi_frame")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 598; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_max_frame_size), __pyx_ptype_6motmot_9FastImage_9FastImage_Size, 1, "max_frame_size")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 599; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean8u_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "running_mean8u_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "fastframef32_tmp")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_sumsqf), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_sumsqf")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 603; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_mean2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "mean2")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 604; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_std2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "std2")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_stdframe), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_stdframe")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_compareframe8u), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "compareframe8u")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; goto __pyx_L1;}
-  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_noisy_pixels_mask), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "noisy_pixels_mask")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 610; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_mean_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 600; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_hw_roi_frame), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "hw_roi_frame")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 601; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_max_frame_size), __pyx_ptype_6motmot_9FastImage_9FastImage_Size, 1, "max_frame_size")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 602; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_mean8u_im), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "running_mean8u_im")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 604; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fastframef32_tmp), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "fastframef32_tmp")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 605; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_sumsqf), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_sumsqf")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 606; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_mean2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "mean2")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 607; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_std2), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "std2")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 608; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_running_stdframe), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage32f, 1, "running_stdframe")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 609; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_compareframe8u), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "compareframe8u")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 611; goto __pyx_L1;}
+  if (!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_noisy_pixels_mask), __pyx_ptype_6motmot_9FastImage_9FastImage_FastImage8u, 1, "noisy_pixels_mask")) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 613; goto __pyx_L1;}
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":641 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":644 */
   __pyx_v_BENCHMARK = __pyx_v_bench;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":644 */
-  Py_BEGIN_ALLOW_THREADS;
-
   /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":648 */
-  CHK_NOGIL(ippiAddWeighted_8u32f_C1IR(((Ipp8u (*))__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f (*))__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));
+  /*with nogil:*/ {
+    PyThreadState *_save;
+    Py_UNBLOCK_THREADS
+    /*try:*/ {
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":651 */
-  __pyx_1 = __pyx_v_BENCHMARK;
-  if (__pyx_1) {
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":652 */
+      CHK_NOGIL(ippiAddWeighted_8u32f_C1IR(((Ipp8u *)__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f *)__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":652 */
-    __pyx_v_t41 = time_time();
-    goto __pyx_L2;
-  }
-  __pyx_L2:;
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":655 */
+      __pyx_1 = __pyx_v_BENCHMARK;
+      if (__pyx_1) {
+        __pyx_v_t41 = time_time();
+        goto __pyx_L5;
+      }
+      __pyx_L5:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":654 */
-  CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f (*))__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp8u (*))__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":658 */
+      CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f *)__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp8u *)__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":659 */
-  __pyx_1 = __pyx_v_BENCHMARK;
-  if (__pyx_1) {
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":663 */
+      __pyx_1 = __pyx_v_BENCHMARK;
+      if (__pyx_1) {
+        __pyx_v_t42 = time_time();
+        goto __pyx_L6;
+      }
+      __pyx_L6:;
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":660 */
-    __pyx_v_t42 = time_time();
-    goto __pyx_L3;
-  }
-  __pyx_L3:;
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":667 */
+      CHK_NOGIL(ippiConvert_8u32f_C1R(((Ipp8u *)__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f *)__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":663 */
-  CHK_NOGIL(ippiConvert_8u32f_C1R(((Ipp8u (*))__pyx_v_hw_roi_frame->__pyx_base.im),__pyx_v_hw_roi_frame->__pyx_base.step,((Ipp32f (*))__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":670 */
+      __pyx_1 = __pyx_v_BENCHMARK;
+      if (__pyx_1) {
+        __pyx_v_t43 = time_time();
+        goto __pyx_L7;
+      }
+      __pyx_L7:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":666 */
-  __pyx_1 = __pyx_v_BENCHMARK;
-  if (__pyx_1) {
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":674 */
+      CHK_NOGIL(ippiSqr_32f_C1IR(((Ipp32f *)__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":667 */
-    __pyx_v_t43 = time_time();
-    goto __pyx_L4;
-  }
-  __pyx_L4:;
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":676 */
+      __pyx_1 = __pyx_v_BENCHMARK;
+      if (__pyx_1) {
+        __pyx_v_t44 = time_time();
+        goto __pyx_L8;
+      }
+      __pyx_L8:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":670 */
-  CHK_NOGIL(ippiSqr_32f_C1IR(((Ipp32f (*))__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,__pyx_v_max_frame_size->sz));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":680 */
+      CHK_NOGIL(ippiAddWeighted_32f_C1IR(((Ipp32f *)__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,((Ipp32f *)__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":672 */
-  __pyx_1 = __pyx_v_BENCHMARK;
-  if (__pyx_1) {
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":683 */
+      __pyx_1 = __pyx_v_BENCHMARK;
+      if (__pyx_1) {
+        __pyx_v_t45 = time_time();
+        goto __pyx_L9;
+      }
+      __pyx_L9:;
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":673 */
-    __pyx_v_t44 = time_time();
-    goto __pyx_L5;
-  }
-  __pyx_L5:;
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":688 */
+      CHK_NOGIL(ippiSqr_32f_C1R(((Ipp32f *)__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp32f *)__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,__pyx_v_max_frame_size->sz));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":676 */
-  CHK_NOGIL(ippiAddWeighted_32f_C1IR(((Ipp32f (*))__pyx_v_fastframef32_tmp->__pyx_base.im),__pyx_v_fastframef32_tmp->__pyx_base.step,((Ipp32f (*))__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,__pyx_v_max_frame_size->sz,__pyx_v_ALPHA));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":691 */
+      __pyx_1 = __pyx_v_BENCHMARK;
+      if (__pyx_1) {
+        __pyx_v_t46 = time_time();
+        goto __pyx_L10;
+      }
+      __pyx_L10:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":679 */
-  __pyx_1 = __pyx_v_BENCHMARK;
-  if (__pyx_1) {
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":695 */
+      CHK_NOGIL(ippiSub_32f_C1R(((Ipp32f *)__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,((Ipp32f *)__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,((Ipp32f *)__pyx_v_std2->__pyx_base.im),__pyx_v_std2->__pyx_base.step,__pyx_v_max_frame_size->sz));
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":680 */
-    __pyx_v_t45 = time_time();
-    goto __pyx_L6;
-  }
-  __pyx_L6:;
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":703 */
+      CHK_NOGIL(ippiAbs_32f_C1R(((Ipp32f *)__pyx_v_std2->__pyx_base.im),__pyx_v_std2->__pyx_base.step,((Ipp32f *)__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":684 */
-  CHK_NOGIL(ippiSqr_32f_C1R(((Ipp32f (*))__pyx_v_running_mean_im->__pyx_base.im),__pyx_v_running_mean_im->__pyx_base.step,((Ipp32f (*))__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,__pyx_v_max_frame_size->sz));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":707 */
+      __pyx_v_errval = ippiSqrt_32f_C1IR(((Ipp32f *)__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz);
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":687 */
-  __pyx_1 = __pyx_v_BENCHMARK;
-  if (__pyx_1) {
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":710 */
+      CHK_NOGIL(__pyx_v_errval);
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":688 */
-    __pyx_v_t46 = time_time();
-    goto __pyx_L7;
-  }
-  __pyx_L7:;
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":712 */
+      __pyx_1 = __pyx_v_BENCHMARK;
+      if (__pyx_1) {
+        __pyx_v_t47 = time_time();
+        goto __pyx_L11;
+      }
+      __pyx_L11:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":691 */
-  CHK_NOGIL(ippiSub_32f_C1R(((Ipp32f (*))__pyx_v_mean2->__pyx_base.im),__pyx_v_mean2->__pyx_base.step,((Ipp32f (*))__pyx_v_running_sumsqf->__pyx_base.im),__pyx_v_running_sumsqf->__pyx_base.step,((Ipp32f (*))__pyx_v_std2->__pyx_base.im),__pyx_v_std2->__pyx_base.step,__pyx_v_max_frame_size->sz));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":716 */
+      __pyx_1 = (__pyx_v_n_sigma != 1.0);
+      if (__pyx_1) {
+        CHK_NOGIL(ippiMulC_32f_C1IR(__pyx_v_n_sigma,((Ipp32f *)__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));
+        goto __pyx_L12;
+      }
+      __pyx_L12:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":699 */
-  CHK_NOGIL(ippiAbs_32f_C1R(((Ipp32f (*))__pyx_v_std2->__pyx_base.im),__pyx_v_std2->__pyx_base.step,((Ipp32f (*))__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":719 */
+      __pyx_1 = __pyx_v_BENCHMARK;
+      if (__pyx_1) {
+        __pyx_v_t48 = time_time();
+        goto __pyx_L13;
+      }
+      __pyx_L13:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":703 */
-  __pyx_v_errval = ippiSqrt_32f_C1IR(((Ipp32f (*))__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz);
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":722 */
+      CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f *)__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,((Ipp8u *)__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":706 */
-  CHK_NOGIL(__pyx_v_errval);
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":727 */
+      __pyx_1 = __pyx_v_BENCHMARK;
+      if (__pyx_1) {
+        __pyx_v_t49 = time_time();
+        goto __pyx_L14;
+      }
+      __pyx_L14:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":708 */
-  __pyx_1 = __pyx_v_BENCHMARK;
-  if (__pyx_1) {
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":731 */
+      CHK_NOGIL(ippiCompareC_8u_C1R(((Ipp8u *)__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,__pyx_v_bright_non_gaussian_cutoff,((Ipp8u *)__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step,__pyx_v_max_frame_size->sz,ippCmpGreater));
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":709 */
-    __pyx_v_t47 = time_time();
-    goto __pyx_L8;
-  }
-  __pyx_L8:;
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":736 */
+      __pyx_1 = __pyx_v_BENCHMARK;
+      if (__pyx_1) {
+        __pyx_v_t491 = time_time();
+        goto __pyx_L15;
+      }
+      __pyx_L15:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":712 */
-  __pyx_1 = (__pyx_v_n_sigma != 1.0);
-  if (__pyx_1) {
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":739 */
+      CHK_NOGIL(ippiSet_8u_C1MR(__pyx_v_bright_non_gaussian_replacement,((Ipp8u *)__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,((Ipp8u *)__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step));
 
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":713 */
-    CHK_NOGIL(ippiMulC_32f_C1IR(__pyx_v_n_sigma,((Ipp32f (*))__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,__pyx_v_max_frame_size->sz));
-    goto __pyx_L9;
+      /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":742 */
+      __pyx_1 = __pyx_v_BENCHMARK;
+      if (__pyx_1) {
+        __pyx_v_t492 = time_time();
+        goto __pyx_L16;
+      }
+      __pyx_L16:;
+    }
+    /*finally:*/ {
+      Py_BLOCK_THREADS
+    }
   }
-  __pyx_L9:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":715 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":747 */
   __pyx_1 = __pyx_v_BENCHMARK;
   if (__pyx_1) {
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":716 */
-    __pyx_v_t48 = time_time();
-    goto __pyx_L10;
-  }
-  __pyx_L10:;
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":718 */
-  CHK_NOGIL(ippiConvert_32f8u_C1R(((Ipp32f (*))__pyx_v_running_stdframe->__pyx_base.im),__pyx_v_running_stdframe->__pyx_base.step,((Ipp8u (*))__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,ippRndNear));
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":723 */
-  __pyx_1 = __pyx_v_BENCHMARK;
-  if (__pyx_1) {
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":724 */
-    __pyx_v_t49 = time_time();
-    goto __pyx_L11;
-  }
-  __pyx_L11:;
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":727 */
-  CHK_NOGIL(ippiCompareC_8u_C1R(((Ipp8u (*))__pyx_v_running_mean8u_im->__pyx_base.im),__pyx_v_running_mean8u_im->__pyx_base.step,__pyx_v_bright_non_gaussian_cutoff,((Ipp8u (*))__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step,__pyx_v_max_frame_size->sz,ippCmpGreater));
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":732 */
-  __pyx_1 = __pyx_v_BENCHMARK;
-  if (__pyx_1) {
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":733 */
-    __pyx_v_t491 = time_time();
-    goto __pyx_L12;
-  }
-  __pyx_L12:;
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":735 */
-  CHK_NOGIL(ippiSet_8u_C1MR(__pyx_v_bright_non_gaussian_replacement,((Ipp8u (*))__pyx_v_compareframe8u->__pyx_base.im),__pyx_v_compareframe8u->__pyx_base.step,__pyx_v_max_frame_size->sz,((Ipp8u (*))__pyx_v_noisy_pixels_mask->__pyx_base.im),__pyx_v_noisy_pixels_mask->__pyx_base.step));
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":738 */
-  __pyx_1 = __pyx_v_BENCHMARK;
-  if (__pyx_1) {
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":739 */
-    __pyx_v_t492 = time_time();
-    goto __pyx_L13;
-  }
-  __pyx_L13:;
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":741 */
-  Py_END_ALLOW_THREADS;
-
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":743 */
-  __pyx_1 = __pyx_v_BENCHMARK;
-  if (__pyx_1) {
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":744 */
-    __pyx_2 = PyFloat_FromDouble(__pyx_v_t41); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; goto __pyx_L1;}
-    __pyx_3 = PyFloat_FromDouble(__pyx_v_t42); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; goto __pyx_L1;}
-    __pyx_4 = PyFloat_FromDouble(__pyx_v_t43); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; goto __pyx_L1;}
-    __pyx_5 = PyFloat_FromDouble(__pyx_v_t44); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; goto __pyx_L1;}
-    __pyx_6 = PyFloat_FromDouble(__pyx_v_t45); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; goto __pyx_L1;}
-    __pyx_7 = PyFloat_FromDouble(__pyx_v_t46); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; goto __pyx_L1;}
-    __pyx_8 = PyFloat_FromDouble(__pyx_v_t47); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; goto __pyx_L1;}
-    __pyx_9 = PyFloat_FromDouble(__pyx_v_t48); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; goto __pyx_L1;}
-    __pyx_10 = PyFloat_FromDouble(__pyx_v_t49); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; goto __pyx_L1;}
-    __pyx_11 = PyFloat_FromDouble(__pyx_v_t491); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; goto __pyx_L1;}
-    __pyx_12 = PyFloat_FromDouble(__pyx_v_t492); if (!__pyx_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; goto __pyx_L1;}
-    __pyx_13 = PyTuple_New(11); if (!__pyx_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; goto __pyx_L1;}
+    __pyx_2 = PyFloat_FromDouble(__pyx_v_t41); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; goto __pyx_L1;}
+    __pyx_3 = PyFloat_FromDouble(__pyx_v_t42); if (!__pyx_3) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; goto __pyx_L1;}
+    __pyx_4 = PyFloat_FromDouble(__pyx_v_t43); if (!__pyx_4) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; goto __pyx_L1;}
+    __pyx_5 = PyFloat_FromDouble(__pyx_v_t44); if (!__pyx_5) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; goto __pyx_L1;}
+    __pyx_6 = PyFloat_FromDouble(__pyx_v_t45); if (!__pyx_6) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; goto __pyx_L1;}
+    __pyx_7 = PyFloat_FromDouble(__pyx_v_t46); if (!__pyx_7) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; goto __pyx_L1;}
+    __pyx_8 = PyFloat_FromDouble(__pyx_v_t47); if (!__pyx_8) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; goto __pyx_L1;}
+    __pyx_9 = PyFloat_FromDouble(__pyx_v_t48); if (!__pyx_9) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; goto __pyx_L1;}
+    __pyx_10 = PyFloat_FromDouble(__pyx_v_t49); if (!__pyx_10) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; goto __pyx_L1;}
+    __pyx_11 = PyFloat_FromDouble(__pyx_v_t491); if (!__pyx_11) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; goto __pyx_L1;}
+    __pyx_12 = PyFloat_FromDouble(__pyx_v_t492); if (!__pyx_12) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; goto __pyx_L1;}
+    __pyx_13 = PyTuple_New(11); if (!__pyx_13) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 748; goto __pyx_L1;}
     PyTuple_SET_ITEM(__pyx_13, 0, __pyx_2);
     PyTuple_SET_ITEM(__pyx_13, 1, __pyx_3);
     PyTuple_SET_ITEM(__pyx_13, 2, __pyx_4);
@@ -2443,18 +2396,16 @@
     Py_DECREF(__pyx_v_res);
     __pyx_v_res = __pyx_13;
     __pyx_13 = 0;
-    goto __pyx_L14;
+    goto __pyx_L17;
   }
   /*else*/ {
-
-    /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":746 */
     Py_INCREF(Py_None);
     Py_DECREF(__pyx_v_res);
     __pyx_v_res = Py_None;
   }
-  __pyx_L14:;
+  __pyx_L17:;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":747 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":751 */
   Py_INCREF(__pyx_v_res);
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
@@ -2501,20 +2452,14 @@
   {&__pyx_n__scale_factor, "_scale_factor"},
   {&__pyx_n_absdiff, "absdiff"},
   {&__pyx_n_append, "append"},
-  {&__pyx_n_bg_help, "bg_help"},
-  {&__pyx_n_bg_help_slow, "bg_help_slow"},
-  {&__pyx_n_c_lib, "c_lib"},
-  {&__pyx_n_c_python, "c_python"},
   {&__pyx_n_cmp, "cmp"},
   {&__pyx_n_cmpdiff, "cmpdiff"},
   {&__pyx_n_distort, "distort"},
-  {&__pyx_n_do_bg_maint, "do_bg_maint"},
   {&__pyx_n_get_32f_copy_put, "get_32f_copy_put"},
   {&__pyx_n_get_8u_copy_put, "get_8u_copy_put"},
   {&__pyx_n_get_compare_put, "get_compare_put"},
   {&__pyx_n_get_square_put, "get_square_put"},
   {&__pyx_n_get_subtracted_put, "get_subtracted_put"},
-  {&__pyx_n_ipp, "ipp"},
   {&__pyx_n_mask, "mask"},
   {&__pyx_n_mean, "mean"},
   {&__pyx_n_nan, "nan"},
@@ -2536,20 +2481,23 @@
 
 static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_k4p, __pyx_k4, sizeof(__pyx_k4)},
-  {&__pyx_k10p, __pyx_k10, sizeof(__pyx_k10)},
-  {&__pyx_k16p, __pyx_k16, sizeof(__pyx_k16)},
+  {&__pyx_k5p, __pyx_k5, sizeof(__pyx_k5)},
+  {&__pyx_k11p, __pyx_k11, sizeof(__pyx_k11)},
   {&__pyx_k17p, __pyx_k17, sizeof(__pyx_k17)},
-  {&__pyx_k19p, __pyx_k19, sizeof(__pyx_k19)},
+  {&__pyx_k18p, __pyx_k18, sizeof(__pyx_k18)},
   {&__pyx_k20p, __pyx_k20, sizeof(__pyx_k20)},
   {&__pyx_k21p, __pyx_k21, sizeof(__pyx_k21)},
   {&__pyx_k22p, __pyx_k22, sizeof(__pyx_k22)},
   {&__pyx_k23p, __pyx_k23, sizeof(__pyx_k23)},
+  {&__pyx_k24p, __pyx_k24, sizeof(__pyx_k24)},
   {0, 0, 0}
 };
 
 static PyObject *__pyx_tp_new_23realtime_image_analysis_RealtimeAnalyzer(PyTypeObject *t, PyObject *a, PyObject *k) {
+  struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *p;
   PyObject *o = (*t->tp_alloc)(t, 0);
-  struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *p = (struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)o;
+  if (!o) return 0;
+  p = ((struct __pyx_obj_23realtime_image_analysis_RealtimeAnalyzer *)o);
   p->_roi_sz = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_Size *)Py_None); Py_INCREF(Py_None);
   p->absdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
   p->cmpdiff_im = ((struct __pyx_obj_6motmot_9FastImage_9FastImage_FastImage8u *)Py_None); Py_INCREF(Py_None);
@@ -2797,6 +2745,9 @@
   0, /*nb_true_divide*/
   0, /*nb_inplace_floor_divide*/
   0, /*nb_inplace_true_divide*/
+  #if Py_TPFLAGS_DEFAULT & Py_TPFLAGS_HAVE_INDEX
+  0, /*nb_index*/
+  #endif
 };
 
 static PySequenceMethods __pyx_tp_as_sequence_RealtimeAnalyzer = {
@@ -2891,6 +2842,7 @@
   __pyx_init_filenames();
   __pyx_m = Py_InitModule4("realtime_image_analysis", __pyx_methods, 0, 0, PYTHON_API_VERSION);
   if (!__pyx_m) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; goto __pyx_L1;};
+  Py_INCREF(__pyx_m);
   __pyx_b = PyImport_AddModule("__builtin__");
   if (!__pyx_b) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; goto __pyx_L1;};
   if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 9; goto __pyx_L1;};
@@ -2931,9 +2883,13 @@
   Py_DECREF(__pyx_1); __pyx_1 = 0;
 
   /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":15 */
-  __pyx_1 = __Pyx_Import(__pyx_k4p, 0); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; goto __pyx_L1;}
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_FastImage, __pyx_1) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; goto __pyx_L1;}
+  __pyx_1 = PyList_New(1); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; goto __pyx_L1;}
+  Py_INCREF(__pyx_k5p);
+  PyList_SET_ITEM(__pyx_1, 0, __pyx_k5p);
+  __pyx_2 = __Pyx_Import(__pyx_k4p, __pyx_1); if (!__pyx_2) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; goto __pyx_L1;}
   Py_DECREF(__pyx_1); __pyx_1 = 0;
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_FastImage, __pyx_2) < 0) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 15; goto __pyx_L1;}
+  Py_DECREF(__pyx_2); __pyx_2 = 0;
 
   /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":18 */
   __pyx_1 = __Pyx_GetName(__pyx_m, __pyx_n_nx); if (!__pyx_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 18; goto __pyx_L1;}
@@ -2944,15 +2900,15 @@
   __pyx_v_23realtime_image_analysis_nan = __pyx_3;
 
   /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":175 */
-  __pyx_k5 = 0;
-  __pyx_k6 = 0.0;
+  __pyx_k6 = 0;
+  __pyx_k7 = 0.0;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":427 */
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":429 */
   Py_INCREF(__pyx_n_mean);
-  __pyx_k8 = __pyx_n_mean;
+  __pyx_k9 = __pyx_n_mean;
 
-  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":597 */
-  __pyx_k9 = 0;
+  /* "/home/astraw/src/motmot/realtime_image_analysis/src/realtime_image_analysis.pyx":600 */
+  __pyx_k10 = 0;
   return;
   __pyx_L1:;
   Py_XDECREF(__pyx_1);
@@ -2975,11 +2931,14 @@
     PyObject **args, 
     PyObject **kwds,
     char *kwd_list[], 
-    int nargs,
+    Py_ssize_t nargs,
     PyObject **args2, 
-    PyObject **kwds2)
+    PyObject **kwds2,
+    char rqd_kwds[])
 {
     PyObject *x = 0, *args1 = 0, *kwds1 = 0;
+    int i;
+    char **p;
     
     if (args2)
         *args2 = 0;
@@ -2990,25 +2949,37 @@
         args1 = PyTuple_GetSlice(*args, 0, nargs);
         if (!args1)
             goto bad;
-        *args2 = PyTuple_GetSlice(*args, nargs, PyTuple_Size(*args));
+        *args2 = PyTuple_GetSlice(*args, nargs, PyTuple_GET_SIZE(*args));
         if (!*args2)
             goto bad;
     }
+    else if (PyTuple_GET_SIZE(*args) > nargs) {
+        int m = nargs;
+        int n = PyTuple_GET_SIZE(*args);
+        PyErr_Format(PyExc_TypeError,
+            "function takes at most %d positional arguments (%d given)",
+                m, n);
+        goto bad;
+    }
     else {
         args1 = *args;
         Py_INCREF(args1);
     }
     
+    if (rqd_kwds && !*kwds)
+            for (i = 0, p = kwd_list; *p; i++, p++)
+                if (rqd_kwds[i])
+                    goto missing_kwarg;
+    
     if (kwds2) {
         if (*kwds) {
-            char **p;
             kwds1 = PyDict_New();
-            if (!kwds)
+            if (!kwds1)
                 goto bad;
             *kwds2 = PyDict_Copy(*kwds);
             if (!*kwds2)
                 goto bad;
-            for (p = kwd_list; *p; p++) {
+            for (i = 0, p = kwd_list; *p; i++, p++) {
                 x = PyDict_GetItemString(*kwds, *p);
                 if (x) {
                     if (PyDict_SetItemString(kwds1, *p, x) < 0)
@@ -3016,6 +2987,8 @@
                     if (PyDict_DelItemString(*kwds2, *p) < 0)
                         goto bad;
                 }
+                else if (rqd_kwds && rqd_kwds[i])
+                    goto missing_kwarg;
             }
         }
         else {
@@ -3027,18 +3000,25 @@
     else {
         kwds1 = *kwds;
         Py_XINCREF(kwds1);
+        if (rqd_kwds && *kwds)
+            for (i = 0, p = kwd_list; *p; i++, p++)
+                if (rqd_kwds[i] && !PyDict_GetItemString(*kwds, *p))
+                        goto missing_kwarg;
     }
     
     *args = args1;
     *kwds = kwds1;
     return 0;
+missing_kwarg:
+    PyErr_Format(PyExc_TypeError,
+        "required keyword argument '%s' is missing", *p);
 bad:
     Py_XDECREF(args1);
     Py_XDECREF(kwds1);
-    if (*args2) {
+    if (args2) {
         Py_XDECREF(*args2);
     }
-    if (*kwds2) {
+    if (kwds2) {
         Py_XDECREF(*kwds2);
     }
     return -1;
@@ -3117,21 +3097,12 @@
         value = Py_None;
         Py_INCREF(value);
     }
-    /* Next, repeatedly, replace a tuple exception with its first item */
-    while (PyTuple_Check(type) && PyTuple_Size(type) > 0) {
-        PyObject *tmp = type;
-        type = PyTuple_GET_ITEM(type, 0);
-        Py_INCREF(type);
-        Py_DECREF(tmp);
-    }
-    if (PyString_Check(type)) {
-        if (PyErr_Warn(PyExc_DeprecationWarning,
-                "raising a string exception is deprecated"))
-            goto raise_error;
-    }
-    else if (PyType_Check(type) || PyClass_Check(type))
-        ; /*PyErr_NormalizeException(&type, &value, &tb);*/
-    else {
+    #if PY_VERSION_HEX < 0x02050000
+    if (!PyClass_Check(type))
+    #else
+    if (!PyType_Check(type))
+    #endif
+    {
         /* Raising an instance.  The value should be a dummy. */
         if (value != Py_None) {
             PyErr_SetString(PyExc_TypeError,
@@ -3141,11 +3112,25 @@
         /* Normalize to raise <class>, <instance> */
         Py_DECREF(value);
         value = type;
-        if (PyInstance_Check(type))
-            type = (PyObject*) ((PyInstanceObject*)type)->in_class;
-        else
+        #if PY_VERSION_HEX < 0x02050000
+            if (PyInstance_Check(type)) {
+                type = (PyObject*) ((PyInstanceObject*)type)->in_class;
+                Py_INCREF(type);
+            }
+            else {
+                PyErr_SetString(PyExc_TypeError,
+                    "raise: exception must be an old-style class or instance");
+                goto raise_error;
+            }
+        #else
             type = (PyObject*) type->ob_type;
-        Py_INCREF(type);
+            Py_INCREF(type);
+            if (!PyType_IsSubtype((PyTypeObject *)type, (PyTypeObject *)PyExc_BaseException)) {
+                PyErr_SetString(PyExc_TypeError,
+                    "raise: exception class must be a subclass of BaseException");
+                goto raise_error;
+            }
+        #endif
     }
     PyErr_Restore(type, value, tb);
     return;
@@ -3177,7 +3162,7 @@
         return -1;
     if (PyString_Check(v)) {
         char *s = PyString_AsString(v);
-        int len = PyString_Size(v);
+        Py_ssize_t len = PyString_Size(v);
         if (len > 0 &&
             isspace(Py_CHARMASK(s[len-1])) &&
             s[len-1] != ' ')
@@ -3255,31 +3240,18 @@
     return 0;
 }
 
+#ifndef __PYX_HAVE_RT_ImportType
+#define __PYX_HAVE_RT_ImportType
 static PyTypeObject *__Pyx_ImportType(char *module_name, char *class_name, 
     long size) 
 {
-    PyObject *py_module_name = 0;
-    PyObject *py_class_name = 0;
-    PyObject *py_name_list = 0;
     PyObject *py_module = 0;
     PyObject *result = 0;
     
-    py_module_name = PyString_FromString(module_name);
-    if (!py_module_name)
-        goto bad;
-    py_class_name = PyString_FromString(class_name);
-    if (!py_class_name)
-        goto bad;
-    py_name_list = PyList_New(1);
-    if (!py_name_list)
-        goto bad;
-    Py_INCREF(py_class_name);
-    if (PyList_SetItem(py_name_list, 0, py_class_name) < 0)
-        goto bad;
-    py_module = __Pyx_Import(py_module_name, py_name_list);
+    py_module = __Pyx_ImportModule(module_name);
     if (!py_module)
         goto bad;
-    result = PyObject_GetAttr(py_module, py_class_name);
+    result = PyObject_GetAttrString(py_module, class_name);
     if (!result)
         goto bad;
     if (!PyType_Check(result)) {
@@ -3294,17 +3266,28 @@
             module_name, class_name);
         goto bad;
     }
-    goto done;
+    return (PyTypeObject *)result;
 bad:
     Py_XDECREF(result);
-    result = 0;
-done:
-    Py_XDECREF(py_module_name);
-    Py_XDECREF(py_class_name);
-    Py_XDECREF(py_name_list);
-    return (PyTypeObject *)result;
+    return 0;
 }
+#endif
 
+#ifndef __PYX_HAVE_RT_ImportModule
+#define __PYX_HAVE_RT_ImportModule
+static PyObject *__Pyx_ImportModule(char *name) {
+    PyObject *py_name = 0;
+    
+    py_name = PyString_FromString(name);
+    if (!py_name)
+        goto bad;
+    return PyImport_Import(py_name);
+bad:
+    Py_XDECREF(py_name);
+    return 0;
+}
+#endif
+
 static int __Pyx_GetVtable(PyObject *dict, void *vtabptr) {
     int result;
     PyObject *pycobj;
